function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fg(e,t){const r=new Set(e.split(","));return i=>r.has(i)}const Vt={},fa=[],St=()=>{},FT=()=>!1,Wd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),pg=e=>e.startsWith("onUpdate:"),ir=Object.assign,gg=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},TT=Object.prototype.hasOwnProperty,mt=(e,t)=>TT.call(e,t),Ue=Array.isArray,pa=e=>zd(e)==="[object Map]",dy=e=>zd(e)==="[object Set]",Ye=e=>typeof e=="function",ct=e=>typeof e=="string",Ha=e=>typeof e=="symbol",ot=e=>e!==null&&typeof e=="object",hy=e=>(ot(e)||Ye(e))&&Ye(e.then)&&Ye(e.catch),fy=Object.prototype.toString,zd=e=>fy.call(e),Lu=e=>zd(e).slice(8,-1),Zu=e=>zd(e)==="[object Object]",mg=e=>ct(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Rl=fg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$d=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},AT=/-(\w)/g,ts=$d(e=>e.replace(AT,(t,r)=>r?r.toUpperCase():"")),PT=/\B([A-Z])/g,Gn=$d(e=>e.replace(PT,"-$1").toLowerCase()),Tc=$d(e=>e.charAt(0).toUpperCase()+e.slice(1)),Bh=$d(e=>e?`on${Tc(e)}`:""),_n=(e,t)=>!Object.is(e,t),Nu=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},ed=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Wf=e=>{const t=parseFloat(e);return isNaN(t)?e:t},DT=e=>{const t=ct(e)?Number(e):NaN;return isNaN(t)?e:t};let Tm;const py=()=>Tm||(Tm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function kt(e){if(Ue(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],s=ct(i)?IT(i):kt(i);if(s)for(const n in s)t[n]=s[n]}return t}else if(ct(e)||ot(e))return e}const MT=/;(?![^(]*\))/g,kT=/:([^]+)/,_T=/\/\*[^]*?\*\//g;function IT(e){const t={};return e.replace(_T,"").split(MT).forEach(r=>{if(r){const i=r.split(kT);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ae(e){let t="";if(ct(e))t=e;else if(Ue(e))for(let r=0;r<e.length;r++){const i=Ae(e[r]);i&&(t+=i+" ")}else if(ot(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const OT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",LT=fg(OT);function gy(e){return!!e||e===""}const Ut=e=>ct(e)?e:e==null?"":Ue(e)||ot(e)&&(e.toString===fy||!Ye(e.toString))?JSON.stringify(e,my,2):String(e),my=(e,t)=>t&&t.__v_isRef?my(e,t.value):pa(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,s],n)=>(r[Gh(i,n)+" =>"]=s,r),{})}:dy(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>Gh(r))}:Ha(t)?Gh(t):ot(t)&&!Ue(t)&&!Zu(t)?String(t):t,Gh=(e,t="")=>{var r;return Ha(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let hi;class NT{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=hi,!t&&hi&&(this.index=(hi.scopes||(hi.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const r=hi;try{return hi=this,t()}finally{hi=r}}}on(){hi=this}off(){hi=this.parent}stop(t){if(this._active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function BT(e,t=hi){t&&t.active&&t.effects.push(e)}function vy(){return hi}function GT(e){hi&&hi.cleanups.push(e)}let go;class vg{constructor(t,r,i,s){this.fn=t,this.trigger=r,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,BT(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Io();for(let t=0;t<this._depsLength;t++){const r=this.deps[t];if(r.computed&&(HT(r.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Oo()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=An,r=go;try{return An=!0,go=this,this._runnings++,Am(this),this.fn()}finally{Pm(this),this._runnings--,go=r,An=t}}stop(){var t;this.active&&(Am(this),Pm(this),(t=this.onStop)==null||t.call(this),this.active=!1)}}function HT(e){return e.value}function Am(e){e._trackId++,e._depsLength=0}function Pm(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)Cy(e.deps[t],e);e.deps.length=e._depsLength}}function Cy(e,t){const r=e.get(t);r!==void 0&&t._trackId!==r&&(e.delete(t),e.size===0&&e.cleanup())}let An=!0,zf=0;const wy=[];function Io(){wy.push(An),An=!1}function Oo(){const e=wy.pop();An=e===void 0?!0:e}function Cg(){zf++}function wg(){for(zf--;!zf&&$f.length;)$f.shift()()}function Sy(e,t,r){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&Cy(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const $f=[];function yy(e,t,r){Cg();for(const i of e.keys()){let s;i._dirtyLevel<t&&(s??(s=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(s??(s=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&$f.push(i.scheduler)))}wg()}const xy=(e,t)=>{const r=new Map;return r.cleanup=e,r.computed=t,r},td=new WeakMap,mo=Symbol(""),Uf=Symbol("");function ai(e,t,r){if(An&&go){let i=td.get(e);i||td.set(e,i=new Map);let s=i.get(r);s||i.set(r,s=xy(()=>i.delete(r))),Sy(go,s)}}function Ws(e,t,r,i,s,n){const o=td.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(r==="length"&&Ue(e)){const l=Number(i);o.forEach((c,u)=>{(u==="length"||!Ha(u)&&u>=l)&&a.push(c)})}else switch(r!==void 0&&a.push(o.get(r)),t){case"add":Ue(e)?mg(r)&&a.push(o.get("length")):(a.push(o.get(mo)),pa(e)&&a.push(o.get(Uf)));break;case"delete":Ue(e)||(a.push(o.get(mo)),pa(e)&&a.push(o.get(Uf)));break;case"set":pa(e)&&a.push(o.get(mo));break}Cg();for(const l of a)l&&yy(l,4);wg()}function VT(e,t){var r;return(r=td.get(e))==null?void 0:r.get(t)}const WT=fg("__proto__,__v_isRef,__isVue"),by=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ha)),Dm=zT();function zT(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=gt(this);for(let n=0,o=this.length;n<o;n++)ai(i,"get",n+"");const s=i[t](...r);return s===-1||s===!1?i[t](...r.map(gt)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Io(),Cg();const i=gt(this)[t].apply(this,r);return wg(),Oo(),i}}),e}function $T(e){const t=gt(this);return ai(t,"has",e),t.hasOwnProperty(e)}class Ry{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,i){const s=this._isReadonly,n=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return n;if(r==="__v_raw")return i===(s?n?iA:Ay:n?Ty:Fy).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=Ue(t);if(!s){if(o&&mt(Dm,r))return Reflect.get(Dm,r,i);if(r==="hasOwnProperty")return $T}const a=Reflect.get(t,r,i);return(Ha(r)?by.has(r):WT(r))||(s||ai(t,"get",r),n)?a:pr(a)?o&&mg(r)?a:a.value:ot(a)?s?Ac(a):Br(a):a}}class Ey extends Ry{constructor(t=!1){super(!1,t)}set(t,r,i,s){let n=t[r];if(!this._isShallow){const l=ya(n);if(!rd(i)&&!ya(i)&&(n=gt(n),i=gt(i)),!Ue(t)&&pr(n)&&!pr(i))return l?!1:(n.value=i,!0)}const o=Ue(t)&&mg(r)?Number(r)<t.length:mt(t,r),a=Reflect.set(t,r,i,s);return t===gt(s)&&(o?_n(i,n)&&Ws(t,"set",r,i):Ws(t,"add",r,i)),a}deleteProperty(t,r){const i=mt(t,r);t[r];const s=Reflect.deleteProperty(t,r);return s&&i&&Ws(t,"delete",r,void 0),s}has(t,r){const i=Reflect.has(t,r);return(!Ha(r)||!by.has(r))&&ai(t,"has",r),i}ownKeys(t){return ai(t,"iterate",Ue(t)?"length":mo),Reflect.ownKeys(t)}}class UT extends Ry{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const KT=new Ey,jT=new UT,qT=new Ey(!0),Sg=e=>e,Ud=e=>Reflect.getPrototypeOf(e);function Qc(e,t,r=!1,i=!1){e=e.__v_raw;const s=gt(e),n=gt(t);r||(_n(t,n)&&ai(s,"get",t),ai(s,"get",n));const{has:o}=Ud(s),a=i?Sg:r?Rg:Jl;if(o.call(s,t))return a(e.get(t));if(o.call(s,n))return a(e.get(n));e!==s&&e.get(t)}function Jc(e,t=!1){const r=this.__v_raw,i=gt(r),s=gt(e);return t||(_n(e,s)&&ai(i,"has",e),ai(i,"has",s)),e===s?r.has(e):r.has(e)||r.has(s)}function Zc(e,t=!1){return e=e.__v_raw,!t&&ai(gt(e),"iterate",mo),Reflect.get(e,"size",e)}function Mm(e){e=gt(e);const t=gt(this);return Ud(t).has.call(t,e)||(t.add(e),Ws(t,"add",e,e)),this}function km(e,t){t=gt(t);const r=gt(this),{has:i,get:s}=Ud(r);let n=i.call(r,e);n||(e=gt(e),n=i.call(r,e));const o=s.call(r,e);return r.set(e,t),n?_n(t,o)&&Ws(r,"set",e,t):Ws(r,"add",e,t),this}function _m(e){const t=gt(this),{has:r,get:i}=Ud(t);let s=r.call(t,e);s||(e=gt(e),s=r.call(t,e)),i&&i.call(t,e);const n=t.delete(e);return s&&Ws(t,"delete",e,void 0),n}function Im(){const e=gt(this),t=e.size!==0,r=e.clear();return t&&Ws(e,"clear",void 0,void 0),r}function eu(e,t){return function(i,s){const n=this,o=n.__v_raw,a=gt(o),l=t?Sg:e?Rg:Jl;return!e&&ai(a,"iterate",mo),o.forEach((c,u)=>i.call(s,l(c),l(u),n))}}function tu(e,t,r){return function(...i){const s=this.__v_raw,n=gt(s),o=pa(n),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=s[e](...i),u=r?Sg:t?Rg:Jl;return!t&&ai(n,"iterate",l?Uf:mo),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function an(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function YT(){const e={get(n){return Qc(this,n)},get size(){return Zc(this)},has:Jc,add:Mm,set:km,delete:_m,clear:Im,forEach:eu(!1,!1)},t={get(n){return Qc(this,n,!1,!0)},get size(){return Zc(this)},has:Jc,add:Mm,set:km,delete:_m,clear:Im,forEach:eu(!1,!0)},r={get(n){return Qc(this,n,!0)},get size(){return Zc(this,!0)},has(n){return Jc.call(this,n,!0)},add:an("add"),set:an("set"),delete:an("delete"),clear:an("clear"),forEach:eu(!0,!1)},i={get(n){return Qc(this,n,!0,!0)},get size(){return Zc(this,!0)},has(n){return Jc.call(this,n,!0)},add:an("add"),set:an("set"),delete:an("delete"),clear:an("clear"),forEach:eu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=tu(n,!1,!1),r[n]=tu(n,!0,!1),t[n]=tu(n,!1,!0),i[n]=tu(n,!0,!0)}),[e,r,t,i]}const[XT,QT,JT,ZT]=YT();function yg(e,t){const r=t?e?ZT:JT:e?QT:XT;return(i,s,n)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(mt(r,s)&&s in i?r:i,s,n)}const eA={get:yg(!1,!1)},tA={get:yg(!1,!0)},rA={get:yg(!0,!1)},Fy=new WeakMap,Ty=new WeakMap,Ay=new WeakMap,iA=new WeakMap;function sA(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function nA(e){return e.__v_skip||!Object.isExtensible(e)?0:sA(Lu(e))}function Br(e){return ya(e)?e:bg(e,!1,KT,eA,Fy)}function xg(e){return bg(e,!1,qT,tA,Ty)}function Ac(e){return bg(e,!0,jT,rA,Ay)}function bg(e,t,r,i,s){if(!ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const n=s.get(e);if(n)return n;const o=nA(e);if(o===0)return e;const a=new Proxy(e,o===2?i:r);return s.set(e,a),a}function ga(e){return ya(e)?ga(e.__v_raw):!!(e&&e.__v_isReactive)}function ya(e){return!!(e&&e.__v_isReadonly)}function rd(e){return!!(e&&e.__v_isShallow)}function Py(e){return ga(e)||ya(e)}function gt(e){const t=e&&e.__v_raw;return t?gt(t):e}function Kd(e){return Object.isExtensible(e)&&ed(e,"__v_skip",!0),e}const Jl=e=>ot(e)?Br(e):e,Rg=e=>ot(e)?Ac(e):e;class Dy{constructor(t,r,i,s){this.getter=t,this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new vg(()=>t(this._value),()=>Bu(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=i}get value(){const t=gt(this);return(!t._cacheable||t.effect.dirty)&&_n(t._value,t._value=t.effect.run())&&Bu(t,4),My(t),t.effect._dirtyLevel>=2&&Bu(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function oA(e,t,r=!1){let i,s;const n=Ye(e);return n?(i=e,s=St):(i=e.get,s=e.set),new Dy(i,s,n||!s,r)}function My(e){var t;An&&go&&(e=gt(e),Sy(go,(t=e.dep)!=null?t:e.dep=xy(()=>e.dep=void 0,e instanceof Dy?e:void 0)))}function Bu(e,t=4,r){e=gt(e);const i=e.dep;i&&yy(i,t)}function pr(e){return!!(e&&e.__v_isRef===!0)}function we(e){return ky(e,!1)}function dr(e){return ky(e,!0)}function ky(e,t){return pr(e)?e:new aA(e,t)}class aA{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:gt(t),this._value=r?t:Jl(t)}get value(){return My(this),this._value}set value(t){const r=this.__v_isShallow||rd(t)||ya(t);t=r?t:gt(t),_n(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Jl(t),Bu(this,4))}}function S(e){return pr(e)?e.value:e}const lA={get:(e,t,r)=>S(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const s=e[t];return pr(s)&&!pr(r)?(s.value=r,!0):Reflect.set(e,t,r,i)}};function _y(e){return ga(e)?e:new Proxy(e,lA)}function Pc(e){const t=Ue(e)?new Array(e.length):{};for(const r in e)t[r]=Iy(e,r);return t}class cA{constructor(t,r,i){this._object=t,this._key=r,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return VT(gt(this._object),this._key)}}class uA{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function ii(e,t,r){return pr(e)?e:Ye(e)?new uA(e):ot(e)&&arguments.length>1?Iy(e,t,r):we(e)}function Iy(e,t,r){const i=e[t];return pr(i)?i:new cA(e,t,r)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Pn(e,t,r,i){try{return i?e(...i):e()}catch(s){jd(s,t,r)}}function Ai(e,t,r,i){if(Ye(e)){const n=Pn(e,t,r,i);return n&&hy(n)&&n.catch(o=>{jd(o,t,r)}),n}const s=[];for(let n=0;n<e.length;n++)s.push(Ai(e[n],t,r,i));return s}function jd(e,t,r,i=!0){const s=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${r}`;for(;n;){const c=n.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,o,a)===!1)return}n=n.parent}const l=t.appContext.config.errorHandler;if(l){Pn(l,null,10,[e,o,a]);return}}dA(e,r,s,i)}function dA(e,t,r,i=!0){console.error(e)}let Zl=!1,Kf=!1;const Dr=[];let vs=0;const ma=[];let mn=null,eo=0;const Oy=Promise.resolve();let Eg=null;function Tt(e){const t=Eg||Oy;return e?t.then(this?e.bind(this):e):t}function hA(e){let t=vs+1,r=Dr.length;for(;t<r;){const i=t+r>>>1,s=Dr[i],n=ec(s);n<e||n===e&&s.pre?t=i+1:r=i}return t}function Fg(e){(!Dr.length||!Dr.includes(e,Zl&&e.allowRecurse?vs+1:vs))&&(e.id==null?Dr.push(e):Dr.splice(hA(e.id),0,e),Ly())}function Ly(){!Zl&&!Kf&&(Kf=!0,Eg=Oy.then(By))}function fA(e){const t=Dr.indexOf(e);t>vs&&Dr.splice(t,1)}function pA(e){Ue(e)?ma.push(...e):(!mn||!mn.includes(e,e.allowRecurse?eo+1:eo))&&ma.push(e),Ly()}function Om(e,t,r=Zl?vs+1:0){for(;r<Dr.length;r++){const i=Dr[r];if(i&&i.pre){if(e&&i.id!==e.uid)continue;Dr.splice(r,1),r--,i()}}}function Ny(e){if(ma.length){const t=[...new Set(ma)].sort((r,i)=>ec(r)-ec(i));if(ma.length=0,mn){mn.push(...t);return}for(mn=t,eo=0;eo<mn.length;eo++)mn[eo]();mn=null,eo=0}}const ec=e=>e.id==null?1/0:e.id,gA=(e,t)=>{const r=ec(e)-ec(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function By(e){Kf=!1,Zl=!0,Dr.sort(gA);try{for(vs=0;vs<Dr.length;vs++){const t=Dr[vs];t&&t.active!==!1&&Pn(t,null,14)}}finally{vs=0,Dr.length=0,Ny(),Zl=!1,Eg=null,(Dr.length||ma.length)&&By()}}function mA(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||Vt;let s=r;const n=t.startsWith("update:"),o=n&&t.slice(7);if(o&&o in i){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:h}=i[u]||Vt;h&&(s=r.map(p=>ct(p)?p.trim():p)),d&&(s=r.map(Wf))}let a,l=i[a=Bh(t)]||i[a=Bh(ts(t))];!l&&n&&(l=i[a=Bh(Gn(t))]),l&&Ai(l,e,6,s);const c=i[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Ai(c,e,6,s)}}function Gy(e,t,r=!1){const i=t.emitsCache,s=i.get(e);if(s!==void 0)return s;const n=e.emits;let o={},a=!1;if(!Ye(e)){const l=c=>{const u=Gy(c,t,!0);u&&(a=!0,ir(o,u))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!n&&!a?(ot(e)&&i.set(e,null),null):(Ue(n)?n.forEach(l=>o[l]=null):ir(o,n),ot(e)&&i.set(e,o),o)}function qd(e,t){return!e||!Wd(t)?!1:(t=t.slice(2).replace(/Once$/,""),mt(e,t[0].toLowerCase()+t.slice(1))||mt(e,Gn(t))||mt(e,t))}let nr=null,Hy=null;function id(e){const t=nr;return nr=e,Hy=e&&e.type.__scopeId||null,t}function ze(e,t=nr,r){if(!t||e._n)return e;const i=(...s)=>{i._d&&Xm(-1);const n=id(t);let o;try{o=e(...s)}finally{id(n),i._d&&Xm(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Hh(e){const{type:t,vnode:r,proxy:i,withProxy:s,props:n,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:d,data:h,setupState:p,ctx:g,inheritAttrs:f}=e;let m,v;const w=id(e);try{if(r.shapeFlag&4){const F=s||i,D=F;m=ms(u.call(D,F,d,n,p,h,g)),v=l}else{const F=t;m=ms(F.length>1?F(n,{attrs:l,slots:a,emit:c}):F(n,null)),v=t.props?l:vA(l)}}catch(F){Pl.length=0,jd(F,e,1),m=ye(Ci)}let C=m;if(v&&f!==!1){const F=Object.keys(v),{shapeFlag:D}=C;F.length&&D&7&&(o&&F.some(pg)&&(v=CA(v,o)),C=js(C,v))}return r.dirs&&(C=js(C),C.dirs=C.dirs?C.dirs.concat(r.dirs):r.dirs),r.transition&&(C.transition=r.transition),m=C,id(w),m}const vA=e=>{let t;for(const r in e)(r==="class"||r==="style"||Wd(r))&&((t||(t={}))[r]=e[r]);return t},CA=(e,t)=>{const r={};for(const i in e)(!pg(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function wA(e,t,r){const{props:i,children:s,component:n}=e,{props:o,children:a,patchFlag:l}=t,c=n.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return i?Lm(i,o,c):!!o;if(l&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(o[h]!==i[h]&&!qd(c,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Lm(i,o,c):!0:!!o;return!1}function Lm(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const n=i[s];if(t[n]!==e[n]&&!qd(r,n))return!0}return!1}function SA({vnode:e,parent:t},r){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=r,t=t.parent;else break}}const Tg="components",yA="directives";function qn(e,t){return Ag(Tg,e,!0,t)||e}const Vy=Symbol.for("v-ndc");function kr(e){return ct(e)?Ag(Tg,e,!1)||e:e||Vy}function xA(e){return Ag(yA,e)}function Ag(e,t,r=!0,i=!1){const s=nr||Sr;if(s){const n=s.type;if(e===Tg){const a=pP(n,!1);if(a&&(a===t||a===ts(t)||a===Tc(ts(t))))return n}const o=Nm(s[e]||n[e],t)||Nm(s.appContext[e],t);return!o&&i?n:o}}function Nm(e,t){return e&&(e[t]||e[ts(t)]||e[Tc(ts(t))])}const bA=e=>e.__isSuspense;function RA(e,t){t&&t.pendingBranch?Ue(e)?t.effects.push(...e):t.effects.push(e):pA(e)}const EA=Symbol.for("v-scx"),FA=()=>rt(EA);function Wy(e,t){return Pg(e,null,t)}const ru={};function Qe(e,t,r){return Pg(e,t,r)}function Pg(e,t,{immediate:r,deep:i,flush:s,once:n,onTrack:o,onTrigger:a}=Vt){if(t&&n){const R=t;t=(...y)=>{R(...y),D()}}const l=Sr,c=R=>i===!0?R:oo(R,i===!1?1:void 0);let u,d=!1,h=!1;if(pr(e)?(u=()=>e.value,d=rd(e)):ga(e)?(u=()=>c(e),d=!0):Ue(e)?(h=!0,d=e.some(R=>ga(R)||rd(R)),u=()=>e.map(R=>{if(pr(R))return R.value;if(ga(R))return c(R);if(Ye(R))return Pn(R,l,2)})):Ye(e)?t?u=()=>Pn(e,l,2):u=()=>(p&&p(),Ai(e,l,3,[g])):u=St,t&&i){const R=u;u=()=>oo(R())}let p,g=R=>{p=C.onStop=()=>{Pn(R,l,4),p=C.onStop=void 0}},f;if(eh)if(g=St,t?r&&Ai(t,l,3,[u(),h?[]:void 0,g]):u(),s==="sync"){const R=FA();f=R.__watcherHandles||(R.__watcherHandles=[])}else return St;let m=h?new Array(e.length).fill(ru):ru;const v=()=>{if(!(!C.active||!C.dirty))if(t){const R=C.run();(i||d||(h?R.some((y,b)=>_n(y,m[b])):_n(R,m)))&&(p&&p(),Ai(t,l,3,[R,m===ru?void 0:h&&m[0]===ru?[]:m,g]),m=R)}else C.run()};v.allowRecurse=!!t;let w;s==="sync"?w=v:s==="post"?w=()=>ei(v,l&&l.suspense):(v.pre=!0,l&&(v.id=l.uid),w=()=>Fg(v));const C=new vg(u,St,w),F=vy(),D=()=>{C.stop(),F&&gg(F.effects,C)};return t?r?v():m=C.run():s==="post"?ei(C.run.bind(C),l&&l.suspense):C.run(),f&&f.push(D),D}function TA(e,t,r){const i=this.proxy,s=ct(e)?e.includes(".")?zy(i,e):()=>i[e]:e.bind(i,i);let n;Ye(t)?n=t:(n=t.handler,r=t);const o=Dc(this),a=Pg(s,n.bind(i),r);return o(),a}function zy(e,t){const r=t.split(".");return()=>{let i=e;for(let s=0;s<r.length&&i;s++)i=i[r[s]];return i}}function oo(e,t,r=0,i){if(!ot(e)||e.__v_skip)return e;if(t&&t>0){if(r>=t)return e;r++}if(i=i||new Set,i.has(e))return e;if(i.add(e),pr(e))oo(e.value,t,r,i);else if(Ue(e))for(let s=0;s<e.length;s++)oo(e[s],t,r,i);else if(dy(e)||pa(e))e.forEach(s=>{oo(s,t,r,i)});else if(Zu(e))for(const s in e)oo(e[s],t,r,i);return e}function Yr(e,t){if(nr===null)return e;const r=th(nr)||nr.proxy,i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[n,o,a,l=Vt]=t[s];n&&(Ye(n)&&(n={mounted:n,updated:n}),n.deep&&oo(o),i.push({dir:n,instance:r,value:o,oldValue:void 0,arg:a,modifiers:l}))}return e}function Yn(e,t,r,i){const s=e.dirs,n=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];n&&(a.oldValue=n[o].value);let l=a.dir[i];l&&(Io(),Ai(l,r,8,[e.el,a,e,t]),Oo())}}const vn=Symbol("_leaveCb"),iu=Symbol("_enterCb");function $y(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Gt(()=>{e.isMounted=!0}),Er(()=>{e.isUnmounting=!0}),e}const yi=[Function,Array],Uy={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:yi,onEnter:yi,onAfterEnter:yi,onEnterCancelled:yi,onBeforeLeave:yi,onLeave:yi,onAfterLeave:yi,onLeaveCancelled:yi,onBeforeAppear:yi,onAppear:yi,onAfterAppear:yi,onAppearCancelled:yi},AA={name:"BaseTransition",props:Uy,setup(e,{slots:t}){const r=Bt(),i=$y();return()=>{const s=t.default&&Dg(t.default(),!0);if(!s||!s.length)return;let n=s[0];if(s.length>1){for(const h of s)if(h.type!==Ci){n=h;break}}const o=gt(e),{mode:a}=o;if(i.isLeaving)return Vh(n);const l=Bm(n);if(!l)return Vh(n);const c=tc(l,o,i,r);rc(l,c);const u=r.subTree,d=u&&Bm(u);if(d&&d.type!==Ci&&!to(l,d)){const h=tc(d,o,i,r);if(rc(d,h),a==="out-in")return i.isLeaving=!0,h.afterLeave=()=>{i.isLeaving=!1,r.update.active!==!1&&(r.effect.dirty=!0,r.update())},Vh(n);a==="in-out"&&l.type!==Ci&&(h.delayLeave=(p,g,f)=>{const m=Ky(i,d);m[String(d.key)]=d,p[vn]=()=>{g(),p[vn]=void 0,delete c.delayedLeave},c.delayedLeave=f})}return n}}},PA=AA;function Ky(e,t){const{leavingVNodes:r}=e;let i=r.get(t.type);return i||(i=Object.create(null),r.set(t.type,i)),i}function tc(e,t,r,i){const{appear:s,mode:n,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:h,onAfterLeave:p,onLeaveCancelled:g,onBeforeAppear:f,onAppear:m,onAfterAppear:v,onAppearCancelled:w}=t,C=String(e.key),F=Ky(r,e),D=(b,x)=>{b&&Ai(b,i,9,x)},R=(b,x)=>{const T=x[1];D(b,x),Ue(b)?b.every(A=>A.length<=1)&&T():b.length<=1&&T()},y={mode:n,persisted:o,beforeEnter(b){let x=a;if(!r.isMounted)if(s)x=f||a;else return;b[vn]&&b[vn](!0);const T=F[C];T&&to(e,T)&&T.el[vn]&&T.el[vn](),D(x,[b])},enter(b){let x=l,T=c,A=u;if(!r.isMounted)if(s)x=m||l,T=v||c,A=w||u;else return;let P=!1;const U=b[iu]=J=>{P||(P=!0,J?D(A,[b]):D(T,[b]),y.delayedLeave&&y.delayedLeave(),b[iu]=void 0)};x?R(x,[b,U]):U()},leave(b,x){const T=String(e.key);if(b[iu]&&b[iu](!0),r.isUnmounting)return x();D(d,[b]);let A=!1;const P=b[vn]=U=>{A||(A=!0,x(),U?D(g,[b]):D(p,[b]),b[vn]=void 0,F[T]===e&&delete F[T])};F[T]=e,h?R(h,[b,P]):P()},clone(b){return tc(b,t,r,i)}};return y}function Vh(e){if(Yd(e))return e=js(e),e.children=null,e}function Bm(e){return Yd(e)?e.children?e.children[0]:void 0:e}function rc(e,t){e.shapeFlag&6&&e.component?rc(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Dg(e,t=!1,r){let i=[],s=0;for(let n=0;n<e.length;n++){let o=e[n];const a=r==null?o.key:String(r)+String(o.key!=null?o.key:n);o.type===Dt?(o.patchFlag&128&&s++,i=i.concat(Dg(o.children,t,a))):(t||o.type!==Ci)&&i.push(a!=null?js(o,{key:a}):o)}if(s>1)for(let n=0;n<i.length;n++)i[n].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function _e(e,t){return Ye(e)?ir({name:e.name},t,{setup:e}):e}const El=e=>!!e.type.__asyncLoader,Yd=e=>e.type.__isKeepAlive;function DA(e,t){qy(e,"a",t)}function jy(e,t){qy(e,"da",t)}function qy(e,t,r=Sr){const i=e.__wdc||(e.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Xd(t,i,r),r){let s=r.parent;for(;s&&s.parent;)Yd(s.parent.vnode)&&MA(i,t,r,s),s=s.parent}}function MA(e,t,r,i){const s=Xd(t,e,i,!0);Qd(()=>{gg(i[t],s)},r)}function Xd(e,t,r=Sr,i=!1){if(r){const s=r[e]||(r[e]=[]),n=t.__weh||(t.__weh=(...o)=>{if(r.isUnmounted)return;Io();const a=Dc(r),l=Ai(t,r,e,o);return a(),Oo(),l});return i?s.unshift(n):s.push(n),n}}const Zs=e=>(t,r=Sr)=>(!eh||e==="sp")&&Xd(e,(...i)=>t(...i),r),Yy=Zs("bm"),Gt=Zs("m"),kA=Zs("bu"),Va=Zs("u"),Er=Zs("bum"),Qd=Zs("um"),_A=Zs("sp"),IA=Zs("rtg"),OA=Zs("rtc");function LA(e,t=Sr){Xd("ec",e,t)}function ao(e,t,r,i){let s;const n=r;if(Ue(e)||ct(e)){s=new Array(e.length);for(let o=0,a=e.length;o<a;o++)s[o]=t(e[o],o,void 0,n)}else if(typeof e=="number"){s=new Array(e);for(let o=0;o<e;o++)s[o]=t(o+1,o,void 0,n)}else if(ot(e))if(e[Symbol.iterator])s=Array.from(e,(o,a)=>t(o,a,void 0,n));else{const o=Object.keys(e);s=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];s[a]=t(e[c],c,a,n)}}else s=[];return s}function Gm(e,t){for(let r=0;r<t.length;r++){const i=t[r];if(Ue(i))for(let s=0;s<i.length;s++)e[i[s].name]=i[s].fn;else i&&(e[i.name]=i.key?(...s)=>{const n=i.fn(...s);return n&&(n.key=i.key),n}:i.fn)}return e}function Xe(e,t,r={},i,s){if(nr.isCE||nr.parent&&El(nr.parent)&&nr.parent.isCE)return t!=="default"&&(r.name=t),ye("slot",r,i&&i());let n=e[t];n&&n._c&&(n._d=!1),ue();const o=n&&Xy(n(r)),a=Je(Dt,{key:r.key||o&&o.key||`_${t}`},o||(i?i():[]),o&&e._===1?64:-2);return a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),n&&n._c&&(n._d=!0),a}function Xy(e){return e.some(t=>Lr(t)?!(t.type===Ci||t.type===Dt&&!Xy(t.children)):!0)?e:null}const jf=e=>e?cx(e)?th(e)||e.proxy:jf(e.parent):null,Fl=ir(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jf(e.parent),$root:e=>jf(e.root),$emit:e=>e.emit,$options:e=>Mg(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Fg(e.update)}),$nextTick:e=>e.n||(e.n=Tt.bind(e.proxy)),$watch:e=>TA.bind(e)}),Wh=(e,t)=>e!==Vt&&!e.__isScriptSetup&&mt(e,t),NA={get({_:e},t){const{ctx:r,setupState:i,data:s,props:n,accessCache:o,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const p=o[t];if(p!==void 0)switch(p){case 1:return i[t];case 2:return s[t];case 4:return r[t];case 3:return n[t]}else{if(Wh(i,t))return o[t]=1,i[t];if(s!==Vt&&mt(s,t))return o[t]=2,s[t];if((c=e.propsOptions[0])&&mt(c,t))return o[t]=3,n[t];if(r!==Vt&&mt(r,t))return o[t]=4,r[t];qf&&(o[t]=0)}}const u=Fl[t];let d,h;if(u)return t==="$attrs"&&ai(e,"get",t),u(e);if((d=a.__cssModules)&&(d=d[t]))return d;if(r!==Vt&&mt(r,t))return o[t]=4,r[t];if(h=l.config.globalProperties,mt(h,t))return h[t]},set({_:e},t,r){const{data:i,setupState:s,ctx:n}=e;return Wh(s,t)?(s[t]=r,!0):i!==Vt&&mt(i,t)?(i[t]=r,!0):mt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(n[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:s,propsOptions:n}},o){let a;return!!r[o]||e!==Vt&&mt(e,o)||Wh(t,o)||(a=n[0])&&mt(a,o)||mt(i,o)||mt(Fl,o)||mt(s.config.globalProperties,o)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:mt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function Jd(){return Qy().slots}function BA(){return Qy().attrs}function Qy(){const e=Bt();return e.setupContext||(e.setupContext=dx(e))}function Hm(e){return Ue(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let qf=!0;function GA(e){const t=Mg(e),r=e.proxy,i=e.ctx;qf=!1,t.beforeCreate&&Vm(t.beforeCreate,e,"bc");const{data:s,computed:n,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:p,updated:g,activated:f,deactivated:m,beforeDestroy:v,beforeUnmount:w,destroyed:C,unmounted:F,render:D,renderTracked:R,renderTriggered:y,errorCaptured:b,serverPrefetch:x,expose:T,inheritAttrs:A,components:P,directives:U,filters:J}=t;if(c&&HA(c,i,null),o)for(const _ in o){const se=o[_];Ye(se)&&(i[_]=se.bind(r))}if(s){const _=s.call(r,r);ot(_)&&(e.data=Br(_))}if(qf=!0,n)for(const _ in n){const se=n[_],G=Ye(se)?se.bind(r,r):Ye(se.get)?se.get.bind(r,r):St,he=!Ye(se)&&Ye(se.set)?se.set.bind(r):St,Re=Q({get:G,set:he});Object.defineProperty(i,_,{enumerable:!0,configurable:!0,get:()=>Re.value,set:M=>Re.value=M})}if(a)for(const _ in a)Jy(a[_],i,r,_);if(l){const _=Ye(l)?l.call(r):l;Reflect.ownKeys(_).forEach(se=>{rr(se,_[se])})}u&&Vm(u,e,"c");function H(_,se){Ue(se)?se.forEach(G=>_(G.bind(r))):se&&_(se.bind(r))}if(H(Yy,d),H(Gt,h),H(kA,p),H(Va,g),H(DA,f),H(jy,m),H(LA,b),H(OA,R),H(IA,y),H(Er,w),H(Qd,F),H(_A,x),Ue(T))if(T.length){const _=e.exposed||(e.exposed={});T.forEach(se=>{Object.defineProperty(_,se,{get:()=>r[se],set:G=>r[se]=G})})}else e.exposed||(e.exposed={});D&&e.render===St&&(e.render=D),A!=null&&(e.inheritAttrs=A),P&&(e.components=P),U&&(e.directives=U)}function HA(e,t,r=St){Ue(e)&&(e=Yf(e));for(const i in e){const s=e[i];let n;ot(s)?"default"in s?n=rt(s.from||i,s.default,!0):n=rt(s.from||i):n=rt(s),pr(n)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):t[i]=n}}function Vm(e,t,r){Ai(Ue(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function Jy(e,t,r,i){const s=i.includes(".")?zy(r,i):()=>r[i];if(ct(e)){const n=t[e];Ye(n)&&Qe(s,n)}else if(Ye(e))Qe(s,e.bind(r));else if(ot(e))if(Ue(e))e.forEach(n=>Jy(n,t,r,i));else{const n=Ye(e.handler)?e.handler.bind(r):t[e.handler];Ye(n)&&Qe(s,n,e)}}function Mg(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:s,optionsCache:n,config:{optionMergeStrategies:o}}=e.appContext,a=n.get(t);let l;return a?l=a:!s.length&&!r&&!i?l=t:(l={},s.length&&s.forEach(c=>sd(l,c,o,!0)),sd(l,t,o)),ot(t)&&n.set(t,l),l}function sd(e,t,r,i=!1){const{mixins:s,extends:n}=t;n&&sd(e,n,r,!0),s&&s.forEach(o=>sd(e,o,r,!0));for(const o in t)if(!(i&&o==="expose")){const a=VA[o]||r&&r[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const VA={data:Wm,props:zm,emits:zm,methods:gl,computed:gl,beforeCreate:Vr,created:Vr,beforeMount:Vr,mounted:Vr,beforeUpdate:Vr,updated:Vr,beforeDestroy:Vr,beforeUnmount:Vr,destroyed:Vr,unmounted:Vr,activated:Vr,deactivated:Vr,errorCaptured:Vr,serverPrefetch:Vr,components:gl,directives:gl,watch:zA,provide:Wm,inject:WA};function Wm(e,t){return t?e?function(){return ir(Ye(e)?e.call(this,this):e,Ye(t)?t.call(this,this):t)}:t:e}function WA(e,t){return gl(Yf(e),Yf(t))}function Yf(e){if(Ue(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Vr(e,t){return e?[...new Set([].concat(e,t))]:t}function gl(e,t){return e?ir(Object.create(null),e,t):t}function zm(e,t){return e?Ue(e)&&Ue(t)?[...new Set([...e,...t])]:ir(Object.create(null),Hm(e),Hm(t??{})):t}function zA(e,t){if(!e)return t;if(!t)return e;const r=ir(Object.create(null),e);for(const i in t)r[i]=Vr(e[i],t[i]);return r}function Zy(){return{app:null,config:{isNativeTag:FT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $A=0;function UA(e,t){return function(i,s=null){Ye(i)||(i=ir({},i)),s!=null&&!ot(s)&&(s=null);const n=Zy(),o=new WeakSet;let a=!1;const l=n.app={_uid:$A++,_component:i,_props:s,_container:null,_context:n,_instance:null,version:mP,get config(){return n.config},set config(c){},use(c,...u){return o.has(c)||(c&&Ye(c.install)?(o.add(c),c.install(l,...u)):Ye(c)&&(o.add(c),c(l,...u))),l},mixin(c){return n.mixins.includes(c)||n.mixins.push(c),l},component(c,u){return u?(n.components[c]=u,l):n.components[c]},directive(c,u){return u?(n.directives[c]=u,l):n.directives[c]},mount(c,u,d){if(!a){const h=ye(i,s);return h.appContext=n,d===!0?d="svg":d===!1&&(d=void 0),u&&t?t(h,c):e(h,c,d),a=!0,l._container=c,c.__vue_app__=l,th(h.component)||h.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return n.provides[c]=u,l},runWithContext(c){const u=Tl;Tl=l;try{return c()}finally{Tl=u}}};return l}}let Tl=null;function rr(e,t){if(Sr){let r=Sr.provides;const i=Sr.parent&&Sr.parent.provides;i===r&&(r=Sr.provides=Object.create(i)),r[e]=t}}function rt(e,t,r=!1){const i=Sr||nr;if(i||Tl){const s=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Tl._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return r&&Ye(t)?t.call(i&&i.proxy):t}}function KA(e,t,r,i=!1){const s={},n={};ed(n,Zd,1),e.propsDefaults=Object.create(null),ex(e,t,s,n);for(const o in e.propsOptions[0])o in s||(s[o]=void 0);r?e.props=i?s:xg(s):e.type.props?e.props=s:e.props=n,e.attrs=n}function jA(e,t,r,i){const{props:s,attrs:n,vnode:{patchFlag:o}}=e,a=gt(s),[l]=e.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const u=e.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(qd(e.emitsOptions,h))continue;const p=t[h];if(l)if(mt(n,h))p!==n[h]&&(n[h]=p,c=!0);else{const g=ts(h);s[g]=Xf(l,a,g,p,e,!1)}else p!==n[h]&&(n[h]=p,c=!0)}}}else{ex(e,t,s,n)&&(c=!0);let u;for(const d in a)(!t||!mt(t,d)&&((u=Gn(d))===d||!mt(t,u)))&&(l?r&&(r[d]!==void 0||r[u]!==void 0)&&(s[d]=Xf(l,a,d,void 0,e,!0)):delete s[d]);if(n!==a)for(const d in n)(!t||!mt(t,d))&&(delete n[d],c=!0)}c&&Ws(e,"set","$attrs")}function ex(e,t,r,i){const[s,n]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(Rl(l))continue;const c=t[l];let u;s&&mt(s,u=ts(l))?!n||!n.includes(u)?r[u]=c:(a||(a={}))[u]=c:qd(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(n){const l=gt(r),c=a||Vt;for(let u=0;u<n.length;u++){const d=n[u];r[d]=Xf(s,l,d,c[d],e,!mt(c,d))}}return o}function Xf(e,t,r,i,s,n){const o=e[r];if(o!=null){const a=mt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ye(l)){const{propsDefaults:c}=s;if(r in c)i=c[r];else{const u=Dc(s);i=c[r]=l.call(null,t),u()}}else i=l}o[0]&&(n&&!a?i=!1:o[1]&&(i===""||i===Gn(r))&&(i=!0))}return i}function tx(e,t,r=!1){const i=t.propsCache,s=i.get(e);if(s)return s;const n=e.props,o={},a=[];let l=!1;if(!Ye(e)){const u=d=>{l=!0;const[h,p]=tx(d,t,!0);ir(o,h),p&&a.push(...p)};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!n&&!l)return ot(e)&&i.set(e,fa),fa;if(Ue(n))for(let u=0;u<n.length;u++){const d=ts(n[u]);$m(d)&&(o[d]=Vt)}else if(n)for(const u in n){const d=ts(u);if($m(d)){const h=n[u],p=o[d]=Ue(h)||Ye(h)?{type:h}:ir({},h);if(p){const g=jm(Boolean,p.type),f=jm(String,p.type);p[0]=g>-1,p[1]=f<0||g<f,(g>-1||mt(p,"default"))&&a.push(d)}}}const c=[o,a];return ot(e)&&i.set(e,c),c}function $m(e){return e[0]!=="$"&&!Rl(e)}function Um(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function Km(e,t){return Um(e)===Um(t)}function jm(e,t){return Ue(t)?t.findIndex(r=>Km(r,e)):Ye(t)&&Km(t,e)?0:-1}const rx=e=>e[0]==="_"||e==="$stable",kg=e=>Ue(e)?e.map(ms):[ms(e)],qA=(e,t,r)=>{if(t._n)return t;const i=ze((...s)=>kg(t(...s)),r);return i._c=!1,i},ix=(e,t,r)=>{const i=e._ctx;for(const s in e){if(rx(s))continue;const n=e[s];if(Ye(n))t[s]=qA(s,n,i);else if(n!=null){const o=kg(n);t[s]=()=>o}}},sx=(e,t)=>{const r=kg(t);e.slots.default=()=>r},YA=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=gt(t),ed(t,"_",r)):ix(t,e.slots={})}else e.slots={},t&&sx(e,t);ed(e.slots,Zd,1)},XA=(e,t,r)=>{const{vnode:i,slots:s}=e;let n=!0,o=Vt;if(i.shapeFlag&32){const a=t._;a?r&&a===1?n=!1:(ir(s,t),!r&&a===1&&delete s._):(n=!t.$stable,ix(t,s)),o=t}else t&&(sx(e,t),o={default:1});if(n)for(const a in s)!rx(a)&&o[a]==null&&delete s[a]};function Qf(e,t,r,i,s=!1){if(Ue(e)){e.forEach((h,p)=>Qf(h,t&&(Ue(t)?t[p]:t),r,i,s));return}if(El(i)&&!s)return;const n=i.shapeFlag&4?th(i.component)||i.component.proxy:i.el,o=s?null:n,{i:a,r:l}=e,c=t&&t.r,u=a.refs===Vt?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(ct(c)?(u[c]=null,mt(d,c)&&(d[c]=null)):pr(c)&&(c.value=null)),Ye(l))Pn(l,a,12,[o,u]);else{const h=ct(l),p=pr(l);if(h||p){const g=()=>{if(e.f){const f=h?mt(d,l)?d[l]:u[l]:l.value;s?Ue(f)&&gg(f,n):Ue(f)?f.includes(n)||f.push(n):h?(u[l]=[n],mt(d,l)&&(d[l]=u[l])):(l.value=[n],e.k&&(u[e.k]=l.value))}else h?(u[l]=o,mt(d,l)&&(d[l]=o)):p&&(l.value=o,e.k&&(u[e.k]=o))};o?(g.id=-1,ei(g,r)):g()}}}const ei=RA;function QA(e){return JA(e)}function JA(e,t){const r=py();r.__VUE__=!0;const{insert:i,remove:s,patchProp:n,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:p=St,insertStaticContent:g}=e,f=(I,V,ie,ne=null,j=null,oe=null,pe=void 0,fe=null,Ce=!!V.dynamicChildren)=>{if(I===V)return;I&&!to(I,V)&&(ne=W(I),M(I,j,oe,!0),I=null),V.patchFlag===-2&&(Ce=!1,V.dynamicChildren=null);const{type:le,ref:be,shapeFlag:De}=V;switch(le){case Wa:m(I,V,ie,ne);break;case Ci:v(I,V,ie,ne);break;case $h:I==null&&w(V,ie,ne,pe);break;case Dt:P(I,V,ie,ne,j,oe,pe,fe,Ce);break;default:De&1?D(I,V,ie,ne,j,oe,pe,fe,Ce):De&6?U(I,V,ie,ne,j,oe,pe,fe,Ce):(De&64||De&128)&&le.process(I,V,ie,ne,j,oe,pe,fe,Ce,ee)}be!=null&&j&&Qf(be,I&&I.ref,oe,V||I,!V)},m=(I,V,ie,ne)=>{if(I==null)i(V.el=a(V.children),ie,ne);else{const j=V.el=I.el;V.children!==I.children&&c(j,V.children)}},v=(I,V,ie,ne)=>{I==null?i(V.el=l(V.children||""),ie,ne):V.el=I.el},w=(I,V,ie,ne)=>{[I.el,I.anchor]=g(I.children,V,ie,ne,I.el,I.anchor)},C=({el:I,anchor:V},ie,ne)=>{let j;for(;I&&I!==V;)j=h(I),i(I,ie,ne),I=j;i(V,ie,ne)},F=({el:I,anchor:V})=>{let ie;for(;I&&I!==V;)ie=h(I),s(I),I=ie;s(V)},D=(I,V,ie,ne,j,oe,pe,fe,Ce)=>{V.type==="svg"?pe="svg":V.type==="math"&&(pe="mathml"),I==null?R(V,ie,ne,j,oe,pe,fe,Ce):x(I,V,j,oe,pe,fe,Ce)},R=(I,V,ie,ne,j,oe,pe,fe)=>{let Ce,le;const{props:be,shapeFlag:De,transition:te,dirs:Pe}=I;if(Ce=I.el=o(I.type,oe,be&&be.is,be),De&8?u(Ce,I.children):De&16&&b(I.children,Ce,null,ne,j,zh(I,oe),pe,fe),Pe&&Yn(I,null,ne,"created"),y(Ce,I,I.scopeId,pe,ne),be){for(const Ve in be)Ve!=="value"&&!Rl(Ve)&&n(Ce,Ve,null,be[Ve],oe,I.children,ne,j,ae);"value"in be&&n(Ce,"value",null,be.value,oe),(le=be.onVnodeBeforeMount)&&us(le,ne,I)}Pe&&Yn(I,null,ne,"beforeMount");const Ne=ZA(j,te);Ne&&te.beforeEnter(Ce),i(Ce,V,ie),((le=be&&be.onVnodeMounted)||Ne||Pe)&&ei(()=>{le&&us(le,ne,I),Ne&&te.enter(Ce),Pe&&Yn(I,null,ne,"mounted")},j)},y=(I,V,ie,ne,j)=>{if(ie&&p(I,ie),ne)for(let oe=0;oe<ne.length;oe++)p(I,ne[oe]);if(j){let oe=j.subTree;if(V===oe){const pe=j.vnode;y(I,pe,pe.scopeId,pe.slotScopeIds,j.parent)}}},b=(I,V,ie,ne,j,oe,pe,fe,Ce=0)=>{for(let le=Ce;le<I.length;le++){const be=I[le]=fe?Cn(I[le]):ms(I[le]);f(null,be,V,ie,ne,j,oe,pe,fe)}},x=(I,V,ie,ne,j,oe,pe)=>{const fe=V.el=I.el;let{patchFlag:Ce,dynamicChildren:le,dirs:be}=V;Ce|=I.patchFlag&16;const De=I.props||Vt,te=V.props||Vt;let Pe;if(ie&&Xn(ie,!1),(Pe=te.onVnodeBeforeUpdate)&&us(Pe,ie,V,I),be&&Yn(V,I,ie,"beforeUpdate"),ie&&Xn(ie,!0),le?T(I.dynamicChildren,le,fe,ie,ne,zh(V,j),oe):pe||se(I,V,fe,null,ie,ne,zh(V,j),oe,!1),Ce>0){if(Ce&16)A(fe,V,De,te,ie,ne,j);else if(Ce&2&&De.class!==te.class&&n(fe,"class",null,te.class,j),Ce&4&&n(fe,"style",De.style,te.style,j),Ce&8){const Ne=V.dynamicProps;for(let Ve=0;Ve<Ne.length;Ve++){const qe=Ne[Ve],$e=De[qe],et=te[qe];(et!==$e||qe==="value")&&n(fe,qe,$e,et,j,I.children,ie,ne,ae)}}Ce&1&&I.children!==V.children&&u(fe,V.children)}else!pe&&le==null&&A(fe,V,De,te,ie,ne,j);((Pe=te.onVnodeUpdated)||be)&&ei(()=>{Pe&&us(Pe,ie,V,I),be&&Yn(V,I,ie,"updated")},ne)},T=(I,V,ie,ne,j,oe,pe)=>{for(let fe=0;fe<V.length;fe++){const Ce=I[fe],le=V[fe],be=Ce.el&&(Ce.type===Dt||!to(Ce,le)||Ce.shapeFlag&70)?d(Ce.el):ie;f(Ce,le,be,null,ne,j,oe,pe,!0)}},A=(I,V,ie,ne,j,oe,pe)=>{if(ie!==ne){if(ie!==Vt)for(const fe in ie)!Rl(fe)&&!(fe in ne)&&n(I,fe,ie[fe],null,pe,V.children,j,oe,ae);for(const fe in ne){if(Rl(fe))continue;const Ce=ne[fe],le=ie[fe];Ce!==le&&fe!=="value"&&n(I,fe,le,Ce,pe,V.children,j,oe,ae)}"value"in ne&&n(I,"value",ie.value,ne.value,pe)}},P=(I,V,ie,ne,j,oe,pe,fe,Ce)=>{const le=V.el=I?I.el:a(""),be=V.anchor=I?I.anchor:a("");let{patchFlag:De,dynamicChildren:te,slotScopeIds:Pe}=V;Pe&&(fe=fe?fe.concat(Pe):Pe),I==null?(i(le,ie,ne),i(be,ie,ne),b(V.children||[],ie,be,j,oe,pe,fe,Ce)):De>0&&De&64&&te&&I.dynamicChildren?(T(I.dynamicChildren,te,ie,j,oe,pe,fe),(V.key!=null||j&&V===j.subTree)&&_g(I,V,!0)):se(I,V,ie,be,j,oe,pe,fe,Ce)},U=(I,V,ie,ne,j,oe,pe,fe,Ce)=>{V.slotScopeIds=fe,I==null?V.shapeFlag&512?j.ctx.activate(V,ie,ne,pe,Ce):J(V,ie,ne,j,oe,pe,Ce):B(I,V,Ce)},J=(I,V,ie,ne,j,oe,pe)=>{const fe=I.component=uP(I,ne,j);if(Yd(I)&&(fe.ctx.renderer=ee),dP(fe),fe.asyncDep){if(j&&j.registerDep(fe,H),!I.el){const Ce=fe.subTree=ye(Ci);v(null,Ce,V,ie)}}else H(fe,I,V,ie,j,oe,pe)},B=(I,V,ie)=>{const ne=V.component=I.component;if(wA(I,V,ie))if(ne.asyncDep&&!ne.asyncResolved){_(ne,V,ie);return}else ne.next=V,fA(ne.update),ne.effect.dirty=!0,ne.update();else V.el=I.el,ne.vnode=V},H=(I,V,ie,ne,j,oe,pe)=>{const fe=()=>{if(I.isMounted){let{next:be,bu:De,u:te,parent:Pe,vnode:Ne}=I;{const ht=nx(I);if(ht){be&&(be.el=Ne.el,_(I,be,pe)),ht.asyncDep.then(()=>{I.isUnmounted||fe()});return}}let Ve=be,qe;Xn(I,!1),be?(be.el=Ne.el,_(I,be,pe)):be=Ne,De&&Nu(De),(qe=be.props&&be.props.onVnodeBeforeUpdate)&&us(qe,Pe,be,Ne),Xn(I,!0);const $e=Hh(I),et=I.subTree;I.subTree=$e,f(et,$e,d(et.el),W(et),I,j,oe),be.el=$e.el,Ve===null&&SA(I,$e.el),te&&ei(te,j),(qe=be.props&&be.props.onVnodeUpdated)&&ei(()=>us(qe,Pe,be,Ne),j)}else{let be;const{el:De,props:te}=V,{bm:Pe,m:Ne,parent:Ve}=I,qe=El(V);if(Xn(I,!1),Pe&&Nu(Pe),!qe&&(be=te&&te.onVnodeBeforeMount)&&us(be,Ve,V),Xn(I,!0),De&&L){const $e=()=>{I.subTree=Hh(I),L(De,I.subTree,I,j,null)};qe?V.type.__asyncLoader().then(()=>!I.isUnmounted&&$e()):$e()}else{const $e=I.subTree=Hh(I);f(null,$e,ie,ne,I,j,oe),V.el=$e.el}if(Ne&&ei(Ne,j),!qe&&(be=te&&te.onVnodeMounted)){const $e=V;ei(()=>us(be,Ve,$e),j)}(V.shapeFlag&256||Ve&&El(Ve.vnode)&&Ve.vnode.shapeFlag&256)&&I.a&&ei(I.a,j),I.isMounted=!0,V=ie=ne=null}},Ce=I.effect=new vg(fe,St,()=>Fg(le),I.scope),le=I.update=()=>{Ce.dirty&&Ce.run()};le.id=I.uid,Xn(I,!0),le()},_=(I,V,ie)=>{V.component=I;const ne=I.vnode.props;I.vnode=V,I.next=null,jA(I,V.props,ne,ie),XA(I,V.children,ie),Io(),Om(I),Oo()},se=(I,V,ie,ne,j,oe,pe,fe,Ce=!1)=>{const le=I&&I.children,be=I?I.shapeFlag:0,De=V.children,{patchFlag:te,shapeFlag:Pe}=V;if(te>0){if(te&128){he(le,De,ie,ne,j,oe,pe,fe,Ce);return}else if(te&256){G(le,De,ie,ne,j,oe,pe,fe,Ce);return}}Pe&8?(be&16&&ae(le,j,oe),De!==le&&u(ie,De)):be&16?Pe&16?he(le,De,ie,ne,j,oe,pe,fe,Ce):ae(le,j,oe,!0):(be&8&&u(ie,""),Pe&16&&b(De,ie,ne,j,oe,pe,fe,Ce))},G=(I,V,ie,ne,j,oe,pe,fe,Ce)=>{I=I||fa,V=V||fa;const le=I.length,be=V.length,De=Math.min(le,be);let te;for(te=0;te<De;te++){const Pe=V[te]=Ce?Cn(V[te]):ms(V[te]);f(I[te],Pe,ie,null,j,oe,pe,fe,Ce)}le>be?ae(I,j,oe,!0,!1,De):b(V,ie,ne,j,oe,pe,fe,Ce,De)},he=(I,V,ie,ne,j,oe,pe,fe,Ce)=>{let le=0;const be=V.length;let De=I.length-1,te=be-1;for(;le<=De&&le<=te;){const Pe=I[le],Ne=V[le]=Ce?Cn(V[le]):ms(V[le]);if(to(Pe,Ne))f(Pe,Ne,ie,null,j,oe,pe,fe,Ce);else break;le++}for(;le<=De&&le<=te;){const Pe=I[De],Ne=V[te]=Ce?Cn(V[te]):ms(V[te]);if(to(Pe,Ne))f(Pe,Ne,ie,null,j,oe,pe,fe,Ce);else break;De--,te--}if(le>De){if(le<=te){const Pe=te+1,Ne=Pe<be?V[Pe].el:ne;for(;le<=te;)f(null,V[le]=Ce?Cn(V[le]):ms(V[le]),ie,Ne,j,oe,pe,fe,Ce),le++}}else if(le>te)for(;le<=De;)M(I[le],j,oe,!0),le++;else{const Pe=le,Ne=le,Ve=new Map;for(le=Ne;le<=te;le++){const Kt=V[le]=Ce?Cn(V[le]):ms(V[le]);Kt.key!=null&&Ve.set(Kt.key,le)}let qe,$e=0;const et=te-Ne+1;let ht=!1,Rt=0;const At=new Array(et);for(le=0;le<et;le++)At[le]=0;for(le=Pe;le<=De;le++){const Kt=I[le];if($e>=et){M(Kt,j,oe,!0);continue}let vr;if(Kt.key!=null)vr=Ve.get(Kt.key);else for(qe=Ne;qe<=te;qe++)if(At[qe-Ne]===0&&to(Kt,V[qe])){vr=qe;break}vr===void 0?M(Kt,j,oe,!0):(At[vr-Ne]=le+1,vr>=Rt?Rt=vr:ht=!0,f(Kt,V[vr],ie,null,j,oe,pe,fe,Ce),$e++)}const mr=ht?eP(At):fa;for(qe=mr.length-1,le=et-1;le>=0;le--){const Kt=Ne+le,vr=V[Kt],Ps=Kt+1<be?V[Kt+1].el:ne;At[le]===0?f(null,vr,ie,Ps,j,oe,pe,fe,Ce):ht&&(qe<0||le!==mr[qe]?Re(vr,ie,Ps,2):qe--)}}},Re=(I,V,ie,ne,j=null)=>{const{el:oe,type:pe,transition:fe,children:Ce,shapeFlag:le}=I;if(le&6){Re(I.component.subTree,V,ie,ne);return}if(le&128){I.suspense.move(V,ie,ne);return}if(le&64){pe.move(I,V,ie,ee);return}if(pe===Dt){i(oe,V,ie);for(let De=0;De<Ce.length;De++)Re(Ce[De],V,ie,ne);i(I.anchor,V,ie);return}if(pe===$h){C(I,V,ie);return}if(ne!==2&&le&1&&fe)if(ne===0)fe.beforeEnter(oe),i(oe,V,ie),ei(()=>fe.enter(oe),j);else{const{leave:De,delayLeave:te,afterLeave:Pe}=fe,Ne=()=>i(oe,V,ie),Ve=()=>{De(oe,()=>{Ne(),Pe&&Pe()})};te?te(oe,Ne,Ve):Ve()}else i(oe,V,ie)},M=(I,V,ie,ne=!1,j=!1)=>{const{type:oe,props:pe,ref:fe,children:Ce,dynamicChildren:le,shapeFlag:be,patchFlag:De,dirs:te}=I;if(fe!=null&&Qf(fe,null,ie,I,!0),be&256){V.ctx.deactivate(I);return}const Pe=be&1&&te,Ne=!El(I);let Ve;if(Ne&&(Ve=pe&&pe.onVnodeBeforeUnmount)&&us(Ve,V,I),be&6)Y(I.component,ie,ne);else{if(be&128){I.suspense.unmount(ie,ne);return}Pe&&Yn(I,null,V,"beforeUnmount"),be&64?I.type.remove(I,V,ie,j,ee,ne):le&&(oe!==Dt||De>0&&De&64)?ae(le,V,ie,!1,!0):(oe===Dt&&De&384||!j&&be&16)&&ae(Ce,V,ie),ne&&X(I)}(Ne&&(Ve=pe&&pe.onVnodeUnmounted)||Pe)&&ei(()=>{Ve&&us(Ve,V,I),Pe&&Yn(I,null,V,"unmounted")},ie)},X=I=>{const{type:V,el:ie,anchor:ne,transition:j}=I;if(V===Dt){z(ie,ne);return}if(V===$h){F(I);return}const oe=()=>{s(ie),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(I.shapeFlag&1&&j&&!j.persisted){const{leave:pe,delayLeave:fe}=j,Ce=()=>pe(ie,oe);fe?fe(I.el,oe,Ce):Ce()}else oe()},z=(I,V)=>{let ie;for(;I!==V;)ie=h(I),s(I),I=ie;s(V)},Y=(I,V,ie)=>{const{bum:ne,scope:j,update:oe,subTree:pe,um:fe}=I;ne&&Nu(ne),j.stop(),oe&&(oe.active=!1,M(pe,I,V,ie)),fe&&ei(fe,V),ei(()=>{I.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&I.asyncDep&&!I.asyncResolved&&I.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},ae=(I,V,ie,ne=!1,j=!1,oe=0)=>{for(let pe=oe;pe<I.length;pe++)M(I[pe],V,ie,ne,j)},W=I=>I.shapeFlag&6?W(I.component.subTree):I.shapeFlag&128?I.suspense.next():h(I.anchor||I.el);let re=!1;const Z=(I,V,ie)=>{I==null?V._vnode&&M(V._vnode,null,null,!0):f(V._vnode||null,I,V,null,null,null,ie),re||(re=!0,Om(),Ny(),re=!1),V._vnode=I},ee={p:f,um:M,m:Re,r:X,mt:J,mc:b,pc:se,pbc:T,n:W,o:e};let Fe,L;return{render:Z,hydrate:Fe,createApp:UA(Z,Fe)}}function zh({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Xn({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function ZA(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function _g(e,t,r=!1){const i=e.children,s=t.children;if(Ue(i)&&Ue(s))for(let n=0;n<i.length;n++){const o=i[n];let a=s[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[n]=Cn(s[n]),a.el=o.el),r||_g(o,a)),a.type===Wa&&(a.el=o.el)}}function eP(e){const t=e.slice(),r=[0];let i,s,n,o,a;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(s=r[r.length-1],e[s]<c){t[i]=s,r.push(i);continue}for(n=0,o=r.length-1;n<o;)a=n+o>>1,e[r[a]]<c?n=a+1:o=a;c<e[r[n]]&&(n>0&&(t[i]=r[n-1]),r[n]=i)}}for(n=r.length,o=r[n-1];n-- >0;)r[n]=o,o=t[o];return r}function nx(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:nx(t)}const tP=e=>e.__isTeleport,Al=e=>e&&(e.disabled||e.disabled===""),qm=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Ym=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Jf=(e,t)=>{const r=e&&e.to;return ct(r)?t?t(r):null:r},rP={name:"Teleport",__isTeleport:!0,process(e,t,r,i,s,n,o,a,l,c){const{mc:u,pc:d,pbc:h,o:{insert:p,querySelector:g,createText:f,createComment:m}}=c,v=Al(t.props);let{shapeFlag:w,children:C,dynamicChildren:F}=t;if(e==null){const D=t.el=f(""),R=t.anchor=f("");p(D,r,i),p(R,r,i);const y=t.target=Jf(t.props,g),b=t.targetAnchor=f("");y&&(p(b,y),o==="svg"||qm(y)?o="svg":(o==="mathml"||Ym(y))&&(o="mathml"));const x=(T,A)=>{w&16&&u(C,T,A,s,n,o,a,l)};v?x(r,R):y&&x(y,b)}else{t.el=e.el;const D=t.anchor=e.anchor,R=t.target=e.target,y=t.targetAnchor=e.targetAnchor,b=Al(e.props),x=b?r:R,T=b?D:y;if(o==="svg"||qm(R)?o="svg":(o==="mathml"||Ym(R))&&(o="mathml"),F?(h(e.dynamicChildren,F,x,s,n,o,a),_g(e,t,!0)):l||d(e,t,x,T,s,n,o,a,!1),v)b?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):su(t,r,D,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const A=t.target=Jf(t.props,g);A&&su(t,A,null,c,0)}else b&&su(t,R,y,c,1)}ox(t)},remove(e,t,r,i,{um:s,o:{remove:n}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:d,props:h}=e;if(d&&n(u),o&&n(c),a&16){const p=o||!Al(h);for(let g=0;g<l.length;g++){const f=l[g];s(f,t,r,p,!!f.dynamicChildren)}}},move:su,hydrate:iP};function su(e,t,r,{o:{insert:i},m:s},n=2){n===0&&i(e.targetAnchor,t,r);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=e,d=n===2;if(d&&i(o,t,r),(!d||Al(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],t,r,2);d&&i(a,t,r)}function iP(e,t,r,i,s,n,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=t.target=Jf(t.props,l);if(u){const d=u._lpa||u.firstChild;if(t.shapeFlag&16)if(Al(t.props))t.anchor=c(o(e),t,a(e),r,i,s,n),t.targetAnchor=d;else{t.anchor=o(e);let h=d;for(;h;)if(h=o(h),h&&h.nodeType===8&&h.data==="teleport anchor"){t.targetAnchor=h,u._lpa=t.targetAnchor&&o(t.targetAnchor);break}c(d,t,u,r,i,s,n)}ox(t)}return t.anchor&&o(t.anchor)}const sP=rP;function ox(e){const t=e.ctx;if(t&&t.ut){let r=e.children[0].el;for(;r&&r!==e.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}const Dt=Symbol.for("v-fgt"),Wa=Symbol.for("v-txt"),Ci=Symbol.for("v-cmt"),$h=Symbol.for("v-stc"),Pl=[];let qi=null;function ue(e=!1){Pl.push(qi=e?null:[])}function nP(){Pl.pop(),qi=Pl[Pl.length-1]||null}let ic=1;function Xm(e){ic+=e}function ax(e){return e.dynamicChildren=ic>0?qi||fa:null,nP(),ic>0&&qi&&qi.push(e),e}function Ie(e,t,r,i,s,n){return ax(Oe(e,t,r,i,s,n,!0))}function Je(e,t,r,i,s){return ax(ye(e,t,r,i,s,!0))}function Lr(e){return e?e.__v_isVNode===!0:!1}function to(e,t){return e.type===t.type&&e.key===t.key}const Zd="__vInternal",lx=({key:e})=>e??null,Gu=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?ct(e)||pr(e)||Ye(e)?{i:nr,r:e,k:t,f:!!r}:e:null);function Oe(e,t=null,r=null,i=0,s=null,n=e===Dt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&lx(t),ref:t&&Gu(t),scopeId:Hy,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:nr};return a?(Ig(l,r),n&128&&e.normalize(l)):r&&(l.shapeFlag|=ct(r)?8:16),ic>0&&!o&&qi&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&qi.push(l),l}const ye=oP;function oP(e,t=null,r=null,i=0,s=null,n=!1){if((!e||e===Vy)&&(e=Ci),Lr(e)){const a=js(e,t,!0);return r&&Ig(a,r),ic>0&&!n&&qi&&(a.shapeFlag&6?qi[qi.indexOf(e)]=a:qi.push(a)),a.patchFlag|=-2,a}if(gP(e)&&(e=e.__vccOpts),t){t=aP(t);let{class:a,style:l}=t;a&&!ct(a)&&(t.class=Ae(a)),ot(l)&&(Py(l)&&!Ue(l)&&(l=ir({},l)),t.style=kt(l))}const o=ct(e)?1:bA(e)?128:tP(e)?64:ot(e)?4:Ye(e)?2:0;return Oe(e,t,r,i,s,o,n,!0)}function aP(e){return e?Py(e)||Zd in e?ir({},e):e:null}function js(e,t,r=!1){const{props:i,ref:s,patchFlag:n,children:o}=e,a=t?_t(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&lx(a),ref:t&&t.ref?r&&s?Ue(s)?s.concat(Gu(t)):[s,Gu(t)]:Gu(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Dt?n===-1?16:n|16:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&js(e.ssContent),ssFallback:e.ssFallback&&js(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function nd(e=" ",t=0){return ye(Wa,null,e,t)}function We(e="",t=!1){return t?(ue(),Je(Ci,null,e)):ye(Ci,null,e)}function ms(e){return e==null||typeof e=="boolean"?ye(Ci):Ue(e)?ye(Dt,null,e.slice()):typeof e=="object"?Cn(e):ye(Wa,null,String(e))}function Cn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:js(e)}function Ig(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Ue(t))r=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Ig(e,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!(Zd in t)?t._ctx=nr:s===3&&nr&&(nr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Ye(t)?(t={default:t,_ctx:nr},r=32):(t=String(t),i&64?(r=16,t=[nd(t)]):r=8);e.children=t,e.shapeFlag|=r}function _t(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Ae([t.class,i.class]));else if(s==="style")t.style=kt([t.style,i.style]);else if(Wd(s)){const n=t[s],o=i[s];o&&n!==o&&!(Ue(n)&&n.includes(o))&&(t[s]=n?[].concat(n,o):o)}else s!==""&&(t[s]=i[s])}return t}function us(e,t,r,i=null){Ai(e,t,7,[r,i])}const lP=Zy();let cP=0;function uP(e,t,r){const i=e.type,s=(t?t.appContext:e.appContext)||lP,n={uid:cP++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new NT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:tx(i,s),emitsOptions:Gy(i,s),emit:null,emitted:null,propsDefaults:Vt,inheritAttrs:i.inheritAttrs,ctx:Vt,data:Vt,props:Vt,attrs:Vt,slots:Vt,refs:Vt,setupState:Vt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=mA.bind(null,n),e.ce&&e.ce(n),n}let Sr=null;const Bt=()=>Sr||nr;let od,Zf;{const e=py(),t=(r,i)=>{let s;return(s=e[r])||(s=e[r]=[]),s.push(i),n=>{s.length>1?s.forEach(o=>o(n)):s[0](n)}};od=t("__VUE_INSTANCE_SETTERS__",r=>Sr=r),Zf=t("__VUE_SSR_SETTERS__",r=>eh=r)}const Dc=e=>{const t=Sr;return od(e),e.scope.on(),()=>{e.scope.off(),od(t)}},Qm=()=>{Sr&&Sr.scope.off(),od(null)};function cx(e){return e.vnode.shapeFlag&4}let eh=!1;function dP(e,t=!1){t&&Zf(t);const{props:r,children:i}=e.vnode,s=cx(e);KA(e,r,s,t),YA(e,i);const n=s?hP(e,t):void 0;return t&&Zf(!1),n}function hP(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Kd(new Proxy(e.ctx,NA));const{setup:i}=r;if(i){const s=e.setupContext=i.length>1?dx(e):null,n=Dc(e);Io();const o=Pn(i,e,0,[e.props,s]);if(Oo(),n(),hy(o)){if(o.then(Qm,Qm),t)return o.then(a=>{Jm(e,a,t)}).catch(a=>{jd(a,e,0)});e.asyncDep=o}else Jm(e,o,t)}else ux(e,t)}function Jm(e,t,r){Ye(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ot(t)&&(e.setupState=_y(t)),ux(e,r)}let Zm;function ux(e,t,r){const i=e.type;if(!e.render){if(!t&&Zm&&!i.render){const s=i.template||Mg(e).template;if(s){const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=i,c=ir(ir({isCustomElement:n,delimiters:a},o),l);i.render=Zm(s,c)}}e.render=i.render||St}{const s=Dc(e);Io();try{GA(e)}finally{Oo(),s()}}}function fP(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,r){return ai(e,"get","$attrs"),t[r]}}))}function dx(e){const t=r=>{e.exposed=r||{}};return{get attrs(){return fP(e)},slots:e.slots,emit:e.emit,expose:t}}function th(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(_y(Kd(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Fl)return Fl[r](e)},has(t,r){return r in t||r in Fl}}))}function pP(e,t=!0){return Ye(e)?e.displayName||e.name:e.name||t&&e.__name}function gP(e){return Ye(e)&&"__vccOpts"in e}const Q=(e,t)=>oA(e,t,eh);function yr(e,t,r){const i=arguments.length;return i===2?ot(t)&&!Ue(t)?Lr(t)?ye(e,null,[t]):ye(e,t):ye(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Lr(r)&&(r=[r]),ye(e,t,r))}const mP="3.4.21",vP=St;/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const CP="http://www.w3.org/2000/svg",wP="http://www.w3.org/1998/Math/MathML",wn=typeof document<"u"?document:null,ev=wn&&wn.createElement("template"),SP={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const s=t==="svg"?wn.createElementNS(CP,e):t==="mathml"?wn.createElementNS(wP,e):wn.createElement(e,r?{is:r}:void 0);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>wn.createTextNode(e),createComment:e=>wn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>wn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,s,n){const o=r?r.previousSibling:t.lastChild;if(s&&(s===n||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===n||!(s=s.nextSibling)););else{ev.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const a=ev.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,r)}return[o?o.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},ln="transition",nl="animation",xa=Symbol("_vtc"),Hn=(e,{slots:t})=>yr(PA,fx(e),t);Hn.displayName="Transition";const hx={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},yP=Hn.props=ir({},Uy,hx),Qn=(e,t=[])=>{Ue(e)?e.forEach(r=>r(...t)):e&&e(...t)},tv=e=>e?Ue(e)?e.some(t=>t.length>1):e.length>1:!1;function fx(e){const t={};for(const P in e)P in hx||(t[P]=e[P]);if(e.css===!1)return t;const{name:r="v",type:i,duration:s,enterFromClass:n=`${r}-enter-from`,enterActiveClass:o=`${r}-enter-active`,enterToClass:a=`${r}-enter-to`,appearFromClass:l=n,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=e,g=xP(s),f=g&&g[0],m=g&&g[1],{onBeforeEnter:v,onEnter:w,onEnterCancelled:C,onLeave:F,onLeaveCancelled:D,onBeforeAppear:R=v,onAppear:y=w,onAppearCancelled:b=C}=t,x=(P,U,J)=>{fn(P,U?u:a),fn(P,U?c:o),J&&J()},T=(P,U)=>{P._isLeaving=!1,fn(P,d),fn(P,p),fn(P,h),U&&U()},A=P=>(U,J)=>{const B=P?y:w,H=()=>x(U,P,J);Qn(B,[U,H]),rv(()=>{fn(U,P?l:n),Os(U,P?u:a),tv(B)||iv(U,i,f,H)})};return ir(t,{onBeforeEnter(P){Qn(v,[P]),Os(P,n),Os(P,o)},onBeforeAppear(P){Qn(R,[P]),Os(P,l),Os(P,c)},onEnter:A(!1),onAppear:A(!0),onLeave(P,U){P._isLeaving=!0;const J=()=>T(P,U);Os(P,d),gx(),Os(P,h),rv(()=>{P._isLeaving&&(fn(P,d),Os(P,p),tv(F)||iv(P,i,m,J))}),Qn(F,[P,J])},onEnterCancelled(P){x(P,!1),Qn(C,[P])},onAppearCancelled(P){x(P,!0),Qn(b,[P])},onLeaveCancelled(P){T(P),Qn(D,[P])}})}function xP(e){if(e==null)return null;if(ot(e))return[Uh(e.enter),Uh(e.leave)];{const t=Uh(e);return[t,t]}}function Uh(e){return DT(e)}function Os(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e[xa]||(e[xa]=new Set)).add(t)}function fn(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const r=e[xa];r&&(r.delete(t),r.size||(e[xa]=void 0))}function rv(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let bP=0;function iv(e,t,r,i){const s=e._endId=++bP,n=()=>{s===e._endId&&i()};if(r)return setTimeout(n,r);const{type:o,timeout:a,propCount:l}=px(e,t);if(!o)return i();const c=o+"end";let u=0;const d=()=>{e.removeEventListener(c,h),n()},h=p=>{p.target===e&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),e.addEventListener(c,h)}function px(e,t){const r=window.getComputedStyle(e),i=g=>(r[g]||"").split(", "),s=i(`${ln}Delay`),n=i(`${ln}Duration`),o=sv(s,n),a=i(`${nl}Delay`),l=i(`${nl}Duration`),c=sv(a,l);let u=null,d=0,h=0;t===ln?o>0&&(u=ln,d=o,h=n.length):t===nl?c>0&&(u=nl,d=c,h=l.length):(d=Math.max(o,c),u=d>0?o>c?ln:nl:null,h=u?u===ln?n.length:l.length:0);const p=u===ln&&/\b(transform|all)(,|$)/.test(i(`${ln}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:p}}function sv(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,i)=>nv(r)+nv(e[i])))}function nv(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function gx(){return document.body.offsetHeight}function RP(e,t,r){const i=e[xa];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const ad=Symbol("_vod"),mx=Symbol("_vsh"),en={beforeMount(e,{value:t},{transition:r}){e[ad]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):ol(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:i}){!t!=!r&&(i?t?(i.beforeEnter(e),ol(e,!0),i.enter(e)):i.leave(e,()=>{ol(e,!1)}):ol(e,t))},beforeUnmount(e,{value:t}){ol(e,t)}};function ol(e,t){e.style.display=t?e[ad]:"none",e[mx]=!t}const EP=Symbol(""),FP=/(^|;)\s*display\s*:/;function TP(e,t,r){const i=e.style,s=ct(r);let n=!1;if(r&&!s){if(t)if(ct(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();r[a]==null&&Hu(i,a,"")}else for(const o in t)r[o]==null&&Hu(i,o,"");for(const o in r)o==="display"&&(n=!0),Hu(i,o,r[o])}else if(s){if(t!==r){const o=i[EP];o&&(r+=";"+o),i.cssText=r,n=FP.test(r)}}else t&&e.removeAttribute("style");ad in e&&(e[ad]=n?i.display:"",e[mx]&&(i.display="none"))}const ov=/\s*!important$/;function Hu(e,t,r){if(Ue(r))r.forEach(i=>Hu(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=AP(e,t);ov.test(r)?e.setProperty(Gn(i),r.replace(ov,""),"important"):e[i]=r}}const av=["Webkit","Moz","ms"],Kh={};function AP(e,t){const r=Kh[t];if(r)return r;let i=ts(t);if(i!=="filter"&&i in e)return Kh[t]=i;i=Tc(i);for(let s=0;s<av.length;s++){const n=av[s]+i;if(n in e)return Kh[t]=n}return t}const lv="http://www.w3.org/1999/xlink";function PP(e,t,r,i,s){if(i&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(lv,t.slice(6,t.length)):e.setAttributeNS(lv,t,r);else{const n=LT(t);r==null||n&&!gy(r)?e.removeAttribute(t):e.setAttribute(t,n?"":r)}}function DP(e,t,r,i,s,n,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,s,n),e[t]=r??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const c=a==="OPTION"?e.getAttribute("value")||"":e.value,u=r??"";(c!==u||!("_value"in e))&&(e.value=u),r==null&&e.removeAttribute(t),e._value=r;return}let l=!1;if(r===""||r==null){const c=typeof e[t];c==="boolean"?r=gy(r):r==null&&c==="string"?(r="",l=!0):c==="number"&&(r=0,l=!0)}try{e[t]=r}catch{}l&&e.removeAttribute(t)}function ia(e,t,r,i){e.addEventListener(t,r,i)}function MP(e,t,r,i){e.removeEventListener(t,r,i)}const cv=Symbol("_vei");function kP(e,t,r,i,s=null){const n=e[cv]||(e[cv]={}),o=n[t];if(i&&o)o.value=i;else{const[a,l]=_P(t);if(i){const c=n[t]=LP(i,s);ia(e,a,c,l)}else o&&(MP(e,a,o,l),n[t]=void 0)}}const uv=/(?:Once|Passive|Capture)$/;function _P(e){let t;if(uv.test(e)){t={};let i;for(;i=e.match(uv);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Gn(e.slice(2)),t]}let jh=0;const IP=Promise.resolve(),OP=()=>jh||(IP.then(()=>jh=0),jh=Date.now());function LP(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Ai(NP(i,r.value),t,5,[i])};return r.value=e,r.attached=OP(),r}function NP(e,t){if(Ue(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const dv=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,BP=(e,t,r,i,s,n,o,a,l)=>{const c=s==="svg";t==="class"?RP(e,i,c):t==="style"?TP(e,r,i):Wd(t)?pg(t)||kP(e,t,r,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):GP(e,t,i,c))?DP(e,t,i,n,o,a,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),PP(e,t,i,c))};function GP(e,t,r,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&dv(t)&&Ye(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return dv(t)&&ct(r)?!1:t in e}const vx=new WeakMap,Cx=new WeakMap,ld=Symbol("_moveCb"),hv=Symbol("_enterCb"),wx={name:"TransitionGroup",props:ir({},yP,{tag:String,moveClass:String}),setup(e,{slots:t}){const r=Bt(),i=$y();let s,n;return Va(()=>{if(!s.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!$P(s[0].el,r.vnode.el,o))return;s.forEach(VP),s.forEach(WP);const a=s.filter(zP);gx(),a.forEach(l=>{const c=l.el,u=c.style;Os(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const d=c[ld]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",d),c[ld]=null,fn(c,o))};c.addEventListener("transitionend",d)})}),()=>{const o=gt(e),a=fx(o);let l=o.tag||Dt;s=n,n=t.default?Dg(t.default()):[];for(let c=0;c<n.length;c++){const u=n[c];u.key!=null&&rc(u,tc(u,a,i,r))}if(s)for(let c=0;c<s.length;c++){const u=s[c];rc(u,tc(u,a,i,r)),vx.set(u,u.el.getBoundingClientRect())}return ye(l,null,n)}}},HP=e=>delete e.mode;wx.props;const Sx=wx;function VP(e){const t=e.el;t[ld]&&t[ld](),t[hv]&&t[hv]()}function WP(e){Cx.set(e,e.el.getBoundingClientRect())}function zP(e){const t=vx.get(e),r=Cx.get(e),i=t.left-r.left,s=t.top-r.top;if(i||s){const n=e.el.style;return n.transform=n.webkitTransform=`translate(${i}px,${s}px)`,n.transitionDuration="0s",e}}function $P(e,t,r){const i=e.cloneNode(),s=e[xa];s&&s.forEach(a=>{a.split(/\s+/).forEach(l=>l&&i.classList.remove(l))}),r.split(/\s+/).forEach(a=>a&&i.classList.add(a)),i.style.display="none";const n=t.nodeType===1?t:t.parentNode;n.appendChild(i);const{hasTransform:o}=px(i);return n.removeChild(i),o}const fv=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ue(t)?r=>Nu(t,r):t};function UP(e){e.target.composing=!0}function pv(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const qh=Symbol("_assign"),KP={created(e,{modifiers:{lazy:t,trim:r,number:i}},s){e[qh]=fv(s);const n=i||s.props&&s.props.type==="number";ia(e,t?"change":"input",o=>{if(o.target.composing)return;let a=e.value;r&&(a=a.trim()),n&&(a=Wf(a)),e[qh](a)}),r&&ia(e,"change",()=>{e.value=e.value.trim()}),t||(ia(e,"compositionstart",UP),ia(e,"compositionend",pv),ia(e,"change",pv))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:i,number:s}},n){if(e[qh]=fv(n),e.composing)return;const o=s||e.type==="number"?Wf(e.value):e.value,a=t??"";o!==a&&(document.activeElement===e&&e.type!=="range"&&(r||i&&e.value.trim()===a)||(e.value=a))}},jP=["ctrl","shift","alt","meta"],qP={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>jP.some(r=>e[`${r}Key`]&&!t.includes(r))},zt=(e,t)=>{const r=e._withMods||(e._withMods={}),i=t.join(".");return r[i]||(r[i]=(s,...n)=>{for(let o=0;o<t.length;o++){const a=qP[t[o]];if(a&&a(s,t))return}return e(s,...n)})},YP={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},$i=(e,t)=>{const r=e._withKeys||(e._withKeys={}),i=t.join(".");return r[i]||(r[i]=s=>{if(!("key"in s))return;const n=Gn(s.key);if(t.some(o=>o===n||YP[o]===n))return e(s)})},XP=ir({patchProp:BP},SP);let gv;function yx(){return gv||(gv=QA(XP))}const cd=(...e)=>{yx().render(...e)},xx=(...e)=>{const t=yx().createApp(...e),{mount:r}=t;return t.mount=i=>{const s=JP(i);if(!s)return;const n=t._component;!Ye(n)&&!n.render&&!n.template&&(n.template=s.innerHTML),s.innerHTML="";const o=r(s,!1,QP(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function QP(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function JP(e){return ct(e)?document.querySelector(e):e}const Ls=(e,t,{checkForDefaultPrevented:r=!0}={})=>s=>{const n=e==null?void 0:e(s);if(r===!1||!n)return t==null?void 0:t(s)};var ZP=Object.defineProperty,eD=Object.defineProperties,tD=Object.getOwnPropertyDescriptors,mv=Object.getOwnPropertySymbols,rD=Object.prototype.hasOwnProperty,iD=Object.prototype.propertyIsEnumerable,vv=(e,t,r)=>t in e?ZP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sD=(e,t)=>{for(var r in t||(t={}))rD.call(t,r)&&vv(e,r,t[r]);if(mv)for(var r of mv(t))iD.call(t,r)&&vv(e,r,t[r]);return e},nD=(e,t)=>eD(e,tD(t));function Cv(e,t){var r;const i=dr();return Wy(()=>{i.value=e()},nD(sD({},t),{flush:(r=void 0)!=null?r:"sync"})),Ac(i)}var wv;const Nt=typeof window<"u",oD=e=>typeof e<"u",aD=e=>typeof e=="function",lD=e=>typeof e=="string",ud=()=>{},cD=Nt&&((wv=window==null?void 0:window.navigator)==null?void 0:wv.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function sc(e){return typeof e=="function"?e():S(e)}function uD(e,t){function r(...i){return new Promise((s,n)=>{Promise.resolve(e(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(s).catch(n)})}return r}function dD(e,t={}){let r,i,s=ud;const n=a=>{clearTimeout(a),s(),s=ud};return a=>{const l=sc(e),c=sc(t.maxWait);return r&&n(r),l<=0||c!==void 0&&c<=0?(i&&(n(i),i=null),Promise.resolve(a())):new Promise((u,d)=>{s=t.rejectOnCancel?d:u,c&&!i&&(i=setTimeout(()=>{r&&n(r),i=null,u(a())},c)),r=setTimeout(()=>{i&&n(i),i=null,u(a())},l)})}}function hD(e){return e}function Mc(e){return vy()?(GT(e),!0):!1}function fD(e,t=200,r={}){return uD(dD(t,r),e)}function pD(e,t=200,r={}){const i=we(e.value),s=fD(()=>{i.value=e.value},t,r);return Qe(e,()=>s()),i}function gD(e,t=!0){Bt()?Gt(e):t?e():Tt(e)}function mD(e,t,r={}){const{immediate:i=!0}=r,s=we(!1);let n=null;function o(){n&&(clearTimeout(n),n=null)}function a(){s.value=!1,o()}function l(...c){o(),s.value=!0,n=setTimeout(()=>{s.value=!1,n=null,e(...c)},sc(t))}return i&&(s.value=!0,Nt&&l()),Mc(a),{isPending:Ac(s),start:l,stop:a}}function Gs(e){var t;const r=sc(e);return(t=r==null?void 0:r.$el)!=null?t:r}const kc=Nt?window:void 0,vD=Nt?window.document:void 0;function Ji(...e){let t,r,i,s;if(lD(e[0])||Array.isArray(e[0])?([r,i,s]=e,t=kc):[t,r,i,s]=e,!t)return ud;Array.isArray(r)||(r=[r]),Array.isArray(i)||(i=[i]);const n=[],o=()=>{n.forEach(u=>u()),n.length=0},a=(u,d,h,p)=>(u.addEventListener(d,h,p),()=>u.removeEventListener(d,h,p)),l=Qe(()=>[Gs(t),sc(s)],([u,d])=>{o(),u&&n.push(...r.flatMap(h=>i.map(p=>a(u,h,p,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return Mc(c),c}let Sv=!1;function CD(e,t,r={}){const{window:i=kc,ignore:s=[],capture:n=!0,detectIframe:o=!1}=r;if(!i)return;cD&&!Sv&&(Sv=!0,Array.from(i.document.body.children).forEach(h=>h.addEventListener("click",ud)));let a=!0;const l=h=>s.some(p=>{if(typeof p=="string")return Array.from(i.document.querySelectorAll(p)).some(g=>g===h.target||h.composedPath().includes(g));{const g=Gs(p);return g&&(h.target===g||h.composedPath().includes(g))}}),u=[Ji(i,"click",h=>{const p=Gs(e);if(!(!p||p===h.target||h.composedPath().includes(p))){if(h.detail===0&&(a=!l(h)),!a){a=!0;return}t(h)}},{passive:!0,capture:n}),Ji(i,"pointerdown",h=>{const p=Gs(e);p&&(a=!h.composedPath().includes(p)&&!l(h))},{passive:!0}),o&&Ji(i,"blur",h=>{var p;const g=Gs(e);((p=i.document.activeElement)==null?void 0:p.tagName)==="IFRAME"&&!(g!=null&&g.contains(i.document.activeElement))&&t(h)})].filter(Boolean);return()=>u.forEach(h=>h())}function bx(e,t=!1){const r=we(),i=()=>r.value=!!e();return i(),gD(i,t),r}function wD(e){return JSON.parse(JSON.stringify(e))}const yv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xv="__vueuse_ssr_handlers__";yv[xv]=yv[xv]||{};function SD({document:e=vD}={}){if(!e)return we("visible");const t=we(e.visibilityState);return Ji(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var bv=Object.getOwnPropertySymbols,yD=Object.prototype.hasOwnProperty,xD=Object.prototype.propertyIsEnumerable,bD=(e,t)=>{var r={};for(var i in e)yD.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&bv)for(var i of bv(e))t.indexOf(i)<0&&xD.call(e,i)&&(r[i]=e[i]);return r};function ri(e,t,r={}){const i=r,{window:s=kc}=i,n=bD(i,["window"]);let o;const a=bx(()=>s&&"ResizeObserver"in s),l=()=>{o&&(o.disconnect(),o=void 0)},c=Qe(()=>Gs(e),d=>{l(),a.value&&s&&d&&(o=new ResizeObserver(t),o.observe(d,n))},{immediate:!0,flush:"post"}),u=()=>{l(),c()};return Mc(u),{isSupported:a,stop:u}}var Rv=Object.getOwnPropertySymbols,RD=Object.prototype.hasOwnProperty,ED=Object.prototype.propertyIsEnumerable,FD=(e,t)=>{var r={};for(var i in e)RD.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&Rv)for(var i of Rv(e))t.indexOf(i)<0&&ED.call(e,i)&&(r[i]=e[i]);return r};function TD(e,t,r={}){const i=r,{window:s=kc}=i,n=FD(i,["window"]);let o;const a=bx(()=>s&&"MutationObserver"in s),l=()=>{o&&(o.disconnect(),o=void 0)},c=Qe(()=>Gs(e),d=>{l(),a.value&&s&&d&&(o=new MutationObserver(t),o.observe(d,n))},{immediate:!0}),u=()=>{l(),c()};return Mc(u),{isSupported:a,stop:u}}var Ev;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Ev||(Ev={}));var AD=Object.defineProperty,Fv=Object.getOwnPropertySymbols,PD=Object.prototype.hasOwnProperty,DD=Object.prototype.propertyIsEnumerable,Tv=(e,t,r)=>t in e?AD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,MD=(e,t)=>{for(var r in t||(t={}))PD.call(t,r)&&Tv(e,r,t[r]);if(Fv)for(var r of Fv(t))DD.call(t,r)&&Tv(e,r,t[r]);return e};const kD={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};MD({linear:hD},kD);function _D(e,t,r,i={}){var s,n,o;const{clone:a=!1,passive:l=!1,eventName:c,deep:u=!1,defaultValue:d}=i,h=Bt(),p=(h==null?void 0:h.emit)||((s=h==null?void 0:h.$emit)==null?void 0:s.bind(h))||((o=(n=h==null?void 0:h.proxy)==null?void 0:n.$emit)==null?void 0:o.bind(h==null?void 0:h.proxy));let g=c;g=c||g||`update:${t.toString()}`;const f=v=>a?aD(a)?a(v):wD(v):v,m=()=>oD(e[t])?f(e[t]):d;if(l){const v=m(),w=we(v);return Qe(()=>e[t],C=>w.value=f(C)),Qe(w,C=>{(C!==e[t]||u)&&p(g,C)},{deep:u}),w}else return Q({get(){return m()},set(v){p(g,v)}})}function ID({window:e=kc}={}){if(!e)return we(!1);const t=we(e.document.hasFocus());return Ji(e,"blur",()=>{t.value=!1}),Ji(e,"focus",()=>{t.value=!0}),t}const OD=()=>Nt&&/firefox/i.test(window.navigator.userAgent);var Rx=typeof global=="object"&&global&&global.Object===Object&&global,LD=typeof self=="object"&&self&&self.Object===Object&&self,os=Rx||LD||Function("return this")(),Rs=os.Symbol,Ex=Object.prototype,ND=Ex.hasOwnProperty,BD=Ex.toString,al=Rs?Rs.toStringTag:void 0;function GD(e){var t=ND.call(e,al),r=e[al];try{e[al]=void 0;var i=!0}catch{}var s=BD.call(e);return i&&(t?e[al]=r:delete e[al]),s}var HD=Object.prototype,VD=HD.toString;function WD(e){return VD.call(e)}var zD="[object Null]",$D="[object Undefined]",Av=Rs?Rs.toStringTag:void 0;function za(e){return e==null?e===void 0?$D:zD:Av&&Av in Object(e)?GD(e):WD(e)}function In(e){return e!=null&&typeof e=="object"}var UD="[object Symbol]";function rh(e){return typeof e=="symbol"||In(e)&&za(e)==UD}function KD(e,t){for(var r=-1,i=e==null?0:e.length,s=Array(i);++r<i;)s[r]=t(e[r],r,e);return s}var rs=Array.isArray,jD=1/0,Pv=Rs?Rs.prototype:void 0,Dv=Pv?Pv.toString:void 0;function Fx(e){if(typeof e=="string")return e;if(rs(e))return KD(e,Fx)+"";if(rh(e))return Dv?Dv.call(e):"";var t=e+"";return t=="0"&&1/e==-jD?"-0":t}var qD=/\s/;function YD(e){for(var t=e.length;t--&&qD.test(e.charAt(t)););return t}var XD=/^\s+/;function QD(e){return e&&e.slice(0,YD(e)+1).replace(XD,"")}function is(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Mv=NaN,JD=/^[-+]0x[0-9a-f]+$/i,ZD=/^0b[01]+$/i,eM=/^0o[0-7]+$/i,tM=parseInt;function kv(e){if(typeof e=="number")return e;if(rh(e))return Mv;if(is(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=is(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=QD(e);var r=ZD.test(e);return r||eM.test(e)?tM(e.slice(2),r?2:8):JD.test(e)?Mv:+e}function rM(e){return e}var iM="[object AsyncFunction]",sM="[object Function]",nM="[object GeneratorFunction]",oM="[object Proxy]";function Tx(e){if(!is(e))return!1;var t=za(e);return t==sM||t==nM||t==iM||t==oM}var Yh=os["__core-js_shared__"],_v=function(){var e=/[^.]+$/.exec(Yh&&Yh.keys&&Yh.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function aM(e){return!!_v&&_v in e}var lM=Function.prototype,cM=lM.toString;function Lo(e){if(e!=null){try{return cM.call(e)}catch{}try{return e+""}catch{}}return""}var uM=/[\\^$.*+?()[\]{}|]/g,dM=/^\[object .+?Constructor\]$/,hM=Function.prototype,fM=Object.prototype,pM=hM.toString,gM=fM.hasOwnProperty,mM=RegExp("^"+pM.call(gM).replace(uM,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vM(e){if(!is(e)||aM(e))return!1;var t=Tx(e)?mM:dM;return t.test(Lo(e))}function CM(e,t){return e==null?void 0:e[t]}function No(e,t){var r=CM(e,t);return vM(r)?r:void 0}var ep=No(os,"WeakMap"),Iv=Object.create,wM=function(){function e(){}return function(t){if(!is(t))return{};if(Iv)return Iv(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function SM(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var Ov=function(){try{var e=No(Object,"defineProperty");return e({},"",{}),e}catch{}}();function yM(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}function xM(e,t,r,i){e.length;for(var s=r+1;s--;)if(t(e[s],s,e))return s;return-1}var bM=9007199254740991,RM=/^(?:0|[1-9]\d*)$/;function Og(e,t){var r=typeof e;return t=t??bM,!!t&&(r=="number"||r!="symbol"&&RM.test(e))&&e>-1&&e%1==0&&e<t}function Ax(e,t,r){t=="__proto__"&&Ov?Ov(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Lg(e,t){return e===t||e!==e&&t!==t}var EM=Object.prototype,FM=EM.hasOwnProperty;function Ng(e,t,r){var i=e[t];(!(FM.call(e,t)&&Lg(i,r))||r===void 0&&!(t in e))&&Ax(e,t,r)}function ih(e,t,r,i){var s=!r;r||(r={});for(var n=-1,o=t.length;++n<o;){var a=t[n],l=void 0;l===void 0&&(l=e[a]),s?Ax(r,a,l):Ng(r,a,l)}return r}var TM=9007199254740991;function Bg(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=TM}function Px(e){return e!=null&&Bg(e.length)&&!Tx(e)}var AM=Object.prototype;function Gg(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||AM;return e===r}function PM(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var DM="[object Arguments]";function Lv(e){return In(e)&&za(e)==DM}var Dx=Object.prototype,MM=Dx.hasOwnProperty,kM=Dx.propertyIsEnumerable,Mx=Lv(function(){return arguments}())?Lv:function(e){return In(e)&&MM.call(e,"callee")&&!kM.call(e,"callee")};function _M(){return!1}var kx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Nv=kx&&typeof module=="object"&&module&&!module.nodeType&&module,IM=Nv&&Nv.exports===kx,Bv=IM?os.Buffer:void 0,OM=Bv?Bv.isBuffer:void 0,dd=OM||_M,LM="[object Arguments]",NM="[object Array]",BM="[object Boolean]",GM="[object Date]",HM="[object Error]",VM="[object Function]",WM="[object Map]",zM="[object Number]",$M="[object Object]",UM="[object RegExp]",KM="[object Set]",jM="[object String]",qM="[object WeakMap]",YM="[object ArrayBuffer]",XM="[object DataView]",QM="[object Float32Array]",JM="[object Float64Array]",ZM="[object Int8Array]",ek="[object Int16Array]",tk="[object Int32Array]",rk="[object Uint8Array]",ik="[object Uint8ClampedArray]",sk="[object Uint16Array]",nk="[object Uint32Array]",Ht={};Ht[QM]=Ht[JM]=Ht[ZM]=Ht[ek]=Ht[tk]=Ht[rk]=Ht[ik]=Ht[sk]=Ht[nk]=!0;Ht[LM]=Ht[NM]=Ht[YM]=Ht[BM]=Ht[XM]=Ht[GM]=Ht[HM]=Ht[VM]=Ht[WM]=Ht[zM]=Ht[$M]=Ht[UM]=Ht[KM]=Ht[jM]=Ht[qM]=!1;function ok(e){return In(e)&&Bg(e.length)&&!!Ht[za(e)]}function Hg(e){return function(t){return e(t)}}var _x=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Dl=_x&&typeof module=="object"&&module&&!module.nodeType&&module,ak=Dl&&Dl.exports===_x,Xh=ak&&Rx.process,ba=function(){try{var e=Dl&&Dl.require&&Dl.require("util").types;return e||Xh&&Xh.binding&&Xh.binding("util")}catch{}}(),Gv=ba&&ba.isTypedArray,Ix=Gv?Hg(Gv):ok,lk=Object.prototype,ck=lk.hasOwnProperty;function Ox(e,t){var r=rs(e),i=!r&&Mx(e),s=!r&&!i&&dd(e),n=!r&&!i&&!s&&Ix(e),o=r||i||s||n,a=o?PM(e.length,String):[],l=a.length;for(var c in e)(t||ck.call(e,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Og(c,l)))&&a.push(c);return a}function Lx(e,t){return function(r){return e(t(r))}}var uk=Lx(Object.keys,Object),dk=Object.prototype,hk=dk.hasOwnProperty;function fk(e){if(!Gg(e))return uk(e);var t=[];for(var r in Object(e))hk.call(e,r)&&r!="constructor"&&t.push(r);return t}function sh(e){return Px(e)?Ox(e):fk(e)}function pk(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var gk=Object.prototype,mk=gk.hasOwnProperty;function vk(e){if(!is(e))return pk(e);var t=Gg(e),r=[];for(var i in e)i=="constructor"&&(t||!mk.call(e,i))||r.push(i);return r}function Vg(e){return Px(e)?Ox(e,!0):vk(e)}var Ck=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wk=/^\w*$/;function Wg(e,t){if(rs(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||rh(e)?!0:wk.test(e)||!Ck.test(e)||t!=null&&e in Object(t)}var nc=No(Object,"create");function Sk(){this.__data__=nc?nc(null):{},this.size=0}function yk(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var xk="__lodash_hash_undefined__",bk=Object.prototype,Rk=bk.hasOwnProperty;function Ek(e){var t=this.__data__;if(nc){var r=t[e];return r===xk?void 0:r}return Rk.call(t,e)?t[e]:void 0}var Fk=Object.prototype,Tk=Fk.hasOwnProperty;function Ak(e){var t=this.__data__;return nc?t[e]!==void 0:Tk.call(t,e)}var Pk="__lodash_hash_undefined__";function Dk(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nc&&t===void 0?Pk:t,this}function To(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}To.prototype.clear=Sk;To.prototype.delete=yk;To.prototype.get=Ek;To.prototype.has=Ak;To.prototype.set=Dk;function Mk(){this.__data__=[],this.size=0}function nh(e,t){for(var r=e.length;r--;)if(Lg(e[r][0],t))return r;return-1}var kk=Array.prototype,_k=kk.splice;function Ik(e){var t=this.__data__,r=nh(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():_k.call(t,r,1),--this.size,!0}function Ok(e){var t=this.__data__,r=nh(t,e);return r<0?void 0:t[r][1]}function Lk(e){return nh(this.__data__,e)>-1}function Nk(e,t){var r=this.__data__,i=nh(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}function tn(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}tn.prototype.clear=Mk;tn.prototype.delete=Ik;tn.prototype.get=Ok;tn.prototype.has=Lk;tn.prototype.set=Nk;var oc=No(os,"Map");function Bk(){this.size=0,this.__data__={hash:new To,map:new(oc||tn),string:new To}}function Gk(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function oh(e,t){var r=e.__data__;return Gk(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Hk(e){var t=oh(this,e).delete(e);return this.size-=t?1:0,t}function Vk(e){return oh(this,e).get(e)}function Wk(e){return oh(this,e).has(e)}function zk(e,t){var r=oh(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}function rn(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}rn.prototype.clear=Bk;rn.prototype.delete=Hk;rn.prototype.get=Vk;rn.prototype.has=Wk;rn.prototype.set=zk;var $k="Expected a function";function ah(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError($k);var r=function(){var i=arguments,s=t?t.apply(this,i):i[0],n=r.cache;if(n.has(s))return n.get(s);var o=e.apply(this,i);return r.cache=n.set(s,o)||n,o};return r.cache=new(ah.Cache||rn),r}ah.Cache=rn;var Uk=500;function Kk(e){var t=ah(e,function(i){return r.size===Uk&&r.clear(),i}),r=t.cache;return t}var jk=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qk=/\\(\\)?/g,Yk=Kk(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(jk,function(r,i,s,n){t.push(s?n.replace(qk,"$1"):i||r)}),t});function Xk(e){return e==null?"":Fx(e)}function zg(e,t){return rs(e)?e:Wg(e,t)?[e]:Yk(Xk(e))}var Qk=1/0;function _c(e){if(typeof e=="string"||rh(e))return e;var t=e+"";return t=="0"&&1/e==-Qk?"-0":t}function Nx(e,t){t=zg(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[_c(t[r++])];return r&&r==i?e:void 0}function Ui(e,t,r){var i=e==null?void 0:Nx(e,t);return i===void 0?r:i}function Bx(e,t){for(var r=-1,i=t.length,s=e.length;++r<i;)e[s+r]=t[r];return e}var Gx=Lx(Object.getPrototypeOf,Object);function hd(){if(!arguments.length)return[];var e=arguments[0];return rs(e)?e:[e]}function Jk(){this.__data__=new tn,this.size=0}function Zk(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function e_(e){return this.__data__.get(e)}function t_(e){return this.__data__.has(e)}var r_=200;function i_(e,t){var r=this.__data__;if(r instanceof tn){var i=r.__data__;if(!oc||i.length<r_-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new rn(i)}return r.set(e,t),this.size=r.size,this}function ws(e){var t=this.__data__=new tn(e);this.size=t.size}ws.prototype.clear=Jk;ws.prototype.delete=Zk;ws.prototype.get=e_;ws.prototype.has=t_;ws.prototype.set=i_;function s_(e,t){return e&&ih(t,sh(t),e)}function n_(e,t){return e&&ih(t,Vg(t),e)}var Hx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Hv=Hx&&typeof module=="object"&&module&&!module.nodeType&&module,o_=Hv&&Hv.exports===Hx,Vv=o_?os.Buffer:void 0,Wv=Vv?Vv.allocUnsafe:void 0;function a_(e,t){if(t)return e.slice();var r=e.length,i=Wv?Wv(r):new e.constructor(r);return e.copy(i),i}function l_(e,t){for(var r=-1,i=e==null?0:e.length,s=0,n=[];++r<i;){var o=e[r];t(o,r,e)&&(n[s++]=o)}return n}function Vx(){return[]}var c_=Object.prototype,u_=c_.propertyIsEnumerable,zv=Object.getOwnPropertySymbols,$g=zv?function(e){return e==null?[]:(e=Object(e),l_(zv(e),function(t){return u_.call(e,t)}))}:Vx;function d_(e,t){return ih(e,$g(e),t)}var h_=Object.getOwnPropertySymbols,Wx=h_?function(e){for(var t=[];e;)Bx(t,$g(e)),e=Gx(e);return t}:Vx;function f_(e,t){return ih(e,Wx(e),t)}function zx(e,t,r){var i=t(e);return rs(e)?i:Bx(i,r(e))}function tp(e){return zx(e,sh,$g)}function p_(e){return zx(e,Vg,Wx)}var rp=No(os,"DataView"),ip=No(os,"Promise"),sp=No(os,"Set"),$v="[object Map]",g_="[object Object]",Uv="[object Promise]",Kv="[object Set]",jv="[object WeakMap]",qv="[object DataView]",m_=Lo(rp),v_=Lo(oc),C_=Lo(ip),w_=Lo(sp),S_=Lo(ep),zi=za;(rp&&zi(new rp(new ArrayBuffer(1)))!=qv||oc&&zi(new oc)!=$v||ip&&zi(ip.resolve())!=Uv||sp&&zi(new sp)!=Kv||ep&&zi(new ep)!=jv)&&(zi=function(e){var t=za(e),r=t==g_?e.constructor:void 0,i=r?Lo(r):"";if(i)switch(i){case m_:return qv;case v_:return $v;case C_:return Uv;case w_:return Kv;case S_:return jv}return t});var y_=Object.prototype,x_=y_.hasOwnProperty;function b_(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&x_.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var fd=os.Uint8Array;function Ug(e){var t=new e.constructor(e.byteLength);return new fd(t).set(new fd(e)),t}function R_(e,t){var r=t?Ug(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var E_=/\w*$/;function F_(e){var t=new e.constructor(e.source,E_.exec(e));return t.lastIndex=e.lastIndex,t}var Yv=Rs?Rs.prototype:void 0,Xv=Yv?Yv.valueOf:void 0;function T_(e){return Xv?Object(Xv.call(e)):{}}function A_(e,t){var r=t?Ug(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var P_="[object Boolean]",D_="[object Date]",M_="[object Map]",k_="[object Number]",__="[object RegExp]",I_="[object Set]",O_="[object String]",L_="[object Symbol]",N_="[object ArrayBuffer]",B_="[object DataView]",G_="[object Float32Array]",H_="[object Float64Array]",V_="[object Int8Array]",W_="[object Int16Array]",z_="[object Int32Array]",$_="[object Uint8Array]",U_="[object Uint8ClampedArray]",K_="[object Uint16Array]",j_="[object Uint32Array]";function q_(e,t,r){var i=e.constructor;switch(t){case N_:return Ug(e);case P_:case D_:return new i(+e);case B_:return R_(e,r);case G_:case H_:case V_:case W_:case z_:case $_:case U_:case K_:case j_:return A_(e,r);case M_:return new i;case k_:case O_:return new i(e);case __:return F_(e);case I_:return new i;case L_:return T_(e)}}function Y_(e){return typeof e.constructor=="function"&&!Gg(e)?wM(Gx(e)):{}}var X_="[object Map]";function Q_(e){return In(e)&&zi(e)==X_}var Qv=ba&&ba.isMap,J_=Qv?Hg(Qv):Q_,Z_="[object Set]";function eI(e){return In(e)&&zi(e)==Z_}var Jv=ba&&ba.isSet,tI=Jv?Hg(Jv):eI,rI=1,iI=2,sI=4,$x="[object Arguments]",nI="[object Array]",oI="[object Boolean]",aI="[object Date]",lI="[object Error]",Ux="[object Function]",cI="[object GeneratorFunction]",uI="[object Map]",dI="[object Number]",Kx="[object Object]",hI="[object RegExp]",fI="[object Set]",pI="[object String]",gI="[object Symbol]",mI="[object WeakMap]",vI="[object ArrayBuffer]",CI="[object DataView]",wI="[object Float32Array]",SI="[object Float64Array]",yI="[object Int8Array]",xI="[object Int16Array]",bI="[object Int32Array]",RI="[object Uint8Array]",EI="[object Uint8ClampedArray]",FI="[object Uint16Array]",TI="[object Uint32Array]",Ot={};Ot[$x]=Ot[nI]=Ot[vI]=Ot[CI]=Ot[oI]=Ot[aI]=Ot[wI]=Ot[SI]=Ot[yI]=Ot[xI]=Ot[bI]=Ot[uI]=Ot[dI]=Ot[Kx]=Ot[hI]=Ot[fI]=Ot[pI]=Ot[gI]=Ot[RI]=Ot[EI]=Ot[FI]=Ot[TI]=!0;Ot[lI]=Ot[Ux]=Ot[mI]=!1;function Ml(e,t,r,i,s,n){var o,a=t&rI,l=t&iI,c=t&sI;if(o!==void 0)return o;if(!is(e))return e;var u=rs(e);if(u){if(o=b_(e),!a)return SM(e,o)}else{var d=zi(e),h=d==Ux||d==cI;if(dd(e))return a_(e,a);if(d==Kx||d==$x||h&&!s){if(o=l||h?{}:Y_(e),!a)return l?f_(e,n_(o,e)):d_(e,s_(o,e))}else{if(!Ot[d])return s?e:{};o=q_(e,d,a)}}n||(n=new ws);var p=n.get(e);if(p)return p;n.set(e,o),tI(e)?e.forEach(function(m){o.add(Ml(m,t,r,m,e,n))}):J_(e)&&e.forEach(function(m,v){o.set(v,Ml(m,t,r,v,e,n))});var g=c?l?p_:tp:l?Vg:sh,f=u?void 0:g(e);return yM(f||e,function(m,v){f&&(v=m,m=e[v]),Ng(o,v,Ml(m,t,r,v,e,n))}),o}var AI=4;function Zv(e){return Ml(e,AI)}var PI=1,DI=4;function eC(e){return Ml(e,PI|DI)}var MI="__lodash_hash_undefined__";function kI(e){return this.__data__.set(e,MI),this}function _I(e){return this.__data__.has(e)}function pd(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new rn;++t<r;)this.add(e[t])}pd.prototype.add=pd.prototype.push=kI;pd.prototype.has=_I;function II(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function OI(e,t){return e.has(t)}var LI=1,NI=2;function jx(e,t,r,i,s,n){var o=r&LI,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=n.get(e),u=n.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,p=r&NI?new pd:void 0;for(n.set(e,t),n.set(t,e);++d<a;){var g=e[d],f=t[d];if(i)var m=o?i(f,g,d,t,e,n):i(g,f,d,e,t,n);if(m!==void 0){if(m)continue;h=!1;break}if(p){if(!II(t,function(v,w){if(!OI(p,w)&&(g===v||s(g,v,r,i,n)))return p.push(w)})){h=!1;break}}else if(!(g===f||s(g,f,r,i,n))){h=!1;break}}return n.delete(e),n.delete(t),h}function BI(e){var t=-1,r=Array(e.size);return e.forEach(function(i,s){r[++t]=[s,i]}),r}function GI(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var HI=1,VI=2,WI="[object Boolean]",zI="[object Date]",$I="[object Error]",UI="[object Map]",KI="[object Number]",jI="[object RegExp]",qI="[object Set]",YI="[object String]",XI="[object Symbol]",QI="[object ArrayBuffer]",JI="[object DataView]",tC=Rs?Rs.prototype:void 0,Qh=tC?tC.valueOf:void 0;function ZI(e,t,r,i,s,n,o){switch(r){case JI:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case QI:return!(e.byteLength!=t.byteLength||!n(new fd(e),new fd(t)));case WI:case zI:case KI:return Lg(+e,+t);case $I:return e.name==t.name&&e.message==t.message;case jI:case YI:return e==t+"";case UI:var a=BI;case qI:var l=i&HI;if(a||(a=GI),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=VI,o.set(e,t);var u=jx(a(e),a(t),i,s,n,o);return o.delete(e),u;case XI:if(Qh)return Qh.call(e)==Qh.call(t)}return!1}var e2=1,t2=Object.prototype,r2=t2.hasOwnProperty;function i2(e,t,r,i,s,n){var o=r&e2,a=tp(e),l=a.length,c=tp(t),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=a[d];if(!(o?h in t:r2.call(t,h)))return!1}var p=n.get(e),g=n.get(t);if(p&&g)return p==t&&g==e;var f=!0;n.set(e,t),n.set(t,e);for(var m=o;++d<l;){h=a[d];var v=e[h],w=t[h];if(i)var C=o?i(w,v,h,t,e,n):i(v,w,h,e,t,n);if(!(C===void 0?v===w||s(v,w,r,i,n):C)){f=!1;break}m||(m=h=="constructor")}if(f&&!m){var F=e.constructor,D=t.constructor;F!=D&&"constructor"in e&&"constructor"in t&&!(typeof F=="function"&&F instanceof F&&typeof D=="function"&&D instanceof D)&&(f=!1)}return n.delete(e),n.delete(t),f}var s2=1,rC="[object Arguments]",iC="[object Array]",nu="[object Object]",n2=Object.prototype,sC=n2.hasOwnProperty;function o2(e,t,r,i,s,n){var o=rs(e),a=rs(t),l=o?iC:zi(e),c=a?iC:zi(t);l=l==rC?nu:l,c=c==rC?nu:c;var u=l==nu,d=c==nu,h=l==c;if(h&&dd(e)){if(!dd(t))return!1;o=!0,u=!1}if(h&&!u)return n||(n=new ws),o||Ix(e)?jx(e,t,r,i,s,n):ZI(e,t,l,r,i,s,n);if(!(r&s2)){var p=u&&sC.call(e,"__wrapped__"),g=d&&sC.call(t,"__wrapped__");if(p||g){var f=p?e.value():e,m=g?t.value():t;return n||(n=new ws),s(f,m,r,i,n)}}return h?(n||(n=new ws),i2(e,t,r,i,s,n)):!1}function lh(e,t,r,i,s){return e===t?!0:e==null||t==null||!In(e)&&!In(t)?e!==e&&t!==t:o2(e,t,r,i,lh,s)}var a2=1,l2=2;function c2(e,t,r,i){var s=r.length,n=s;if(e==null)return!n;for(e=Object(e);s--;){var o=r[s];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++s<n;){o=r[s];var a=o[0],l=e[a],c=o[1];if(o[2]){if(l===void 0&&!(a in e))return!1}else{var u=new ws,d;if(!(d===void 0?lh(c,l,a2|l2,i,u):d))return!1}}return!0}function qx(e){return e===e&&!is(e)}function u2(e){for(var t=sh(e),r=t.length;r--;){var i=t[r],s=e[i];t[r]=[i,s,qx(s)]}return t}function Yx(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function d2(e){var t=u2(e);return t.length==1&&t[0][2]?Yx(t[0][0],t[0][1]):function(r){return r===e||c2(r,e,t)}}function h2(e,t){return e!=null&&t in Object(e)}function f2(e,t,r){t=zg(t,e);for(var i=-1,s=t.length,n=!1;++i<s;){var o=_c(t[i]);if(!(n=e!=null&&r(e,o)))break;e=e[o]}return n||++i!=s?n:(s=e==null?0:e.length,!!s&&Bg(s)&&Og(o,s)&&(rs(e)||Mx(e)))}function p2(e,t){return e!=null&&f2(e,t,h2)}var g2=1,m2=2;function v2(e,t){return Wg(e)&&qx(t)?Yx(_c(e),t):function(r){var i=Ui(r,e);return i===void 0&&i===t?p2(r,e):lh(t,i,g2|m2)}}function C2(e){return function(t){return t==null?void 0:t[e]}}function w2(e){return function(t){return Nx(t,e)}}function S2(e){return Wg(e)?C2(_c(e)):w2(e)}function y2(e){return typeof e=="function"?e:e==null?rM:typeof e=="object"?rs(e)?v2(e[0],e[1]):d2(e):S2(e)}var Jh=function(){return os.Date.now()},x2="Expected a function",b2=Math.max,R2=Math.min;function Xx(e,t,r){var i,s,n,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(x2);t=kv(t)||0,is(r)&&(u=!!r.leading,d="maxWait"in r,n=d?b2(kv(r.maxWait)||0,t):n,h="trailing"in r?!!r.trailing:h);function p(R){var y=i,b=s;return i=s=void 0,c=R,o=e.apply(b,y),o}function g(R){return c=R,a=setTimeout(v,t),u?p(R):o}function f(R){var y=R-l,b=R-c,x=t-y;return d?R2(x,n-b):x}function m(R){var y=R-l,b=R-c;return l===void 0||y>=t||y<0||d&&b>=n}function v(){var R=Jh();if(m(R))return w(R);a=setTimeout(v,f(R))}function w(R){return a=void 0,h&&i?p(R):(i=s=void 0,o)}function C(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function F(){return a===void 0?o:w(Jh())}function D(){var R=Jh(),y=m(R);if(i=arguments,s=this,l=R,y){if(a===void 0)return g(l);if(d)return clearTimeout(a),a=setTimeout(v,t),p(l)}return a===void 0&&(a=setTimeout(v,t)),o}return D.cancel=C,D.flush=F,D}function E2(e,t,r){var i=e==null?0:e.length;if(!i)return-1;var s=i-1;return xM(e,y2(t),s)}function gd(e){for(var t=-1,r=e==null?0:e.length,i={};++t<r;){var s=e[t];i[s[0]]=s[1]}return i}function ac(e,t){return lh(e,t)}function Pi(e){return e==null}function F2(e){return e===void 0}function T2(e,t,r,i){if(!is(e))return e;t=zg(t,e);for(var s=-1,n=t.length,o=n-1,a=e;a!=null&&++s<n;){var l=_c(t[s]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(s!=o){var u=a[l];c=void 0,c===void 0&&(c=is(u)?u:Og(t[s+1])?[]:{})}Ng(a,l,c),a=a[l]}return e}function A2(e,t,r){return e==null?e:T2(e,t,r)}const Hs=e=>e===void 0,ch=e=>typeof e=="boolean",dt=e=>typeof e=="number",Ra=e=>typeof Element>"u"?!1:e instanceof Element,P2=e=>ct(e)?!Number.isNaN(Number(e)):!1,Qx=e=>Nt?window.requestAnimationFrame(e):setTimeout(e,16),Jx=e=>Nt?window.cancelAnimationFrame(e):clearTimeout(e),D2=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),yn=e=>Tc(e),nC=e=>Object.keys(e),M2=e=>Object.entries(e),Zh=(e,t,r)=>({get value(){return Ui(e,t,r)},set value(i){A2(e,t,i)}});class k2 extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function sn(e,t){throw new k2(`[${e}] ${t}`)}const Zx=(e="")=>e.split(" ").filter(t=>!!t.trim()),oC=(e,t)=>{!e||!t.trim()||e.classList.add(...Zx(t))},md=(e,t)=>{!e||!t.trim()||e.classList.remove(...Zx(t))},ll=(e,t)=>{var r;if(!Nt||!e||!t)return"";let i=ts(t);i==="float"&&(i="cssFloat");try{const s=e.style[i];if(s)return s;const n=(r=document.defaultView)==null?void 0:r.getComputedStyle(e,"");return n?n[i]:""}catch{return e.style[i]}};function Ss(e,t="px"){if(!e)return"";if(dt(e)||P2(e))return`${e}${t}`;if(ct(e))return e}let ou;const _2=e=>{var t;if(!Nt)return 0;if(ou!==void 0)return ou;const r=document.createElement("div");r.className=`${e}-scrollbar__wrap`,r.style.visibility="hidden",r.style.width="100px",r.style.position="absolute",r.style.top="-9999px",document.body.appendChild(r);const i=r.offsetWidth;r.style.overflow="scroll";const s=document.createElement("div");s.style.width="100%",r.appendChild(s);const n=s.offsetWidth;return(t=r.parentNode)==null||t.removeChild(r),ou=i-n,ou};function I2(e,t){if(!Nt)return;if(!t){e.scrollTop=0;return}const r=[];let i=t.offsetParent;for(;i!==null&&e!==i&&e.contains(i);)r.push(i),i=i.offsetParent;const s=t.offsetTop+r.reduce((l,c)=>l+c.offsetTop,0),n=s+t.offsetHeight,o=e.scrollTop,a=o+e.clientHeight;s<o?e.scrollTop=s:n>a&&(e.scrollTop=n-e.clientHeight)}/*! Element Plus Icons Vue v2.3.1 */var O2=_e({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),eb=O2,L2=_e({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),N2=L2,B2=_e({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),tb=B2,G2=_e({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),H2=G2,V2=_e({name:"Check",__name:"check",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),rb=V2,W2=_e({name:"CircleCheck",__name:"circle-check",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Oe("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),Kg=W2,z2=_e({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),ib=z2,$2=_e({name:"CircleClose",__name:"circle-close",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Oe("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),uh=$2,U2=_e({name:"Close",__name:"close",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Ea=U2,K2=_e({name:"Delete",__name:"delete",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),j2=K2,q2=_e({name:"Document",__name:"document",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),Y2=q2,X2=_e({name:"Hide",__name:"hide",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Oe("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),Q2=X2,J2=_e({name:"InfoFilled",__name:"info-filled",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),sb=J2,Z2=_e({name:"Loading",__name:"loading",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),nb=Z2,eO=_e({name:"Minus",__name:"minus",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),tO=eO,rO=_e({name:"Plus",__name:"plus",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),ob=rO,iO=_e({name:"SortDown",__name:"sort-down",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),sO=iO,nO=_e({name:"SortUp",__name:"sort-up",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),oO=nO,aO=_e({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),ab=aO,lO=_e({name:"View",__name:"view",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),cO=lO,uO=_e({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),jg=uO,dO=_e({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,r)=>(ue(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Oe("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),hO=dO;const lb="__epPropKey",Me=e=>e,fO=e=>ot(e)&&!!e[lb],as=(e,t)=>{if(!ot(e)||fO(e))return e;const{values:r,required:i,default:s,type:n,validator:o}=e,l={type:n,required:!!i,validator:r||o?c=>{let u=!1,d=[];if(r&&(d=Array.from(r),mt(e,"default")&&d.push(s),u||(u=d.includes(c))),o&&(u||(u=o(c))),!u&&d.length>0){const h=[...new Set(d)].map(p=>JSON.stringify(p)).join(", ");vP(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${h}], got value ${JSON.stringify(c)}.`)}return u}:void 0,[lb]:!0};return mt(e,"default")&&(l.default=s),l},it=e=>gd(Object.entries(e).map(([t,r])=>[t,as(r,t)])),Ao=Me([String,Object,Function]),pO={Close:Ea,SuccessFilled:ab,InfoFilled:sb,WarningFilled:jg,CircleCloseFilled:ib},aC={success:ab,warning:jg,error:ib,info:sb},cb={validating:nb,success:Kg,error:uh},gr=(e,t)=>{if(e.install=r=>{for(const i of[e,...Object.values(t??{})])r.component(i.name,i)},t)for(const[r,i]of Object.entries(t))e[r]=i;return e},gO=(e,t)=>(e.install=r=>{e._context=r._context,r.config.globalProperties[t]=e},e),Ic=e=>(e.install=St,e),ys={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},ur="update:modelValue",dh="change",Vu="input",hh=["","default","small","large"],Wu=e=>{const t=Ue(e)?e:[e],r=[];return t.forEach(i=>{var s;Ue(i)?r.push(...Wu(i)):Lr(i)&&Ue(i.children)?r.push(...Wu(i.children)):(r.push(i),Lr(i)&&((s=i.component)!=null&&s.subTree)&&r.push(...Wu(i.component.subTree)))}),r},ub=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e),qs=e=>e,mO=["class","style"],vO=/^on[A-Z]/,CO=(e={})=>{const{excludeListeners:t=!1,excludeKeys:r}=e,i=Q(()=>((r==null?void 0:r.value)||[]).concat(mO)),s=Bt();return Q(s?()=>{var n;return gd(Object.entries((n=s.proxy)==null?void 0:n.$attrs).filter(([o])=>!i.value.includes(o)&&!(t&&vO.test(o))))}:()=>({}))},wO=({from:e,replacement:t,scope:r,version:i,ref:s,type:n="API"},o)=>{Qe(()=>S(o),a=>{},{immediate:!0})};var SO={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const yO=e=>(t,r)=>xO(t,r,S(e)),xO=(e,t,r)=>Ui(r,e,e).replace(/\{(\w+)\}/g,(i,s)=>{var n;return`${(n=t==null?void 0:t[s])!=null?n:`{${s}}`}`}),bO=e=>{const t=Q(()=>S(e).name),r=pr(e)?e:we(e);return{lang:t,locale:r,t:yO(e)}},db=Symbol("localeContextKey"),Oc=e=>{const t=e||rt(db,we());return bO(Q(()=>t.value||SO))},zu="el",RO="is-",Jn=(e,t,r,i,s)=>{let n=`${e}-${t}`;return r&&(n+=`-${r}`),i&&(n+=`__${i}`),s&&(n+=`--${s}`),n},hb=Symbol("namespaceContextKey"),qg=e=>{const t=e||(Bt()?rt(hb,we(zu)):we(zu));return Q(()=>S(t)||zu)},at=(e,t)=>{const r=qg(t);return{namespace:r,b:(f="")=>Jn(r.value,e,f,"",""),e:f=>f?Jn(r.value,e,"",f,""):"",m:f=>f?Jn(r.value,e,"","",f):"",be:(f,m)=>f&&m?Jn(r.value,e,f,m,""):"",em:(f,m)=>f&&m?Jn(r.value,e,"",f,m):"",bm:(f,m)=>f&&m?Jn(r.value,e,f,"",m):"",bem:(f,m,v)=>f&&m&&v?Jn(r.value,e,f,m,v):"",is:(f,...m)=>{const v=m.length>=1?m[0]:!0;return f&&v?`${RO}${f}`:""},cssVar:f=>{const m={};for(const v in f)f[v]&&(m[`--${r.value}-${v}`]=f[v]);return m},cssVarName:f=>`--${r.value}-${f}`,cssVarBlock:f=>{const m={};for(const v in f)f[v]&&(m[`--${r.value}-${e}-${v}`]=f[v]);return m},cssVarBlockName:f=>`--${r.value}-${e}-${f}`}},EO=as({type:Me(Boolean),default:null}),FO=as({type:Me(Function)}),fb=e=>{const t=`update:${e}`,r=`onUpdate:${e}`,i=[t],s={[e]:EO,[r]:FO};return{useModelToggle:({indicator:o,toggleReason:a,shouldHideWhenRouteChanges:l,shouldProceed:c,onShow:u,onHide:d})=>{const h=Bt(),{emit:p}=h,g=h.props,f=Q(()=>Ye(g[r])),m=Q(()=>g[e]===null),v=y=>{o.value!==!0&&(o.value=!0,a&&(a.value=y),Ye(u)&&u(y))},w=y=>{o.value!==!1&&(o.value=!1,a&&(a.value=y),Ye(d)&&d(y))},C=y=>{if(g.disabled===!0||Ye(c)&&!c())return;const b=f.value&&Nt;b&&p(t,!0),(m.value||!b)&&v(y)},F=y=>{if(g.disabled===!0||!Nt)return;const b=f.value&&Nt;b&&p(t,!1),(m.value||!b)&&w(y)},D=y=>{ch(y)&&(g.disabled&&y?f.value&&p(t,!1):o.value!==y&&(y?v():w()))},R=()=>{o.value?F():C()};return Qe(()=>g[e],D),l&&h.appContext.config.globalProperties.$route!==void 0&&Qe(()=>({...h.proxy.$route}),()=>{l.value&&o.value&&F()}),Gt(()=>{D(g[e])}),{hide:F,show:C,toggle:R,hasUpdateHandler:f}},useModelToggleProps:s,useModelToggleEmits:i}};fb("modelValue");const pb=e=>{const t=Bt();return Q(()=>{var r,i;return(i=(r=t==null?void 0:t.proxy)==null?void 0:r.$props)==null?void 0:i[e]})};var ni="top",_i="bottom",Ii="right",oi="left",Yg="auto",Lc=[ni,_i,Ii,oi],Fa="start",lc="end",TO="clippingParents",gb="viewport",cl="popper",AO="reference",lC=Lc.reduce(function(e,t){return e.concat([t+"-"+Fa,t+"-"+lc])},[]),fh=[].concat(Lc,[Yg]).reduce(function(e,t){return e.concat([t,t+"-"+Fa,t+"-"+lc])},[]),PO="beforeRead",DO="read",MO="afterRead",kO="beforeMain",_O="main",IO="afterMain",OO="beforeWrite",LO="write",NO="afterWrite",BO=[PO,DO,MO,kO,_O,IO,OO,LO,NO];function Es(e){return e?(e.nodeName||"").toLowerCase():null}function ls(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ta(e){var t=ls(e).Element;return e instanceof t||e instanceof Element}function Di(e){var t=ls(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Xg(e){if(typeof ShadowRoot>"u")return!1;var t=ls(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function GO(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var i=t.styles[r]||{},s=t.attributes[r]||{},n=t.elements[r];!Di(n)||!Es(n)||(Object.assign(n.style,i),Object.keys(s).forEach(function(o){var a=s[o];a===!1?n.removeAttribute(o):n.setAttribute(o,a===!0?"":a)}))})}function HO(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(i){var s=t.elements[i],n=t.attributes[i]||{},o=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:r[i]),a=o.reduce(function(l,c){return l[c]="",l},{});!Di(s)||!Es(s)||(Object.assign(s.style,a),Object.keys(n).forEach(function(l){s.removeAttribute(l)}))})}}var mb={name:"applyStyles",enabled:!0,phase:"write",fn:GO,effect:HO,requires:["computeStyles"]};function xs(e){return e.split("-")[0]}var vo=Math.max,vd=Math.min,Aa=Math.round;function Pa(e,t){t===void 0&&(t=!1);var r=e.getBoundingClientRect(),i=1,s=1;if(Di(e)&&t){var n=e.offsetHeight,o=e.offsetWidth;o>0&&(i=Aa(r.width)/o||1),n>0&&(s=Aa(r.height)/n||1)}return{width:r.width/i,height:r.height/s,top:r.top/s,right:r.right/i,bottom:r.bottom/s,left:r.left/i,x:r.left/i,y:r.top/s}}function Qg(e){var t=Pa(e),r=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:i}}function vb(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Xg(r)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Ys(e){return ls(e).getComputedStyle(e)}function VO(e){return["table","td","th"].indexOf(Es(e))>=0}function Vn(e){return((Ta(e)?e.ownerDocument:e.document)||window.document).documentElement}function ph(e){return Es(e)==="html"?e:e.assignedSlot||e.parentNode||(Xg(e)?e.host:null)||Vn(e)}function cC(e){return!Di(e)||Ys(e).position==="fixed"?null:e.offsetParent}function WO(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,r=navigator.userAgent.indexOf("Trident")!==-1;if(r&&Di(e)){var i=Ys(e);if(i.position==="fixed")return null}var s=ph(e);for(Xg(s)&&(s=s.host);Di(s)&&["html","body"].indexOf(Es(s))<0;){var n=Ys(s);if(n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].indexOf(n.willChange)!==-1||t&&n.willChange==="filter"||t&&n.filter&&n.filter!=="none")return s;s=s.parentNode}return null}function Nc(e){for(var t=ls(e),r=cC(e);r&&VO(r)&&Ys(r).position==="static";)r=cC(r);return r&&(Es(r)==="html"||Es(r)==="body"&&Ys(r).position==="static")?t:r||WO(e)||t}function Jg(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function kl(e,t,r){return vo(e,vd(t,r))}function zO(e,t,r){var i=kl(e,t,r);return i>r?r:i}function Cb(){return{top:0,right:0,bottom:0,left:0}}function wb(e){return Object.assign({},Cb(),e)}function Sb(e,t){return t.reduce(function(r,i){return r[i]=e,r},{})}var $O=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,wb(typeof e!="number"?e:Sb(e,Lc))};function UO(e){var t,r=e.state,i=e.name,s=e.options,n=r.elements.arrow,o=r.modifiersData.popperOffsets,a=xs(r.placement),l=Jg(a),c=[oi,Ii].indexOf(a)>=0,u=c?"height":"width";if(!(!n||!o)){var d=$O(s.padding,r),h=Qg(n),p=l==="y"?ni:oi,g=l==="y"?_i:Ii,f=r.rects.reference[u]+r.rects.reference[l]-o[l]-r.rects.popper[u],m=o[l]-r.rects.reference[l],v=Nc(n),w=v?l==="y"?v.clientHeight||0:v.clientWidth||0:0,C=f/2-m/2,F=d[p],D=w-h[u]-d[g],R=w/2-h[u]/2+C,y=kl(F,R,D),b=l;r.modifiersData[i]=(t={},t[b]=y,t.centerOffset=y-R,t)}}function KO(e){var t=e.state,r=e.options,i=r.element,s=i===void 0?"[data-popper-arrow]":i;s!=null&&(typeof s=="string"&&(s=t.elements.popper.querySelector(s),!s)||!vb(t.elements.popper,s)||(t.elements.arrow=s))}var jO={name:"arrow",enabled:!0,phase:"main",fn:UO,effect:KO,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Da(e){return e.split("-")[1]}var qO={top:"auto",right:"auto",bottom:"auto",left:"auto"};function YO(e){var t=e.x,r=e.y,i=window,s=i.devicePixelRatio||1;return{x:Aa(t*s)/s||0,y:Aa(r*s)/s||0}}function uC(e){var t,r=e.popper,i=e.popperRect,s=e.placement,n=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=o.x,p=h===void 0?0:h,g=o.y,f=g===void 0?0:g,m=typeof u=="function"?u({x:p,y:f}):{x:p,y:f};p=m.x,f=m.y;var v=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),C=oi,F=ni,D=window;if(c){var R=Nc(r),y="clientHeight",b="clientWidth";if(R===ls(r)&&(R=Vn(r),Ys(R).position!=="static"&&a==="absolute"&&(y="scrollHeight",b="scrollWidth")),R=R,s===ni||(s===oi||s===Ii)&&n===lc){F=_i;var x=d&&R===D&&D.visualViewport?D.visualViewport.height:R[y];f-=x-i.height,f*=l?1:-1}if(s===oi||(s===ni||s===_i)&&n===lc){C=Ii;var T=d&&R===D&&D.visualViewport?D.visualViewport.width:R[b];p-=T-i.width,p*=l?1:-1}}var A=Object.assign({position:a},c&&qO),P=u===!0?YO({x:p,y:f}):{x:p,y:f};if(p=P.x,f=P.y,l){var U;return Object.assign({},A,(U={},U[F]=w?"0":"",U[C]=v?"0":"",U.transform=(D.devicePixelRatio||1)<=1?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",U))}return Object.assign({},A,(t={},t[F]=w?f+"px":"",t[C]=v?p+"px":"",t.transform="",t))}function XO(e){var t=e.state,r=e.options,i=r.gpuAcceleration,s=i===void 0?!0:i,n=r.adaptive,o=n===void 0?!0:n,a=r.roundOffsets,l=a===void 0?!0:a,c={placement:xs(t.placement),variation:Da(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,uC(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,uC(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var yb={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:XO,data:{}},au={passive:!0};function QO(e){var t=e.state,r=e.instance,i=e.options,s=i.scroll,n=s===void 0?!0:s,o=i.resize,a=o===void 0?!0:o,l=ls(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return n&&c.forEach(function(u){u.addEventListener("scroll",r.update,au)}),a&&l.addEventListener("resize",r.update,au),function(){n&&c.forEach(function(u){u.removeEventListener("scroll",r.update,au)}),a&&l.removeEventListener("resize",r.update,au)}}var xb={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:QO,data:{}},JO={left:"right",right:"left",bottom:"top",top:"bottom"};function $u(e){return e.replace(/left|right|bottom|top/g,function(t){return JO[t]})}var ZO={start:"end",end:"start"};function dC(e){return e.replace(/start|end/g,function(t){return ZO[t]})}function Zg(e){var t=ls(e),r=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:r,scrollTop:i}}function e0(e){return Pa(Vn(e)).left+Zg(e).scrollLeft}function eL(e){var t=ls(e),r=Vn(e),i=t.visualViewport,s=r.clientWidth,n=r.clientHeight,o=0,a=0;return i&&(s=i.width,n=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=i.offsetLeft,a=i.offsetTop)),{width:s,height:n,x:o+e0(e),y:a}}function tL(e){var t,r=Vn(e),i=Zg(e),s=(t=e.ownerDocument)==null?void 0:t.body,n=vo(r.scrollWidth,r.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),o=vo(r.scrollHeight,r.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-i.scrollLeft+e0(e),l=-i.scrollTop;return Ys(s||r).direction==="rtl"&&(a+=vo(r.clientWidth,s?s.clientWidth:0)-n),{width:n,height:o,x:a,y:l}}function t0(e){var t=Ys(e),r=t.overflow,i=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+s+i)}function bb(e){return["html","body","#document"].indexOf(Es(e))>=0?e.ownerDocument.body:Di(e)&&t0(e)?e:bb(ph(e))}function _l(e,t){var r;t===void 0&&(t=[]);var i=bb(e),s=i===((r=e.ownerDocument)==null?void 0:r.body),n=ls(i),o=s?[n].concat(n.visualViewport||[],t0(i)?i:[]):i,a=t.concat(o);return s?a:a.concat(_l(ph(o)))}function np(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function rL(e){var t=Pa(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function hC(e,t){return t===gb?np(eL(e)):Ta(t)?rL(t):np(tL(Vn(e)))}function iL(e){var t=_l(ph(e)),r=["absolute","fixed"].indexOf(Ys(e).position)>=0,i=r&&Di(e)?Nc(e):e;return Ta(i)?t.filter(function(s){return Ta(s)&&vb(s,i)&&Es(s)!=="body"}):[]}function sL(e,t,r){var i=t==="clippingParents"?iL(e):[].concat(t),s=[].concat(i,[r]),n=s[0],o=s.reduce(function(a,l){var c=hC(e,l);return a.top=vo(c.top,a.top),a.right=vd(c.right,a.right),a.bottom=vd(c.bottom,a.bottom),a.left=vo(c.left,a.left),a},hC(e,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function Rb(e){var t=e.reference,r=e.element,i=e.placement,s=i?xs(i):null,n=i?Da(i):null,o=t.x+t.width/2-r.width/2,a=t.y+t.height/2-r.height/2,l;switch(s){case ni:l={x:o,y:t.y-r.height};break;case _i:l={x:o,y:t.y+t.height};break;case Ii:l={x:t.x+t.width,y:a};break;case oi:l={x:t.x-r.width,y:a};break;default:l={x:t.x,y:t.y}}var c=s?Jg(s):null;if(c!=null){var u=c==="y"?"height":"width";switch(n){case Fa:l[c]=l[c]-(t[u]/2-r[u]/2);break;case lc:l[c]=l[c]+(t[u]/2-r[u]/2);break}}return l}function cc(e,t){t===void 0&&(t={});var r=t,i=r.placement,s=i===void 0?e.placement:i,n=r.boundary,o=n===void 0?TO:n,a=r.rootBoundary,l=a===void 0?gb:a,c=r.elementContext,u=c===void 0?cl:c,d=r.altBoundary,h=d===void 0?!1:d,p=r.padding,g=p===void 0?0:p,f=wb(typeof g!="number"?g:Sb(g,Lc)),m=u===cl?AO:cl,v=e.rects.popper,w=e.elements[h?m:u],C=sL(Ta(w)?w:w.contextElement||Vn(e.elements.popper),o,l),F=Pa(e.elements.reference),D=Rb({reference:F,element:v,strategy:"absolute",placement:s}),R=np(Object.assign({},v,D)),y=u===cl?R:F,b={top:C.top-y.top+f.top,bottom:y.bottom-C.bottom+f.bottom,left:C.left-y.left+f.left,right:y.right-C.right+f.right},x=e.modifiersData.offset;if(u===cl&&x){var T=x[s];Object.keys(b).forEach(function(A){var P=[Ii,_i].indexOf(A)>=0?1:-1,U=[ni,_i].indexOf(A)>=0?"y":"x";b[A]+=T[U]*P})}return b}function nL(e,t){t===void 0&&(t={});var r=t,i=r.placement,s=r.boundary,n=r.rootBoundary,o=r.padding,a=r.flipVariations,l=r.allowedAutoPlacements,c=l===void 0?fh:l,u=Da(i),d=u?a?lC:lC.filter(function(g){return Da(g)===u}):Lc,h=d.filter(function(g){return c.indexOf(g)>=0});h.length===0&&(h=d);var p=h.reduce(function(g,f){return g[f]=cc(e,{placement:f,boundary:s,rootBoundary:n,padding:o})[xs(f)],g},{});return Object.keys(p).sort(function(g,f){return p[g]-p[f]})}function oL(e){if(xs(e)===Yg)return[];var t=$u(e);return[dC(e),t,dC(t)]}function aL(e){var t=e.state,r=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var s=r.mainAxis,n=s===void 0?!0:s,o=r.altAxis,a=o===void 0?!0:o,l=r.fallbackPlacements,c=r.padding,u=r.boundary,d=r.rootBoundary,h=r.altBoundary,p=r.flipVariations,g=p===void 0?!0:p,f=r.allowedAutoPlacements,m=t.options.placement,v=xs(m),w=v===m,C=l||(w||!g?[$u(m)]:oL(m)),F=[m].concat(C).reduce(function(z,Y){return z.concat(xs(Y)===Yg?nL(t,{placement:Y,boundary:u,rootBoundary:d,padding:c,flipVariations:g,allowedAutoPlacements:f}):Y)},[]),D=t.rects.reference,R=t.rects.popper,y=new Map,b=!0,x=F[0],T=0;T<F.length;T++){var A=F[T],P=xs(A),U=Da(A)===Fa,J=[ni,_i].indexOf(P)>=0,B=J?"width":"height",H=cc(t,{placement:A,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),_=J?U?Ii:oi:U?_i:ni;D[B]>R[B]&&(_=$u(_));var se=$u(_),G=[];if(n&&G.push(H[P]<=0),a&&G.push(H[_]<=0,H[se]<=0),G.every(function(z){return z})){x=A,b=!1;break}y.set(A,G)}if(b)for(var he=g?3:1,Re=function(z){var Y=F.find(function(ae){var W=y.get(ae);if(W)return W.slice(0,z).every(function(re){return re})});if(Y)return x=Y,"break"},M=he;M>0;M--){var X=Re(M);if(X==="break")break}t.placement!==x&&(t.modifiersData[i]._skip=!0,t.placement=x,t.reset=!0)}}var lL={name:"flip",enabled:!0,phase:"main",fn:aL,requiresIfExists:["offset"],data:{_skip:!1}};function fC(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function pC(e){return[ni,Ii,_i,oi].some(function(t){return e[t]>=0})}function cL(e){var t=e.state,r=e.name,i=t.rects.reference,s=t.rects.popper,n=t.modifiersData.preventOverflow,o=cc(t,{elementContext:"reference"}),a=cc(t,{altBoundary:!0}),l=fC(o,i),c=fC(a,s,n),u=pC(l),d=pC(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}var uL={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:cL};function dL(e,t,r){var i=xs(e),s=[oi,ni].indexOf(i)>=0?-1:1,n=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,o=n[0],a=n[1];return o=o||0,a=(a||0)*s,[oi,Ii].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function hL(e){var t=e.state,r=e.options,i=e.name,s=r.offset,n=s===void 0?[0,0]:s,o=fh.reduce(function(u,d){return u[d]=dL(d,t.rects,n),u},{}),a=o[t.placement],l=a.x,c=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}var fL={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hL};function pL(e){var t=e.state,r=e.name;t.modifiersData[r]=Rb({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var Eb={name:"popperOffsets",enabled:!0,phase:"read",fn:pL,data:{}};function gL(e){return e==="x"?"y":"x"}function mL(e){var t=e.state,r=e.options,i=e.name,s=r.mainAxis,n=s===void 0?!0:s,o=r.altAxis,a=o===void 0?!1:o,l=r.boundary,c=r.rootBoundary,u=r.altBoundary,d=r.padding,h=r.tether,p=h===void 0?!0:h,g=r.tetherOffset,f=g===void 0?0:g,m=cc(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=xs(t.placement),w=Da(t.placement),C=!w,F=Jg(v),D=gL(F),R=t.modifiersData.popperOffsets,y=t.rects.reference,b=t.rects.popper,x=typeof f=="function"?f(Object.assign({},t.rects,{placement:t.placement})):f,T=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,P={x:0,y:0};if(R){if(n){var U,J=F==="y"?ni:oi,B=F==="y"?_i:Ii,H=F==="y"?"height":"width",_=R[F],se=_+m[J],G=_-m[B],he=p?-b[H]/2:0,Re=w===Fa?y[H]:b[H],M=w===Fa?-b[H]:-y[H],X=t.elements.arrow,z=p&&X?Qg(X):{width:0,height:0},Y=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Cb(),ae=Y[J],W=Y[B],re=kl(0,y[H],z[H]),Z=C?y[H]/2-he-re-ae-T.mainAxis:Re-re-ae-T.mainAxis,ee=C?-y[H]/2+he+re+W+T.mainAxis:M+re+W+T.mainAxis,Fe=t.elements.arrow&&Nc(t.elements.arrow),L=Fe?F==="y"?Fe.clientTop||0:Fe.clientLeft||0:0,I=(U=A==null?void 0:A[F])!=null?U:0,V=_+Z-I-L,ie=_+ee-I,ne=kl(p?vd(se,V):se,_,p?vo(G,ie):G);R[F]=ne,P[F]=ne-_}if(a){var j,oe=F==="x"?ni:oi,pe=F==="x"?_i:Ii,fe=R[D],Ce=D==="y"?"height":"width",le=fe+m[oe],be=fe-m[pe],De=[ni,oi].indexOf(v)!==-1,te=(j=A==null?void 0:A[D])!=null?j:0,Pe=De?le:fe-y[Ce]-b[Ce]-te+T.altAxis,Ne=De?fe+y[Ce]+b[Ce]-te-T.altAxis:be,Ve=p&&De?zO(Pe,fe,Ne):kl(p?Pe:le,fe,p?Ne:be);R[D]=Ve,P[D]=Ve-fe}t.modifiersData[i]=P}}var vL={name:"preventOverflow",enabled:!0,phase:"main",fn:mL,requiresIfExists:["offset"]};function CL(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function wL(e){return e===ls(e)||!Di(e)?Zg(e):CL(e)}function SL(e){var t=e.getBoundingClientRect(),r=Aa(t.width)/e.offsetWidth||1,i=Aa(t.height)/e.offsetHeight||1;return r!==1||i!==1}function yL(e,t,r){r===void 0&&(r=!1);var i=Di(t),s=Di(t)&&SL(t),n=Vn(t),o=Pa(e,s),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!r)&&((Es(t)!=="body"||t0(n))&&(a=wL(t)),Di(t)?(l=Pa(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):n&&(l.x=e0(n))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function xL(e){var t=new Map,r=new Set,i=[];e.forEach(function(n){t.set(n.name,n)});function s(n){r.add(n.name);var o=[].concat(n.requires||[],n.requiresIfExists||[]);o.forEach(function(a){if(!r.has(a)){var l=t.get(a);l&&s(l)}}),i.push(n)}return e.forEach(function(n){r.has(n.name)||s(n)}),i}function bL(e){var t=xL(e);return BO.reduce(function(r,i){return r.concat(t.filter(function(s){return s.phase===i}))},[])}function RL(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function EL(e){var t=e.reduce(function(r,i){var s=r[i.name];return r[i.name]=s?Object.assign({},s,i,{options:Object.assign({},s.options,i.options),data:Object.assign({},s.data,i.data)}):i,r},{});return Object.keys(t).map(function(r){return t[r]})}var gC={placement:"bottom",modifiers:[],strategy:"absolute"};function mC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function r0(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,i=r===void 0?[]:r,s=t.defaultOptions,n=s===void 0?gC:s;return function(o,a,l){l===void 0&&(l=n);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},gC,n),modifiersData:{},elements:{reference:o,popper:a},attributes:{},styles:{}},u=[],d=!1,h={state:c,setOptions:function(f){var m=typeof f=="function"?f(c.options):f;g(),c.options=Object.assign({},n,c.options,m),c.scrollParents={reference:Ta(o)?_l(o):o.contextElement?_l(o.contextElement):[],popper:_l(a)};var v=bL(EL([].concat(i,c.options.modifiers)));return c.orderedModifiers=v.filter(function(w){return w.enabled}),p(),h.update()},forceUpdate:function(){if(!d){var f=c.elements,m=f.reference,v=f.popper;if(mC(m,v)){c.rects={reference:yL(m,Nc(v),c.options.strategy==="fixed"),popper:Qg(v)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(b){return c.modifiersData[b.name]=Object.assign({},b.data)});for(var w=0;w<c.orderedModifiers.length;w++){if(c.reset===!0){c.reset=!1,w=-1;continue}var C=c.orderedModifiers[w],F=C.fn,D=C.options,R=D===void 0?{}:D,y=C.name;typeof F=="function"&&(c=F({state:c,options:R,name:y,instance:h})||c)}}}},update:RL(function(){return new Promise(function(f){h.forceUpdate(),f(c)})}),destroy:function(){g(),d=!0}};if(!mC(o,a))return h;h.setOptions(l).then(function(f){!d&&l.onFirstUpdate&&l.onFirstUpdate(f)});function p(){c.orderedModifiers.forEach(function(f){var m=f.name,v=f.options,w=v===void 0?{}:v,C=f.effect;if(typeof C=="function"){var F=C({state:c,name:m,instance:h,options:w}),D=function(){};u.push(F||D)}})}function g(){u.forEach(function(f){return f()}),u=[]}return h}}r0();var FL=[xb,Eb,yb,mb];r0({defaultModifiers:FL});var TL=[xb,Eb,yb,mb,fL,lL,vL,jO,uL],AL=r0({defaultModifiers:TL});const PL=(e,t,r={})=>{const i={name:"updateState",enabled:!0,phase:"write",fn:({state:l})=>{const c=DL(l);Object.assign(o.value,c)},requires:["computeStyles"]},s=Q(()=>{const{onFirstUpdate:l,placement:c,strategy:u,modifiers:d}=S(r);return{onFirstUpdate:l,placement:c||"bottom",strategy:u||"absolute",modifiers:[...d||[],i,{name:"applyStyles",enabled:!1}]}}),n=dr(),o=we({styles:{popper:{position:S(s).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),a=()=>{n.value&&(n.value.destroy(),n.value=void 0)};return Qe(s,l=>{const c=S(n);c&&c.setOptions(l)},{deep:!0}),Qe([e,t],([l,c])=>{a(),!(!l||!c)&&(n.value=AL(l,c,S(s)))}),Er(()=>{a()}),{state:Q(()=>{var l;return{...((l=S(n))==null?void 0:l.state)||{}}}),styles:Q(()=>S(o).styles),attributes:Q(()=>S(o).attributes),update:()=>{var l;return(l=S(n))==null?void 0:l.update()},forceUpdate:()=>{var l;return(l=S(n))==null?void 0:l.forceUpdate()},instanceRef:Q(()=>S(n))}};function DL(e){const t=Object.keys(e.elements),r=gd(t.map(s=>[s,e.styles[s]||{}])),i=gd(t.map(s=>[s,e.attributes[s]]));return{styles:r,attributes:i}}function vC(){let e;const t=(i,s)=>{r(),e=window.setTimeout(i,s)},r=()=>window.clearTimeout(e);return Mc(()=>r()),{registerTimeout:t,cancelTimeout:r}}const CC={prefix:Math.floor(Math.random()*1e4),current:0},ML=Symbol("elIdInjection"),Fb=()=>Bt()?rt(ML,CC):CC,$a=e=>{const t=Fb(),r=qg();return Q(()=>S(e)||`${r.value}-id-${t.prefix}-${t.current++}`)};let sa=[];const wC=e=>{const t=e;t.key===ys.esc&&sa.forEach(r=>r(t))},kL=e=>{Gt(()=>{sa.length===0&&document.addEventListener("keydown",wC),Nt&&sa.push(e)}),Er(()=>{sa=sa.filter(t=>t!==e),sa.length===0&&Nt&&document.removeEventListener("keydown",wC)})};let SC;const Tb=()=>{const e=qg(),t=Fb(),r=Q(()=>`${e.value}-popper-container-${t.prefix}`),i=Q(()=>`#${r.value}`);return{id:r,selector:i}},_L=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},IL=()=>{const{id:e,selector:t}=Tb();return Yy(()=>{Nt&&!SC&&!document.body.querySelector(t.value)&&(SC=_L(e.value))}),{id:e,selector:t}},OL=it({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),LL=({showAfter:e,hideAfter:t,autoClose:r,open:i,close:s})=>{const{registerTimeout:n}=vC(),{registerTimeout:o,cancelTimeout:a}=vC();return{onOpen:u=>{n(()=>{i(u);const d=S(r);dt(d)&&d>0&&o(()=>{s(u)},d)},S(e))},onClose:u=>{a(),n(()=>{s(u)},S(t))}}},Ab=Symbol("elForwardRef"),NL=e=>{rr(Ab,{setForwardRef:r=>{e.value=r}})},BL=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),yC={current:0},xC=we(0),Pb=2e3,bC=Symbol("elZIndexContextKey"),Db=Symbol("zIndexContextKey"),Mb=e=>{const t=Bt()?rt(bC,yC):yC,r=e||(Bt()?rt(Db,void 0):void 0),i=Q(()=>{const o=S(r);return dt(o)?o:Pb}),s=Q(()=>i.value+xC.value),n=()=>(t.current++,xC.value=t.current,s.value);return!Nt&&rt(bC),{initialZIndex:i,currentZIndex:s,nextZIndex:n}};function GL(e){const t=we();function r(){if(e.value==null)return;const{selectionStart:s,selectionEnd:n,value:o}=e.value;if(s==null||n==null)return;const a=o.slice(0,Math.max(0,s)),l=o.slice(Math.max(0,n));t.value={selectionStart:s,selectionEnd:n,value:o,beforeTxt:a,afterTxt:l}}function i(){if(e.value==null||t.value==null)return;const{value:s}=e.value,{beforeTxt:n,afterTxt:o,selectionStart:a}=t.value;if(n==null||o==null||a==null)return;let l=s.length;if(s.endsWith(o))l=s.length-o.length;else if(s.startsWith(n))l=n.length;else{const c=n[a-1],u=s.indexOf(c,a-1);u!==-1&&(l=u+1)}e.value.setSelectionRange(l,l)}return[r,i]}const HL=(e,t,r)=>Wu(e.subTree).filter(n=>{var o;return Lr(n)&&((o=n.type)==null?void 0:o.name)===t&&!!n.component}).map(n=>n.component.uid).map(n=>r[n]).filter(n=>!!n),VL=(e,t)=>{const r={},i=dr([]);return{children:i,addChild:o=>{r[o.uid]=o,i.value=HL(e,t,r)},removeChild:o=>{delete r[o],i.value=i.value.filter(a=>a.uid!==o)}}},Bc=as({type:String,values:hh,required:!1}),kb=Symbol("size"),WL=()=>{const e=rt(kb,{});return Q(()=>S(e.size)||"")};function _b(e,{afterFocus:t,beforeBlur:r,afterBlur:i}={}){const s=Bt(),{emit:n}=s,o=dr(),a=we(!1),l=d=>{a.value||(a.value=!0,n("focus",d),t==null||t())},c=d=>{var h;Ye(r)&&r(d)||d.relatedTarget&&((h=o.value)!=null&&h.contains(d.relatedTarget))||(a.value=!1,n("blur",d),i==null||i())},u=()=>{var d;(d=e.value)==null||d.focus()};return Qe(o,d=>{d&&d.setAttribute("tabindex","-1")}),Ji(o,"click",u),{wrapperRef:o,isFocused:a,handleFocus:l,handleBlur:c}}const Ib=Symbol(),Cd=we();function i0(e,t=void 0){const r=Bt()?rt(Ib,Cd):Cd;return e?Q(()=>{var i,s;return(s=(i=r.value)==null?void 0:i[e])!=null?s:t}):r}function Ob(e,t){const r=i0(),i=at(e,Q(()=>{var a;return((a=r.value)==null?void 0:a.namespace)||zu})),s=Oc(Q(()=>{var a;return(a=r.value)==null?void 0:a.locale})),n=Mb(Q(()=>{var a;return((a=r.value)==null?void 0:a.zIndex)||Pb})),o=Q(()=>{var a;return S(t)||((a=r.value)==null?void 0:a.size)||""});return Lb(Q(()=>S(r)||{})),{ns:i,locale:s,zIndex:n,size:o}}const Lb=(e,t,r=!1)=>{var i;const s=!!Bt(),n=s?i0():void 0,o=(i=void 0)!=null?i:s?rr:void 0;if(!o)return;const a=Q(()=>{const l=S(e);return n!=null&&n.value?zL(n.value,l):l});return o(Ib,a),o(db,Q(()=>a.value.locale)),o(hb,Q(()=>a.value.namespace)),o(Db,Q(()=>a.value.zIndex)),o(kb,{size:Q(()=>a.value.size||"")}),(r||!Cd.value)&&(Cd.value=a.value),a},zL=(e,t)=>{var r;const i=[...new Set([...nC(e),...nC(t)])],s={};for(const n of i)s[n]=(r=t[n])!=null?r:e[n];return s},$L=it({a11y:{type:Boolean,default:!0},locale:{type:Me(Object)},size:Bc,button:{type:Me(Object)},experimentalFeatures:{type:Me(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:Me(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),op={},UL=_e({name:"ElConfigProvider",props:$L,setup(e,{slots:t}){Qe(()=>e.message,i=>{Object.assign(op,i??{})},{immediate:!0,deep:!0});const r=Lb(e);return()=>Xe(t,"default",{config:r==null?void 0:r.value})}}),KL=gr(UL);var bt=(e,t)=>{const r=e.__vccOpts||e;for(const[i,s]of t)r[i]=s;return r};const jL=it({size:{type:Me([Number,String])},color:{type:String}}),qL=_e({name:"ElIcon",inheritAttrs:!1}),YL=_e({...qL,props:jL,setup(e){const t=e,r=at("icon"),i=Q(()=>{const{size:s,color:n}=t;return!s&&!n?{}:{fontSize:Hs(s)?void 0:Ss(s),"--color":n}});return(s,n)=>(ue(),Ie("i",_t({class:S(r).b(),style:S(i)},s.$attrs),[Xe(s.$slots,"default")],16))}});var XL=bt(YL,[["__file","icon.vue"]]);const It=gr(XL),Ua=Symbol("formContextKey"),Po=Symbol("formItemContextKey"),Bo=(e,t={})=>{const r=we(void 0),i=t.prop?r:pb("size"),s=t.global?r:WL(),n=t.form?{size:void 0}:rt(Ua,void 0),o=t.formItem?{size:void 0}:rt(Po,void 0);return Q(()=>i.value||S(e)||(o==null?void 0:o.size)||(n==null?void 0:n.size)||s.value||"")},Wn=e=>{const t=pb("disabled"),r=rt(Ua,void 0);return Q(()=>t.value||S(e)||(r==null?void 0:r.disabled)||!1)},gh=()=>{const e=rt(Ua,void 0),t=rt(Po,void 0);return{form:e,formItem:t}},Nb=(e,{formItemContext:t,disableIdGeneration:r,disableIdManagement:i})=>{r||(r=we(!1)),i||(i=we(!1));const s=we();let n;const o=Q(()=>{var a;return!!(!e.label&&t&&t.inputIds&&((a=t.inputIds)==null?void 0:a.length)<=1)});return Gt(()=>{n=Qe([ii(e,"id"),r],([a,l])=>{const c=a??(l?void 0:$a().value);c!==s.value&&(t!=null&&t.removeInputId&&(s.value&&t.removeInputId(s.value),!(i!=null&&i.value)&&!l&&c&&t.addInputId(c)),s.value=c)},{immediate:!0})}),Qd(()=>{n&&n(),t!=null&&t.removeInputId&&s.value&&t.removeInputId(s.value)}),{isLabeledByFormItem:o,inputId:s}},QL=it({size:{type:String,values:hh},disabled:Boolean}),JL=it({...QL,model:Object,rules:{type:Me(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),ZL={validate:(e,t,r)=>(Ue(e)||ct(e))&&ch(t)&&ct(r)};function eN(){const e=we([]),t=Q(()=>{if(!e.value.length)return"0";const n=Math.max(...e.value);return n?`${n}px`:""});function r(n){const o=e.value.indexOf(n);return o===-1&&t.value,o}function i(n,o){if(n&&o){const a=r(o);e.value.splice(a,1,n)}else n&&e.value.push(n)}function s(n){const o=r(n);o>-1&&e.value.splice(o,1)}return{autoLabelWidth:t,registerLabelWidth:i,deregisterLabelWidth:s}}const lu=(e,t)=>{const r=hd(t);return r.length>0?e.filter(i=>i.prop&&r.includes(i.prop)):e},tN="ElForm",rN=_e({name:tN}),iN=_e({...rN,props:JL,emits:ZL,setup(e,{expose:t,emit:r}){const i=e,s=[],n=Bo(),o=at("form"),a=Q(()=>{const{labelPosition:C,inline:F}=i;return[o.b(),o.m(n.value||"default"),{[o.m(`label-${C}`)]:C,[o.m("inline")]:F}]}),l=C=>s.find(F=>F.prop===C),c=C=>{s.push(C)},u=C=>{C.prop&&s.splice(s.indexOf(C),1)},d=(C=[])=>{i.model&&lu(s,C).forEach(F=>F.resetField())},h=(C=[])=>{lu(s,C).forEach(F=>F.clearValidate())},p=Q(()=>!!i.model),g=C=>{if(s.length===0)return[];const F=lu(s,C);return F.length?F:[]},f=async C=>v(void 0,C),m=async(C=[])=>{if(!p.value)return!1;const F=g(C);if(F.length===0)return!0;let D={};for(const R of F)try{await R.validate("")}catch(y){D={...D,...y}}return Object.keys(D).length===0?!0:Promise.reject(D)},v=async(C=[],F)=>{const D=!Ye(F);try{const R=await m(C);return R===!0&&(F==null||F(R)),R}catch(R){if(R instanceof Error)throw R;const y=R;return i.scrollToError&&w(Object.keys(y)[0]),F==null||F(!1,y),D&&Promise.reject(y)}},w=C=>{var F;const D=lu(s,C)[0];D&&((F=D.$el)==null||F.scrollIntoView(i.scrollIntoViewOptions))};return Qe(()=>i.rules,()=>{i.validateOnRuleChange&&f().catch(C=>void 0)},{deep:!0}),rr(Ua,Br({...Pc(i),emit:r,resetFields:d,clearValidate:h,validateField:v,getField:l,addField:c,removeField:u,...eN()})),t({validate:f,validateField:v,resetFields:d,clearValidate:h,scrollToField:w}),(C,F)=>(ue(),Ie("form",{class:Ae(S(a))},[Xe(C.$slots,"default")],2))}});var sN=bt(iN,[["__file","form.vue"]]);function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},lo.apply(this,arguments)}function nN(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,uc(e,t)}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}function uc(e,t){return uc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},uc(e,t)}function oN(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uu(e,t,r){return oN()?Uu=Reflect.construct.bind():Uu=function(s,n,o){var a=[null];a.push.apply(a,n);var l=Function.bind.apply(s,a),c=new l;return o&&uc(c,o.prototype),c},Uu.apply(null,arguments)}function aN(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function lp(e){var t=typeof Map=="function"?new Map:void 0;return lp=function(i){if(i===null||!aN(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,s)}function s(){return Uu(i,arguments,ap(this).constructor)}return s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),uc(s,i)},lp(e)}var lN=/%[sdj%]/g,cN=function(){};function cp(e){if(!e||!e.length)return null;var t={};return e.forEach(function(r){var i=r.field;t[i]=t[i]||[],t[i].push(r)}),t}function mi(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var s=0,n=r.length;if(typeof e=="function")return e.apply(null,r);if(typeof e=="string"){var o=e.replace(lN,function(a){if(a==="%%")return"%";if(s>=n)return a;switch(a){case"%s":return String(r[s++]);case"%d":return Number(r[s++]);case"%j":try{return JSON.stringify(r[s++])}catch{return"[Circular]"}break;default:return a}});return o}return e}function uN(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function lr(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||uN(t)&&typeof e=="string"&&!e)}function dN(e,t,r){var i=[],s=0,n=e.length;function o(a){i.push.apply(i,a||[]),s++,s===n&&r(i)}e.forEach(function(a){t(a,o)})}function RC(e,t,r){var i=0,s=e.length;function n(o){if(o&&o.length){r(o);return}var a=i;i=i+1,a<s?t(e[a],n):r([])}n([])}function hN(e){var t=[];return Object.keys(e).forEach(function(r){t.push.apply(t,e[r]||[])}),t}var EC=function(e){nN(t,e);function t(r,i){var s;return s=e.call(this,"Async Validation Error")||this,s.errors=r,s.fields=i,s}return t}(lp(Error));function fN(e,t,r,i,s){if(t.first){var n=new Promise(function(h,p){var g=function(v){return i(v),v.length?p(new EC(v,cp(v))):h(s)},f=hN(e);RC(f,r,g)});return n.catch(function(h){return h}),n}var o=t.firstFields===!0?Object.keys(e):t.firstFields||[],a=Object.keys(e),l=a.length,c=0,u=[],d=new Promise(function(h,p){var g=function(m){if(u.push.apply(u,m),c++,c===l)return i(u),u.length?p(new EC(u,cp(u))):h(s)};a.length||(i(u),h(s)),a.forEach(function(f){var m=e[f];o.indexOf(f)!==-1?RC(m,r,g):dN(m,r,g)})});return d.catch(function(h){return h}),d}function pN(e){return!!(e&&e.message!==void 0)}function gN(e,t){for(var r=e,i=0;i<t.length;i++){if(r==null)return r;r=r[t[i]]}return r}function FC(e,t){return function(r){var i;return e.fullFields?i=gN(t,e.fullFields):i=t[r.field||e.fullField],pN(r)?(r.field=r.field||e.fullField,r.fieldValue=i,r):{message:typeof r=="function"?r():r,fieldValue:i,field:r.field||e.fullField}}}function TC(e,t){if(t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];typeof i=="object"&&typeof e[r]=="object"?e[r]=lo({},e[r],i):e[r]=i}}return e}var Bb=function(t,r,i,s,n,o){t.required&&(!i.hasOwnProperty(t.field)||lr(r,o||t.type))&&s.push(mi(n.messages.required,t.fullField))},mN=function(t,r,i,s,n){(/^\s+$/.test(r)||r==="")&&s.push(mi(n.messages.whitespace,t.fullField))},cu,vN=function(){if(cu)return cu;var e="[a-fA-F\\d:]",t=function(F){return F&&F.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",s=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+r+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+r+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+r+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+r+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+r+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+r+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+r+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),n=new RegExp("(?:^"+r+"$)|(?:^"+s+"$)"),o=new RegExp("^"+r+"$"),a=new RegExp("^"+s+"$"),l=function(F){return F&&F.exact?n:new RegExp("(?:"+t(F)+r+t(F)+")|(?:"+t(F)+s+t(F)+")","g")};l.v4=function(C){return C&&C.exact?o:new RegExp(""+t(C)+r+t(C),"g")},l.v6=function(C){return C&&C.exact?a:new RegExp(""+t(C)+s+t(C),"g")};var c="(?:(?:[a-z]+:)?//)",u="(?:\\S+(?::\\S*)?@)?",d=l.v4().source,h=l.v6().source,p="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",g="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",f="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",m="(?::\\d{2,5})?",v='(?:[/?#][^\\s"]*)?',w="(?:"+c+"|www\\.)"+u+"(?:localhost|"+d+"|"+h+"|"+p+g+f+")"+m+v;return cu=new RegExp("(?:^"+w+"$)","i"),cu},AC={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ml={integer:function(t){return ml.number(t)&&parseInt(t,10)===t},float:function(t){return ml.number(t)&&!ml.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!ml.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(AC.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(vN())},hex:function(t){return typeof t=="string"&&!!t.match(AC.hex)}},CN=function(t,r,i,s,n){if(t.required&&r===void 0){Bb(t,r,i,s,n);return}var o=["integer","float","array","regexp","object","method","email","number","date","url","hex"],a=t.type;o.indexOf(a)>-1?ml[a](r)||s.push(mi(n.messages.types[a],t.fullField,t.type)):a&&typeof r!==t.type&&s.push(mi(n.messages.types[a],t.fullField,t.type))},wN=function(t,r,i,s,n){var o=typeof t.len=="number",a=typeof t.min=="number",l=typeof t.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=r,d=null,h=typeof r=="number",p=typeof r=="string",g=Array.isArray(r);if(h?d="number":p?d="string":g&&(d="array"),!d)return!1;g&&(u=r.length),p&&(u=r.replace(c,"_").length),o?u!==t.len&&s.push(mi(n.messages[d].len,t.fullField,t.len)):a&&!l&&u<t.min?s.push(mi(n.messages[d].min,t.fullField,t.min)):l&&!a&&u>t.max?s.push(mi(n.messages[d].max,t.fullField,t.max)):a&&l&&(u<t.min||u>t.max)&&s.push(mi(n.messages[d].range,t.fullField,t.min,t.max))},Xo="enum",SN=function(t,r,i,s,n){t[Xo]=Array.isArray(t[Xo])?t[Xo]:[],t[Xo].indexOf(r)===-1&&s.push(mi(n.messages[Xo],t.fullField,t[Xo].join(", ")))},yN=function(t,r,i,s,n){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(r)||s.push(mi(n.messages.pattern.mismatch,t.fullField,r,t.pattern));else if(typeof t.pattern=="string"){var o=new RegExp(t.pattern);o.test(r)||s.push(mi(n.messages.pattern.mismatch,t.fullField,r,t.pattern))}}},vt={required:Bb,whitespace:mN,type:CN,range:wN,enum:SN,pattern:yN},xN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r,"string")&&!t.required)return i();vt.required(t,r,s,o,n,"string"),lr(r,"string")||(vt.type(t,r,s,o,n),vt.range(t,r,s,o,n),vt.pattern(t,r,s,o,n),t.whitespace===!0&&vt.whitespace(t,r,s,o,n))}i(o)},bN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&vt.type(t,r,s,o,n)}i(o)},RN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(r===""&&(r=void 0),lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&(vt.type(t,r,s,o,n),vt.range(t,r,s,o,n))}i(o)},EN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&vt.type(t,r,s,o,n)}i(o)},FN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),lr(r)||vt.type(t,r,s,o,n)}i(o)},TN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&(vt.type(t,r,s,o,n),vt.range(t,r,s,o,n))}i(o)},AN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&(vt.type(t,r,s,o,n),vt.range(t,r,s,o,n))}i(o)},PN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(r==null&&!t.required)return i();vt.required(t,r,s,o,n,"array"),r!=null&&(vt.type(t,r,s,o,n),vt.range(t,r,s,o,n))}i(o)},DN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&vt.type(t,r,s,o,n)}i(o)},MN="enum",kN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n),r!==void 0&&vt[MN](t,r,s,o,n)}i(o)},_N=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r,"string")&&!t.required)return i();vt.required(t,r,s,o,n),lr(r,"string")||vt.pattern(t,r,s,o,n)}i(o)},IN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r,"date")&&!t.required)return i();if(vt.required(t,r,s,o,n),!lr(r,"date")){var l;r instanceof Date?l=r:l=new Date(r),vt.type(t,l,s,o,n),l&&vt.range(t,l.getTime(),s,o,n)}}i(o)},ON=function(t,r,i,s,n){var o=[],a=Array.isArray(r)?"array":typeof r;vt.required(t,r,s,o,n,a),i(o)},ef=function(t,r,i,s,n){var o=t.type,a=[],l=t.required||!t.required&&s.hasOwnProperty(t.field);if(l){if(lr(r,o)&&!t.required)return i();vt.required(t,r,s,a,n,o),lr(r,o)||vt.type(t,r,s,a,n)}i(a)},LN=function(t,r,i,s,n){var o=[],a=t.required||!t.required&&s.hasOwnProperty(t.field);if(a){if(lr(r)&&!t.required)return i();vt.required(t,r,s,o,n)}i(o)},Il={string:xN,method:bN,number:RN,boolean:EN,regexp:FN,integer:TN,float:AN,array:PN,object:DN,enum:kN,pattern:_N,date:IN,url:ef,hex:ef,email:ef,required:ON,any:LN};function up(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var dp=up(),Gc=function(){function e(r){this.rules=null,this._messages=dp,this.define(r)}var t=e.prototype;return t.define=function(i){var s=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(n){var o=i[n];s.rules[n]=Array.isArray(o)?o:[o]})},t.messages=function(i){return i&&(this._messages=TC(up(),i)),this._messages},t.validate=function(i,s,n){var o=this;s===void 0&&(s={}),n===void 0&&(n=function(){});var a=i,l=s,c=n;if(typeof l=="function"&&(c=l,l={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,a),Promise.resolve(a);function u(f){var m=[],v={};function w(F){if(Array.isArray(F)){var D;m=(D=m).concat.apply(D,F)}else m.push(F)}for(var C=0;C<f.length;C++)w(f[C]);m.length?(v=cp(m),c(m,v)):c(null,a)}if(l.messages){var d=this.messages();d===dp&&(d=up()),TC(d,l.messages),l.messages=d}else l.messages=this.messages();var h={},p=l.keys||Object.keys(this.rules);p.forEach(function(f){var m=o.rules[f],v=a[f];m.forEach(function(w){var C=w;typeof C.transform=="function"&&(a===i&&(a=lo({},a)),v=a[f]=C.transform(v)),typeof C=="function"?C={validator:C}:C=lo({},C),C.validator=o.getValidationMethod(C),C.validator&&(C.field=f,C.fullField=C.fullField||f,C.type=o.getType(C),h[f]=h[f]||[],h[f].push({rule:C,value:v,source:a,field:f}))})});var g={};return fN(h,l,function(f,m){var v=f.rule,w=(v.type==="object"||v.type==="array")&&(typeof v.fields=="object"||typeof v.defaultField=="object");w=w&&(v.required||!v.required&&f.value),v.field=f.field;function C(R,y){return lo({},y,{fullField:v.fullField+"."+R,fullFields:v.fullFields?[].concat(v.fullFields,[R]):[R]})}function F(R){R===void 0&&(R=[]);var y=Array.isArray(R)?R:[R];!l.suppressWarning&&y.length&&e.warning("async-validator:",y),y.length&&v.message!==void 0&&(y=[].concat(v.message));var b=y.map(FC(v,a));if(l.first&&b.length)return g[v.field]=1,m(b);if(!w)m(b);else{if(v.required&&!f.value)return v.message!==void 0?b=[].concat(v.message).map(FC(v,a)):l.error&&(b=[l.error(v,mi(l.messages.required,v.field))]),m(b);var x={};v.defaultField&&Object.keys(f.value).map(function(P){x[P]=v.defaultField}),x=lo({},x,f.rule.fields);var T={};Object.keys(x).forEach(function(P){var U=x[P],J=Array.isArray(U)?U:[U];T[P]=J.map(C.bind(null,P))});var A=new e(T);A.messages(l.messages),f.rule.options&&(f.rule.options.messages=l.messages,f.rule.options.error=l.error),A.validate(f.value,f.rule.options||l,function(P){var U=[];b&&b.length&&U.push.apply(U,b),P&&P.length&&U.push.apply(U,P),m(U.length?U:null)})}}var D;if(v.asyncValidator)D=v.asyncValidator(v,f.value,F,f.source,l);else if(v.validator){try{D=v.validator(v,f.value,F,f.source,l)}catch(R){console.error==null||console.error(R),l.suppressValidatorError||setTimeout(function(){throw R},0),F(R.message)}D===!0?F():D===!1?F(typeof v.message=="function"?v.message(v.fullField||v.field):v.message||(v.fullField||v.field)+" fails"):D instanceof Array?F(D):D instanceof Error&&F(D.message)}D&&D.then&&D.then(function(){return F()},function(R){return F(R)})},function(f){u(f)},a)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!Il.hasOwnProperty(i.type))throw new Error(mi("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var s=Object.keys(i),n=s.indexOf("message");return n!==-1&&s.splice(n,1),s.length===1&&s[0]==="required"?Il.required:Il[this.getType(i)]||void 0},e}();Gc.register=function(t,r){if(typeof r!="function")throw new Error("Cannot register a validator by type, validator is not a function");Il[t]=r};Gc.warning=cN;Gc.messages=dp;Gc.validators=Il;const NN=["","error","validating","success"],BN=it({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:Me([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Me([Object,Array])},error:String,validateStatus:{type:String,values:NN},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:hh}}),PC="ElLabelWrap";var GN=_e({name:PC,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const r=rt(Ua,void 0),i=rt(Po);i||sn(PC,"usage: <el-form-item><label-wrap /></el-form-item>");const s=at("form"),n=we(),o=we(0),a=()=>{var u;if((u=n.value)!=null&&u.firstElementChild){const d=window.getComputedStyle(n.value.firstElementChild).width;return Math.ceil(Number.parseFloat(d))}else return 0},l=(u="update")=>{Tt(()=>{t.default&&e.isAutoWidth&&(u==="update"?o.value=a():u==="remove"&&(r==null||r.deregisterLabelWidth(o.value)))})},c=()=>l("update");return Gt(()=>{c()}),Er(()=>{l("remove")}),Va(()=>c()),Qe(o,(u,d)=>{e.updateAll&&(r==null||r.registerLabelWidth(u,d))}),ri(Q(()=>{var u,d;return(d=(u=n.value)==null?void 0:u.firstElementChild)!=null?d:null}),c),()=>{var u,d;if(!t)return null;const{isAutoWidth:h}=e;if(h){const p=r==null?void 0:r.autoLabelWidth,g=i==null?void 0:i.hasLabel,f={};if(g&&p&&p!=="auto"){const m=Math.max(0,Number.parseInt(p,10)-o.value),v=r.labelPosition==="left"?"marginRight":"marginLeft";m&&(f[v]=`${m}px`)}return ye("div",{ref:n,class:[s.be("item","label-wrap")],style:f},[(u=t.default)==null?void 0:u.call(t)])}else return ye(Dt,{ref:n},[(d=t.default)==null?void 0:d.call(t)])}}});const HN=["role","aria-labelledby"],VN=_e({name:"ElFormItem"}),WN=_e({...VN,props:BN,setup(e,{expose:t}){const r=e,i=Jd(),s=rt(Ua,void 0),n=rt(Po,void 0),o=Bo(void 0,{formItem:!1}),a=at("form-item"),l=$a().value,c=we([]),u=we(""),d=pD(u,100),h=we(""),p=we();let g,f=!1;const m=Q(()=>{if((s==null?void 0:s.labelPosition)==="top")return{};const W=Ss(r.labelWidth||(s==null?void 0:s.labelWidth)||"");return W?{width:W}:{}}),v=Q(()=>{if((s==null?void 0:s.labelPosition)==="top"||s!=null&&s.inline)return{};if(!r.label&&!r.labelWidth&&x)return{};const W=Ss(r.labelWidth||(s==null?void 0:s.labelWidth)||"");return!r.label&&!i.label?{marginLeft:W}:{}}),w=Q(()=>[a.b(),a.m(o.value),a.is("error",u.value==="error"),a.is("validating",u.value==="validating"),a.is("success",u.value==="success"),a.is("required",J.value||r.required),a.is("no-asterisk",s==null?void 0:s.hideRequiredAsterisk),(s==null?void 0:s.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[a.m("feedback")]:s==null?void 0:s.statusIcon}]),C=Q(()=>ch(r.inlineMessage)?r.inlineMessage:(s==null?void 0:s.inlineMessage)||!1),F=Q(()=>[a.e("error"),{[a.em("error","inline")]:C.value}]),D=Q(()=>r.prop?ct(r.prop)?r.prop:r.prop.join("."):""),R=Q(()=>!!(r.label||i.label)),y=Q(()=>r.for||(c.value.length===1?c.value[0]:void 0)),b=Q(()=>!y.value&&R.value),x=!!n,T=Q(()=>{const W=s==null?void 0:s.model;if(!(!W||!r.prop))return Zh(W,r.prop).value}),A=Q(()=>{const{required:W}=r,re=[];r.rules&&re.push(...hd(r.rules));const Z=s==null?void 0:s.rules;if(Z&&r.prop){const ee=Zh(Z,r.prop).value;ee&&re.push(...hd(ee))}if(W!==void 0){const ee=re.map((Fe,L)=>[Fe,L]).filter(([Fe])=>Object.keys(Fe).includes("required"));if(ee.length>0)for(const[Fe,L]of ee)Fe.required!==W&&(re[L]={...Fe,required:W});else re.push({required:W})}return re}),P=Q(()=>A.value.length>0),U=W=>A.value.filter(Z=>!Z.trigger||!W?!0:Array.isArray(Z.trigger)?Z.trigger.includes(W):Z.trigger===W).map(({trigger:Z,...ee})=>ee),J=Q(()=>A.value.some(W=>W.required)),B=Q(()=>{var W;return d.value==="error"&&r.showMessage&&((W=s==null?void 0:s.showMessage)!=null?W:!0)}),H=Q(()=>`${r.label||""}${(s==null?void 0:s.labelSuffix)||""}`),_=W=>{u.value=W},se=W=>{var re,Z;const{errors:ee,fields:Fe}=W;(!ee||!Fe)&&console.error(W),_("error"),h.value=ee?(Z=(re=ee==null?void 0:ee[0])==null?void 0:re.message)!=null?Z:`${r.prop} is required`:"",s==null||s.emit("validate",r.prop,!1,h.value)},G=()=>{_("success"),s==null||s.emit("validate",r.prop,!0,"")},he=async W=>{const re=D.value;return new Gc({[re]:W}).validate({[re]:T.value},{firstFields:!0}).then(()=>(G(),!0)).catch(ee=>(se(ee),Promise.reject(ee)))},Re=async(W,re)=>{if(f||!r.prop)return!1;const Z=Ye(re);if(!P.value)return re==null||re(!1),!1;const ee=U(W);return ee.length===0?(re==null||re(!0),!0):(_("validating"),he(ee).then(()=>(re==null||re(!0),!0)).catch(Fe=>{const{fields:L}=Fe;return re==null||re(!1,L),Z?!1:Promise.reject(L)}))},M=()=>{_(""),h.value="",f=!1},X=async()=>{const W=s==null?void 0:s.model;if(!W||!r.prop)return;const re=Zh(W,r.prop);f=!0,re.value=Zv(g),await Tt(),M(),f=!1},z=W=>{c.value.includes(W)||c.value.push(W)},Y=W=>{c.value=c.value.filter(re=>re!==W)};Qe(()=>r.error,W=>{h.value=W||"",_(W?"error":"")},{immediate:!0}),Qe(()=>r.validateStatus,W=>_(W||""));const ae=Br({...Pc(r),$el:p,size:o,validateState:u,labelId:l,inputIds:c,isGroup:b,hasLabel:R,fieldValue:T,addInputId:z,removeInputId:Y,resetField:X,clearValidate:M,validate:Re});return rr(Po,ae),Gt(()=>{r.prop&&(s==null||s.addField(ae),g=Zv(T.value))}),Er(()=>{s==null||s.removeField(ae)}),t({size:o,validateMessage:h,validateState:u,validate:Re,clearValidate:M,resetField:X}),(W,re)=>{var Z;return ue(),Ie("div",{ref_key:"formItemRef",ref:p,class:Ae(S(w)),role:S(b)?"group":void 0,"aria-labelledby":S(b)?S(l):void 0},[ye(S(GN),{"is-auto-width":S(m).width==="auto","update-all":((Z=S(s))==null?void 0:Z.labelWidth)==="auto"},{default:ze(()=>[S(R)?(ue(),Je(kr(S(y)?"label":"div"),{key:0,id:S(l),for:S(y),class:Ae(S(a).e("label")),style:kt(S(m))},{default:ze(()=>[Xe(W.$slots,"label",{label:S(H)},()=>[nd(Ut(S(H)),1)])]),_:3},8,["id","for","class","style"])):We("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Oe("div",{class:Ae(S(a).e("content")),style:kt(S(v))},[Xe(W.$slots,"default"),ye(Sx,{name:`${S(a).namespace.value}-zoom-in-top`},{default:ze(()=>[S(B)?Xe(W.$slots,"error",{key:0,error:h.value},()=>[Oe("div",{class:Ae(S(F))},Ut(h.value),3)]):We("v-if",!0)]),_:3},8,["name"])],6)],10,HN)}}});var Gb=bt(WN,[["__file","form-item.vue"]]);const zN=gr(sN,{FormItem:Gb}),$N=Ic(Gb);let Bi;const UN=`
  height:0 !important;
  visibility:hidden !important;
  ${OD()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,KN=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function jN(e){const t=window.getComputedStyle(e),r=t.getPropertyValue("box-sizing"),i=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),s=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:KN.map(o=>`${o}:${t.getPropertyValue(o)}`).join(";"),paddingSize:i,borderSize:s,boxSizing:r}}function DC(e,t=1,r){var i;Bi||(Bi=document.createElement("textarea"),document.body.appendChild(Bi));const{paddingSize:s,borderSize:n,boxSizing:o,contextStyle:a}=jN(e);Bi.setAttribute("style",`${a};${UN}`),Bi.value=e.value||e.placeholder||"";let l=Bi.scrollHeight;const c={};o==="border-box"?l=l+n:o==="content-box"&&(l=l-s),Bi.value="";const u=Bi.scrollHeight-s;if(dt(t)){let d=u*t;o==="border-box"&&(d=d+s+n),l=Math.max(d,l),c.minHeight=`${d}px`}if(dt(r)){let d=u*r;o==="border-box"&&(d=d+s+n),l=Math.min(d,l)}return c.height=`${l}px`,(i=Bi.parentNode)==null||i.removeChild(Bi),Bi=void 0,c}const qN=it({id:{type:String,default:void 0},size:Bc,disabled:Boolean,modelValue:{type:Me([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Me([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Ao},prefixIcon:{type:Ao},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:Me([Object,Array,String]),default:()=>qs({})},autofocus:{type:Boolean,default:!1}}),YN={[ur]:e=>ct(e),input:e=>ct(e),change:e=>ct(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},XN=["role"],QN=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],JN=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],ZN=_e({name:"ElInput",inheritAttrs:!1}),eB=_e({...ZN,props:qN,emits:YN,setup(e,{expose:t,emit:r}){const i=e,s=BA(),n=Jd(),o=Q(()=>{const te={};return i.containerRole==="combobox"&&(te["aria-haspopup"]=s["aria-haspopup"],te["aria-owns"]=s["aria-owns"],te["aria-expanded"]=s["aria-expanded"]),te}),a=Q(()=>[i.type==="textarea"?m.b():f.b(),f.m(p.value),f.is("disabled",g.value),f.is("exceed",z.value),{[f.b("group")]:n.prepend||n.append,[f.bm("group","append")]:n.append,[f.bm("group","prepend")]:n.prepend,[f.m("prefix")]:n.prefix||i.prefixIcon,[f.m("suffix")]:n.suffix||i.suffixIcon||i.clearable||i.showPassword,[f.bm("suffix","password-clear")]:he.value&&Re.value,[f.b("hidden")]:i.type==="hidden"},s.class]),l=Q(()=>[f.e("wrapper"),f.is("focus",T.value)]),c=CO({excludeKeys:Q(()=>Object.keys(o.value))}),{form:u,formItem:d}=gh(),{inputId:h}=Nb(i,{formItemContext:d}),p=Bo(),g=Wn(),f=at("input"),m=at("textarea"),v=dr(),w=dr(),C=we(!1),F=we(!1),D=we(!1),R=we(),y=dr(i.inputStyle),b=Q(()=>v.value||w.value),{wrapperRef:x,isFocused:T,handleFocus:A,handleBlur:P}=_b(b,{afterBlur(){var te;i.validateEvent&&((te=d==null?void 0:d.validate)==null||te.call(d,"blur").catch(Pe=>void 0))}}),U=Q(()=>{var te;return(te=u==null?void 0:u.statusIcon)!=null?te:!1}),J=Q(()=>(d==null?void 0:d.validateState)||""),B=Q(()=>J.value&&cb[J.value]),H=Q(()=>D.value?cO:Q2),_=Q(()=>[s.style]),se=Q(()=>[i.inputStyle,y.value,{resize:i.resize}]),G=Q(()=>Pi(i.modelValue)?"":String(i.modelValue)),he=Q(()=>i.clearable&&!g.value&&!i.readonly&&!!G.value&&(T.value||C.value)),Re=Q(()=>i.showPassword&&!g.value&&!i.readonly&&!!G.value&&(!!G.value||T.value)),M=Q(()=>i.showWordLimit&&!!i.maxlength&&(i.type==="text"||i.type==="textarea")&&!g.value&&!i.readonly&&!i.showPassword),X=Q(()=>G.value.length),z=Q(()=>!!M.value&&X.value>Number(i.maxlength)),Y=Q(()=>!!n.suffix||!!i.suffixIcon||he.value||i.showPassword||M.value||!!J.value&&U.value),[ae,W]=GL(v);ri(w,te=>{if(ee(),!M.value||i.resize!=="both")return;const Pe=te[0],{width:Ne}=Pe.contentRect;R.value={right:`calc(100% - ${Ne+15+6}px)`}});const re=()=>{const{type:te,autosize:Pe}=i;if(!(!Nt||te!=="textarea"||!w.value))if(Pe){const Ne=ot(Pe)?Pe.minRows:void 0,Ve=ot(Pe)?Pe.maxRows:void 0,qe=DC(w.value,Ne,Ve);y.value={overflowY:"hidden",...qe},Tt(()=>{w.value.offsetHeight,y.value=qe})}else y.value={minHeight:DC(w.value).minHeight}},ee=(te=>{let Pe=!1;return()=>{var Ne;if(Pe||!i.autosize)return;((Ne=w.value)==null?void 0:Ne.offsetParent)===null||(te(),Pe=!0)}})(re),Fe=()=>{const te=b.value,Pe=i.formatter?i.formatter(G.value):G.value;!te||te.value===Pe||(te.value=Pe)},L=async te=>{ae();let{value:Pe}=te.target;if(i.formatter&&(Pe=i.parser?i.parser(Pe):Pe),!F.value){if(Pe===G.value){Fe();return}r(ur,Pe),r("input",Pe),await Tt(),Fe(),W()}},I=te=>{r("change",te.target.value)},V=te=>{r("compositionstart",te),F.value=!0},ie=te=>{var Pe;r("compositionupdate",te);const Ne=(Pe=te.target)==null?void 0:Pe.value,Ve=Ne[Ne.length-1]||"";F.value=!ub(Ve)},ne=te=>{r("compositionend",te),F.value&&(F.value=!1,L(te))},j=()=>{D.value=!D.value,oe()},oe=async()=>{var te;await Tt(),(te=b.value)==null||te.focus()},pe=()=>{var te;return(te=b.value)==null?void 0:te.blur()},fe=te=>{C.value=!1,r("mouseleave",te)},Ce=te=>{C.value=!0,r("mouseenter",te)},le=te=>{r("keydown",te)},be=()=>{var te;(te=b.value)==null||te.select()},De=()=>{r(ur,""),r("change",""),r("clear"),r("input","")};return Qe(()=>i.modelValue,()=>{var te;Tt(()=>re()),i.validateEvent&&((te=d==null?void 0:d.validate)==null||te.call(d,"change").catch(Pe=>void 0))}),Qe(G,()=>Fe()),Qe(()=>i.type,async()=>{await Tt(),Fe(),re()}),Gt(()=>{!i.formatter&&i.parser,Fe(),Tt(re)}),t({input:v,textarea:w,ref:b,textareaStyle:se,autosize:ii(i,"autosize"),focus:oe,blur:pe,select:be,clear:De,resizeTextarea:re}),(te,Pe)=>(ue(),Ie("div",_t(S(o),{class:S(a),style:S(_),role:te.containerRole,onMouseenter:Ce,onMouseleave:fe}),[We(" input "),te.type!=="textarea"?(ue(),Ie(Dt,{key:0},[We(" prepend slot "),te.$slots.prepend?(ue(),Ie("div",{key:0,class:Ae(S(f).be("group","prepend"))},[Xe(te.$slots,"prepend")],2)):We("v-if",!0),Oe("div",{ref_key:"wrapperRef",ref:x,class:Ae(S(l))},[We(" prefix slot "),te.$slots.prefix||te.prefixIcon?(ue(),Ie("span",{key:0,class:Ae(S(f).e("prefix"))},[Oe("span",{class:Ae(S(f).e("prefix-inner"))},[Xe(te.$slots,"prefix"),te.prefixIcon?(ue(),Je(S(It),{key:0,class:Ae(S(f).e("icon"))},{default:ze(()=>[(ue(),Je(kr(te.prefixIcon)))]),_:1},8,["class"])):We("v-if",!0)],2)],2)):We("v-if",!0),Oe("input",_t({id:S(h),ref_key:"input",ref:v,class:S(f).e("inner")},S(c),{minlength:te.minlength,maxlength:te.maxlength,type:te.showPassword?D.value?"text":"password":te.type,disabled:S(g),readonly:te.readonly,autocomplete:te.autocomplete,tabindex:te.tabindex,"aria-label":te.label,placeholder:te.placeholder,style:te.inputStyle,form:te.form,autofocus:te.autofocus,onCompositionstart:V,onCompositionupdate:ie,onCompositionend:ne,onInput:L,onFocus:Pe[0]||(Pe[0]=(...Ne)=>S(A)&&S(A)(...Ne)),onBlur:Pe[1]||(Pe[1]=(...Ne)=>S(P)&&S(P)(...Ne)),onChange:I,onKeydown:le}),null,16,QN),We(" suffix slot "),S(Y)?(ue(),Ie("span",{key:1,class:Ae(S(f).e("suffix"))},[Oe("span",{class:Ae(S(f).e("suffix-inner"))},[!S(he)||!S(Re)||!S(M)?(ue(),Ie(Dt,{key:0},[Xe(te.$slots,"suffix"),te.suffixIcon?(ue(),Je(S(It),{key:0,class:Ae(S(f).e("icon"))},{default:ze(()=>[(ue(),Je(kr(te.suffixIcon)))]),_:1},8,["class"])):We("v-if",!0)],64)):We("v-if",!0),S(he)?(ue(),Je(S(It),{key:1,class:Ae([S(f).e("icon"),S(f).e("clear")]),onMousedown:zt(S(St),["prevent"]),onClick:De},{default:ze(()=>[ye(S(uh))]),_:1},8,["class","onMousedown"])):We("v-if",!0),S(Re)?(ue(),Je(S(It),{key:2,class:Ae([S(f).e("icon"),S(f).e("password")]),onClick:j},{default:ze(()=>[(ue(),Je(kr(S(H))))]),_:1},8,["class"])):We("v-if",!0),S(M)?(ue(),Ie("span",{key:3,class:Ae(S(f).e("count"))},[Oe("span",{class:Ae(S(f).e("count-inner"))},Ut(S(X))+" / "+Ut(te.maxlength),3)],2)):We("v-if",!0),S(J)&&S(B)&&S(U)?(ue(),Je(S(It),{key:4,class:Ae([S(f).e("icon"),S(f).e("validateIcon"),S(f).is("loading",S(J)==="validating")])},{default:ze(()=>[(ue(),Je(kr(S(B))))]),_:1},8,["class"])):We("v-if",!0)],2)],2)):We("v-if",!0)],2),We(" append slot "),te.$slots.append?(ue(),Ie("div",{key:1,class:Ae(S(f).be("group","append"))},[Xe(te.$slots,"append")],2)):We("v-if",!0)],64)):(ue(),Ie(Dt,{key:1},[We(" textarea "),Oe("textarea",_t({id:S(h),ref_key:"textarea",ref:w,class:S(m).e("inner")},S(c),{minlength:te.minlength,maxlength:te.maxlength,tabindex:te.tabindex,disabled:S(g),readonly:te.readonly,autocomplete:te.autocomplete,style:S(se),"aria-label":te.label,placeholder:te.placeholder,form:te.form,autofocus:te.autofocus,onCompositionstart:V,onCompositionupdate:ie,onCompositionend:ne,onInput:L,onFocus:Pe[2]||(Pe[2]=(...Ne)=>S(A)&&S(A)(...Ne)),onBlur:Pe[3]||(Pe[3]=(...Ne)=>S(P)&&S(P)(...Ne)),onChange:I,onKeydown:le}),null,16,JN),S(M)?(ue(),Ie("span",{key:0,style:kt(R.value),class:Ae(S(f).e("count"))},Ut(S(X))+" / "+Ut(te.maxlength),7)):We("v-if",!0)],64))],16,XN))}});var tB=bt(eB,[["__file","input.vue"]]);const s0=gr(tB),Qo=4,Hb={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},rB=({move:e,size:t,bar:r})=>({[r.size]:t,transform:`translate${r.axis}(${e}%)`}),n0=Symbol("scrollbarContextKey"),iB=it({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),sB="Thumb",nB=_e({__name:"thumb",props:iB,setup(e){const t=e,r=rt(n0),i=at("scrollbar");r||sn(sB,"can not inject scrollbar context");const s=we(),n=we(),o=we({}),a=we(!1);let l=!1,c=!1,u=Nt?document.onselectstart:null;const d=Q(()=>Hb[t.vertical?"vertical":"horizontal"]),h=Q(()=>rB({size:t.size,move:t.move,bar:d.value})),p=Q(()=>s.value[d.value.offset]**2/r.wrapElement[d.value.scrollSize]/t.ratio/n.value[d.value.offset]),g=R=>{var y;if(R.stopPropagation(),R.ctrlKey||[1,2].includes(R.button))return;(y=window.getSelection())==null||y.removeAllRanges(),m(R);const b=R.currentTarget;b&&(o.value[d.value.axis]=b[d.value.offset]-(R[d.value.client]-b.getBoundingClientRect()[d.value.direction]))},f=R=>{if(!n.value||!s.value||!r.wrapElement)return;const y=Math.abs(R.target.getBoundingClientRect()[d.value.direction]-R[d.value.client]),b=n.value[d.value.offset]/2,x=(y-b)*100*p.value/s.value[d.value.offset];r.wrapElement[d.value.scroll]=x*r.wrapElement[d.value.scrollSize]/100},m=R=>{R.stopImmediatePropagation(),l=!0,document.addEventListener("mousemove",v),document.addEventListener("mouseup",w),u=document.onselectstart,document.onselectstart=()=>!1},v=R=>{if(!s.value||!n.value||l===!1)return;const y=o.value[d.value.axis];if(!y)return;const b=(s.value.getBoundingClientRect()[d.value.direction]-R[d.value.client])*-1,x=n.value[d.value.offset]-y,T=(b-x)*100*p.value/s.value[d.value.offset];r.wrapElement[d.value.scroll]=T*r.wrapElement[d.value.scrollSize]/100},w=()=>{l=!1,o.value[d.value.axis]=0,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",w),D(),c&&(a.value=!1)},C=()=>{c=!1,a.value=!!t.size},F=()=>{c=!0,a.value=l};Er(()=>{D(),document.removeEventListener("mouseup",w)});const D=()=>{document.onselectstart!==u&&(document.onselectstart=u)};return Ji(ii(r,"scrollbarElement"),"mousemove",C),Ji(ii(r,"scrollbarElement"),"mouseleave",F),(R,y)=>(ue(),Je(Hn,{name:S(i).b("fade"),persisted:""},{default:ze(()=>[Yr(Oe("div",{ref_key:"instance",ref:s,class:Ae([S(i).e("bar"),S(i).is(S(d).key)]),onMousedown:f},[Oe("div",{ref_key:"thumb",ref:n,class:Ae(S(i).e("thumb")),style:kt(S(h)),onMousedown:g},null,38)],34),[[en,R.always||a.value]])]),_:1},8,["name"]))}});var MC=bt(nB,[["__file","thumb.vue"]]);const oB=it({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),aB=_e({__name:"bar",props:oB,setup(e,{expose:t}){const r=e,i=rt(n0),s=we(0),n=we(0),o=we(""),a=we(""),l=we(1),c=we(1);return t({handleScroll:h=>{if(h){const p=h.offsetHeight-Qo,g=h.offsetWidth-Qo;n.value=h.scrollTop*100/p*l.value,s.value=h.scrollLeft*100/g*c.value}},update:()=>{const h=i==null?void 0:i.wrapElement;if(!h)return;const p=h.offsetHeight-Qo,g=h.offsetWidth-Qo,f=p**2/h.scrollHeight,m=g**2/h.scrollWidth,v=Math.max(f,r.minSize),w=Math.max(m,r.minSize);l.value=f/(p-f)/(v/(p-v)),c.value=m/(g-m)/(w/(g-w)),a.value=v+Qo<p?`${v}px`:"",o.value=w+Qo<g?`${w}px`:""}}),(h,p)=>(ue(),Ie(Dt,null,[ye(MC,{move:s.value,ratio:c.value,size:o.value,always:h.always},null,8,["move","ratio","size","always"]),ye(MC,{move:n.value,ratio:l.value,size:a.value,vertical:"",always:h.always},null,8,["move","ratio","size","always"])],64))}});var lB=bt(aB,[["__file","bar.vue"]]);const cB=it({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Me([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),uB={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(dt)},dB="ElScrollbar",hB=_e({name:dB}),fB=_e({...hB,props:cB,emits:uB,setup(e,{expose:t,emit:r}){const i=e,s=at("scrollbar");let n,o;const a=we(),l=we(),c=we(),u=we(),d=Q(()=>{const C={};return i.height&&(C.height=Ss(i.height)),i.maxHeight&&(C.maxHeight=Ss(i.maxHeight)),[i.wrapStyle,C]}),h=Q(()=>[i.wrapClass,s.e("wrap"),{[s.em("wrap","hidden-default")]:!i.native}]),p=Q(()=>[s.e("view"),i.viewClass]),g=()=>{var C;l.value&&((C=u.value)==null||C.handleScroll(l.value),r("scroll",{scrollTop:l.value.scrollTop,scrollLeft:l.value.scrollLeft}))};function f(C,F){ot(C)?l.value.scrollTo(C):dt(C)&&dt(F)&&l.value.scrollTo(C,F)}const m=C=>{dt(C)&&(l.value.scrollTop=C)},v=C=>{dt(C)&&(l.value.scrollLeft=C)},w=()=>{var C;(C=u.value)==null||C.update()};return Qe(()=>i.noresize,C=>{C?(n==null||n(),o==null||o()):({stop:n}=ri(c,w),o=Ji("resize",w))},{immediate:!0}),Qe(()=>[i.maxHeight,i.height],()=>{i.native||Tt(()=>{var C;w(),l.value&&((C=u.value)==null||C.handleScroll(l.value))})}),rr(n0,Br({scrollbarElement:a,wrapElement:l})),Gt(()=>{i.native||Tt(()=>{w()})}),Va(()=>w()),t({wrapRef:l,update:w,scrollTo:f,setScrollTop:m,setScrollLeft:v,handleScroll:g}),(C,F)=>(ue(),Ie("div",{ref_key:"scrollbarRef",ref:a,class:Ae(S(s).b())},[Oe("div",{ref_key:"wrapRef",ref:l,class:Ae(S(h)),style:kt(S(d)),onScroll:g},[(ue(),Je(kr(C.tag),{id:C.id,ref_key:"resizeRef",ref:c,class:Ae(S(p)),style:kt(C.viewStyle),role:C.role,"aria-label":C.ariaLabel,"aria-orientation":C.ariaOrientation},{default:ze(()=>[Xe(C.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),C.native?We("v-if",!0):(ue(),Je(lB,{key:0,ref_key:"barRef",ref:u,always:C.always,"min-size":C.minSize},null,8,["always","min-size"]))],2))}});var pB=bt(fB,[["__file","scrollbar.vue"]]);const gB=gr(pB),o0=Symbol("popper"),Vb=Symbol("popperContent"),mB=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],Wb=it({role:{type:String,values:mB,default:"tooltip"}}),vB=_e({name:"ElPopper",inheritAttrs:!1}),CB=_e({...vB,props:Wb,setup(e,{expose:t}){const r=e,i=we(),s=we(),n=we(),o=we(),a=Q(()=>r.role),l={triggerRef:i,popperInstanceRef:s,contentRef:n,referenceRef:o,role:a};return t(l),rr(o0,l),(c,u)=>Xe(c.$slots,"default")}});var wB=bt(CB,[["__file","popper.vue"]]);const zb=it({arrowOffset:{type:Number,default:5}}),SB=_e({name:"ElPopperArrow",inheritAttrs:!1}),yB=_e({...SB,props:zb,setup(e,{expose:t}){const r=e,i=at("popper"),{arrowOffset:s,arrowRef:n,arrowStyle:o}=rt(Vb,void 0);return Qe(()=>r.arrowOffset,a=>{s.value=a}),Er(()=>{n.value=void 0}),t({arrowRef:n}),(a,l)=>(ue(),Ie("span",{ref_key:"arrowRef",ref:n,class:Ae(S(i).e("arrow")),style:kt(S(o)),"data-popper-arrow":""},null,6))}});var xB=bt(yB,[["__file","arrow.vue"]]);const bB="ElOnlyChild",RB=_e({name:bB,setup(e,{slots:t,attrs:r}){var i;const s=rt(Ab),n=BL((i=s==null?void 0:s.setForwardRef)!=null?i:St);return()=>{var o;const a=(o=t.default)==null?void 0:o.call(t,r);if(!a||a.length>1)return null;const l=$b(a);return l?Yr(js(l,r),[[n]]):null}}});function $b(e){if(!e)return null;const t=e;for(const r of t){if(ot(r))switch(r.type){case Ci:continue;case Wa:case"svg":return kC(r);case Dt:return $b(r.children);default:return r}return kC(r)}return null}function kC(e){const t=at("only-child");return ye("span",{class:t.e("content")},[e])}const Ub=it({virtualRef:{type:Me(Object)},virtualTriggering:Boolean,onMouseenter:{type:Me(Function)},onMouseleave:{type:Me(Function)},onClick:{type:Me(Function)},onKeydown:{type:Me(Function)},onFocus:{type:Me(Function)},onBlur:{type:Me(Function)},onContextmenu:{type:Me(Function)},id:String,open:Boolean}),EB=_e({name:"ElPopperTrigger",inheritAttrs:!1}),FB=_e({...EB,props:Ub,setup(e,{expose:t}){const r=e,{role:i,triggerRef:s}=rt(o0,void 0);NL(s);const n=Q(()=>a.value?r.id:void 0),o=Q(()=>{if(i&&i.value==="tooltip")return r.open&&r.id?r.id:void 0}),a=Q(()=>{if(i&&i.value!=="tooltip")return i.value}),l=Q(()=>a.value?`${r.open}`:void 0);let c;return Gt(()=>{Qe(()=>r.virtualRef,u=>{u&&(s.value=Gs(u))},{immediate:!0}),Qe(s,(u,d)=>{c==null||c(),c=void 0,Ra(u)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(h=>{var p;const g=r[h];g&&(u.addEventListener(h.slice(2).toLowerCase(),g),(p=d==null?void 0:d.removeEventListener)==null||p.call(d,h.slice(2).toLowerCase(),g))}),c=Qe([n,o,a,l],h=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((p,g)=>{Pi(h[g])?u.removeAttribute(p):u.setAttribute(p,h[g])})},{immediate:!0})),Ra(d)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(h=>d.removeAttribute(h))},{immediate:!0})}),Er(()=>{c==null||c(),c=void 0}),t({triggerRef:s}),(u,d)=>u.virtualTriggering?We("v-if",!0):(ue(),Je(S(RB),_t({key:0},u.$attrs,{"aria-controls":S(n),"aria-describedby":S(o),"aria-expanded":S(l),"aria-haspopup":S(a)}),{default:ze(()=>[Xe(u.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var TB=bt(FB,[["__file","trigger.vue"]]);const tf="focus-trap.focus-after-trapped",rf="focus-trap.focus-after-released",AB="focus-trap.focusout-prevented",_C={cancelable:!0,bubbles:!1},PB={cancelable:!0,bubbles:!1},IC="focusAfterTrapped",OC="focusAfterReleased",DB=Symbol("elFocusTrap"),a0=we(),mh=we(0),l0=we(0);let uu=0;const Kb=e=>{const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const s=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||s?NodeFilter.FILTER_SKIP:i.tabIndex>=0||i===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t},LC=(e,t)=>{for(const r of e)if(!MB(r,t))return r},MB=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},kB=e=>{const t=Kb(e),r=LC(t,e),i=LC(t.reverse(),e);return[r,i]},_B=e=>e instanceof HTMLInputElement&&"select"in e,pn=(e,t)=>{if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),l0.value=window.performance.now(),e!==r&&_B(e)&&t&&e.select()}};function NC(e,t){const r=[...e],i=e.indexOf(t);return i!==-1&&r.splice(i,1),r}const IB=()=>{let e=[];return{push:i=>{const s=e[0];s&&i!==s&&s.pause(),e=NC(e,i),e.unshift(i)},remove:i=>{var s,n;e=NC(e,i),(n=(s=e[0])==null?void 0:s.resume)==null||n.call(s)}}},OB=(e,t=!1)=>{const r=document.activeElement;for(const i of e)if(pn(i,t),document.activeElement!==r)return},BC=IB(),LB=()=>mh.value>l0.value,du=()=>{a0.value="pointer",mh.value=window.performance.now()},GC=()=>{a0.value="keyboard",mh.value=window.performance.now()},NB=()=>(Gt(()=>{uu===0&&(document.addEventListener("mousedown",du),document.addEventListener("touchstart",du),document.addEventListener("keydown",GC)),uu++}),Er(()=>{uu--,uu<=0&&(document.removeEventListener("mousedown",du),document.removeEventListener("touchstart",du),document.removeEventListener("keydown",GC))}),{focusReason:a0,lastUserFocusTimestamp:mh,lastAutomatedFocusTimestamp:l0}),hu=e=>new CustomEvent(AB,{...PB,detail:e}),BB=_e({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[IC,OC,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const r=we();let i,s;const{focusReason:n}=NB();kL(g=>{e.trapped&&!o.paused&&t("release-requested",g)});const o={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=g=>{if(!e.loop&&!e.trapped||o.paused)return;const{key:f,altKey:m,ctrlKey:v,metaKey:w,currentTarget:C,shiftKey:F}=g,{loop:D}=e,R=f===ys.tab&&!m&&!v&&!w,y=document.activeElement;if(R&&y){const b=C,[x,T]=kB(b);if(x&&T){if(!F&&y===T){const P=hu({focusReason:n.value});t("focusout-prevented",P),P.defaultPrevented||(g.preventDefault(),D&&pn(x,!0))}else if(F&&[x,b].includes(y)){const P=hu({focusReason:n.value});t("focusout-prevented",P),P.defaultPrevented||(g.preventDefault(),D&&pn(T,!0))}}else if(y===b){const P=hu({focusReason:n.value});t("focusout-prevented",P),P.defaultPrevented||g.preventDefault()}}};rr(DB,{focusTrapRef:r,onKeydown:a}),Qe(()=>e.focusTrapEl,g=>{g&&(r.value=g)},{immediate:!0}),Qe([r],([g],[f])=>{g&&(g.addEventListener("keydown",a),g.addEventListener("focusin",u),g.addEventListener("focusout",d)),f&&(f.removeEventListener("keydown",a),f.removeEventListener("focusin",u),f.removeEventListener("focusout",d))});const l=g=>{t(IC,g)},c=g=>t(OC,g),u=g=>{const f=S(r);if(!f)return;const m=g.target,v=g.relatedTarget,w=m&&f.contains(m);e.trapped||v&&f.contains(v)||(i=v),w&&t("focusin",g),!o.paused&&e.trapped&&(w?s=m:pn(s,!0))},d=g=>{const f=S(r);if(!(o.paused||!f))if(e.trapped){const m=g.relatedTarget;!Pi(m)&&!f.contains(m)&&setTimeout(()=>{if(!o.paused&&e.trapped){const v=hu({focusReason:n.value});t("focusout-prevented",v),v.defaultPrevented||pn(s,!0)}},0)}else{const m=g.target;m&&f.contains(m)||t("focusout",g)}};async function h(){await Tt();const g=S(r);if(g){BC.push(o);const f=g.contains(document.activeElement)?i:document.activeElement;if(i=f,!g.contains(f)){const v=new Event(tf,_C);g.addEventListener(tf,l),g.dispatchEvent(v),v.defaultPrevented||Tt(()=>{let w=e.focusStartEl;ct(w)||(pn(w),document.activeElement!==w&&(w="first")),w==="first"&&OB(Kb(g),!0),(document.activeElement===f||w==="container")&&pn(g)})}}}function p(){const g=S(r);if(g){g.removeEventListener(tf,l);const f=new CustomEvent(rf,{..._C,detail:{focusReason:n.value}});g.addEventListener(rf,c),g.dispatchEvent(f),!f.defaultPrevented&&(n.value=="keyboard"||!LB()||g.contains(document.activeElement))&&pn(i??document.body),g.removeEventListener(rf,c),BC.remove(o)}}return Gt(()=>{e.trapped&&h(),Qe(()=>e.trapped,g=>{g?h():p()})}),Er(()=>{e.trapped&&p()}),{onKeydown:a}}});function GB(e,t,r,i,s,n){return Xe(e.$slots,"default",{handleKeydown:e.onKeydown})}var HB=bt(BB,[["render",GB],["__file","focus-trap.vue"]]);const VB=["fixed","absolute"],WB=it({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Me(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:fh,default:"bottom"},popperOptions:{type:Me(Object),default:()=>({})},strategy:{type:String,values:VB,default:"absolute"}}),jb=it({...WB,id:String,style:{type:Me([String,Array,Object])},className:{type:Me([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:Me([String,Array,Object])},popperStyle:{type:Me([String,Array,Object])},referenceEl:{type:Me(Object)},triggerTargetEl:{type:Me(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),zB={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},$B=(e,t=[])=>{const{placement:r,strategy:i,popperOptions:s}=e,n={placement:r,strategy:i,...s,modifiers:[...KB(e),...t]};return jB(n,s==null?void 0:s.modifiers),n},UB=e=>{if(Nt)return Gs(e)};function KB(e){const{offset:t,gpuAcceleration:r,fallbackPlacements:i}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:i}},{name:"computeStyles",options:{gpuAcceleration:r}}]}function jB(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const qB=0,YB=e=>{const{popperInstanceRef:t,contentRef:r,triggerRef:i,role:s}=rt(o0,void 0),n=we(),o=we(),a=Q(()=>({name:"eventListeners",enabled:!!e.visible})),l=Q(()=>{var v;const w=S(n),C=(v=S(o))!=null?v:qB;return{name:"arrow",enabled:!F2(w),options:{element:w,padding:C}}}),c=Q(()=>({onFirstUpdate:()=>{g()},...$B(e,[S(l),S(a)])})),u=Q(()=>UB(e.referenceEl)||S(i)),{attributes:d,state:h,styles:p,update:g,forceUpdate:f,instanceRef:m}=PL(u,r,c);return Qe(m,v=>t.value=v),Gt(()=>{Qe(()=>{var v;return(v=S(u))==null?void 0:v.getBoundingClientRect()},()=>{g()})}),{attributes:d,arrowRef:n,contentRef:r,instanceRef:m,state:h,styles:p,role:s,forceUpdate:f,update:g}},XB=(e,{attributes:t,styles:r,role:i})=>{const{nextZIndex:s}=Mb(),n=at("popper"),o=Q(()=>S(t).popper),a=we(dt(e.zIndex)?e.zIndex:s()),l=Q(()=>[n.b(),n.is("pure",e.pure),n.is(e.effect),e.popperClass]),c=Q(()=>[{zIndex:S(a)},S(r).popper,e.popperStyle||{}]),u=Q(()=>i.value==="dialog"?"false":void 0),d=Q(()=>S(r).arrow||{});return{ariaModal:u,arrowStyle:d,contentAttrs:o,contentClass:l,contentStyle:c,contentZIndex:a,updateZIndex:()=>{a.value=dt(e.zIndex)?e.zIndex:s()}}},QB=(e,t)=>{const r=we(!1),i=we();return{focusStartRef:i,trapped:r,onFocusAfterReleased:c=>{var u;((u=c.detail)==null?void 0:u.focusReason)!=="pointer"&&(i.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:c=>{e.visible&&!r.value&&(c.target&&(i.value=c.target),r.value=!0)},onFocusoutPrevented:c=>{e.trapping||(c.detail.focusReason==="pointer"&&c.preventDefault(),r.value=!1)},onReleaseRequested:()=>{r.value=!1,t("close")}}},JB=_e({name:"ElPopperContent"}),ZB=_e({...JB,props:jb,emits:zB,setup(e,{expose:t,emit:r}){const i=e,{focusStartRef:s,trapped:n,onFocusAfterReleased:o,onFocusAfterTrapped:a,onFocusInTrap:l,onFocusoutPrevented:c,onReleaseRequested:u}=QB(i,r),{attributes:d,arrowRef:h,contentRef:p,styles:g,instanceRef:f,role:m,update:v}=YB(i),{ariaModal:w,arrowStyle:C,contentAttrs:F,contentClass:D,contentStyle:R,updateZIndex:y}=XB(i,{styles:g,attributes:d,role:m}),b=rt(Po,void 0),x=we();rr(Vb,{arrowStyle:C,arrowRef:h,arrowOffset:x}),b&&(b.addInputId||b.removeInputId)&&rr(Po,{...b,addInputId:St,removeInputId:St});let T;const A=(U=!0)=>{v(),U&&y()},P=()=>{A(!1),i.visible&&i.focusOnShow?n.value=!0:i.visible===!1&&(n.value=!1)};return Gt(()=>{Qe(()=>i.triggerTargetEl,(U,J)=>{T==null||T(),T=void 0;const B=S(U||p.value),H=S(J||p.value);Ra(B)&&(T=Qe([m,()=>i.ariaLabel,w,()=>i.id],_=>{["role","aria-label","aria-modal","id"].forEach((se,G)=>{Pi(_[G])?B.removeAttribute(se):B.setAttribute(se,_[G])})},{immediate:!0})),H!==B&&Ra(H)&&["role","aria-label","aria-modal","id"].forEach(_=>{H.removeAttribute(_)})},{immediate:!0}),Qe(()=>i.visible,P,{immediate:!0})}),Er(()=>{T==null||T(),T=void 0}),t({popperContentRef:p,popperInstanceRef:f,updatePopper:A,contentStyle:R}),(U,J)=>(ue(),Ie("div",_t({ref_key:"contentRef",ref:p},S(F),{style:S(R),class:S(D),tabindex:"-1",onMouseenter:J[0]||(J[0]=B=>U.$emit("mouseenter",B)),onMouseleave:J[1]||(J[1]=B=>U.$emit("mouseleave",B))}),[ye(S(HB),{trapped:S(n),"trap-on-focus-in":!0,"focus-trap-el":S(p),"focus-start-el":S(s),onFocusAfterTrapped:S(a),onFocusAfterReleased:S(o),onFocusin:S(l),onFocusoutPrevented:S(c),onReleaseRequested:S(u)},{default:ze(()=>[Xe(U.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var e4=bt(ZB,[["__file","content.vue"]]);const t4=gr(wB),c0=Symbol("elTooltip"),u0=it({...OL,...jb,appendTo:{type:Me([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:Me(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),qb=it({...Ub,disabled:Boolean,trigger:{type:Me([String,Array]),default:"hover"},triggerKeys:{type:Me(Array),default:()=>[ys.enter,ys.space]}}),{useModelToggleProps:r4,useModelToggleEmits:i4,useModelToggle:s4}=fb("visible"),n4=it({...Wb,...r4,...u0,...qb,...zb,showArrow:{type:Boolean,default:!0}}),o4=[...i4,"before-show","before-hide","show","hide","open","close"],a4=(e,t)=>Ue(e)?e.includes(t):e===t,Jo=(e,t,r)=>i=>{a4(S(e),t)&&r(i)},l4=_e({name:"ElTooltipTrigger"}),c4=_e({...l4,props:qb,setup(e,{expose:t}){const r=e,i=at("tooltip"),{controlled:s,id:n,open:o,onOpen:a,onClose:l,onToggle:c}=rt(c0,void 0),u=we(null),d=()=>{if(S(s)||r.disabled)return!0},h=ii(r,"trigger"),p=Ls(d,Jo(h,"hover",a)),g=Ls(d,Jo(h,"hover",l)),f=Ls(d,Jo(h,"click",F=>{F.button===0&&c(F)})),m=Ls(d,Jo(h,"focus",a)),v=Ls(d,Jo(h,"focus",l)),w=Ls(d,Jo(h,"contextmenu",F=>{F.preventDefault(),c(F)})),C=Ls(d,F=>{const{code:D}=F;r.triggerKeys.includes(D)&&(F.preventDefault(),c(F))});return t({triggerRef:u}),(F,D)=>(ue(),Je(S(TB),{id:S(n),"virtual-ref":F.virtualRef,open:S(o),"virtual-triggering":F.virtualTriggering,class:Ae(S(i).e("trigger")),onBlur:S(v),onClick:S(f),onContextmenu:S(w),onFocus:S(m),onMouseenter:S(p),onMouseleave:S(g),onKeydown:S(C)},{default:ze(()=>[Xe(F.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var u4=bt(c4,[["__file","trigger.vue"]]);const d4=_e({name:"ElTooltipContent",inheritAttrs:!1}),h4=_e({...d4,props:u0,setup(e,{expose:t}){const r=e,{selector:i}=Tb(),s=at("tooltip"),n=we(null),o=we(!1),{controlled:a,id:l,open:c,trigger:u,onClose:d,onOpen:h,onShow:p,onHide:g,onBeforeShow:f,onBeforeHide:m}=rt(c0,void 0),v=Q(()=>r.transition||`${s.namespace.value}-fade-in-linear`),w=Q(()=>r.persistent);Er(()=>{o.value=!0});const C=Q(()=>S(w)?!0:S(c)),F=Q(()=>r.disabled?!1:S(c)),D=Q(()=>r.appendTo||i.value),R=Q(()=>{var _;return(_=r.style)!=null?_:{}}),y=Q(()=>!S(c)),b=()=>{g()},x=()=>{if(S(a))return!0},T=Ls(x,()=>{r.enterable&&S(u)==="hover"&&h()}),A=Ls(x,()=>{S(u)==="hover"&&d()}),P=()=>{var _,se;(se=(_=n.value)==null?void 0:_.updatePopper)==null||se.call(_),f==null||f()},U=()=>{m==null||m()},J=()=>{p(),H=CD(Q(()=>{var _;return(_=n.value)==null?void 0:_.popperContentRef}),()=>{if(S(a))return;S(u)!=="hover"&&d()})},B=()=>{r.virtualTriggering||d()};let H;return Qe(()=>S(c),_=>{_||H==null||H()},{flush:"post"}),Qe(()=>r.content,()=>{var _,se;(se=(_=n.value)==null?void 0:_.updatePopper)==null||se.call(_)}),t({contentRef:n}),(_,se)=>(ue(),Je(sP,{disabled:!_.teleported,to:S(D)},[ye(Hn,{name:S(v),onAfterLeave:b,onBeforeEnter:P,onAfterEnter:J,onBeforeLeave:U},{default:ze(()=>[S(C)?Yr((ue(),Je(S(e4),_t({key:0,id:S(l),ref_key:"contentRef",ref:n},_.$attrs,{"aria-label":_.ariaLabel,"aria-hidden":S(y),"boundaries-padding":_.boundariesPadding,"fallback-placements":_.fallbackPlacements,"gpu-acceleration":_.gpuAcceleration,offset:_.offset,placement:_.placement,"popper-options":_.popperOptions,strategy:_.strategy,effect:_.effect,enterable:_.enterable,pure:_.pure,"popper-class":_.popperClass,"popper-style":[_.popperStyle,S(R)],"reference-el":_.referenceEl,"trigger-target-el":_.triggerTargetEl,visible:S(F),"z-index":_.zIndex,onMouseenter:S(T),onMouseleave:S(A),onBlur:B,onClose:S(d)}),{default:ze(()=>[o.value?We("v-if",!0):Xe(_.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[en,S(F)]]):We("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var f4=bt(h4,[["__file","content.vue"]]);const p4=["innerHTML"],g4={key:1},m4=_e({name:"ElTooltip"}),v4=_e({...m4,props:n4,emits:o4,setup(e,{expose:t,emit:r}){const i=e;IL();const s=$a(),n=we(),o=we(),a=()=>{var v;const w=S(n);w&&((v=w.popperInstanceRef)==null||v.update())},l=we(!1),c=we(),{show:u,hide:d,hasUpdateHandler:h}=s4({indicator:l,toggleReason:c}),{onOpen:p,onClose:g}=LL({showAfter:ii(i,"showAfter"),hideAfter:ii(i,"hideAfter"),autoClose:ii(i,"autoClose"),open:u,close:d}),f=Q(()=>ch(i.visible)&&!h.value);rr(c0,{controlled:f,id:s,open:Ac(l),trigger:ii(i,"trigger"),onOpen:v=>{p(v)},onClose:v=>{g(v)},onToggle:v=>{S(l)?g(v):p(v)},onShow:()=>{r("show",c.value)},onHide:()=>{r("hide",c.value)},onBeforeShow:()=>{r("before-show",c.value)},onBeforeHide:()=>{r("before-hide",c.value)},updatePopper:a}),Qe(()=>i.disabled,v=>{v&&l.value&&(l.value=!1)});const m=v=>{var w,C;const F=(C=(w=o.value)==null?void 0:w.contentRef)==null?void 0:C.popperContentRef,D=(v==null?void 0:v.relatedTarget)||document.activeElement;return F&&F.contains(D)};return jy(()=>l.value&&d()),t({popperRef:n,contentRef:o,isFocusInsideContent:m,updatePopper:a,onOpen:p,onClose:g,hide:d}),(v,w)=>(ue(),Je(S(t4),{ref_key:"popperRef",ref:n,role:v.role},{default:ze(()=>[ye(u4,{disabled:v.disabled,trigger:v.trigger,"trigger-keys":v.triggerKeys,"virtual-ref":v.virtualRef,"virtual-triggering":v.virtualTriggering},{default:ze(()=>[v.$slots.default?Xe(v.$slots,"default",{key:0}):We("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),ye(f4,{ref_key:"contentRef",ref:o,"aria-label":v.ariaLabel,"boundaries-padding":v.boundariesPadding,content:v.content,disabled:v.disabled,effect:v.effect,enterable:v.enterable,"fallback-placements":v.fallbackPlacements,"hide-after":v.hideAfter,"gpu-acceleration":v.gpuAcceleration,offset:v.offset,persistent:v.persistent,"popper-class":v.popperClass,"popper-style":v.popperStyle,placement:v.placement,"popper-options":v.popperOptions,pure:v.pure,"raw-content":v.rawContent,"reference-el":v.referenceEl,"trigger-target-el":v.triggerTargetEl,"show-after":v.showAfter,strategy:v.strategy,teleported:v.teleported,transition:v.transition,"virtual-triggering":v.virtualTriggering,"z-index":v.zIndex,"append-to":v.appendTo},{default:ze(()=>[Xe(v.$slots,"content",{},()=>[v.rawContent?(ue(),Ie("span",{key:0,innerHTML:v.content},null,8,p4)):(ue(),Ie("span",g4,Ut(v.content),1))]),v.showArrow?(ue(),Je(S(xB),{key:0,"arrow-offset":v.arrowOffset},null,8,["arrow-offset"])):We("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var C4=bt(v4,[["__file","tooltip.vue"]]);const w4=gr(C4),S4=it({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0}}),y4=["textContent"],x4=_e({name:"ElBadge"}),b4=_e({...x4,props:S4,setup(e,{expose:t}){const r=e,i=at("badge"),s=Q(()=>r.isDot?"":dt(r.value)&&dt(r.max)?r.max<r.value?`${r.max}+`:r.value===0&&!r.showZero?"":`${r.value}`:`${r.value}`);return t({content:s}),(n,o)=>(ue(),Ie("div",{class:Ae(S(i).b())},[Xe(n.$slots,"default"),ye(Hn,{name:`${S(i).namespace.value}-zoom-in-center`,persisted:""},{default:ze(()=>[Yr(Oe("sup",{class:Ae([S(i).e("content"),S(i).em("content",n.type),S(i).is("fixed",!!n.$slots.default),S(i).is("dot",n.isDot)]),textContent:Ut(S(s))},null,10,y4),[[en,!n.hidden&&(S(s)||n.isDot)]])]),_:1},8,["name"])],2))}});var R4=bt(b4,[["__file","badge.vue"]]);const E4=gr(R4),Yb=Symbol("buttonGroupContextKey"),F4=(e,t)=>{wO({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Q(()=>e.type==="text"));const r=rt(Yb,void 0),i=i0("button"),{form:s}=gh(),n=Bo(Q(()=>r==null?void 0:r.size)),o=Wn(),a=we(),l=Jd(),c=Q(()=>e.type||(r==null?void 0:r.type)||""),u=Q(()=>{var g,f,m;return(m=(f=e.autoInsertSpace)!=null?f:(g=i.value)==null?void 0:g.autoInsertSpace)!=null?m:!1}),d=Q(()=>e.tag==="button"?{ariaDisabled:o.value||e.loading,disabled:o.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),h=Q(()=>{var g;const f=(g=l.default)==null?void 0:g.call(l);if(u.value&&(f==null?void 0:f.length)===1){const m=f[0];if((m==null?void 0:m.type)===Wa){const v=m.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(v.trim())}}return!1});return{_disabled:o,_size:n,_type:c,_ref:a,_props:d,shouldAddSpace:h,handleClick:g=>{e.nativeType==="reset"&&(s==null||s.resetFields()),t("click",g)}}},T4=["default","primary","success","warning","info","danger","text",""],A4=["button","submit","reset"],hp=it({size:Bc,disabled:Boolean,type:{type:String,values:T4,default:""},icon:{type:Ao},nativeType:{type:String,values:A4,default:"button"},loading:Boolean,loadingIcon:{type:Ao,default:()=>nb},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Me([String,Object]),default:"button"}}),P4={click:e=>e instanceof MouseEvent};function xr(e,t){D4(e)&&(e="100%");var r=M4(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function fu(e){return Math.min(1,Math.max(0,e))}function D4(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function M4(e){return typeof e=="string"&&e.indexOf("%")!==-1}function Xb(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function pu(e){return e<=1?"".concat(Number(e)*100,"%"):e}function co(e){return e.length===1?"0"+e:String(e)}function k4(e,t,r){return{r:xr(e,255)*255,g:xr(t,255)*255,b:xr(r,255)*255}}function HC(e,t,r){e=xr(e,255),t=xr(t,255),r=xr(r,255);var i=Math.max(e,t,r),s=Math.min(e,t,r),n=0,o=0,a=(i+s)/2;if(i===s)o=0,n=0;else{var l=i-s;switch(o=a>.5?l/(2-i-s):l/(i+s),i){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4;break}n/=6}return{h:n,s:o,l:a}}function sf(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*(6*r):r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function _4(e,t,r){var i,s,n;if(e=xr(e,360),t=xr(t,100),r=xr(r,100),t===0)s=r,n=r,i=r;else{var o=r<.5?r*(1+t):r+t-r*t,a=2*r-o;i=sf(a,o,e+1/3),s=sf(a,o,e),n=sf(a,o,e-1/3)}return{r:i*255,g:s*255,b:n*255}}function VC(e,t,r){e=xr(e,255),t=xr(t,255),r=xr(r,255);var i=Math.max(e,t,r),s=Math.min(e,t,r),n=0,o=i,a=i-s,l=i===0?0:a/i;if(i===s)n=0;else{switch(i){case e:n=(t-r)/a+(t<r?6:0);break;case t:n=(r-e)/a+2;break;case r:n=(e-t)/a+4;break}n/=6}return{h:n,s:l,v:o}}function I4(e,t,r){e=xr(e,360)*6,t=xr(t,100),r=xr(r,100);var i=Math.floor(e),s=e-i,n=r*(1-t),o=r*(1-s*t),a=r*(1-(1-s)*t),l=i%6,c=[r,o,n,n,a,r][l],u=[a,r,r,o,n,n][l],d=[n,n,a,r,r,o][l];return{r:c*255,g:u*255,b:d*255}}function WC(e,t,r,i){var s=[co(Math.round(e).toString(16)),co(Math.round(t).toString(16)),co(Math.round(r).toString(16))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function O4(e,t,r,i,s){var n=[co(Math.round(e).toString(16)),co(Math.round(t).toString(16)),co(Math.round(r).toString(16)),co(L4(i))];return s&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))&&n[3].startsWith(n[3].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)+n[3].charAt(0):n.join("")}function L4(e){return Math.round(parseFloat(e)*255).toString(16)}function zC(e){return ui(e)/255}function ui(e){return parseInt(e,16)}function N4(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var fp={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function B4(e){var t={r:0,g:0,b:0},r=1,i=null,s=null,n=null,o=!1,a=!1;return typeof e=="string"&&(e=V4(e)),typeof e=="object"&&(Ms(e.r)&&Ms(e.g)&&Ms(e.b)?(t=k4(e.r,e.g,e.b),o=!0,a=String(e.r).substr(-1)==="%"?"prgb":"rgb"):Ms(e.h)&&Ms(e.s)&&Ms(e.v)?(i=pu(e.s),s=pu(e.v),t=I4(e.h,i,s),o=!0,a="hsv"):Ms(e.h)&&Ms(e.s)&&Ms(e.l)&&(i=pu(e.s),n=pu(e.l),t=_4(e.h,i,n),o=!0,a="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=Xb(r),{ok:o,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var G4="[-\\+]?\\d+%?",H4="[-\\+]?\\d*\\.\\d+%?",Rn="(?:".concat(H4,")|(?:").concat(G4,")"),nf="[\\s|\\(]+(".concat(Rn,")[,|\\s]+(").concat(Rn,")[,|\\s]+(").concat(Rn,")\\s*\\)?"),of="[\\s|\\(]+(".concat(Rn,")[,|\\s]+(").concat(Rn,")[,|\\s]+(").concat(Rn,")[,|\\s]+(").concat(Rn,")\\s*\\)?"),Wi={CSS_UNIT:new RegExp(Rn),rgb:new RegExp("rgb"+nf),rgba:new RegExp("rgba"+of),hsl:new RegExp("hsl"+nf),hsla:new RegExp("hsla"+of),hsv:new RegExp("hsv"+nf),hsva:new RegExp("hsva"+of),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function V4(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(fp[e])e=fp[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r=Wi.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=Wi.rgba.exec(e),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Wi.hsl.exec(e),r?{h:r[1],s:r[2],l:r[3]}:(r=Wi.hsla.exec(e),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Wi.hsv.exec(e),r?{h:r[1],s:r[2],v:r[3]}:(r=Wi.hsva.exec(e),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Wi.hex8.exec(e),r?{r:ui(r[1]),g:ui(r[2]),b:ui(r[3]),a:zC(r[4]),format:t?"name":"hex8"}:(r=Wi.hex6.exec(e),r?{r:ui(r[1]),g:ui(r[2]),b:ui(r[3]),format:t?"name":"hex"}:(r=Wi.hex4.exec(e),r?{r:ui(r[1]+r[1]),g:ui(r[2]+r[2]),b:ui(r[3]+r[3]),a:zC(r[4]+r[4]),format:t?"name":"hex8"}:(r=Wi.hex3.exec(e),r?{r:ui(r[1]+r[1]),g:ui(r[2]+r[2]),b:ui(r[3]+r[3]),format:t?"name":"hex"}:!1)))))))))}function Ms(e){return!!Wi.CSS_UNIT.exec(String(e))}var W4=function(){function e(t,r){t===void 0&&(t=""),r===void 0&&(r={});var i;if(t instanceof e)return t;typeof t=="number"&&(t=N4(t)),this.originalInput=t;var s=B4(t);this.originalInput=t,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=r.format)!==null&&i!==void 0?i:s.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),r,i,s,n=t.r/255,o=t.g/255,a=t.b/255;return n<=.03928?r=n/12.92:r=Math.pow((n+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),a<=.03928?s=a/12.92:s=Math.pow((a+.055)/1.055,2.4),.2126*r+.7152*i+.0722*s},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=Xb(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=VC(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=VC(this.r,this.g,this.b),r=Math.round(t.h*360),i=Math.round(t.s*100),s=Math.round(t.v*100);return this.a===1?"hsv(".concat(r,", ").concat(i,"%, ").concat(s,"%)"):"hsva(".concat(r,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=HC(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=HC(this.r,this.g,this.b),r=Math.round(t.h*360),i=Math.round(t.s*100),s=Math.round(t.l*100);return this.a===1?"hsl(".concat(r,", ").concat(i,"%, ").concat(s,"%)"):"hsla(".concat(r,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),WC(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),O4(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),r=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(r,", ").concat(i,")"):"rgba(".concat(t,", ").concat(r,", ").concat(i,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(r){return"".concat(Math.round(xr(r,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(r){return Math.round(xr(r,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+WC(this.r,this.g,this.b,!1),r=0,i=Object.entries(fp);r<i.length;r++){var s=i[r],n=s[0],o=s[1];if(t===o)return n}return!1},e.prototype.toString=function(t){var r=!!t;t=t??this.format;var i=!1,s=this.a<1&&this.a>=0,n=!r&&s&&(t.startsWith("hex")||t==="name");return n?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=fu(r.l),new e(r)},e.prototype.brighten=function(t){t===void 0&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(t/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(t/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(t/100)))),new e(r)},e.prototype.darken=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=fu(r.l),new e(r)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=fu(r.s),new e(r)},e.prototype.saturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=fu(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),i=(r.h+t)%360;return r.h=i<0?360+i:i,new e(r)},e.prototype.mix=function(t,r){r===void 0&&(r=50);var i=this.toRgb(),s=new e(t).toRgb(),n=r/100,o={r:(s.r-i.r)*n+i.r,g:(s.g-i.g)*n+i.g,b:(s.b-i.b)*n+i.b,a:(s.a-i.a)*n+i.a};return new e(o)},e.prototype.analogous=function(t,r){t===void 0&&(t=6),r===void 0&&(r=30);var i=this.toHsl(),s=360/r,n=[this];for(i.h=(i.h-(s*t>>1)+720)%360;--t;)i.h=(i.h+s)%360,n.push(new e(i));return n},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var r=this.toHsv(),i=r.h,s=r.s,n=r.v,o=[],a=1/t;t--;)o.push(new e({h:i,s,v:n})),n=(n+a)%1;return o},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),i=new e(t).toRgb(),s=r.a+i.a*(1-r.a);return new e({r:(r.r*r.a+i.r*i.a*(1-r.a))/s,g:(r.g*r.a+i.g*i.a*(1-r.a))/s,b:(r.b*r.a+i.b*i.a*(1-r.a))/s,a:s})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),i=r.h,s=[this],n=360/t,o=1;o<t;o++)s.push(new e({h:(i+o*n)%360,s:r.s,l:r.l}));return s},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function cn(e,t=20){return e.mix("#141414",t).toString()}function z4(e){const t=Wn(),r=at("button");return Q(()=>{let i={};const s=e.color;if(s){const n=new W4(s),o=e.dark?n.tint(20).toString():cn(n,20);if(e.plain)i=r.cssVarBlock({"bg-color":e.dark?cn(n,90):n.tint(90).toString(),"text-color":s,"border-color":e.dark?cn(n,50):n.tint(50).toString(),"hover-text-color":`var(${r.cssVarName("color-white")})`,"hover-bg-color":s,"hover-border-color":s,"active-bg-color":o,"active-text-color":`var(${r.cssVarName("color-white")})`,"active-border-color":o}),t.value&&(i[r.cssVarBlockName("disabled-bg-color")]=e.dark?cn(n,90):n.tint(90).toString(),i[r.cssVarBlockName("disabled-text-color")]=e.dark?cn(n,50):n.tint(50).toString(),i[r.cssVarBlockName("disabled-border-color")]=e.dark?cn(n,80):n.tint(80).toString());else{const a=e.dark?cn(n,30):n.tint(30).toString(),l=n.isDark()?`var(${r.cssVarName("color-white")})`:`var(${r.cssVarName("color-black")})`;if(i=r.cssVarBlock({"bg-color":s,"text-color":l,"border-color":s,"hover-bg-color":a,"hover-text-color":l,"hover-border-color":a,"active-bg-color":o,"active-border-color":o}),t.value){const c=e.dark?cn(n,50):n.tint(50).toString();i[r.cssVarBlockName("disabled-bg-color")]=c,i[r.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${r.cssVarName("color-white")})`,i[r.cssVarBlockName("disabled-border-color")]=c}}}return i})}const $4=_e({name:"ElButton"}),U4=_e({...$4,props:hp,emits:P4,setup(e,{expose:t,emit:r}){const i=e,s=z4(i),n=at("button"),{_ref:o,_size:a,_type:l,_disabled:c,_props:u,shouldAddSpace:d,handleClick:h}=F4(i,r);return t({ref:o,size:a,type:l,disabled:c,shouldAddSpace:d}),(p,g)=>(ue(),Je(kr(p.tag),_t({ref_key:"_ref",ref:o},S(u),{class:[S(n).b(),S(n).m(S(l)),S(n).m(S(a)),S(n).is("disabled",S(c)),S(n).is("loading",p.loading),S(n).is("plain",p.plain),S(n).is("round",p.round),S(n).is("circle",p.circle),S(n).is("text",p.text),S(n).is("link",p.link),S(n).is("has-bg",p.bg)],style:S(s),onClick:S(h)}),{default:ze(()=>[p.loading?(ue(),Ie(Dt,{key:0},[p.$slots.loading?Xe(p.$slots,"loading",{key:0}):(ue(),Je(S(It),{key:1,class:Ae(S(n).is("loading"))},{default:ze(()=>[(ue(),Je(kr(p.loadingIcon)))]),_:1},8,["class"]))],64)):p.icon||p.$slots.icon?(ue(),Je(S(It),{key:1},{default:ze(()=>[p.icon?(ue(),Je(kr(p.icon),{key:0})):Xe(p.$slots,"icon",{key:1})]),_:3})):We("v-if",!0),p.$slots.default?(ue(),Ie("span",{key:2,class:Ae({[S(n).em("text","expand")]:S(d)})},[Xe(p.$slots,"default")],2)):We("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var K4=bt(U4,[["__file","button.vue"]]);const j4={size:hp.size,type:hp.type},q4=_e({name:"ElButtonGroup"}),Y4=_e({...q4,props:j4,setup(e){const t=e;rr(Yb,Br({size:ii(t,"size"),type:ii(t,"type")}));const r=at("button");return(i,s)=>(ue(),Ie("div",{class:Ae(`${S(r).b("group")}`)},[Xe(i.$slots,"default")],2))}});var Qb=bt(Y4,[["__file","button-group.vue"]]);const X4=gr(K4,{ButtonGroup:Qb});Ic(Qb);var ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zb={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(ro,function(){var r=1e3,i=6e4,s=36e5,n="millisecond",o="second",a="minute",l="hour",c="day",u="week",d="month",h="quarter",p="year",g="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(J){var B=["th","st","nd","rd"],H=J%100;return"["+J+(B[(H-20)%10]||B[H]||B[0])+"]"}},C=function(J,B,H){var _=String(J);return!_||_.length>=B?J:""+Array(B+1-_.length).join(H)+J},F={s:C,z:function(J){var B=-J.utcOffset(),H=Math.abs(B),_=Math.floor(H/60),se=H%60;return(B<=0?"+":"-")+C(_,2,"0")+":"+C(se,2,"0")},m:function J(B,H){if(B.date()<H.date())return-J(H,B);var _=12*(H.year()-B.year())+(H.month()-B.month()),se=B.clone().add(_,d),G=H-se<0,he=B.clone().add(_+(G?-1:1),d);return+(-(_+(H-se)/(G?se-he:he-se))||0)},a:function(J){return J<0?Math.ceil(J)||0:Math.floor(J)},p:function(J){return{M:d,y:p,w:u,d:c,D:g,h:l,m:a,s:o,ms:n,Q:h}[J]||String(J||"").toLowerCase().replace(/s$/,"")},u:function(J){return J===void 0}},D="en",R={};R[D]=w;var y="$isDayjsObject",b=function(J){return J instanceof P||!(!J||!J[y])},x=function J(B,H,_){var se;if(!B)return D;if(typeof B=="string"){var G=B.toLowerCase();R[G]&&(se=G),H&&(R[G]=H,se=G);var he=B.split("-");if(!se&&he.length>1)return J(he[0])}else{var Re=B.name;R[Re]=B,se=Re}return!_&&se&&(D=se),se||!_&&D},T=function(J,B){if(b(J))return J.clone();var H=typeof B=="object"?B:{};return H.date=J,H.args=arguments,new P(H)},A=F;A.l=x,A.i=b,A.w=function(J,B){return T(J,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var P=function(){function J(H){this.$L=x(H.locale,null,!0),this.parse(H),this.$x=this.$x||H.x||{},this[y]=!0}var B=J.prototype;return B.parse=function(H){this.$d=function(_){var se=_.date,G=_.utc;if(se===null)return new Date(NaN);if(A.u(se))return new Date;if(se instanceof Date)return new Date(se);if(typeof se=="string"&&!/Z$/i.test(se)){var he=se.match(m);if(he){var Re=he[2]-1||0,M=(he[7]||"0").substring(0,3);return G?new Date(Date.UTC(he[1],Re,he[3]||1,he[4]||0,he[5]||0,he[6]||0,M)):new Date(he[1],Re,he[3]||1,he[4]||0,he[5]||0,he[6]||0,M)}}return new Date(se)}(H),this.init()},B.init=function(){var H=this.$d;this.$y=H.getFullYear(),this.$M=H.getMonth(),this.$D=H.getDate(),this.$W=H.getDay(),this.$H=H.getHours(),this.$m=H.getMinutes(),this.$s=H.getSeconds(),this.$ms=H.getMilliseconds()},B.$utils=function(){return A},B.isValid=function(){return this.$d.toString()!==f},B.isSame=function(H,_){var se=T(H);return this.startOf(_)<=se&&se<=this.endOf(_)},B.isAfter=function(H,_){return T(H)<this.startOf(_)},B.isBefore=function(H,_){return this.endOf(_)<T(H)},B.$g=function(H,_,se){return A.u(H)?this[_]:this.set(se,H)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(H,_){var se=this,G=!!A.u(_)||_,he=A.p(H),Re=function(Z,ee){var Fe=A.w(se.$u?Date.UTC(se.$y,ee,Z):new Date(se.$y,ee,Z),se);return G?Fe:Fe.endOf(c)},M=function(Z,ee){return A.w(se.toDate()[Z].apply(se.toDate("s"),(G?[0,0,0,0]:[23,59,59,999]).slice(ee)),se)},X=this.$W,z=this.$M,Y=this.$D,ae="set"+(this.$u?"UTC":"");switch(he){case p:return G?Re(1,0):Re(31,11);case d:return G?Re(1,z):Re(0,z+1);case u:var W=this.$locale().weekStart||0,re=(X<W?X+7:X)-W;return Re(G?Y-re:Y+(6-re),z);case c:case g:return M(ae+"Hours",0);case l:return M(ae+"Minutes",1);case a:return M(ae+"Seconds",2);case o:return M(ae+"Milliseconds",3);default:return this.clone()}},B.endOf=function(H){return this.startOf(H,!1)},B.$set=function(H,_){var se,G=A.p(H),he="set"+(this.$u?"UTC":""),Re=(se={},se[c]=he+"Date",se[g]=he+"Date",se[d]=he+"Month",se[p]=he+"FullYear",se[l]=he+"Hours",se[a]=he+"Minutes",se[o]=he+"Seconds",se[n]=he+"Milliseconds",se)[G],M=G===c?this.$D+(_-this.$W):_;if(G===d||G===p){var X=this.clone().set(g,1);X.$d[Re](M),X.init(),this.$d=X.set(g,Math.min(this.$D,X.daysInMonth())).$d}else Re&&this.$d[Re](M);return this.init(),this},B.set=function(H,_){return this.clone().$set(H,_)},B.get=function(H){return this[A.p(H)]()},B.add=function(H,_){var se,G=this;H=Number(H);var he=A.p(_),Re=function(z){var Y=T(G);return A.w(Y.date(Y.date()+Math.round(z*H)),G)};if(he===d)return this.set(d,this.$M+H);if(he===p)return this.set(p,this.$y+H);if(he===c)return Re(1);if(he===u)return Re(7);var M=(se={},se[a]=i,se[l]=s,se[o]=r,se)[he]||1,X=this.$d.getTime()+H*M;return A.w(X,this)},B.subtract=function(H,_){return this.add(-1*H,_)},B.format=function(H){var _=this,se=this.$locale();if(!this.isValid())return se.invalidDate||f;var G=H||"YYYY-MM-DDTHH:mm:ssZ",he=A.z(this),Re=this.$H,M=this.$m,X=this.$M,z=se.weekdays,Y=se.months,ae=se.meridiem,W=function(ee,Fe,L,I){return ee&&(ee[Fe]||ee(_,G))||L[Fe].slice(0,I)},re=function(ee){return A.s(Re%12||12,ee,"0")},Z=ae||function(ee,Fe,L){var I=ee<12?"AM":"PM";return L?I.toLowerCase():I};return G.replace(v,function(ee,Fe){return Fe||function(L){switch(L){case"YY":return String(_.$y).slice(-2);case"YYYY":return A.s(_.$y,4,"0");case"M":return X+1;case"MM":return A.s(X+1,2,"0");case"MMM":return W(se.monthsShort,X,Y,3);case"MMMM":return W(Y,X);case"D":return _.$D;case"DD":return A.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return W(se.weekdaysMin,_.$W,z,2);case"ddd":return W(se.weekdaysShort,_.$W,z,3);case"dddd":return z[_.$W];case"H":return String(Re);case"HH":return A.s(Re,2,"0");case"h":return re(1);case"hh":return re(2);case"a":return Z(Re,M,!0);case"A":return Z(Re,M,!1);case"m":return String(M);case"mm":return A.s(M,2,"0");case"s":return String(_.$s);case"ss":return A.s(_.$s,2,"0");case"SSS":return A.s(_.$ms,3,"0");case"Z":return he}return null}(ee)||he.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(H,_,se){var G,he=this,Re=A.p(_),M=T(H),X=(M.utcOffset()-this.utcOffset())*i,z=this-M,Y=function(){return A.m(he,M)};switch(Re){case p:G=Y()/12;break;case d:G=Y();break;case h:G=Y()/3;break;case u:G=(z-X)/6048e5;break;case c:G=(z-X)/864e5;break;case l:G=z/s;break;case a:G=z/i;break;case o:G=z/r;break;default:G=z}return se?G:A.a(G)},B.daysInMonth=function(){return this.endOf(d).$D},B.$locale=function(){return R[this.$L]},B.locale=function(H,_){if(!H)return this.$L;var se=this.clone(),G=x(H,_,!0);return G&&(se.$L=G),se},B.clone=function(){return A.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},J}(),U=P.prototype;return T.prototype=U,[["$ms",n],["$s",o],["$m",a],["$H",l],["$W",c],["$M",d],["$y",p],["$D",g]].forEach(function(J){U[J[1]]=function(B){return this.$g(B,J[0],J[1])}}),T.extend=function(J,B){return J.$i||(J(B,P,T),J.$i=!0),T},T.locale=x,T.isDayjs=b,T.unix=function(J){return T(1e3*J)},T.en=R[D],T.Ls=R,T.p={},T})})(Zb);var Q4=Zb.exports;const J4=Jb(Q4),gn=new Map;let $C;Nt&&(document.addEventListener("mousedown",e=>$C=e),document.addEventListener("mouseup",e=>{for(const t of gn.values())for(const{documentHandler:r}of t)r(e,$C)}));function UC(e,t){let r=[];return Array.isArray(t.arg)?r=t.arg:Ra(t.arg)&&r.push(t.arg),function(i,s){const n=t.instance.popperRef,o=i.target,a=s==null?void 0:s.target,l=!t||!t.instance,c=!o||!a,u=e.contains(o)||e.contains(a),d=e===o,h=r.length&&r.some(g=>g==null?void 0:g.contains(o))||r.length&&r.includes(a),p=n&&(n.contains(o)||n.contains(a));l||c||u||d||h||p||t.value(i,s)}}const Z4={beforeMount(e,t){gn.has(e)||gn.set(e,[]),gn.get(e).push({documentHandler:UC(e,t),bindingFn:t.value})},updated(e,t){gn.has(e)||gn.set(e,[]);const r=gn.get(e),i=r.findIndex(n=>n.bindingFn===t.oldValue),s={documentHandler:UC(e,t),bindingFn:t.value};i>=0?r.splice(i,1,s):r.push(s)},unmounted(e){gn.delete(e)}},eG=100,tG=600,KC={beforeMount(e,t){const r=t.value,{interval:i=eG,delay:s=tG}=Ye(r)?{}:r;let n,o;const a=()=>Ye(r)?r():r.handler(),l=()=>{o&&(clearTimeout(o),o=void 0),n&&(clearInterval(n),n=void 0)};e.addEventListener("mousedown",c=>{c.button===0&&(l(),a(),document.addEventListener("mouseup",()=>l(),{once:!0}),o=setTimeout(()=>{n=setInterval(()=>{a()},i)},s))})}},e1=it({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:hh},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),rG={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},iG=_e({name:"ElTag"}),sG=_e({...iG,props:e1,emits:rG,setup(e,{emit:t}){const r=e,i=Bo(),s=at("tag"),n=Q(()=>{const{type:l,hit:c,effect:u,closable:d,round:h}=r;return[s.b(),s.is("closable",d),s.m(l||"primary"),s.m(i.value),s.m(u),s.is("hit",c),s.is("round",h)]}),o=l=>{t("close",l)},a=l=>{t("click",l)};return(l,c)=>l.disableTransitions?(ue(),Ie("span",{key:0,class:Ae(S(n)),style:kt({backgroundColor:l.color}),onClick:a},[Oe("span",{class:Ae(S(s).e("content"))},[Xe(l.$slots,"default")],2),l.closable?(ue(),Je(S(It),{key:0,class:Ae(S(s).e("close")),onClick:zt(o,["stop"])},{default:ze(()=>[ye(S(Ea))]),_:1},8,["class","onClick"])):We("v-if",!0)],6)):(ue(),Je(Hn,{key:1,name:`${S(s).namespace.value}-zoom-in-center`,appear:""},{default:ze(()=>[Oe("span",{class:Ae(S(n)),style:kt({backgroundColor:l.color}),onClick:a},[Oe("span",{class:Ae(S(s).e("content"))},[Xe(l.$slots,"default")],2),l.closable?(ue(),Je(S(It),{key:0,class:Ae(S(s).e("close")),onClick:zt(o,["stop"])},{default:ze(()=>[ye(S(Ea))]),_:1},8,["class","onClick"])):We("v-if",!0)],6)]),_:3},8,["name"]))}});var nG=bt(sG,[["__file","tag.vue"]]);const oG=gr(nG),aG={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},lG=["id"],cG=["stop-color"],uG=["stop-color"],dG=["id"],hG=["stop-color"],fG=["stop-color"],pG=["id"],gG={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},mG={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},vG={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},CG=["fill"],wG=["fill"],SG={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},yG=["fill"],xG=["fill"],bG=["fill"],RG=["fill"],EG=["fill"],FG={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},TG=["fill","xlink:href"],AG=["fill","mask"],PG=["fill"],DG=_e({name:"ImgEmpty"}),MG=_e({...DG,setup(e){const t=at("empty"),r=$a();return(i,s)=>(ue(),Ie("svg",aG,[Oe("defs",null,[Oe("linearGradient",{id:`linearGradient-1-${S(r)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Oe("stop",{"stop-color":`var(${S(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,cG),Oe("stop",{"stop-color":`var(${S(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,uG)],8,lG),Oe("linearGradient",{id:`linearGradient-2-${S(r)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Oe("stop",{"stop-color":`var(${S(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,hG),Oe("stop",{"stop-color":`var(${S(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,fG)],8,dG),Oe("rect",{id:`path-3-${S(r)}`,x:"0",y:"0",width:"17",height:"36"},null,8,pG)]),Oe("g",gG,[Oe("g",mG,[Oe("g",vG,[Oe("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${S(t).cssVarBlockName("fill-color-3")})`},null,8,CG),Oe("polygon",{id:"Rectangle-Copy-14",fill:`var(${S(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,wG),Oe("g",SG,[Oe("polygon",{id:"Rectangle-Copy-10",fill:`var(${S(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,yG),Oe("polygon",{id:"Rectangle-Copy-11",fill:`var(${S(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,xG),Oe("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${S(r)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,bG),Oe("polygon",{id:"Rectangle-Copy-13",fill:`var(${S(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,RG)]),Oe("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${S(r)})`,x:"13",y:"45",width:"40",height:"36"},null,8,EG),Oe("g",FG,[Oe("use",{id:"Mask",fill:`var(${S(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${S(r)}`},null,8,TG),Oe("polygon",{id:"Rectangle-Copy",fill:`var(${S(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${S(r)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,AG)]),Oe("polygon",{id:"Rectangle-Copy-18",fill:`var(${S(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,PG)])])])]))}});var kG=bt(MG,[["__file","img-empty.vue"]]);const _G=it({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),IG=["src"],OG={key:1},LG=_e({name:"ElEmpty"}),NG=_e({...LG,props:_G,setup(e){const t=e,{t:r}=Oc(),i=at("empty"),s=Q(()=>t.description||r("el.table.emptyText")),n=Q(()=>({width:Ss(t.imageSize)}));return(o,a)=>(ue(),Ie("div",{class:Ae(S(i).b())},[Oe("div",{class:Ae(S(i).e("image")),style:kt(S(n))},[o.image?(ue(),Ie("img",{key:0,src:o.image,ondragstart:"return false"},null,8,IG)):Xe(o.$slots,"image",{key:1},()=>[ye(kG)])],6),Oe("div",{class:Ae(S(i).e("description"))},[o.$slots.description?Xe(o.$slots,"description",{key:0}):(ue(),Ie("p",OG,Ut(S(s)),1))],2),o.$slots.default?(ue(),Ie("div",{key:0,class:Ae(S(i).e("bottom"))},[Xe(o.$slots,"default")],2)):We("v-if",!0)],2))}});var BG=bt(NG,[["__file","empty.vue"]]);const GG=gr(BG),HG=it({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Bc,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||dt(e)||["min","max"].includes(e),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0}}),VG={[dh]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Vu]:e=>dt(e)||Pi(e),[ur]:e=>dt(e)||Pi(e)},WG=["aria-label","onKeydown"],zG=["aria-label","onKeydown"],$G=_e({name:"ElInputNumber"}),UG=_e({...$G,props:HG,emits:VG,setup(e,{expose:t,emit:r}){const i=e,{t:s}=Oc(),n=at("input-number"),o=we(),a=Br({currentValue:i.modelValue,userInput:null}),{formItem:l}=gh(),c=Q(()=>dt(i.modelValue)&&i.modelValue<=i.min),u=Q(()=>dt(i.modelValue)&&i.modelValue>=i.max),d=Q(()=>{const B=v(i.step);return Hs(i.precision)?Math.max(v(i.modelValue),B):(B>i.precision,i.precision)}),h=Q(()=>i.controls&&i.controlsPosition==="right"),p=Bo(),g=Wn(),f=Q(()=>{if(a.userInput!==null)return a.userInput;let B=a.currentValue;if(Pi(B))return"";if(dt(B)){if(Number.isNaN(B))return"";Hs(i.precision)||(B=B.toFixed(i.precision))}return B}),m=(B,H)=>{if(Hs(H)&&(H=d.value),H===0)return Math.round(B);let _=String(B);const se=_.indexOf(".");if(se===-1||!_.replace(".","").split("")[se+H])return B;const Re=_.length;return _.charAt(Re-1)==="5"&&(_=`${_.slice(0,Math.max(0,Re-1))}6`),Number.parseFloat(Number(_).toFixed(H))},v=B=>{if(Pi(B))return 0;const H=B.toString(),_=H.indexOf(".");let se=0;return _!==-1&&(se=H.length-_-1),se},w=(B,H=1)=>dt(B)?m(B+i.step*H):a.currentValue,C=()=>{if(i.readonly||g.value||u.value)return;const B=Number(f.value)||0,H=w(B);R(H),r(Vu,a.currentValue),U()},F=()=>{if(i.readonly||g.value||c.value)return;const B=Number(f.value)||0,H=w(B,-1);R(H),r(Vu,a.currentValue),U()},D=(B,H)=>{const{max:_,min:se,step:G,precision:he,stepStrictly:Re,valueOnClear:M}=i;_<se&&sn("InputNumber","min should not be greater than max.");let X=Number(B);if(Pi(B)||Number.isNaN(X))return null;if(B===""){if(M===null)return null;X=ct(M)?{min:se,max:_}[M]:M}return Re&&(X=m(Math.round(X/G)*G,he)),Hs(he)||(X=m(X,he)),(X>_||X<se)&&(X=X>_?_:se,H&&r(ur,X)),X},R=(B,H=!0)=>{var _;const se=a.currentValue,G=D(B);if(!H){r(ur,G);return}se===G&&B||(a.userInput=null,r(ur,G),se!==G&&r(dh,G,se),i.validateEvent&&((_=l==null?void 0:l.validate)==null||_.call(l,"change").catch(he=>void 0)),a.currentValue=G)},y=B=>{a.userInput=B;const H=B===""?null:Number(B);r(Vu,H),R(H,!1)},b=B=>{const H=B!==""?Number(B):"";(dt(H)&&!Number.isNaN(H)||B==="")&&R(H),U(),a.userInput=null},x=()=>{var B,H;(H=(B=o.value)==null?void 0:B.focus)==null||H.call(B)},T=()=>{var B,H;(H=(B=o.value)==null?void 0:B.blur)==null||H.call(B)},A=B=>{r("focus",B)},P=B=>{var H;a.userInput=null,r("blur",B),i.validateEvent&&((H=l==null?void 0:l.validate)==null||H.call(l,"blur").catch(_=>void 0))},U=()=>{a.currentValue!==i.modelValue&&(a.currentValue=i.modelValue)},J=B=>{document.activeElement===B.target&&B.preventDefault()};return Qe(()=>i.modelValue,(B,H)=>{const _=D(B,!0);a.userInput===null&&_!==H&&(a.currentValue=_)},{immediate:!0}),Gt(()=>{var B;const{min:H,max:_,modelValue:se}=i,G=(B=o.value)==null?void 0:B.input;if(G.setAttribute("role","spinbutton"),Number.isFinite(_)?G.setAttribute("aria-valuemax",String(_)):G.removeAttribute("aria-valuemax"),Number.isFinite(H)?G.setAttribute("aria-valuemin",String(H)):G.removeAttribute("aria-valuemin"),G.setAttribute("aria-valuenow",a.currentValue||a.currentValue===0?String(a.currentValue):""),G.setAttribute("aria-disabled",String(g.value)),!dt(se)&&se!=null){let he=Number(se);Number.isNaN(he)&&(he=null),r(ur,he)}}),Va(()=>{var B,H;const _=(B=o.value)==null?void 0:B.input;_==null||_.setAttribute("aria-valuenow",`${(H=a.currentValue)!=null?H:""}`)}),t({focus:x,blur:T}),(B,H)=>(ue(),Ie("div",{class:Ae([S(n).b(),S(n).m(S(p)),S(n).is("disabled",S(g)),S(n).is("without-controls",!B.controls),S(n).is("controls-right",S(h))]),onDragstart:H[0]||(H[0]=zt(()=>{},["prevent"]))},[B.controls?Yr((ue(),Ie("span",{key:0,role:"button","aria-label":S(s)("el.inputNumber.decrease"),class:Ae([S(n).e("decrease"),S(n).is("disabled",S(c))]),onKeydown:$i(F,["enter"])},[ye(S(It),null,{default:ze(()=>[S(h)?(ue(),Je(S(eb),{key:0})):(ue(),Je(S(tO),{key:1}))]),_:1})],42,WG)),[[S(KC),F]]):We("v-if",!0),B.controls?Yr((ue(),Ie("span",{key:1,role:"button","aria-label":S(s)("el.inputNumber.increase"),class:Ae([S(n).e("increase"),S(n).is("disabled",S(u))]),onKeydown:$i(C,["enter"])},[ye(S(It),null,{default:ze(()=>[S(h)?(ue(),Je(S(H2),{key:0})):(ue(),Je(S(ob),{key:1}))]),_:1})],42,zG)),[[S(KC),C]]):We("v-if",!0),ye(S(s0),{id:B.id,ref_key:"input",ref:o,type:"number",step:B.step,"model-value":S(f),placeholder:B.placeholder,readonly:B.readonly,disabled:S(g),size:S(p),max:B.max,min:B.min,name:B.name,label:B.label,"validate-event":!1,onWheel:J,onKeydown:[$i(zt(C,["prevent"]),["up"]),$i(zt(F,["prevent"]),["down"])],onBlur:P,onFocus:A,onInput:y,onChange:b},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var KG=bt(UG,[["__file","input-number.vue"]]);const jG=gr(KG),t1=Symbol("ElSelectGroup"),vh=Symbol("ElSelect");function qG(e,t){const r=rt(vh),i=rt(t1,{disabled:!1}),s=Q(()=>r.props.multiple?u(r.props.modelValue,e.value):u([r.props.modelValue],e.value)),n=Q(()=>{if(r.props.multiple){const p=r.props.modelValue||[];return!s.value&&p.length>=r.props.multipleLimit&&r.props.multipleLimit>0}else return!1}),o=Q(()=>e.label||(ot(e.value)?"":e.value)),a=Q(()=>e.value||e.label||""),l=Q(()=>e.disabled||t.groupDisabled||n.value),c=Bt(),u=(p=[],g)=>{if(ot(e.value)){const f=r.props.valueKey;return p&&p.some(m=>gt(Ui(m,f))===Ui(g,f))}else return p&&p.includes(g)},d=()=>{!e.disabled&&!i.disabled&&(r.states.hoveringIndex=r.optionsArray.indexOf(c.proxy))},h=p=>{const g=new RegExp(D2(p),"i");t.visible=g.test(o.value)||e.created};return Qe(()=>o.value,()=>{!e.created&&!r.props.remote&&r.setSelected()}),Qe(()=>e.value,(p,g)=>{const{remote:f,valueKey:m}=r.props;if(ac(p,g)||(r.onOptionDestroy(g,c.proxy),r.onOptionCreate(c.proxy)),!e.created&&!f){if(m&&ot(p)&&ot(g)&&p[m]===g[m])return;r.setSelected()}}),Qe(()=>i.disabled,()=>{t.groupDisabled=i.disabled},{immediate:!0}),{select:r,currentLabel:o,currentValue:a,itemSelected:s,isDisabled:l,hoverItem:d,updateOption:h}}const YG=_e({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=at("select"),r=$a(),i=Q(()=>[t.be("dropdown","item"),t.is("disabled",S(a)),t.is("selected",S(o)),t.is("hovering",S(h))]),s=Br({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:n,itemSelected:o,isDisabled:a,select:l,hoverItem:c,updateOption:u}=qG(e,s),{visible:d,hover:h}=Pc(s),p=Bt().proxy;l.onOptionCreate(p),Er(()=>{const f=p.value,{selected:m}=l.states,w=(l.props.multiple?m:[m]).some(C=>C.value===p.value);Tt(()=>{l.states.cachedOptions.get(f)===p&&!w&&l.states.cachedOptions.delete(f)}),l.onOptionDestroy(f,p)});function g(){e.disabled!==!0&&s.groupDisabled!==!0&&l.handleOptionSelect(p)}return{ns:t,id:r,containerKls:i,currentLabel:n,itemSelected:o,isDisabled:a,select:l,hoverItem:c,updateOption:u,visible:d,hover:h,selectOptionClick:g,states:s}}}),XG=["id","aria-disabled","aria-selected"];function QG(e,t,r,i,s,n){return Yr((ue(),Ie("li",{id:e.id,class:Ae(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMouseenter:t[0]||(t[0]=(...o)=>e.hoverItem&&e.hoverItem(...o)),onClick:t[1]||(t[1]=zt((...o)=>e.selectOptionClick&&e.selectOptionClick(...o),["stop"]))},[Xe(e.$slots,"default",{},()=>[Oe("span",null,Ut(e.currentLabel),1)])],42,XG)),[[en,e.visible]])}var d0=bt(YG,[["render",QG],["__file","option.vue"]]);const JG=_e({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=rt(vh),t=at("select"),r=Q(()=>e.props.popperClass),i=Q(()=>e.props.multiple),s=Q(()=>e.props.fitInputWidth),n=we("");function o(){var a;n.value=`${(a=e.selectRef)==null?void 0:a.offsetWidth}px`}return Gt(()=>{o(),ri(e.selectRef,o)}),{ns:t,minWidth:n,popperClass:r,isMultiple:i,isFitInputWidth:s}}});function ZG(e,t,r,i,s,n){return ue(),Ie("div",{class:Ae([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:kt({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(ue(),Ie("div",{key:0,class:Ae(e.ns.be("dropdown","header"))},[Xe(e.$slots,"header")],2)):We("v-if",!0),Xe(e.$slots,"default"),e.$slots.footer?(ue(),Ie("div",{key:1,class:Ae(e.ns.be("dropdown","footer"))},[Xe(e.$slots,"footer")],2)):We("v-if",!0)],6)}var e3=bt(JG,[["render",ZG],["__file","select-dropdown.vue"]]);function t3(e){const t=we(!1);return{handleCompositionStart:()=>{t.value=!0},handleCompositionUpdate:n=>{const o=n.target.value,a=o[o.length-1]||"";t.value=!ub(a)},handleCompositionEnd:n=>{t.value&&(t.value=!1,Ye(e)&&e(n))}}}const r3=11,i3=(e,t)=>{const{t:r}=Oc(),i=$a(),s=at("select"),n=at("input"),o=Br({inputValue:"",options:new Map,cachedOptions:new Map,disabledOptions:new Map,optionValues:[],selected:e.multiple?[]:{},selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),a=we(null),l=we(null),c=we(null),u=we(null),d=we(null),h=we(null),p=we(null),g=we(null),f=we(null),m=we(null),v=we(null),w=we(null),{wrapperRef:C,isFocused:F,handleFocus:D,handleBlur:R}=_b(d,{afterFocus(){e.automaticDropdown&&!y.value&&(y.value=!0,o.menuVisibleOnFocus=!0)},beforeBlur(E){var k,O;return((k=c.value)==null?void 0:k.isFocusInsideContent(E))||((O=u.value)==null?void 0:O.isFocusInsideContent(E))},afterBlur(){y.value=!1,o.menuVisibleOnFocus=!1}}),y=we(!1),b=we(),{form:x,formItem:T}=gh(),{inputId:A}=Nb(e,{formItemContext:T}),P=Q(()=>e.disabled||(x==null?void 0:x.disabled)),U=Q(()=>X.value.some(E=>E.value==="")),J=Q(()=>e.multiple?Ue(e.modelValue)&&e.modelValue.length>0:!Pi(e.modelValue)&&(e.modelValue!==""||U.value)),B=Q(()=>e.clearable&&!P.value&&o.inputHovering&&J.value),H=Q(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),_=Q(()=>s.is("reverse",H.value&&y.value)),se=Q(()=>(T==null?void 0:T.validateState)||""),G=Q(()=>cb[se.value]),he=Q(()=>e.remote?300:0),Re=Q(()=>e.loading?e.loadingText||r("el.select.loading"):e.remote&&!o.inputValue&&o.options.size===0?!1:e.filterable&&o.inputValue&&o.options.size>0&&M.value===0?e.noMatchText||r("el.select.noMatch"):o.options.size===0?e.noDataText||r("el.select.noData"):null),M=Q(()=>X.value.filter(E=>E.visible).length),X=Q(()=>{const E=Array.from(o.options.values()),k=[];return o.optionValues.forEach(O=>{const N=E.findIndex(K=>K.value===O);N>-1&&k.push(E[N])}),k.length>=E.length?k:E}),z=Q(()=>Array.from(o.cachedOptions.values())),Y=Q(()=>{const E=X.value.filter(k=>!k.created).some(k=>k.currentLabel===o.inputValue);return e.filterable&&e.allowCreate&&o.inputValue!==""&&!E}),ae=()=>{e.filterable&&Ye(e.filterMethod)||e.filterable&&e.remote&&Ye(e.remoteMethod)||X.value.forEach(E=>{E.updateOption(o.inputValue)})},W=Bo(),re=Q(()=>["small"].includes(W.value)?"small":"default"),Z=Q({get(){return y.value&&Re.value!==!1},set(E){y.value=E}}),ee=Q(()=>Ue(e.modelValue)?e.modelValue.length===0&&!o.inputValue:e.filterable?!o.inputValue:!0),Fe=Q(()=>{var E;const k=(E=e.placeholder)!=null?E:r("el.select.placeholder");return e.multiple||!J.value?k:o.selectedLabel});Qe(()=>e.modelValue,(E,k)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(o.inputValue="",L("")),V(),!ac(E,k)&&e.validateEvent&&(T==null||T.validate("change").catch(O=>void 0))},{flush:"post",deep:!0}),Qe(()=>y.value,E=>{E?L(o.inputValue):(o.inputValue="",o.previousQuery=null,o.isBeforeHide=!0),t("visible-change",E)}),Qe(()=>o.options.entries(),()=>{var E;if(!Nt)return;const k=((E=a.value)==null?void 0:E.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!Hs(e.modelValue)||!Array.from(k).includes(document.activeElement))&&V(),e.defaultFirstOption&&(e.filterable||e.remote)&&M.value&&I()},{flush:"post"}),Qe(()=>o.hoveringIndex,E=>{dt(E)&&E>-1?b.value=X.value[E]||{}:b.value={},X.value.forEach(k=>{k.hover=b.value===k})}),Wy(()=>{o.isBeforeHide||ae()});const L=E=>{o.previousQuery!==E&&(o.previousQuery=E,e.filterable&&Ye(e.filterMethod)?e.filterMethod(E):e.filterable&&e.remote&&Ye(e.remoteMethod)&&e.remoteMethod(E),e.defaultFirstOption&&(e.filterable||e.remote)&&M.value?Tt(I):Tt(ne))},I=()=>{const E=X.value.filter(N=>N.visible&&!N.disabled&&!N.states.groupDisabled),k=E.find(N=>N.created),O=E[0];o.hoveringIndex=et(X.value,k||O)},V=()=>{if(e.multiple)o.selectedLabel="";else{const k=ie(e.modelValue);o.selectedLabel=k.currentLabel,o.selected=k;return}const E=[];Ue(e.modelValue)&&e.modelValue.forEach(k=>{E.push(ie(k))}),o.selected=E},ie=E=>{let k;const O=Lu(E).toLowerCase()==="object",N=Lu(E).toLowerCase()==="null",K=Lu(E).toLowerCase()==="undefined";for(let Ee=o.cachedOptions.size-1;Ee>=0;Ee--){const ce=z.value[Ee];if(O?Ui(ce.value,e.valueKey)===Ui(E,e.valueKey):ce.value===E){k={value:E,currentLabel:ce.currentLabel,isDisabled:ce.isDisabled};break}}if(k)return k;const q=O?E.label:!N&&!K?E:"";return{value:E,currentLabel:q}},ne=()=>{e.multiple?o.hoveringIndex=X.value.findIndex(E=>o.selected.some(k=>Kn(k)===Kn(E))):o.hoveringIndex=X.value.findIndex(E=>Kn(E)===Kn(o.selected))},j=()=>{o.selectionWidth=l.value.getBoundingClientRect().width},oe=()=>{o.calculatorWidth=h.value.getBoundingClientRect().width},pe=()=>{o.collapseItemWidth=v.value.getBoundingClientRect().width},fe=()=>{var E,k;(k=(E=c.value)==null?void 0:E.updatePopper)==null||k.call(E)},Ce=()=>{var E,k;(k=(E=u.value)==null?void 0:E.updatePopper)==null||k.call(E)},le=()=>{o.inputValue.length>0&&!y.value&&(y.value=!0),L(o.inputValue)},be=E=>{if(o.inputValue=E.target.value,e.remote)De();else return le()},De=Xx(()=>{le()},he.value),te=E=>{ac(e.modelValue,E)||t(dh,E)},Pe=E=>E2(E,k=>!o.disabledOptions.has(k)),Ne=E=>{if(e.multiple&&E.code!==ys.delete&&E.target.value.length<=0){const k=e.modelValue.slice(),O=Pe(k);if(O<0)return;k.splice(O,1),t(ur,k),te(k)}},Ve=(E,k)=>{const O=o.selected.indexOf(k);if(O>-1&&!P.value){const N=e.modelValue.slice();N.splice(O,1),t(ur,N),te(N),t("remove-tag",k.value)}E.stopPropagation(),Cr()},qe=E=>{E.stopPropagation();const k=e.multiple?[]:void 0;if(e.multiple)for(const O of o.selected)O.isDisabled&&k.push(O.value);t(ur,k),te(k),o.hoveringIndex=-1,y.value=!1,t("clear"),Cr()},$e=E=>{if(e.multiple){const k=(e.modelValue||[]).slice(),O=et(k,E.value);O>-1?k.splice(O,1):(e.multipleLimit<=0||k.length<e.multipleLimit)&&k.push(E.value),t(ur,k),te(k),E.created&&L(""),e.filterable&&!e.reserveKeyword&&(o.inputValue="")}else t(ur,E.value),te(E.value),y.value=!1;Cr(),!y.value&&Tt(()=>{ht(E)})},et=(E=[],k)=>{if(!ot(k))return E.indexOf(k);const O=e.valueKey;let N=-1;return E.some((K,q)=>gt(Ui(K,O))===Ui(k,O)?(N=q,!0):!1),N},ht=E=>{var k,O,N,K,q;const de=Ue(E)?E[0]:E;let Ee=null;if(de!=null&&de.value){const ce=X.value.filter(ge=>ge.value===de.value);ce.length>0&&(Ee=ce[0].$el)}if(c.value&&Ee){const ce=(K=(N=(O=(k=c.value)==null?void 0:k.popperRef)==null?void 0:O.contentRef)==null?void 0:N.querySelector)==null?void 0:K.call(N,`.${s.be("dropdown","wrap")}`);ce&&I2(ce,Ee)}(q=w.value)==null||q.handleScroll()},Rt=E=>{o.options.set(E.value,E),o.cachedOptions.set(E.value,E),E.disabled&&o.disabledOptions.set(E.value,E)},At=(E,k)=>{o.options.get(E)===k&&o.options.delete(E)},{handleCompositionStart:mr,handleCompositionUpdate:Kt,handleCompositionEnd:vr}=t3(E=>be(E)),Ps=Q(()=>{var E,k;return(k=(E=c.value)==null?void 0:E.popperRef)==null?void 0:k.contentRef}),Un=()=>{Tt(()=>ht(o.selected))},Cr=()=>{var E;(E=d.value)==null||E.focus()},Za=()=>{Ni()},el=E=>{qe(E)},Ni=E=>{if(y.value=!1,F.value){const k=new FocusEvent("focus",E);Tt(()=>R(k))}},Hr=()=>{o.inputValue.length>0?o.inputValue="":y.value=!1},Si=()=>{P.value||(o.menuVisibleOnFocus?o.menuVisibleOnFocus=!1:y.value=!y.value)},Dh=()=>{y.value?X.value[o.hoveringIndex]&&$e(X.value[o.hoveringIndex]):Si()},Kn=E=>ot(E.value)?Ui(E.value,e.valueKey):E.value,Mh=Q(()=>X.value.filter(E=>E.visible).every(E=>E.disabled)),kh=Q(()=>e.multiple?e.collapseTags?o.selected.slice(0,e.maxCollapseTags):o.selected:[]),_h=Q(()=>e.multiple?e.collapseTags?o.selected.slice(e.maxCollapseTags):[]:[]),Xc=E=>{if(!y.value){y.value=!0;return}if(!(o.options.size===0||M.value===0)&&!Mh.value){E==="next"?(o.hoveringIndex++,o.hoveringIndex===o.options.size&&(o.hoveringIndex=0)):E==="prev"&&(o.hoveringIndex--,o.hoveringIndex<0&&(o.hoveringIndex=o.options.size-1));const k=X.value[o.hoveringIndex];(k.disabled===!0||k.states.groupDisabled===!0||!k.visible)&&Xc(E),Tt(()=>ht(b.value))}},tl=()=>{if(!l.value)return 0;const E=window.getComputedStyle(l.value);return Number.parseFloat(E.gap||"6px")},Ih=Q(()=>{const E=tl();return{maxWidth:`${v.value&&e.maxCollapseTags===1?o.selectionWidth-o.collapseItemWidth-E:o.selectionWidth}px`}}),Oh=Q(()=>({maxWidth:`${o.selectionWidth}px`})),Lh=Q(()=>({width:`${Math.max(o.calculatorWidth,r3)}px`}));return e.multiple&&!Ue(e.modelValue)&&t(ur,[]),!e.multiple&&Ue(e.modelValue)&&t(ur,""),ri(l,j),ri(h,oe),ri(f,fe),ri(C,fe),ri(m,Ce),ri(v,pe),Gt(()=>{V()}),{inputId:A,contentId:i,nsSelect:s,nsInput:n,states:o,isFocused:F,expanded:y,optionsArray:X,hoverOption:b,selectSize:W,filteredOptionsCount:M,resetCalculatorWidth:oe,updateTooltip:fe,updateTagTooltip:Ce,debouncedOnInputChange:De,onInput:be,deletePrevTag:Ne,deleteTag:Ve,deleteSelected:qe,handleOptionSelect:$e,scrollToOption:ht,hasModelValue:J,shouldShowPlaceholder:ee,currentPlaceholder:Fe,showClose:B,iconComponent:H,iconReverse:_,validateState:se,validateIcon:G,showNewOption:Y,updateOptions:ae,collapseTagSize:re,setSelected:V,selectDisabled:P,emptyText:Re,handleCompositionStart:mr,handleCompositionUpdate:Kt,handleCompositionEnd:vr,onOptionCreate:Rt,onOptionDestroy:At,handleMenuEnter:Un,handleFocus:D,focus:Cr,blur:Za,handleBlur:R,handleClearClick:el,handleClickOutside:Ni,handleEsc:Hr,toggleMenu:Si,selectOption:Dh,getValueKey:Kn,navigateOptions:Xc,dropdownMenuVisible:Z,showTagList:kh,collapseTagList:_h,tagStyle:Ih,collapseTagStyle:Oh,inputStyle:Lh,popperRef:Ps,inputRef:d,tooltipRef:c,tagTooltipRef:u,calculatorRef:h,prefixRef:p,suffixRef:g,selectRef:a,wrapperRef:C,selectionRef:l,scrollbarRef:w,menuRef:f,tagMenuRef:m,collapseItemRef:v}};var s3=_e({name:"ElOptions",setup(e,{slots:t}){const r=rt(vh);let i=[];return()=>{var s,n;const o=(s=t.default)==null?void 0:s.call(t),a=[];function l(c){Ue(c)&&c.forEach(u=>{var d,h,p,g;const f=(d=(u==null?void 0:u.type)||{})==null?void 0:d.name;f==="ElOptionGroup"?l(!ct(u.children)&&!Ue(u.children)&&Ye((h=u.children)==null?void 0:h.default)?(p=u.children)==null?void 0:p.default():u.children):f==="ElOption"?a.push((g=u.props)==null?void 0:g.value):Ue(u.children)&&l(u.children)})}return o.length&&l((n=o[0])==null?void 0:n.children),ac(a,i)||(i=a,r&&(r.states.optionValues=a)),o}}});const n3=it({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Bc,effect:{type:Me(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Me(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:u0.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ao,default:uh},fitInputWidth:Boolean,suffixIcon:{type:Ao,default:eb},tagType:{...e1.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,placement:{type:Me(String),values:fh,default:"bottom-start"},fallbackPlacements:{type:Me(Array),default:["bottom-start","top-start","right","left"]},ariaLabel:{type:String,default:void 0}}),jC="ElSelect",o3=_e({name:jC,componentName:jC,components:{ElInput:s0,ElSelectMenu:e3,ElOption:d0,ElOptions:s3,ElTag:oG,ElScrollbar:gB,ElTooltip:w4,ElIcon:It},directives:{ClickOutside:Z4},props:n3,emits:[ur,dh,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const r=i3(e,t);return rr(vh,Br({props:e,states:r.states,optionsArray:r.optionsArray,handleOptionSelect:r.handleOptionSelect,onOptionCreate:r.onOptionCreate,onOptionDestroy:r.onOptionDestroy,selectRef:r.selectRef,setSelected:r.setSelected})),{...r}}}),a3=["id","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label"],l3=["textContent"];function c3(e,t,r,i,s,n){const o=qn("el-tag"),a=qn("el-tooltip"),l=qn("el-icon"),c=qn("el-option"),u=qn("el-options"),d=qn("el-scrollbar"),h=qn("el-select-menu"),p=xA("click-outside");return Yr((ue(),Ie("div",{ref:"selectRef",class:Ae([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:t[16]||(t[16]=g=>e.states.inputHovering=!0),onMouseleave:t[17]||(t[17]=g=>e.states.inputHovering=!1),onClick:t[18]||(t[18]=zt((...g)=>e.toggleMenu&&e.toggleMenu(...g),["prevent","stop"]))},[ye(a,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[15]||(t[15]=g=>e.states.isBeforeHide=!1)},{default:ze(()=>{var g;return[Oe("div",{ref:"wrapperRef",class:Ae([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(ue(),Ie("div",{key:0,ref:"prefixRef",class:Ae(e.nsSelect.e("prefix"))},[Xe(e.$slots,"prefix")],2)):We("v-if",!0),Oe("div",{ref:"selectionRef",class:Ae([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?Xe(e.$slots,"tag",{key:0},()=>[(ue(!0),Ie(Dt,null,ao(e.showTagList,f=>(ue(),Ie("div",{key:e.getValueKey(f),class:Ae(e.nsSelect.e("selected-item"))},[ye(o,{closable:!e.selectDisabled&&!f.isDisabled,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",style:kt(e.tagStyle),onClose:m=>e.deleteTag(m,f)},{default:ze(()=>[Oe("span",{class:Ae(e.nsSelect.e("tags-text"))},Ut(f.currentLabel),3)]),_:2},1032,["closable","size","type","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(ue(),Je(a,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:ze(()=>[Oe("div",{ref:"collapseItemRef",class:Ae(e.nsSelect.e("selected-item"))},[ye(o,{closable:!1,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",style:kt(e.collapseTagStyle)},{default:ze(()=>[Oe("span",{class:Ae(e.nsSelect.e("tags-text"))}," + "+Ut(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","style"])],2)]),content:ze(()=>[Oe("div",{ref:"tagMenuRef",class:Ae(e.nsSelect.e("selection"))},[(ue(!0),Ie(Dt,null,ao(e.collapseTagList,f=>(ue(),Ie("div",{key:e.getValueKey(f),class:Ae(e.nsSelect.e("selected-item"))},[ye(o,{class:"in-tooltip",closable:!e.selectDisabled&&!f.isDisabled,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",onClose:m=>e.deleteTag(m,f)},{default:ze(()=>[Oe("span",{class:Ae(e.nsSelect.e("tags-text"))},Ut(f.currentLabel),3)]),_:2},1032,["closable","size","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):We("v-if",!0)]):We("v-if",!0),e.selectDisabled?We("v-if",!0):(ue(),Ie("div",{key:1,class:Ae([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[Yr(Oe("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":t[0]||(t[0]=f=>e.states.inputValue=f),type:"text",class:Ae([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:kt(e.inputStyle),role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((g=e.hoverOption)==null?void 0:g.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:t[1]||(t[1]=(...f)=>e.handleFocus&&e.handleFocus(...f)),onBlur:t[2]||(t[2]=(...f)=>e.handleBlur&&e.handleBlur(...f)),onKeydown:[t[3]||(t[3]=$i(zt(f=>e.navigateOptions("next"),["stop","prevent"]),["down"])),t[4]||(t[4]=$i(zt(f=>e.navigateOptions("prev"),["stop","prevent"]),["up"])),t[5]||(t[5]=$i(zt((...f)=>e.handleEsc&&e.handleEsc(...f),["stop","prevent"]),["esc"])),t[6]||(t[6]=$i(zt((...f)=>e.selectOption&&e.selectOption(...f),["stop","prevent"]),["enter"])),t[7]||(t[7]=$i(zt((...f)=>e.deletePrevTag&&e.deletePrevTag(...f),["stop"]),["delete"]))],onCompositionstart:t[8]||(t[8]=(...f)=>e.handleCompositionStart&&e.handleCompositionStart(...f)),onCompositionupdate:t[9]||(t[9]=(...f)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...f)),onCompositionend:t[10]||(t[10]=(...f)=>e.handleCompositionEnd&&e.handleCompositionEnd(...f)),onInput:t[11]||(t[11]=(...f)=>e.onInput&&e.onInput(...f)),onClick:t[12]||(t[12]=zt((...f)=>e.toggleMenu&&e.toggleMenu(...f),["stop"]))},null,46,a3),[[KP,e.states.inputValue]]),e.filterable?(ue(),Ie("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:Ae(e.nsSelect.e("input-calculator")),textContent:Ut(e.states.inputValue)},null,10,l3)):We("v-if",!0)],2)),e.shouldShowPlaceholder?(ue(),Ie("div",{key:2,class:Ae([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[Oe("span",null,Ut(e.currentPlaceholder),1)],2)):We("v-if",!0)],2),Oe("div",{ref:"suffixRef",class:Ae(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(ue(),Je(l,{key:0,class:Ae([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:ze(()=>[(ue(),Je(kr(e.iconComponent)))]),_:1},8,["class"])):We("v-if",!0),e.showClose&&e.clearIcon?(ue(),Je(l,{key:1,class:Ae([e.nsSelect.e("caret"),e.nsSelect.e("icon")]),onClick:e.handleClearClick},{default:ze(()=>[(ue(),Je(kr(e.clearIcon)))]),_:1},8,["class","onClick"])):We("v-if",!0),e.validateState&&e.validateIcon?(ue(),Je(l,{key:2,class:Ae([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:ze(()=>[(ue(),Je(kr(e.validateIcon)))]),_:1},8,["class"])):We("v-if",!0)],2)],2)]}),content:ze(()=>[ye(h,{ref:"menuRef"},{default:ze(()=>[e.$slots.header?(ue(),Ie("div",{key:0,class:Ae(e.nsSelect.be("dropdown","header")),onClick:t[13]||(t[13]=zt(()=>{},["stop"]))},[Xe(e.$slots,"header")],2)):We("v-if",!0),Yr(ye(d,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:Ae([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:ze(()=>[e.showNewOption?(ue(),Je(c,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):We("v-if",!0),ye(u,null,{default:ze(()=>[Xe(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[en,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(ue(),Ie("div",{key:1,class:Ae(e.nsSelect.be("dropdown","loading"))},[Xe(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(ue(),Ie("div",{key:2,class:Ae(e.nsSelect.be("dropdown","empty"))},[Xe(e.$slots,"empty",{},()=>[Oe("span",null,Ut(e.emptyText),1)])],2)):We("v-if",!0),e.$slots.footer?(ue(),Ie("div",{key:3,class:Ae(e.nsSelect.be("dropdown","footer")),onClick:t[14]||(t[14]=zt(()=>{},["stop"]))},[Xe(e.$slots,"footer")],2)):We("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","onBeforeShow"])],34)),[[p,e.handleClickOutside,e.popperRef]])}var u3=bt(o3,[["render",c3],["__file","select.vue"]]);const d3=_e({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=at("select"),r=we(null),i=Bt(),s=we([]);rr(t1,Br({...Pc(e)}));const n=Q(()=>s.value.some(l=>l.visible===!0)),o=l=>{const c=[];return Ue(l.children)&&l.children.forEach(u=>{var d,h;u.type&&u.type.name==="ElOption"&&u.component&&u.component.proxy?c.push(u.component.proxy):(d=u.children)!=null&&d.length?c.push(...o(u)):(h=u.component)!=null&&h.subTree&&c.push(...o(u.component.subTree))}),c},a=()=>{s.value=o(i.subTree)};return Gt(()=>{a()}),TD(r,a,{attributes:!0,subtree:!0,childList:!0}),{groupRef:r,visible:n,ns:t}}});function h3(e,t,r,i,s,n){return Yr((ue(),Ie("ul",{ref:"groupRef",class:Ae(e.ns.be("group","wrap"))},[Oe("li",{class:Ae(e.ns.be("group","title"))},Ut(e.label),3),Oe("li",null,[Oe("ul",{class:Ae(e.ns.b("group"))},[Xe(e.$slots,"default")],2)])],2)),[[en,e.visible]])}var r1=bt(d3,[["render",h3],["__file","option-group.vue"]]);const f3=gr(u3,{Option:d0,OptionGroup:r1}),p3=Ic(d0);Ic(r1);const g3=it({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Me(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Me([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Me(Function),default:e=>`${e}%`}}),m3=["aria-valuenow"],v3={viewBox:"0 0 100 100"},C3=["d","stroke","stroke-linecap","stroke-width"],w3=["d","stroke","opacity","stroke-linecap","stroke-width"],S3={key:0},y3=_e({name:"ElProgress"}),x3=_e({...y3,props:g3,setup(e){const t=e,r={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},i=at("progress"),s=Q(()=>({width:`${t.percentage}%`,animationDuration:`${t.duration}s`,backgroundColor:w(t.percentage)})),n=Q(()=>(t.strokeWidth/t.width*100).toFixed(1)),o=Q(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(n.value)/2}`,10):0),a=Q(()=>{const C=o.value,F=t.type==="dashboard";return`
          M 50 50
          m 0 ${F?"":"-"}${C}
          a ${C} ${C} 0 1 1 0 ${F?"-":""}${C*2}
          a ${C} ${C} 0 1 1 0 ${F?"":"-"}${C*2}
          `}),l=Q(()=>2*Math.PI*o.value),c=Q(()=>t.type==="dashboard"?.75:1),u=Q(()=>`${-1*l.value*(1-c.value)/2}px`),d=Q(()=>({strokeDasharray:`${l.value*c.value}px, ${l.value}px`,strokeDashoffset:u.value})),h=Q(()=>({strokeDasharray:`${l.value*c.value*(t.percentage/100)}px, ${l.value}px`,strokeDashoffset:u.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),p=Q(()=>{let C;return t.color?C=w(t.percentage):C=r[t.status]||r.default,C}),g=Q(()=>t.status==="warning"?jg:t.type==="line"?t.status==="success"?Kg:uh:t.status==="success"?rb:Ea),f=Q(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),m=Q(()=>t.format(t.percentage));function v(C){const F=100/C.length;return C.map((R,y)=>ct(R)?{color:R,percentage:(y+1)*F}:R).sort((R,y)=>R.percentage-y.percentage)}const w=C=>{var F;const{color:D}=t;if(Ye(D))return D(C);if(ct(D))return D;{const R=v(D);for(const y of R)if(y.percentage>C)return y.color;return(F=R[R.length-1])==null?void 0:F.color}};return(C,F)=>(ue(),Ie("div",{class:Ae([S(i).b(),S(i).m(C.type),S(i).is(C.status),{[S(i).m("without-text")]:!C.showText,[S(i).m("text-inside")]:C.textInside}]),role:"progressbar","aria-valuenow":C.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[C.type==="line"?(ue(),Ie("div",{key:0,class:Ae(S(i).b("bar"))},[Oe("div",{class:Ae(S(i).be("bar","outer")),style:kt({height:`${C.strokeWidth}px`})},[Oe("div",{class:Ae([S(i).be("bar","inner"),{[S(i).bem("bar","inner","indeterminate")]:C.indeterminate},{[S(i).bem("bar","inner","striped")]:C.striped},{[S(i).bem("bar","inner","striped-flow")]:C.stripedFlow}]),style:kt(S(s))},[(C.showText||C.$slots.default)&&C.textInside?(ue(),Ie("div",{key:0,class:Ae(S(i).be("bar","innerText"))},[Xe(C.$slots,"default",{percentage:C.percentage},()=>[Oe("span",null,Ut(S(m)),1)])],2)):We("v-if",!0)],6)],6)],2)):(ue(),Ie("div",{key:1,class:Ae(S(i).b("circle")),style:kt({height:`${C.width}px`,width:`${C.width}px`})},[(ue(),Ie("svg",v3,[Oe("path",{class:Ae(S(i).be("circle","track")),d:S(a),stroke:`var(${S(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":C.strokeLinecap,"stroke-width":S(n),fill:"none",style:kt(S(d))},null,14,C3),Oe("path",{class:Ae(S(i).be("circle","path")),d:S(a),stroke:S(p),fill:"none",opacity:C.percentage?1:0,"stroke-linecap":C.strokeLinecap,"stroke-width":S(n),style:kt(S(h))},null,14,w3)]))],6)),(C.showText||C.$slots.default)&&!C.textInside?(ue(),Ie("div",{key:2,class:Ae(S(i).e("text")),style:kt({fontSize:`${S(f)}px`})},[Xe(C.$slots,"default",{percentage:C.percentage},()=>[C.status?(ue(),Je(S(It),{key:1},{default:ze(()=>[(ue(),Je(kr(S(g))))]),_:1})):(ue(),Ie("span",S3,Ut(S(m)),1))])],6)):We("v-if",!0)],10,m3))}});var b3=bt(x3,[["__file","progress.vue"]]);const R3=gr(b3);var qC=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function E3(e,t){return!!(e===t||qC(e)&&qC(t))}function F3(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!E3(e[r],t[r]))return!1;return!0}function T3(e,t){t===void 0&&(t=F3);var r=null;function i(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;var o=e.apply(this,s);return r={lastResult:o,lastArgs:s,lastThis:this},o}return i.clear=function(){r=null},i}const A3=()=>{const t=Bt().proxy.$props;return Q(()=>{const r=(i,s,n)=>({});return t.perfMode?ah(r):T3(r)})},YC=50,XC="itemRendered",QC="scroll",vl="forward",pp="backward",uo="auto",i1="smart",gp="start",la="center",mp="end",vp="horizontal",s1="vertical",n1="rtl",Cp="negative",o1="positive-ascending",a1="positive-descending",P3={[vp]:"left",[s1]:"top"},D3=20,wp=as({type:Me([Number,Function]),required:!0}),Sp=as({type:Number}),yp=as({type:Number,default:2}),M3=as({type:String,values:["ltr","rtl"],default:"ltr"}),xp=as({type:Number,default:0}),wd=as({type:Number,required:!0}),l1=as({type:String,values:["horizontal","vertical"],default:s1}),c1=it({className:{type:String,default:""},containerElement:{type:Me([String,Object]),default:"div"},data:{type:Me(Array),default:()=>qs([])},direction:M3,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:Me([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),k3=it({cache:yp,estimatedItemSize:Sp,layout:l1,initScrollOffset:xp,total:wd,itemSize:wp,...c1}),bp={type:Number,default:6},u1={type:Number,default:0},d1={type:Number,default:2},Co=it({columnCache:yp,columnWidth:wp,estimatedColumnWidth:Sp,estimatedRowHeight:Sp,initScrollLeft:xp,initScrollTop:xp,itemKey:{type:Me(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:yp,rowHeight:wp,totalColumn:wd,totalRow:wd,hScrollbarSize:bp,vScrollbarSize:bp,scrollbarStartGap:u1,scrollbarEndGap:d1,role:String,...c1}),h1=it({alwaysOn:Boolean,class:String,layout:l1,total:wd,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:bp,startGap:u1,endGap:d1,visible:Boolean}),gu=(e,t)=>e<t?vl:pp,JC=e=>e===n1;let Zo=null;function ZC(e=!1){if(Zo===null||e){const t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";const i=document.createElement("div"),s=i.style;return s.width="100px",s.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?Zo=a1:(t.scrollLeft=1,t.scrollLeft===0?Zo=Cp:Zo=o1),document.body.removeChild(t),Zo}return Zo}function _3({move:e,size:t,bar:r},i){const s={},n=`translate${r.axis}(${e}px)`;return s[r.size]=t,s.transform=n,s.msTransform=n,s.webkitTransform=n,i==="horizontal"?s.height="100%":s.width="100%",s}const ew=_e({name:"ElVirtualScrollBar",props:h1,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const r=Q(()=>e.startGap+e.endGap),i=at("virtual-scrollbar"),s=at("scrollbar"),n=we(),o=we();let a=null,l=null;const c=Br({isDragging:!1,traveled:0}),u=Q(()=>Hb[e.layout]),d=Q(()=>e.clientSize-S(r)),h=Q(()=>({position:"absolute",width:`${vp===e.layout?d.value:e.scrollbarSize}px`,height:`${vp===e.layout?e.scrollbarSize:d.value}px`,[P3[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),p=Q(()=>{const R=e.ratio,y=e.clientSize;if(R>=100)return Number.POSITIVE_INFINITY;if(R>=50)return R*y/100;const b=y/3;return Math.floor(Math.min(Math.max(R*y,D3),b))}),g=Q(()=>{if(!Number.isFinite(p.value))return{display:"none"};const R=`${p.value}px`;return _3({bar:u.value,size:R,move:c.traveled},e.layout)}),f=Q(()=>Math.floor(e.clientSize-p.value-S(r))),m=()=>{window.addEventListener("mousemove",F),window.addEventListener("mouseup",C);const R=S(o);R&&(l=document.onselectstart,document.onselectstart=()=>!1,R.addEventListener("touchmove",F),R.addEventListener("touchend",C))},v=()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",C),document.onselectstart=l,l=null;const R=S(o);R&&(R.removeEventListener("touchmove",F),R.removeEventListener("touchend",C))},w=R=>{R.stopImmediatePropagation(),!(R.ctrlKey||[1,2].includes(R.button))&&(c.isDragging=!0,c[u.value.axis]=R.currentTarget[u.value.offset]-(R[u.value.client]-R.currentTarget.getBoundingClientRect()[u.value.direction]),t("start-move"),m())},C=()=>{c.isDragging=!1,c[u.value.axis]=0,t("stop-move"),v()},F=R=>{const{isDragging:y}=c;if(!y||!o.value||!n.value)return;const b=c[u.value.axis];if(!b)return;Jx(a);const x=(n.value.getBoundingClientRect()[u.value.direction]-R[u.value.client])*-1,T=o.value[u.value.offset]-b,A=x-T;a=Qx(()=>{c.traveled=Math.max(e.startGap,Math.min(A,f.value)),t("scroll",A,f.value)})},D=R=>{const y=Math.abs(R.target.getBoundingClientRect()[u.value.direction]-R[u.value.client]),b=o.value[u.value.offset]/2,x=y-b;c.traveled=Math.max(0,Math.min(x,f.value)),t("scroll",x,f.value)};return Qe(()=>e.scrollFrom,R=>{c.isDragging||(c.traveled=Math.ceil(R*f.value))}),Er(()=>{v()}),()=>yr("div",{role:"presentation",ref:n,class:[i.b(),e.class,(e.alwaysOn||c.isDragging)&&"always-on"],style:h.value,onMousedown:zt(D,["stop","prevent"]),onTouchstartPrevent:w},yr("div",{ref:o,class:s.e("thumb"),style:g.value,onMousedown:w},[]))}}),I3=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:r,atYStartEdge:i},s)=>{let n=null,o=0,a=0;const l=(u,d)=>{const h=u<=0&&t.value||u>=0&&e.value,p=d<=0&&i.value||d>=0&&r.value;return h&&p};return{hasReachedEdge:l,onWheel:u=>{Jx(n);let d=u.deltaX,h=u.deltaY;Math.abs(d)>Math.abs(h)?h=0:d=0,u.shiftKey&&h!==0&&(d=h,h=0),!(l(o,a)&&l(o+d,a+h))&&(o+=d,a+=h,u.preventDefault(),n=Qx(()=>{s(o,a),o=0,a=0}))}}},f1=({name:e,clearCache:t,getColumnPosition:r,getColumnStartIndexForOffset:i,getColumnStopIndexForStartIndex:s,getEstimatedTotalHeight:n,getEstimatedTotalWidth:o,getColumnOffset:a,getRowOffset:l,getRowPosition:c,getRowStartIndexForOffset:u,getRowStopIndexForStartIndex:d,initCache:h,injectToInstance:p,validateProps:g})=>_e({name:e??"ElVirtualList",props:Co,emits:[XC,QC],setup(f,{emit:m,expose:v,slots:w}){const C=at("vl");g(f);const F=Bt(),D=we(h(f,F));p==null||p(F,D);const R=we(),y=we(),b=we(),x=we(null),T=we({isScrolling:!1,scrollLeft:dt(f.initScrollLeft)?f.initScrollLeft:0,scrollTop:dt(f.initScrollTop)?f.initScrollTop:0,updateRequested:!1,xAxisScrollDir:vl,yAxisScrollDir:vl}),A=A3(),P=Q(()=>Number.parseInt(`${f.height}`,10)),U=Q(()=>Number.parseInt(`${f.width}`,10)),J=Q(()=>{const{totalColumn:j,totalRow:oe,columnCache:pe}=f,{isScrolling:fe,xAxisScrollDir:Ce,scrollLeft:le}=S(T);if(j===0||oe===0)return[0,0,0,0];const be=i(f,le,S(D)),De=s(f,be,le,S(D)),te=!fe||Ce===pp?Math.max(1,pe):1,Pe=!fe||Ce===vl?Math.max(1,pe):1;return[Math.max(0,be-te),Math.max(0,Math.min(j-1,De+Pe)),be,De]}),B=Q(()=>{const{totalColumn:j,totalRow:oe,rowCache:pe}=f,{isScrolling:fe,yAxisScrollDir:Ce,scrollTop:le}=S(T);if(j===0||oe===0)return[0,0,0,0];const be=u(f,le,S(D)),De=d(f,be,le,S(D)),te=!fe||Ce===pp?Math.max(1,pe):1,Pe=!fe||Ce===vl?Math.max(1,pe):1;return[Math.max(0,be-te),Math.max(0,Math.min(oe-1,De+Pe)),be,De]}),H=Q(()=>n(f,S(D))),_=Q(()=>o(f,S(D))),se=Q(()=>{var j;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:f.direction,height:dt(f.height)?`${f.height}px`:f.height,width:dt(f.width)?`${f.width}px`:f.width},(j=f.style)!=null?j:{}]}),G=Q(()=>{const j=`${S(_)}px`;return{height:`${S(H)}px`,pointerEvents:S(T).isScrolling?"none":void 0,width:j}}),he=()=>{const{totalColumn:j,totalRow:oe}=f;if(j>0&&oe>0){const[De,te,Pe,Ne]=S(J),[Ve,qe,$e,et]=S(B);m(XC,{columnCacheStart:De,columnCacheEnd:te,rowCacheStart:Ve,rowCacheEnd:qe,columnVisibleStart:Pe,columnVisibleEnd:Ne,rowVisibleStart:$e,rowVisibleEnd:et})}const{scrollLeft:pe,scrollTop:fe,updateRequested:Ce,xAxisScrollDir:le,yAxisScrollDir:be}=S(T);m(QC,{xAxisScrollDir:le,scrollLeft:pe,yAxisScrollDir:be,scrollTop:fe,updateRequested:Ce})},Re=j=>{const{clientHeight:oe,clientWidth:pe,scrollHeight:fe,scrollLeft:Ce,scrollTop:le,scrollWidth:be}=j.currentTarget,De=S(T);if(De.scrollTop===le&&De.scrollLeft===Ce)return;let te=Ce;if(JC(f.direction))switch(ZC()){case Cp:te=-Ce;break;case a1:te=be-pe-Ce;break}T.value={...De,isScrolling:!0,scrollLeft:te,scrollTop:Math.max(0,Math.min(le,fe-oe)),updateRequested:!0,xAxisScrollDir:gu(De.scrollLeft,te),yAxisScrollDir:gu(De.scrollTop,le)},Tt(()=>re()),Z(),he()},M=(j,oe)=>{const pe=S(P),fe=(H.value-pe)/oe*j;Y({scrollTop:Math.min(H.value-pe,fe)})},X=(j,oe)=>{const pe=S(U),fe=(_.value-pe)/oe*j;Y({scrollLeft:Math.min(_.value-pe,fe)})},{onWheel:z}=I3({atXStartEdge:Q(()=>T.value.scrollLeft<=0),atXEndEdge:Q(()=>T.value.scrollLeft>=_.value-S(U)),atYStartEdge:Q(()=>T.value.scrollTop<=0),atYEndEdge:Q(()=>T.value.scrollTop>=H.value-S(P))},(j,oe)=>{var pe,fe,Ce,le;(fe=(pe=y.value)==null?void 0:pe.onMouseUp)==null||fe.call(pe),(le=(Ce=b.value)==null?void 0:Ce.onMouseUp)==null||le.call(Ce);const be=S(U),De=S(P);Y({scrollLeft:Math.min(T.value.scrollLeft+j,_.value-be),scrollTop:Math.min(T.value.scrollTop+oe,H.value-De)})}),Y=({scrollLeft:j=T.value.scrollLeft,scrollTop:oe=T.value.scrollTop})=>{j=Math.max(j,0),oe=Math.max(oe,0);const pe=S(T);oe===pe.scrollTop&&j===pe.scrollLeft||(T.value={...pe,xAxisScrollDir:gu(pe.scrollLeft,j),yAxisScrollDir:gu(pe.scrollTop,oe),scrollLeft:j,scrollTop:oe,updateRequested:!0},Tt(()=>re()),Z(),he())},ae=(j=0,oe=0,pe=uo)=>{const fe=S(T);oe=Math.max(0,Math.min(oe,f.totalColumn-1)),j=Math.max(0,Math.min(j,f.totalRow-1));const Ce=_2(C.namespace.value),le=S(D),be=n(f,le),De=o(f,le);Y({scrollLeft:a(f,oe,pe,fe.scrollLeft,le,De>f.width?Ce:0),scrollTop:l(f,j,pe,fe.scrollTop,le,be>f.height?Ce:0)})},W=(j,oe)=>{const{columnWidth:pe,direction:fe,rowHeight:Ce}=f,le=A.value(t&&pe,t&&Ce,t&&fe),be=`${j},${oe}`;if(mt(le,be))return le[be];{const[,De]=r(f,oe,S(D)),te=S(D),Pe=JC(fe),[Ne,Ve]=c(f,j,te),[qe]=r(f,oe,te);return le[be]={position:"absolute",left:Pe?void 0:`${De}px`,right:Pe?`${De}px`:void 0,top:`${Ve}px`,height:`${Ne}px`,width:`${qe}px`},le[be]}},re=()=>{T.value.isScrolling=!1,Tt(()=>{A.value(-1,null,null)})};Gt(()=>{if(!Nt)return;const{initScrollLeft:j,initScrollTop:oe}=f,pe=S(R);pe&&(dt(j)&&(pe.scrollLeft=j),dt(oe)&&(pe.scrollTop=oe)),he()});const Z=()=>{const{direction:j}=f,{scrollLeft:oe,scrollTop:pe,updateRequested:fe}=S(T),Ce=S(R);if(fe&&Ce){if(j===n1)switch(ZC()){case Cp:{Ce.scrollLeft=-oe;break}case o1:{Ce.scrollLeft=oe;break}default:{const{clientWidth:le,scrollWidth:be}=Ce;Ce.scrollLeft=be-le-oe;break}}else Ce.scrollLeft=Math.max(0,oe);Ce.scrollTop=Math.max(0,pe)}},{resetAfterColumnIndex:ee,resetAfterRowIndex:Fe,resetAfter:L}=F.proxy;v({windowRef:R,innerRef:x,getItemStyleCache:A,scrollTo:Y,scrollToItem:ae,states:T,resetAfterColumnIndex:ee,resetAfterRowIndex:Fe,resetAfter:L});const I=()=>{const{scrollbarAlwaysOn:j,scrollbarStartGap:oe,scrollbarEndGap:pe,totalColumn:fe,totalRow:Ce}=f,le=S(U),be=S(P),De=S(_),te=S(H),{scrollLeft:Pe,scrollTop:Ne}=S(T),Ve=yr(ew,{ref:y,alwaysOn:j,startGap:oe,endGap:pe,class:C.e("horizontal"),clientSize:le,layout:"horizontal",onScroll:X,ratio:le*100/De,scrollFrom:Pe/(De-le),total:Ce,visible:!0}),qe=yr(ew,{ref:b,alwaysOn:j,startGap:oe,endGap:pe,class:C.e("vertical"),clientSize:be,layout:"vertical",onScroll:M,ratio:be*100/te,scrollFrom:Ne/(te-be),total:fe,visible:!0});return{horizontalScrollbar:Ve,verticalScrollbar:qe}},V=()=>{var j;const[oe,pe]=S(J),[fe,Ce]=S(B),{data:le,totalColumn:be,totalRow:De,useIsScrolling:te,itemKey:Pe}=f,Ne=[];if(De>0&&be>0)for(let Ve=fe;Ve<=Ce;Ve++)for(let qe=oe;qe<=pe;qe++)Ne.push((j=w.default)==null?void 0:j.call(w,{columnIndex:qe,data:le,key:Pe({columnIndex:qe,data:le,rowIndex:Ve}),isScrolling:te?S(T).isScrolling:void 0,style:W(Ve,qe),rowIndex:Ve}));return Ne},ie=()=>{const j=kr(f.innerElement),oe=V();return[yr(j,{style:S(G),ref:x},ct(j)?oe:{default:()=>oe})]};return()=>{const j=kr(f.containerElement),{horizontalScrollbar:oe,verticalScrollbar:pe}=I(),fe=ie();return yr("div",{key:0,class:C.e("wrapper"),role:f.role},[yr(j,{class:f.className,style:S(se),onScroll:Re,onWheel:z,ref:R},ct(j)?fe:{default:()=>fe}),oe,pe])}}}),O3=f1({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:r},i,s,n,o,a)=>{r=Number(r);const l=Math.max(0,e*t-r),c=Math.min(l,i*t),u=Math.max(0,i*t-r+a+t);switch(s==="smart"&&(n>=u-r&&n<=c+r?s=uo:s=la),s){case gp:return c;case mp:return u;case la:{const d=Math.round(u+(c-u)/2);return d<Math.ceil(r/2)?0:d>l+Math.floor(r/2)?l:d}case uo:default:return n>=u&&n<=c?n:u>c||n<u?u:c}},getRowOffset:({rowHeight:e,height:t,totalRow:r},i,s,n,o,a)=>{t=Number(t);const l=Math.max(0,r*e-t),c=Math.min(l,i*e),u=Math.max(0,i*e-t+a+e);switch(s===i1&&(n>=u-t&&n<=c+t?s=uo:s=la),s){case gp:return c;case mp:return u;case la:{const d=Math.round(u+(c-u)/2);return d<Math.ceil(t/2)?0:d>l+Math.floor(t/2)?l:d}case uo:default:return n>=u&&n<=c?n:u>c||n<u?u:c}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:r},i,s)=>{const n=i*e,o=Math.ceil((r+s-n)/e);return Math.max(0,Math.min(t-1,i+o-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:r},i,s)=>{const n=i*e,o=Math.ceil((r+s-n)/e);return Math.max(0,Math.min(t-1,i+o-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),{max:Sd,min:p1,floor:g1}=Math,L3={column:"columnWidth",row:"rowHeight"},Rp={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Ns=(e,t,r,i)=>{const[s,n,o]=[r[i],e[L3[i]],r[Rp[i]]];if(t>o){let a=0;if(o>=0){const l=s[o];a=l.offset+l.size}for(let l=o+1;l<=t;l++){const c=n(l);s[l]={offset:a,size:c},a+=c}r[Rp[i]]=t}return s[t]},m1=(e,t,r,i,s,n)=>{for(;r<=i;){const o=r+g1((i-r)/2),a=Ns(e,o,t,n).offset;if(a===s)return o;a<s?r=o+1:i=o-1}return Sd(0,r-1)},N3=(e,t,r,i,s)=>{const n=s==="column"?e.totalColumn:e.totalRow;let o=1;for(;r<n&&Ns(e,r,t,s).offset<i;)r+=o,o*=2;return m1(e,t,g1(r/2),p1(r,n-1),i,s)},tw=(e,t,r,i)=>{const[s,n]=[t[i],t[Rp[i]]];return(n>0?s[n].offset:0)>=r?m1(e,t,0,n,r,i):N3(e,t,Sd(0,n),r,i)},v1=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:r,row:i})=>{let s=0;if(r>=e&&(r=e-1),r>=0){const a=i[r];s=a.offset+a.size}const o=(e-r-1)*t;return s+o},C1=({totalColumn:e},{column:t,estimatedColumnWidth:r,lastVisitedColumnIndex:i})=>{let s=0;if(i>e&&(i=e-1),i>=0){const a=t[i];s=a.offset+a.size}const o=(e-i-1)*r;return s+o},B3={column:C1,row:v1},rw=(e,t,r,i,s,n,o)=>{const[a,l]=[n==="row"?e.height:e.width,B3[n]],c=Ns(e,t,s,n),u=l(e,s),d=Sd(0,p1(u-a,c.offset)),h=Sd(0,c.offset-a+o+c.size);switch(r===i1&&(i>=h-a&&i<=d+a?r=uo:r=la),r){case gp:return d;case mp:return h;case la:return Math.round(h+(d-h)/2);case uo:default:return i>=h&&i<=d?i:h>d||i<h?h:d}},G3=f1({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,r)=>{const i=Ns(e,t,r,"column");return[i.size,i.offset]},getRowPosition:(e,t,r)=>{const i=Ns(e,t,r,"row");return[i.size,i.offset]},getColumnOffset:(e,t,r,i,s,n)=>rw(e,t,r,i,s,"column",n),getRowOffset:(e,t,r,i,s,n)=>rw(e,t,r,i,s,"row",n),getColumnStartIndexForOffset:(e,t,r)=>tw(e,r,t,"column"),getColumnStopIndexForStartIndex:(e,t,r,i)=>{const s=Ns(e,t,i,"column"),n=r+e.width;let o=s.offset+s.size,a=t;for(;a<e.totalColumn-1&&o<n;)a++,o+=Ns(e,t,i,"column").size;return a},getEstimatedTotalHeight:v1,getEstimatedTotalWidth:C1,getRowStartIndexForOffset:(e,t,r)=>tw(e,r,t,"row"),getRowStopIndexForStartIndex:(e,t,r,i)=>{const{totalRow:s,height:n}=e,o=Ns(e,t,i,"row"),a=r+n;let l=o.size+o.offset,c=t;for(;c<s-1&&l<a;)c++,l+=Ns(e,c,i,"row").size;return c},injectToInstance:(e,t)=>{const r=({columnIndex:n,rowIndex:o},a)=>{var l,c;a=Hs(a)?!0:a,dt(n)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,n-1)),dt(o)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,o-1)),(l=e.exposed)==null||l.getItemStyleCache.value(-1,null,null),a&&((c=e.proxy)==null||c.$forceUpdate())},i=(n,o)=>{r({columnIndex:n},o)},s=(n,o)=>{r({rowIndex:n},o)};Object.assign(e.proxy,{resetAfterColumnIndex:i,resetAfterRowIndex:s,resetAfter:r})},initCache:({estimatedColumnWidth:e=YC,estimatedRowHeight:t=YC})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}});var dc=(e=>(e.ASC="asc",e.DESC="desc",e))(dc||{}),hc=(e=>(e.CENTER="center",e.RIGHT="right",e))(hc||{}),h0=(e=>(e.LEFT="left",e.RIGHT="right",e))(h0||{});const Ep={asc:"desc",desc:"asc"},fc=Symbol("placeholder"),H3=(e,t,r)=>{var i;const s={flexGrow:0,flexShrink:0,...r?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};r||(s.flexShrink=1);const n={...(i=e.style)!=null?i:{},...s,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(n.maxWidth=e.maxWidth),e.minWidth&&(n.minWidth=e.minWidth)),n};function V3(e,t,r){const i=Q(()=>S(t).filter(f=>!f.hidden)),s=Q(()=>S(i).filter(f=>f.fixed==="left"||f.fixed===!0)),n=Q(()=>S(i).filter(f=>f.fixed==="right")),o=Q(()=>S(i).filter(f=>!f.fixed)),a=Q(()=>{const f=[];return S(s).forEach(m=>{f.push({...m,placeholderSign:fc})}),S(o).forEach(m=>{f.push(m)}),S(n).forEach(m=>{f.push({...m,placeholderSign:fc})}),f}),l=Q(()=>S(s).length||S(n).length),c=Q(()=>S(t).reduce((m,v)=>(m[v.key]=H3(v,S(r),e.fixed),m),{})),u=Q(()=>S(i).reduce((f,m)=>f+m.width,0)),d=f=>S(t).find(m=>m.key===f),h=f=>S(c)[f],p=(f,m)=>{f.width=m};function g(f){var m;const{key:v}=f.currentTarget.dataset;if(!v)return;const{sortState:w,sortBy:C}=e;let F=dc.ASC;ot(w)?F=Ep[w[v]]:F=Ep[C.order],(m=e.onColumnSort)==null||m.call(e,{column:d(v),key:v,order:F})}return{columns:t,columnsStyles:c,columnsTotalWidth:u,fixedColumnsOnLeft:s,fixedColumnsOnRight:n,hasFixedColumns:l,mainColumns:a,normalColumns:o,visibleColumns:i,getColumn:d,getColumnStyle:h,updateColumnWidth:p,onColumnSorted:g}}const W3=(e,{mainTableRef:t,leftTableRef:r,rightTableRef:i,onMaybeEndReached:s})=>{const n=we({scrollLeft:0,scrollTop:0});function o(p){var g,f,m;const{scrollTop:v}=p;(g=t.value)==null||g.scrollTo(p),(f=r.value)==null||f.scrollToTop(v),(m=i.value)==null||m.scrollToTop(v)}function a(p){n.value=p,o(p)}function l(p){n.value.scrollTop=p,o(S(n))}function c(p){var g,f;n.value.scrollLeft=p,(f=(g=t.value)==null?void 0:g.scrollTo)==null||f.call(g,S(n))}function u(p){var g;a(p),(g=e.onScroll)==null||g.call(e,p)}function d({scrollTop:p}){const{scrollTop:g}=S(n);p!==g&&l(p)}function h(p,g="auto"){var f;(f=t.value)==null||f.scrollToRow(p,g)}return Qe(()=>S(n).scrollTop,(p,g)=>{p>g&&s()}),{scrollPos:n,scrollTo:a,scrollToLeft:c,scrollToTop:l,scrollToRow:h,onScroll:u,onVerticalScroll:d}},z3=(e,{mainTableRef:t,leftTableRef:r,rightTableRef:i})=>{const s=Bt(),{emit:n}=s,o=dr(!1),a=dr(null),l=we(e.defaultExpandedRowKeys||[]),c=we(-1),u=dr(null),d=we({}),h=we({}),p=dr({}),g=dr({}),f=dr({}),m=Q(()=>dt(e.estimatedRowHeight));function v(b){var x;(x=e.onRowsRendered)==null||x.call(e,b),b.rowCacheEnd>S(c)&&(c.value=b.rowCacheEnd)}function w({hovered:b,rowKey:x}){a.value=b?x:null}function C({expanded:b,rowData:x,rowIndex:T,rowKey:A}){var P,U;const J=[...S(l)],B=J.indexOf(A);b?B===-1&&J.push(A):B>-1&&J.splice(B,1),l.value=J,n("update:expandedRowKeys",J),(P=e.onRowExpand)==null||P.call(e,{expanded:b,rowData:x,rowIndex:T,rowKey:A}),(U=e.onExpandedRowsChange)==null||U.call(e,J)}const F=Xx(()=>{var b,x,T,A;o.value=!0,d.value={...S(d),...S(h)},D(S(u),!1),h.value={},u.value=null,(b=t.value)==null||b.forceUpdate(),(x=r.value)==null||x.forceUpdate(),(T=i.value)==null||T.forceUpdate(),(A=s.proxy)==null||A.$forceUpdate(),o.value=!1},0);function D(b,x=!1){S(m)&&[t,r,i].forEach(T=>{const A=S(T);A&&A.resetAfterRowIndex(b,x)})}function R(b,x,T){const A=S(u);(A===null||A>T)&&(u.value=T),h.value[b]=x}function y({rowKey:b,height:x,rowIndex:T},A){A?A===h0.RIGHT?f.value[b]=x:p.value[b]=x:g.value[b]=x;const P=Math.max(...[p,f,g].map(U=>U.value[b]||0));S(d)[b]!==P&&(R(b,P,T),F())}return{hoveringRowKey:a,expandedRowKeys:l,lastRenderedRowIndex:c,isDynamic:m,isResetting:o,rowHeights:d,resetAfterIndex:D,onRowExpanded:C,onRowHovered:w,onRowsRendered:v,onRowHeightChange:y}},$3=(e,{expandedRowKeys:t,lastRenderedRowIndex:r,resetAfterIndex:i})=>{const s=we({}),n=Q(()=>{const a={},{data:l,rowKey:c}=e,u=S(t);if(!u||!u.length)return l;const d=[],h=new Set;u.forEach(g=>h.add(g));let p=l.slice();for(p.forEach(g=>a[g[c]]=0);p.length>0;){const g=p.shift();d.push(g),h.has(g[c])&&Array.isArray(g.children)&&g.children.length>0&&(p=[...g.children,...p],g.children.forEach(f=>a[f[c]]=a[g[c]]+1))}return s.value=a,d}),o=Q(()=>{const{data:a,expandColumnKey:l}=e;return l?S(n):a});return Qe(o,(a,l)=>{a!==l&&(r.value=-1,i(0,!0))}),{data:o,depthMap:s}},U3=(e,t)=>e+t,Ku=e=>Ue(e)?e.reduce(U3,0):e,Do=(e,t,r={})=>Ye(e)?e(t):e??r,En=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=Ss(e[t])}),e),w1=e=>Lr(e)?t=>yr(e,t):e,K3=(e,{columnsTotalWidth:t,data:r,fixedColumnsOnLeft:i,fixedColumnsOnRight:s})=>{const n=Q(()=>{const{fixed:C,width:F,vScrollbarSize:D}=e,R=F-D;return C?Math.max(Math.round(S(t)),R):R}),o=Q(()=>S(n)+e.vScrollbarSize),a=Q(()=>{const{height:C=0,maxHeight:F=0,footerHeight:D,hScrollbarSize:R}=e;if(F>0){const y=S(g),b=S(l),T=S(p)+y+b+R;return Math.min(T,F-D)}return C-D}),l=Q(()=>{const{rowHeight:C,estimatedRowHeight:F}=e,D=S(r);return dt(F)?D.length*F:D.length*C}),c=Q(()=>{const{maxHeight:C}=e,F=S(a);if(dt(C)&&C>0)return F;const D=S(l)+S(p)+S(g);return Math.min(F,D)}),u=C=>C.width,d=Q(()=>Ku(S(i).map(u))),h=Q(()=>Ku(S(s).map(u))),p=Q(()=>Ku(e.headerHeight)),g=Q(()=>{var C;return(((C=e.fixedData)==null?void 0:C.length)||0)*e.rowHeight}),f=Q(()=>S(a)-S(p)-S(g)),m=Q(()=>{const{style:C={},height:F,width:D}=e;return En({...C,height:F,width:D})}),v=Q(()=>En({height:e.footerHeight})),w=Q(()=>({top:Ss(S(p)),bottom:Ss(e.footerHeight),width:Ss(e.width)}));return{bodyWidth:n,fixedTableHeight:c,mainTableHeight:a,leftTableWidth:d,rightTableWidth:h,headerWidth:o,rowsHeight:l,windowHeight:f,footerHeight:v,emptyStyle:w,rootStyle:m,headerHeight:p}},j3=e=>{const t=we(),r=we(0),i=we(0);let s;return Gt(()=>{s=ri(t,([n])=>{const{width:o,height:a}=n.contentRect,{paddingLeft:l,paddingRight:c,paddingTop:u,paddingBottom:d}=getComputedStyle(n.target),h=Number.parseInt(l)||0,p=Number.parseInt(c)||0,g=Number.parseInt(u)||0,f=Number.parseInt(d)||0;r.value=o-h-p,i.value=a-g-f}).stop}),Er(()=>{s==null||s()}),Qe([r,i],([n,o])=>{var a;(a=e.onResize)==null||a.call(e,{width:n,height:o})}),{sizer:t,width:r,height:i}};function q3(e){const t=we(),r=we(),i=we(),{columns:s,columnsStyles:n,columnsTotalWidth:o,fixedColumnsOnLeft:a,fixedColumnsOnRight:l,hasFixedColumns:c,mainColumns:u,onColumnSorted:d}=V3(e,ii(e,"columns"),ii(e,"fixed")),{scrollTo:h,scrollToLeft:p,scrollToTop:g,scrollToRow:f,onScroll:m,onVerticalScroll:v,scrollPos:w}=W3(e,{mainTableRef:t,leftTableRef:r,rightTableRef:i,onMaybeEndReached:L}),{expandedRowKeys:C,hoveringRowKey:F,lastRenderedRowIndex:D,isDynamic:R,isResetting:y,rowHeights:b,resetAfterIndex:x,onRowExpanded:T,onRowHeightChange:A,onRowHovered:P,onRowsRendered:U}=z3(e,{mainTableRef:t,leftTableRef:r,rightTableRef:i}),{data:J,depthMap:B}=$3(e,{expandedRowKeys:C,lastRenderedRowIndex:D,resetAfterIndex:x}),{bodyWidth:H,fixedTableHeight:_,mainTableHeight:se,leftTableWidth:G,rightTableWidth:he,headerWidth:Re,rowsHeight:M,windowHeight:X,footerHeight:z,emptyStyle:Y,rootStyle:ae,headerHeight:W}=K3(e,{columnsTotalWidth:o,data:J,fixedColumnsOnLeft:a,fixedColumnsOnRight:l}),re=dr(!1),Z=we(),ee=Q(()=>{const I=S(J).length===0;return Ue(e.fixedData)?e.fixedData.length===0&&I:I});function Fe(I){const{estimatedRowHeight:V,rowHeight:ie,rowKey:ne}=e;return V?S(b)[S(J)[I][ne]]||V:ie}function L(){const{onEndReached:I}=e;if(!I)return;const{scrollTop:V}=S(w),ie=S(M),ne=S(X),j=ie-(V+ne)+e.hScrollbarSize;S(D)>=0&&ie===V+S(se)-S(W)&&I(j)}return Qe(()=>e.expandedRowKeys,I=>C.value=I,{deep:!0}),{columns:s,containerRef:Z,mainTableRef:t,leftTableRef:r,rightTableRef:i,isDynamic:R,isResetting:y,isScrolling:re,hoveringRowKey:F,hasFixedColumns:c,columnsStyles:n,columnsTotalWidth:o,data:J,expandedRowKeys:C,depthMap:B,fixedColumnsOnLeft:a,fixedColumnsOnRight:l,mainColumns:u,bodyWidth:H,emptyStyle:Y,rootStyle:ae,headerWidth:Re,footerHeight:z,mainTableHeight:se,fixedTableHeight:_,leftTableWidth:G,rightTableWidth:he,showEmpty:ee,getRowHeight:Fe,onColumnSorted:d,onRowHovered:P,onRowExpanded:T,onRowsRendered:U,onRowHeightChange:A,scrollTo:h,scrollToLeft:p,scrollToTop:g,scrollToRow:f,onScroll:m,onVerticalScroll:v}}const f0=Symbol("tableV2"),S1=String,Hc={type:Me(Array),required:!0},p0={type:Me(Array)},y1={...p0,required:!0},Y3=String,iw={type:Me(Array),default:()=>qs([])},io={type:Number,required:!0},x1={type:Me([String,Number,Symbol]),default:"id"},sw={type:Me(Object)},ho=it({class:String,columns:Hc,columnsStyles:{type:Me(Object),required:!0},depth:Number,expandColumnKey:Y3,estimatedRowHeight:{...Co.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:Me(Function)},onRowHover:{type:Me(Function)},onRowHeightChange:{type:Me(Function)},rowData:{type:Me(Object),required:!0},rowEventHandlers:{type:Me(Object)},rowIndex:{type:Number,required:!0},rowKey:x1,style:{type:Me(Object)}}),af={type:Number,required:!0},g0=it({class:String,columns:Hc,fixedHeaderData:{type:Me(Array)},headerData:{type:Me(Array),required:!0},headerHeight:{type:Me([Number,Array]),default:50},rowWidth:af,rowHeight:{type:Number,default:50},height:af,width:af}),ju=it({columns:Hc,data:y1,fixedData:p0,estimatedRowHeight:ho.estimatedRowHeight,width:io,height:io,headerWidth:io,headerHeight:g0.headerHeight,bodyWidth:io,rowHeight:io,cache:k3.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Co.scrollbarAlwaysOn,scrollbarStartGap:Co.scrollbarStartGap,scrollbarEndGap:Co.scrollbarEndGap,class:S1,style:sw,containerStyle:sw,getRowHeight:{type:Me(Function),required:!0},rowKey:ho.rowKey,onRowsRendered:{type:Me(Function)},onScroll:{type:Me(Function)}}),X3=it({cache:ju.cache,estimatedRowHeight:ho.estimatedRowHeight,rowKey:x1,headerClass:{type:Me([String,Function])},headerProps:{type:Me([Object,Function])},headerCellProps:{type:Me([Object,Function])},headerHeight:g0.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:Me([String,Function])},rowProps:{type:Me([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:Me([Object,Function])},columns:Hc,data:y1,dataGetter:{type:Me(Function)},fixedData:p0,expandColumnKey:ho.expandColumnKey,expandedRowKeys:iw,defaultExpandedRowKeys:iw,class:S1,fixed:Boolean,style:{type:Me(Object)},width:io,height:io,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Co.hScrollbarSize,vScrollbarSize:Co.vScrollbarSize,scrollbarAlwaysOn:h1.alwaysOn,sortBy:{type:Me(Object),default:()=>({})},sortState:{type:Me(Object),default:void 0},onColumnSort:{type:Me(Function)},onExpandedRowsChange:{type:Me(Function)},onEndReached:{type:Me(Function)},onRowExpand:ho.onRowExpand,onScroll:ju.onScroll,onRowsRendered:ju.onRowsRendered,rowEventHandlers:ho.rowEventHandlers}),m0=(e,{slots:t})=>{var r;const{cellData:i,style:s}=e,n=((r=i==null?void 0:i.toString)==null?void 0:r.call(i))||"",o=Xe(t,"default",e,()=>[n]);return ye("div",{class:e.class,title:n,style:s},[o])};m0.displayName="ElTableV2Cell";m0.inheritAttrs=!1;const v0=(e,{slots:t})=>Xe(t,"default",e,()=>{var r,i;return[ye("div",{class:e.class,title:(r=e.column)==null?void 0:r.title},[(i=e.column)==null?void 0:i.title])]});v0.displayName="ElTableV2HeaderCell";v0.inheritAttrs=!1;const Q3=it({class:String,columns:Hc,columnsStyles:{type:Me(Object),required:!0},headerIndex:Number,style:{type:Me(Object)}}),J3=_e({name:"ElTableV2HeaderRow",props:Q3,setup(e,{slots:t}){return()=>{const{columns:r,columnsStyles:i,headerIndex:s,style:n}=e;let o=r.map((a,l)=>t.cell({columns:r,column:a,columnIndex:l,headerIndex:s,style:i[a.key]}));return t.header&&(o=t.header({cells:o.map(a=>Ue(a)&&a.length===1?a[0]:a),columns:r,headerIndex:s})),ye("div",{class:e.class,style:n,role:"row"},[o])}}}),Z3="ElTableV2Header",eH=_e({name:Z3,props:g0,setup(e,{slots:t,expose:r}){const i=at("table-v2"),s=we(),n=Q(()=>En({width:e.width,height:e.height})),o=Q(()=>En({width:e.rowWidth,height:e.height})),a=Q(()=>hd(S(e.headerHeight))),l=d=>{const h=S(s);Tt(()=>{h!=null&&h.scroll&&h.scroll({left:d})})},c=()=>{const d=i.e("fixed-header-row"),{columns:h,fixedHeaderData:p,rowHeight:g}=e;return p==null?void 0:p.map((f,m)=>{var v;const w=En({height:g,width:"100%"});return(v=t.fixed)==null?void 0:v.call(t,{class:d,columns:h,rowData:f,rowIndex:-(m+1),style:w})})},u=()=>{const d=i.e("dynamic-header-row"),{columns:h}=e;return S(a).map((p,g)=>{var f;const m=En({width:"100%",height:p});return(f=t.dynamic)==null?void 0:f.call(t,{class:d,columns:h,headerIndex:g,style:m})})};return r({scrollToLeft:l}),()=>{if(!(e.height<=0))return ye("div",{ref:s,class:e.class,style:S(n),role:"rowgroup"},[ye("div",{style:S(o),class:i.e("header")},[u(),c()])])}}}),tH=e=>{const{isScrolling:t}=rt(f0),r=we(!1),i=we(),s=Q(()=>dt(e.estimatedRowHeight)&&e.rowIndex>=0),n=(l=!1)=>{const c=S(i);if(!c)return;const{columns:u,onRowHeightChange:d,rowKey:h,rowIndex:p,style:g}=e,{height:f}=c.getBoundingClientRect();r.value=!0,Tt(()=>{if(l||f!==Number.parseInt(g.height)){const m=u[0],v=(m==null?void 0:m.placeholderSign)===fc;d==null||d({rowKey:h,height:f,rowIndex:p},m&&!v&&m.fixed)}})},o=Q(()=>{const{rowData:l,rowIndex:c,rowKey:u,onRowHover:d}=e,h=e.rowEventHandlers||{},p={};return Object.entries(h).forEach(([g,f])=>{Ye(f)&&(p[g]=m=>{f({event:m,rowData:l,rowIndex:c,rowKey:u})})}),d&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:g,hovered:f})=>{const m=p[g];p[g]=v=>{d({event:v,hovered:f,rowData:l,rowIndex:c,rowKey:u}),m==null||m(v)}}),p}),a=l=>{const{onRowExpand:c,rowData:u,rowIndex:d,rowKey:h}=e;c==null||c({expanded:l,rowData:u,rowIndex:d,rowKey:h})};return Gt(()=>{S(s)&&n(!0)}),{isScrolling:t,measurable:s,measured:r,rowRef:i,eventHandlers:o,onExpand:a}},rH="ElTableV2TableRow",iH=_e({name:rH,props:ho,setup(e,{expose:t,slots:r,attrs:i}){const{eventHandlers:s,isScrolling:n,measurable:o,measured:a,rowRef:l,onExpand:c}=tH(e);return t({onExpand:c}),()=>{const{columns:u,columnsStyles:d,expandColumnKey:h,depth:p,rowData:g,rowIndex:f,style:m}=e;let v=u.map((w,C)=>{const F=Ue(g.children)&&g.children.length>0&&w.key===h;return r.cell({column:w,columns:u,columnIndex:C,depth:p,style:d[w.key],rowData:g,rowIndex:f,isScrolling:S(n),expandIconProps:F?{rowData:g,rowIndex:f,onExpand:c}:void 0})});if(r.row&&(v=r.row({cells:v.map(w=>Ue(w)&&w.length===1?w[0]:w),style:m,columns:u,depth:p,rowData:g,rowIndex:f,isScrolling:S(n)})),S(o)){const{height:w,...C}=m||{},F=S(a);return ye("div",_t({ref:l,class:e.class,style:F?m:C,role:"row"},i,S(s)),[v])}return ye("div",_t(i,{ref:l,class:e.class,style:m,role:"row"},S(s)),[v])}}}),sH=e=>{const{sortOrder:t}=e;return ye(It,{size:14,class:e.class},{default:()=>[t===dc.ASC?ye(oO,null,null):ye(sO,null,null)]})},nH=e=>{const{expanded:t,expandable:r,onExpand:i,style:s,size:n}=e,o={onClick:r?()=>i(!t):void 0,class:e.class};return ye(It,_t(o,{size:n,style:s}),{default:()=>[ye(tb,null,null)]})},oH="ElTableV2Grid",aH=e=>{const t=we(),r=we(),i=Q(()=>{const{data:f,rowHeight:m,estimatedRowHeight:v}=e;if(!v)return f.length*m}),s=Q(()=>{const{fixedData:f,rowHeight:m}=e;return((f==null?void 0:f.length)||0)*m}),n=Q(()=>Ku(e.headerHeight)),o=Q(()=>{const{height:f}=e;return Math.max(0,f-S(n)-S(s))}),a=Q(()=>S(n)+S(s)>0),l=({data:f,rowIndex:m})=>f[m][e.rowKey];function c({rowCacheStart:f,rowCacheEnd:m,rowVisibleStart:v,rowVisibleEnd:w}){var C;(C=e.onRowsRendered)==null||C.call(e,{rowCacheStart:f,rowCacheEnd:m,rowVisibleStart:v,rowVisibleEnd:w})}function u(f,m){var v;(v=r.value)==null||v.resetAfterRowIndex(f,m)}function d(f,m){const v=S(t),w=S(r);!v||!w||(ot(f)?(v.scrollToLeft(f.scrollLeft),w.scrollTo(f)):(v.scrollToLeft(f),w.scrollTo({scrollLeft:f,scrollTop:m})))}function h(f){var m;(m=S(r))==null||m.scrollTo({scrollTop:f})}function p(f,m){var v;(v=S(r))==null||v.scrollToItem(f,1,m)}function g(){var f,m;(f=S(r))==null||f.$forceUpdate(),(m=S(t))==null||m.$forceUpdate()}return{bodyRef:r,forceUpdate:g,fixedRowHeight:s,gridHeight:o,hasHeader:a,headerHeight:n,headerRef:t,totalHeight:i,itemKey:l,onItemRendered:c,resetAfterRowIndex:u,scrollTo:d,scrollToTop:h,scrollToRow:p}},C0=_e({name:oH,props:ju,setup(e,{slots:t,expose:r}){const{ns:i}=rt(f0),{bodyRef:s,fixedRowHeight:n,gridHeight:o,hasHeader:a,headerRef:l,headerHeight:c,totalHeight:u,forceUpdate:d,itemKey:h,onItemRendered:p,resetAfterRowIndex:g,scrollTo:f,scrollToTop:m,scrollToRow:v}=aH(e);r({forceUpdate:d,totalHeight:u,scrollTo:f,scrollToTop:m,scrollToRow:v,resetAfterRowIndex:g});const w=()=>e.bodyWidth;return()=>{const{cache:C,columns:F,data:D,fixedData:R,useIsScrolling:y,scrollbarAlwaysOn:b,scrollbarEndGap:x,scrollbarStartGap:T,style:A,rowHeight:P,bodyWidth:U,estimatedRowHeight:J,headerWidth:B,height:H,width:_,getRowHeight:se,onScroll:G}=e,he=dt(J),Re=he?G3:O3,M=S(c);return ye("div",{role:"table",class:[i.e("table"),e.class],style:A},[ye(Re,{ref:s,data:D,useIsScrolling:y,itemKey:h,columnCache:0,columnWidth:he?w:U,totalColumn:1,totalRow:D.length,rowCache:C,rowHeight:he?se:P,width:_,height:S(o),class:i.e("body"),role:"rowgroup",scrollbarStartGap:T,scrollbarEndGap:x,scrollbarAlwaysOn:b,onScroll:G,onItemRendered:p,perfMode:!1},{default:X=>{var z;const Y=D[X.rowIndex];return(z=t.row)==null?void 0:z.call(t,{...X,columns:F,rowData:Y})}}),S(a)&&ye(eH,{ref:l,class:i.e("header-wrapper"),columns:F,headerData:D,headerHeight:e.headerHeight,fixedHeaderData:R,rowWidth:B,rowHeight:P,width:_,height:Math.min(M+S(n),H)},{dynamic:t.header,fixed:t.row})])}}});function lH(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const cH=(e,{slots:t})=>{const{mainTableRef:r,...i}=e;return ye(C0,_t({ref:r},i),lH(t)?t:{default:()=>[t]})};function uH(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const dH=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:r,...i}=e;return ye(C0,_t({ref:r},i),uH(t)?t:{default:()=>[t]})};function hH(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const fH=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:r,...i}=e;return ye(C0,_t({ref:r},i),hH(t)?t:{default:()=>[t]})};function pH(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const gH=(e,{slots:t})=>{const{columns:r,columnsStyles:i,depthMap:s,expandColumnKey:n,expandedRowKeys:o,estimatedRowHeight:a,hasFixedColumns:l,hoveringRowKey:c,rowData:u,rowIndex:d,style:h,isScrolling:p,rowProps:g,rowClass:f,rowKey:m,rowEventHandlers:v,ns:w,onRowHovered:C,onRowExpanded:F}=e,D=Do(f,{columns:r,rowData:u,rowIndex:d},""),R=Do(g,{columns:r,rowData:u,rowIndex:d}),y=u[m],b=s[y]||0,x=!!n,T=d<0,A=[w.e("row"),D,{[w.e(`row-depth-${b}`)]:x&&d>=0,[w.is("expanded")]:x&&o.includes(y),[w.is("hovered")]:!p&&y===c,[w.is("fixed")]:!b&&T,[w.is("customized")]:!!t.row}],P=l?C:void 0,U={...R,columns:r,columnsStyles:i,class:A,depth:b,expandColumnKey:n,estimatedRowHeight:T?void 0:a,isScrolling:p,rowIndex:d,rowData:u,rowKey:y,rowEventHandlers:v,style:h};return ye(iH,_t(U,{onRowHover:P,onRowExpand:F}),pH(t)?t:{default:()=>[t]})},Fp=({columns:e,column:t,columnIndex:r,depth:i,expandIconProps:s,isScrolling:n,rowData:o,rowIndex:a,style:l,expandedRowKeys:c,ns:u,cellProps:d,expandColumnKey:h,indentSize:p,iconSize:g,rowKey:f},{slots:m})=>{const v=En(l);if(t.placeholderSign===fc)return ye("div",{class:u.em("row-cell","placeholder"),style:v},null);const{cellRenderer:w,dataKey:C,dataGetter:F}=t,D=Ye(F)?F({columns:e,column:t,columnIndex:r,rowData:o,rowIndex:a}):Ui(o,C??""),R=Do(d,{cellData:D,columns:e,column:t,columnIndex:r,rowIndex:a,rowData:o}),y={class:u.e("cell-text"),columns:e,column:t,columnIndex:r,cellData:D,isScrolling:n,rowData:o,rowIndex:a},b=w1(w),x=b?b(y):Xe(m,"default",y,()=>[ye(m0,y,null)]),T=[u.e("row-cell"),t.class,t.align===hc.CENTER&&u.is("align-center"),t.align===hc.RIGHT&&u.is("align-right")],A=a>=0&&h&&t.key===h,P=a>=0&&c.includes(o[f]);let U;const J=`margin-inline-start: ${i*p}px;`;return A&&(ot(s)?U=ye(nH,_t(s,{class:[u.e("expand-icon"),u.is("expanded",P)],size:g,expanded:P,style:J,expandable:!0}),null):U=ye("div",{style:[J,`width: ${g}px; height: ${g}px;`].join(" ")},null)),ye("div",_t({class:T,style:v},R,{role:"cell"}),[U,x])};Fp.inheritAttrs=!1;function mH(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const vH=({columns:e,columnsStyles:t,headerIndex:r,style:i,headerClass:s,headerProps:n,ns:o},{slots:a})=>{const l={columns:e,headerIndex:r},c=[o.e("header-row"),Do(s,l,""),{[o.is("customized")]:!!a.header}],u={...Do(n,l),columnsStyles:t,class:c,columns:e,headerIndex:r,style:i};return ye(J3,u,mH(a)?a:{default:()=>[a]})},nw=(e,{slots:t})=>{const{column:r,ns:i,style:s,onColumnSorted:n}=e,o=En(s);if(r.placeholderSign===fc)return ye("div",{class:i.em("header-row-cell","placeholder"),style:o},null);const{headerCellRenderer:a,headerClass:l,sortable:c}=r,u={...e,class:i.e("header-cell-text")},d=w1(a),h=d?d(u):Xe(t,"default",u,()=>[ye(v0,u,null)]),{sortBy:p,sortState:g,headerCellProps:f}=e;let m,v;if(g){const F=g[r.key];m=!!Ep[F],v=m?F:dc.ASC}else m=r.key===p.key,v=m?p.order:dc.ASC;const w=[i.e("header-cell"),Do(l,e,""),r.align===hc.CENTER&&i.is("align-center"),r.align===hc.RIGHT&&i.is("align-right"),c&&i.is("sortable")],C={...Do(f,e),onClick:r.sortable?n:void 0,class:w,style:o,"data-key":r.key};return ye("div",_t(C,{role:"columnheader"}),[h,c&&ye(sH,{class:[i.e("sort-icon"),m&&i.is("sorting")],sortOrder:v},null)])},b1=(e,{slots:t})=>{var r;return ye("div",{class:e.class,style:e.style},[(r=t.default)==null?void 0:r.call(t)])};b1.displayName="ElTableV2Footer";const R1=(e,{slots:t})=>{const r=Xe(t,"default",{},()=>[ye(GG,null,null)]);return ye("div",{class:e.class,style:e.style},[r])};R1.displayName="ElTableV2Empty";const E1=(e,{slots:t})=>{var r;return ye("div",{class:e.class,style:e.style},[(r=t.default)==null?void 0:r.call(t)])};E1.displayName="ElTableV2Overlay";function ul(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lr(e)}const CH="ElTableV2",wH=_e({name:CH,props:X3,setup(e,{slots:t,expose:r}){const i=at("table-v2"),{columnsStyles:s,fixedColumnsOnLeft:n,fixedColumnsOnRight:o,mainColumns:a,mainTableHeight:l,fixedTableHeight:c,leftTableWidth:u,rightTableWidth:d,data:h,depthMap:p,expandedRowKeys:g,hasFixedColumns:f,hoveringRowKey:m,mainTableRef:v,leftTableRef:w,rightTableRef:C,isDynamic:F,isResetting:D,isScrolling:R,bodyWidth:y,emptyStyle:b,rootStyle:x,headerWidth:T,footerHeight:A,showEmpty:P,scrollTo:U,scrollToLeft:J,scrollToTop:B,scrollToRow:H,getRowHeight:_,onColumnSorted:se,onRowHeightChange:G,onRowHovered:he,onRowExpanded:Re,onRowsRendered:M,onScroll:X,onVerticalScroll:z}=q3(e);return r({scrollTo:U,scrollToLeft:J,scrollToTop:B,scrollToRow:H}),rr(f0,{ns:i,isResetting:D,hoveringRowKey:m,isScrolling:R}),()=>{const{cache:Y,cellProps:ae,estimatedRowHeight:W,expandColumnKey:re,fixedData:Z,headerHeight:ee,headerClass:Fe,headerProps:L,headerCellProps:I,sortBy:V,sortState:ie,rowHeight:ne,rowClass:j,rowEventHandlers:oe,rowKey:pe,rowProps:fe,scrollbarAlwaysOn:Ce,indentSize:le,iconSize:be,useIsScrolling:De,vScrollbarSize:te,width:Pe}=e,Ne=S(h),Ve={cache:Y,class:i.e("main"),columns:S(a),data:Ne,fixedData:Z,estimatedRowHeight:W,bodyWidth:S(y)+te,headerHeight:ee,headerWidth:S(T),height:S(l),mainTableRef:v,rowKey:pe,rowHeight:ne,scrollbarAlwaysOn:Ce,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:De,width:Pe,getRowHeight:_,onRowsRendered:M,onScroll:X},qe=S(u),$e=S(c),et={cache:Y,class:i.e("left"),columns:S(n),data:Ne,estimatedRowHeight:W,leftTableRef:w,rowHeight:ne,bodyWidth:qe,headerWidth:qe,headerHeight:ee,height:$e,rowKey:pe,scrollbarAlwaysOn:Ce,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:De,width:qe,getRowHeight:_,onScroll:z},Rt=S(d)+te,At={cache:Y,class:i.e("right"),columns:S(o),data:Ne,estimatedRowHeight:W,rightTableRef:C,rowHeight:ne,bodyWidth:Rt,headerWidth:Rt,headerHeight:ee,height:$e,rowKey:pe,scrollbarAlwaysOn:Ce,scrollbarStartGap:2,scrollbarEndGap:te,width:Rt,style:`--${S(i.namespace)}-table-scrollbar-size: ${te}px`,useIsScrolling:De,getRowHeight:_,onScroll:z},mr=S(s),Kt={ns:i,depthMap:S(p),columnsStyles:mr,expandColumnKey:re,expandedRowKeys:S(g),estimatedRowHeight:W,hasFixedColumns:S(f),hoveringRowKey:S(m),rowProps:fe,rowClass:j,rowKey:pe,rowEventHandlers:oe,onRowHovered:he,onRowExpanded:Re,onRowHeightChange:G},vr={cellProps:ae,expandColumnKey:re,indentSize:le,iconSize:be,rowKey:pe,expandedRowKeys:S(g),ns:i},Ps={ns:i,headerClass:Fe,headerProps:L,columnsStyles:mr},Un={ns:i,sortBy:V,sortState:ie,headerCellProps:I,onColumnSorted:se},Cr={row:Ni=>ye(gH,_t(Ni,Kt),{row:t.row,cell:Hr=>{let Si;return t.cell?ye(Fp,_t(Hr,vr,{style:mr[Hr.column.key]}),ul(Si=t.cell(Hr))?Si:{default:()=>[Si]}):ye(Fp,_t(Hr,vr,{style:mr[Hr.column.key]}),null)}}),header:Ni=>ye(vH,_t(Ni,Ps),{header:t.header,cell:Hr=>{let Si;return t["header-cell"]?ye(nw,_t(Hr,Un,{style:mr[Hr.column.key]}),ul(Si=t["header-cell"](Hr))?Si:{default:()=>[Si]}):ye(nw,_t(Hr,Un,{style:mr[Hr.column.key]}),null)}})},Za=[e.class,i.b(),i.e("root"),{[i.is("dynamic")]:S(F)}],el={class:i.e("footer"),style:S(A)};return ye("div",{class:Za,style:S(x)},[ye(cH,Ve,ul(Cr)?Cr:{default:()=>[Cr]}),ye(dH,et,ul(Cr)?Cr:{default:()=>[Cr]}),ye(fH,At,ul(Cr)?Cr:{default:()=>[Cr]}),t.footer&&ye(b1,el,{default:t.footer}),S(P)&&ye(R1,{class:i.e("empty"),style:S(b)},{default:t.empty}),t.overlay&&ye(E1,{class:i.e("overlay")},{default:t.overlay})])}}}),SH=it({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:Me(Function)}}),yH=_e({name:"ElAutoResizer",props:SH,setup(e,{slots:t}){const r=at("auto-resizer"),{height:i,width:s,sizer:n}=j3(e),o={width:"100%",height:"100%"};return()=>{var a;return ye("div",{ref:n,class:r.b(),style:o},[(a=t.default)==null?void 0:a.call(t,{height:i.value,width:s.value})])}}});gr(wH);const xH=gr(yH),Ch=Symbol("tabsRootContextKey"),bH=it({tabs:{type:Me(Array),default:()=>qs([])}}),F1="ElTabBar",RH=_e({name:F1}),EH=_e({...RH,props:bH,setup(e,{expose:t}){const r=e,i=Bt(),s=rt(Ch);s||sn(F1,"<el-tabs><el-tab-bar /></el-tabs>");const n=at("tabs"),o=we(),a=we(),l=()=>{let u=0,d=0;const h=["top","bottom"].includes(s.props.tabPosition)?"width":"height",p=h==="width"?"x":"y",g=p==="x"?"left":"top";return r.tabs.every(f=>{var m,v;const w=(v=(m=i.parent)==null?void 0:m.refs)==null?void 0:v[`tab-${f.uid}`];if(!w)return!1;if(!f.active)return!0;u=w[`offset${yn(g)}`],d=w[`client${yn(h)}`];const C=window.getComputedStyle(w);return h==="width"&&(r.tabs.length>1&&(d-=Number.parseFloat(C.paddingLeft)+Number.parseFloat(C.paddingRight)),u+=Number.parseFloat(C.paddingLeft)),!1}),{[h]:`${d}px`,transform:`translate${yn(p)}(${u}px)`}},c=()=>a.value=l();return Qe(()=>r.tabs,async()=>{await Tt(),c()},{immediate:!0}),ri(o,()=>c()),t({ref:o,update:c}),(u,d)=>(ue(),Ie("div",{ref_key:"barRef",ref:o,class:Ae([S(n).e("active-bar"),S(n).is(S(s).props.tabPosition)]),style:kt(a.value)},null,6))}});var FH=bt(EH,[["__file","tab-bar.vue"]]);const TH=it({panes:{type:Me(Array),default:()=>qs([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),AH={tabClick:(e,t,r)=>r instanceof Event,tabRemove:(e,t)=>t instanceof Event},ow="ElTabNav",PH=_e({name:ow,props:TH,emits:AH,setup(e,{expose:t,emit:r}){const i=Bt(),s=rt(Ch);s||sn(ow,"<el-tabs><tab-nav /></el-tabs>");const n=at("tabs"),o=SD(),a=ID(),l=we(),c=we(),u=we(),d=we(),h=we(!1),p=we(0),g=we(!1),f=we(!0),m=Q(()=>["top","bottom"].includes(s.props.tabPosition)?"width":"height"),v=Q(()=>({transform:`translate${m.value==="width"?"X":"Y"}(-${p.value}px)`})),w=()=>{if(!l.value)return;const x=l.value[`offset${yn(m.value)}`],T=p.value;if(!T)return;const A=T>x?T-x:0;p.value=A},C=()=>{if(!l.value||!c.value)return;const x=c.value[`offset${yn(m.value)}`],T=l.value[`offset${yn(m.value)}`],A=p.value;if(x-A<=T)return;const P=x-A>T*2?A+T:x-T;p.value=P},F=async()=>{const x=c.value;if(!h.value||!u.value||!l.value||!x)return;await Tt();const T=u.value.querySelector(".is-active");if(!T)return;const A=l.value,P=["top","bottom"].includes(s.props.tabPosition),U=T.getBoundingClientRect(),J=A.getBoundingClientRect(),B=P?x.offsetWidth-J.width:x.offsetHeight-J.height,H=p.value;let _=H;P?(U.left<J.left&&(_=H-(J.left-U.left)),U.right>J.right&&(_=H+U.right-J.right)):(U.top<J.top&&(_=H-(J.top-U.top)),U.bottom>J.bottom&&(_=H+(U.bottom-J.bottom))),_=Math.max(_,0),p.value=Math.min(_,B)},D=()=>{var x;if(!c.value||!l.value)return;e.stretch&&((x=d.value)==null||x.update());const T=c.value[`offset${yn(m.value)}`],A=l.value[`offset${yn(m.value)}`],P=p.value;A<T?(h.value=h.value||{},h.value.prev=P,h.value.next=P+A<T,T-P<A&&(p.value=T-A)):(h.value=!1,P>0&&(p.value=0))},R=x=>{const T=x.code,{up:A,down:P,left:U,right:J}=ys;if(![A,P,U,J].includes(T))return;const B=Array.from(x.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),H=B.indexOf(x.target);let _;T===U||T===A?H===0?_=B.length-1:_=H-1:H<B.length-1?_=H+1:_=0,B[_].focus({preventScroll:!0}),B[_].click(),y()},y=()=>{f.value&&(g.value=!0)},b=()=>g.value=!1;return Qe(o,x=>{x==="hidden"?f.value=!1:x==="visible"&&setTimeout(()=>f.value=!0,50)}),Qe(a,x=>{x?setTimeout(()=>f.value=!0,50):f.value=!1}),ri(u,D),Gt(()=>setTimeout(()=>F(),0)),Va(()=>D()),t({scrollToActiveTab:F,removeFocus:b}),Qe(()=>e.panes,()=>i.update(),{flush:"post",deep:!0}),()=>{const x=h.value?[ye("span",{class:[n.e("nav-prev"),n.is("disabled",!h.value.prev)],onClick:w},[ye(It,null,{default:()=>[ye(N2,null,null)]})]),ye("span",{class:[n.e("nav-next"),n.is("disabled",!h.value.next)],onClick:C},[ye(It,null,{default:()=>[ye(tb,null,null)]})])]:null,T=e.panes.map((A,P)=>{var U,J,B,H;const _=A.uid,se=A.props.disabled,G=(J=(U=A.props.name)!=null?U:A.index)!=null?J:`${P}`,he=!se&&(A.isClosable||e.editable);A.index=`${P}`;const Re=he?ye(It,{class:"is-icon-close",onClick:z=>r("tabRemove",A,z)},{default:()=>[ye(Ea,null,null)]}):null,M=((H=(B=A.slots).label)==null?void 0:H.call(B))||A.props.label,X=!se&&A.active?0:-1;return ye("div",{ref:`tab-${_}`,class:[n.e("item"),n.is(s.props.tabPosition),n.is("active",A.active),n.is("disabled",se),n.is("closable",he),n.is("focus",g.value)],id:`tab-${G}`,key:`tab-${_}`,"aria-controls":`pane-${G}`,role:"tab","aria-selected":A.active,tabindex:X,onFocus:()=>y(),onBlur:()=>b(),onClick:z=>{b(),r("tabClick",A,G,z)},onKeydown:z=>{he&&(z.code===ys.delete||z.code===ys.backspace)&&r("tabRemove",A,z)}},[M,Re])});return ye("div",{ref:u,class:[n.e("nav-wrap"),n.is("scrollable",!!h.value),n.is(s.props.tabPosition)]},[x,ye("div",{class:n.e("nav-scroll"),ref:l},[ye("div",{class:[n.e("nav"),n.is(s.props.tabPosition),n.is("stretch",e.stretch&&["top","bottom"].includes(s.props.tabPosition))],ref:c,style:v.value,role:"tablist",onKeydown:R},[e.type?null:ye(FH,{ref:d,tabs:[...e.panes]},null),T])])])}}}),DH=it({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Me(Function),default:()=>!0},stretch:Boolean}),lf=e=>ct(e)||dt(e),MH={[ur]:e=>lf(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>lf(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>lf(e),tabAdd:()=>!0},kH=_e({name:"ElTabs",props:DH,emits:MH,setup(e,{emit:t,slots:r,expose:i}){var s;const n=at("tabs"),{children:o,addChild:a,removeChild:l}=VL(Bt(),"ElTabPane"),c=we(),u=we((s=e.modelValue)!=null?s:"0"),d=async(f,m=!1)=>{var v,w,C;if(!(u.value===f||Hs(f)))try{await((v=e.beforeLeave)==null?void 0:v.call(e,f,u.value))!==!1&&(u.value=f,m&&(t(ur,f),t("tabChange",f)),(C=(w=c.value)==null?void 0:w.removeFocus)==null||C.call(w))}catch{}},h=(f,m,v)=>{f.props.disabled||(d(m,!0),t("tabClick",f,v))},p=(f,m)=>{f.props.disabled||Hs(f.props.name)||(m.stopPropagation(),t("edit",f.props.name,"remove"),t("tabRemove",f.props.name))},g=()=>{t("edit",void 0,"add"),t("tabAdd")};return Qe(()=>e.modelValue,f=>d(f)),Qe(u,async()=>{var f;await Tt(),(f=c.value)==null||f.scrollToActiveTab()}),rr(Ch,{props:e,currentName:u,registerPane:a,unregisterPane:l}),i({currentName:u}),()=>{const f=r["add-icon"],m=e.editable||e.addable?ye("span",{class:n.e("new-tab"),tabindex:"0",onClick:g,onKeydown:C=>{C.code===ys.enter&&g()}},[f?Xe(r,"add-icon"):ye(It,{class:n.is("icon-plus")},{default:()=>[ye(ob,null,null)]})]):null,v=ye("div",{class:[n.e("header"),n.is(e.tabPosition)]},[m,ye(PH,{ref:c,currentName:u.value,editable:e.editable,type:e.type,panes:o.value,stretch:e.stretch,onTabClick:h,onTabRemove:p},null)]),w=ye("div",{class:n.e("content")},[Xe(r,"default")]);return ye("div",{class:[n.b(),n.m(e.tabPosition),{[n.m("card")]:e.type==="card",[n.m("border-card")]:e.type==="border-card"}]},[...e.tabPosition!=="bottom"?[v,w]:[w,v]])}}}),_H=it({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),IH=["id","aria-hidden","aria-labelledby"],T1="ElTabPane",OH=_e({name:T1}),LH=_e({...OH,props:_H,setup(e){const t=e,r=Bt(),i=Jd(),s=rt(Ch);s||sn(T1,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const n=at("tab-pane"),o=we(),a=Q(()=>t.closable||s.props.closable),l=Cv(()=>{var p;return s.currentName.value===((p=t.name)!=null?p:o.value)}),c=we(l.value),u=Q(()=>{var p;return(p=t.name)!=null?p:o.value}),d=Cv(()=>!t.lazy||c.value||l.value);Qe(l,p=>{p&&(c.value=!0)});const h=Br({uid:r.uid,slots:i,props:t,paneName:u,active:l,index:o,isClosable:a});return Gt(()=>{s.registerPane(h)}),Qd(()=>{s.unregisterPane(h.uid)}),(p,g)=>S(d)?Yr((ue(),Ie("div",{key:0,id:`pane-${S(u)}`,class:Ae(S(n).b()),role:"tabpanel","aria-hidden":!S(l),"aria-labelledby":`tab-${S(u)}`},[Xe(p.$slots,"default")],10,IH)),[[en,S(l)]]):We("v-if",!0)}});var A1=bt(LH,[["__file","tab-pane.vue"]]);const NH=gr(kH,{TabPane:A1}),BH=Ic(A1),P1=Symbol("uploadContextKey"),GH="ElUpload";class HH extends Error{constructor(t,r,i,s){super(t),this.name="UploadAjaxError",this.status=r,this.method=i,this.url=s}}function aw(e,t,r){let i;return r.response?i=`${r.response.error||r.response}`:r.responseText?i=`${r.responseText}`:i=`fail to ${t.method} ${e} ${r.status}`,new HH(i,r.status,t.method,e)}function VH(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const WH=e=>{typeof XMLHttpRequest>"u"&&sn(GH,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,r=e.action;t.upload&&t.upload.addEventListener("progress",n=>{const o=n;o.percent=n.total>0?n.loaded/n.total*100:0,e.onProgress(o)});const i=new FormData;if(e.data)for(const[n,o]of Object.entries(e.data))Ue(o)&&o.length?i.append(n,...o):i.append(n,o);i.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(aw(r,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(aw(r,e,t));e.onSuccess(VH(t))}),t.open(e.method,r,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const s=e.headers||{};if(s instanceof Headers)s.forEach((n,o)=>t.setRequestHeader(o,n));else for(const[n,o]of Object.entries(s))Pi(o)||t.setRequestHeader(n,String(o));return t.send(i),t},D1=["text","picture","picture-card"];let zH=1;const Tp=()=>Date.now()+zH++,M1=it({action:{type:String,default:"#"},headers:{type:Me(Object)},method:{type:String,default:"post"},data:{type:Me([Object,Function,Promise]),default:()=>qs({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Me(Array),default:()=>qs([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:D1,default:"text"},httpRequest:{type:Me(Function),default:WH},disabled:Boolean,limit:Number}),$H=it({...M1,beforeUpload:{type:Me(Function),default:St},beforeRemove:{type:Me(Function)},onRemove:{type:Me(Function),default:St},onChange:{type:Me(Function),default:St},onPreview:{type:Me(Function),default:St},onSuccess:{type:Me(Function),default:St},onProgress:{type:Me(Function),default:St},onError:{type:Me(Function),default:St},onExceed:{type:Me(Function),default:St},crossorigin:{type:Me(String)}}),UH=it({files:{type:Me(Array),default:()=>qs([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Me(Function),default:St},listType:{type:String,values:D1,default:"text"},crossorigin:{type:Me(String)}}),KH={remove:e=>!!e},jH=["onKeydown"],qH=["src","crossorigin"],YH=["onClick"],XH=["title"],QH=["onClick"],JH=["onClick"],ZH=_e({name:"ElUploadList"}),eV=_e({...ZH,props:UH,emits:KH,setup(e,{emit:t}){const r=e,{t:i}=Oc(),s=at("upload"),n=at("icon"),o=at("list"),a=Wn(),l=we(!1),c=Q(()=>[s.b("list"),s.bm("list",r.listType),s.is("disabled",r.disabled)]),u=d=>{t("remove",d)};return(d,h)=>(ue(),Je(Sx,{tag:"ul",class:Ae(S(c)),name:S(o).b()},{default:ze(()=>[(ue(!0),Ie(Dt,null,ao(d.files,p=>(ue(),Ie("li",{key:p.uid||p.name,class:Ae([S(s).be("list","item"),S(s).is(p.status),{focusing:l.value}]),tabindex:"0",onKeydown:$i(g=>!S(a)&&u(p),["delete"]),onFocus:h[0]||(h[0]=g=>l.value=!0),onBlur:h[1]||(h[1]=g=>l.value=!1),onClick:h[2]||(h[2]=g=>l.value=!1)},[Xe(d.$slots,"default",{file:p},()=>[d.listType==="picture"||p.status!=="uploading"&&d.listType==="picture-card"?(ue(),Ie("img",{key:0,class:Ae(S(s).be("list","item-thumbnail")),src:p.url,crossorigin:d.crossorigin,alt:""},null,10,qH)):We("v-if",!0),p.status==="uploading"||d.listType!=="picture-card"?(ue(),Ie("div",{key:1,class:Ae(S(s).be("list","item-info"))},[Oe("a",{class:Ae(S(s).be("list","item-name")),onClick:zt(g=>d.handlePreview(p),["prevent"])},[ye(S(It),{class:Ae(S(n).m("document"))},{default:ze(()=>[ye(S(Y2))]),_:1},8,["class"]),Oe("span",{class:Ae(S(s).be("list","item-file-name")),title:p.name},Ut(p.name),11,XH)],10,YH),p.status==="uploading"?(ue(),Je(S(R3),{key:0,type:d.listType==="picture-card"?"circle":"line","stroke-width":d.listType==="picture-card"?6:2,percentage:Number(p.percentage),style:kt(d.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):We("v-if",!0)],2)):We("v-if",!0),Oe("label",{class:Ae(S(s).be("list","item-status-label"))},[d.listType==="text"?(ue(),Je(S(It),{key:0,class:Ae([S(n).m("upload-success"),S(n).m("circle-check")])},{default:ze(()=>[ye(S(Kg))]),_:1},8,["class"])):["picture-card","picture"].includes(d.listType)?(ue(),Je(S(It),{key:1,class:Ae([S(n).m("upload-success"),S(n).m("check")])},{default:ze(()=>[ye(S(rb))]),_:1},8,["class"])):We("v-if",!0)],2),S(a)?We("v-if",!0):(ue(),Je(S(It),{key:2,class:Ae(S(n).m("close")),onClick:g=>u(p)},{default:ze(()=>[ye(S(Ea))]),_:2},1032,["class","onClick"])),We(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),We(" This is a bug which needs to be fixed "),We(" TODO: Fix the incorrect navigation interaction "),S(a)?We("v-if",!0):(ue(),Ie("i",{key:3,class:Ae(S(n).m("close-tip"))},Ut(S(i)("el.upload.deleteTip")),3)),d.listType==="picture-card"?(ue(),Ie("span",{key:4,class:Ae(S(s).be("list","item-actions"))},[Oe("span",{class:Ae(S(s).be("list","item-preview")),onClick:g=>d.handlePreview(p)},[ye(S(It),{class:Ae(S(n).m("zoom-in"))},{default:ze(()=>[ye(S(hO))]),_:1},8,["class"])],10,QH),S(a)?We("v-if",!0):(ue(),Ie("span",{key:0,class:Ae(S(s).be("list","item-delete")),onClick:g=>u(p)},[ye(S(It),{class:Ae(S(n).m("delete"))},{default:ze(()=>[ye(S(j2))]),_:1},8,["class"])],10,JH))],2)):We("v-if",!0)])],42,jH))),128)),Xe(d.$slots,"append")]),_:3},8,["class","name"]))}});var lw=bt(eV,[["__file","upload-list.vue"]]);const tV=it({disabled:{type:Boolean,default:!1}}),rV={file:e=>Ue(e)},iV=["onDrop","onDragover"],k1="ElUploadDrag",sV=_e({name:k1}),nV=_e({...sV,props:tV,emits:rV,setup(e,{emit:t}){rt(P1)||sn(k1,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=at("upload"),s=we(!1),n=Wn(),o=l=>{if(n.value)return;s.value=!1,l.stopPropagation();const c=Array.from(l.dataTransfer.files);t("file",c)},a=()=>{n.value||(s.value=!0)};return(l,c)=>(ue(),Ie("div",{class:Ae([S(i).b("dragger"),S(i).is("dragover",s.value)]),onDrop:zt(o,["prevent"]),onDragover:zt(a,["prevent"]),onDragleave:c[0]||(c[0]=zt(u=>s.value=!1,["prevent"]))},[Xe(l.$slots,"default")],42,iV))}});var oV=bt(nV,[["__file","upload-dragger.vue"]]);const aV=it({...M1,beforeUpload:{type:Me(Function),default:St},onRemove:{type:Me(Function),default:St},onStart:{type:Me(Function),default:St},onSuccess:{type:Me(Function),default:St},onProgress:{type:Me(Function),default:St},onError:{type:Me(Function),default:St},onExceed:{type:Me(Function),default:St}}),lV=["onKeydown"],cV=["name","multiple","accept"],uV=_e({name:"ElUploadContent",inheritAttrs:!1}),dV=_e({...uV,props:aV,setup(e,{expose:t}){const r=e,i=at("upload"),s=Wn(),n=dr({}),o=dr(),a=f=>{if(f.length===0)return;const{autoUpload:m,limit:v,fileList:w,multiple:C,onStart:F,onExceed:D}=r;if(v&&w.length+f.length>v){D(f,w);return}C||(f=f.slice(0,1));for(const R of f){const y=R;y.uid=Tp(),F(y),m&&l(y)}},l=async f=>{if(o.value.value="",!r.beforeUpload)return u(f);let m,v={};try{const C=r.data,F=r.beforeUpload(f);v=Zu(r.data)?eC(r.data):r.data,m=await F,Zu(r.data)&&ac(C,v)&&(v=eC(r.data))}catch{m=!1}if(m===!1){r.onRemove(f);return}let w=f;m instanceof Blob&&(m instanceof File?w=m:w=new File([m],f.name,{type:f.type})),u(Object.assign(w,{uid:f.uid}),v)},c=async(f,m)=>Ye(f)?f(m):f,u=async(f,m)=>{const{headers:v,data:w,method:C,withCredentials:F,name:D,action:R,onProgress:y,onSuccess:b,onError:x,httpRequest:T}=r;try{m=await c(m??w,f)}catch{r.onRemove(f);return}const{uid:A}=f,P={headers:v||{},withCredentials:F,file:f,data:m,method:C,filename:D,action:R,onProgress:J=>{y(J,f)},onSuccess:J=>{b(J,f),delete n.value[A]},onError:J=>{x(J,f),delete n.value[A]}},U=T(P);n.value[A]=U,U instanceof Promise&&U.then(P.onSuccess,P.onError)},d=f=>{const m=f.target.files;m&&a(Array.from(m))},h=()=>{s.value||(o.value.value="",o.value.click())},p=()=>{h()};return t({abort:f=>{M2(n.value).filter(f?([v])=>String(f.uid)===v:()=>!0).forEach(([v,w])=>{w instanceof XMLHttpRequest&&w.abort(),delete n.value[v]})},upload:l}),(f,m)=>(ue(),Ie("div",{class:Ae([S(i).b(),S(i).m(f.listType),S(i).is("drag",f.drag)]),tabindex:"0",onClick:h,onKeydown:$i(zt(p,["self"]),["enter","space"])},[f.drag?(ue(),Je(oV,{key:0,disabled:S(s),onFile:a},{default:ze(()=>[Xe(f.$slots,"default")]),_:3},8,["disabled"])):Xe(f.$slots,"default",{key:1}),Oe("input",{ref_key:"inputRef",ref:o,class:Ae(S(i).e("input")),name:f.name,multiple:f.multiple,accept:f.accept,type:"file",onChange:d,onClick:m[0]||(m[0]=zt(()=>{},["stop"]))},null,42,cV)],42,lV))}});var cw=bt(dV,[["__file","upload-content.vue"]]);const uw="ElUpload",dw=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},hV=(e,t)=>{const r=_D(e,"fileList",void 0,{passive:!0}),i=h=>r.value.find(p=>p.uid===h.uid);function s(h){var p;(p=t.value)==null||p.abort(h)}function n(h=["ready","uploading","success","fail"]){r.value=r.value.filter(p=>!h.includes(p.status))}const o=(h,p)=>{const g=i(p);g&&(console.error(h),g.status="fail",r.value.splice(r.value.indexOf(g),1),e.onError(h,g,r.value),e.onChange(g,r.value))},a=(h,p)=>{const g=i(p);g&&(e.onProgress(h,g,r.value),g.status="uploading",g.percentage=Math.round(h.percent))},l=(h,p)=>{const g=i(p);g&&(g.status="success",g.response=h,e.onSuccess(h,g,r.value),e.onChange(g,r.value))},c=h=>{Pi(h.uid)&&(h.uid=Tp());const p={name:h.name,percentage:0,status:"ready",size:h.size,raw:h,uid:h.uid};if(e.listType==="picture-card"||e.listType==="picture")try{p.url=URL.createObjectURL(h)}catch(g){g.message,e.onError(g,p,r.value)}r.value=[...r.value,p],e.onChange(p,r.value)},u=async h=>{const p=h instanceof File?i(h):h;p||sn(uw,"file to be removed not found");const g=f=>{s(f);const m=r.value;m.splice(m.indexOf(f),1),e.onRemove(f,m),dw(f)};e.beforeRemove?await e.beforeRemove(p,r.value)!==!1&&g(p):g(p)};function d(){r.value.filter(({status:h})=>h==="ready").forEach(({raw:h})=>{var p;return h&&((p=t.value)==null?void 0:p.upload(h))})}return Qe(()=>e.listType,h=>{h!=="picture-card"&&h!=="picture"||(r.value=r.value.map(p=>{const{raw:g,url:f}=p;if(!f&&g)try{p.url=URL.createObjectURL(g)}catch(m){e.onError(m,p,r.value)}return p}))}),Qe(r,h=>{for(const p of h)p.uid||(p.uid=Tp()),p.status||(p.status="success")},{immediate:!0,deep:!0}),{uploadFiles:r,abort:s,clearFiles:n,handleError:o,handleProgress:a,handleStart:c,handleSuccess:l,handleRemove:u,submit:d,revokeFileObjectURL:dw}},fV=_e({name:"ElUpload"}),pV=_e({...fV,props:$H,setup(e,{expose:t}){const r=e,i=Wn(),s=dr(),{abort:n,submit:o,clearFiles:a,uploadFiles:l,handleStart:c,handleError:u,handleRemove:d,handleSuccess:h,handleProgress:p,revokeFileObjectURL:g}=hV(r,s),f=Q(()=>r.listType==="picture-card"),m=Q(()=>({...r,fileList:l.value,onStart:c,onProgress:p,onSuccess:h,onError:u,onRemove:d}));return Er(()=>{l.value.forEach(g)}),rr(P1,{accept:ii(r,"accept")}),t({abort:n,submit:o,clearFiles:a,handleStart:c,handleRemove:d}),(v,w)=>(ue(),Ie("div",null,[S(f)&&v.showFileList?(ue(),Je(lw,{key:0,disabled:S(i),"list-type":v.listType,files:S(l),crossorigin:v.crossorigin,"handle-preview":v.onPreview,onRemove:S(d)},Gm({append:ze(()=>[ye(cw,_t({ref_key:"uploadRef",ref:s},S(m)),{default:ze(()=>[v.$slots.trigger?Xe(v.$slots,"trigger",{key:0}):We("v-if",!0),!v.$slots.trigger&&v.$slots.default?Xe(v.$slots,"default",{key:1}):We("v-if",!0)]),_:3},16)]),_:2},[v.$slots.file?{name:"default",fn:ze(({file:C})=>[Xe(v.$slots,"file",{file:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):We("v-if",!0),!S(f)||S(f)&&!v.showFileList?(ue(),Je(cw,_t({key:1,ref_key:"uploadRef",ref:s},S(m)),{default:ze(()=>[v.$slots.trigger?Xe(v.$slots,"trigger",{key:0}):We("v-if",!0),!v.$slots.trigger&&v.$slots.default?Xe(v.$slots,"default",{key:1}):We("v-if",!0)]),_:3},16)):We("v-if",!0),v.$slots.trigger?Xe(v.$slots,"default",{key:2}):We("v-if",!0),Xe(v.$slots,"tip"),!S(f)&&v.showFileList?(ue(),Je(lw,{key:3,disabled:S(i),"list-type":v.listType,files:S(l),crossorigin:v.crossorigin,"handle-preview":v.onPreview,onRemove:S(d)},Gm({_:2},[v.$slots.file?{name:"default",fn:ze(({file:C})=>[Xe(v.$slots,"file",{file:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):We("v-if",!0)]))}});var gV=bt(pV,[["__file","upload.vue"]]);const mV=gr(gV);function vV(e){let t;const r=we(!1),i=Br({...e,originalPosition:"",originalOverflow:"",visible:!1});function s(h){i.text=h}function n(){const h=i.parent,p=d.ns;if(!h.vLoadingAddClassList){let g=h.getAttribute("loading-number");g=Number.parseInt(g)-1,g?h.setAttribute("loading-number",g.toString()):(md(h,p.bm("parent","relative")),h.removeAttribute("loading-number")),md(h,p.bm("parent","hidden"))}o(),u.unmount()}function o(){var h,p;(p=(h=d.$el)==null?void 0:h.parentNode)==null||p.removeChild(d.$el)}function a(){var h;e.beforeClose&&!e.beforeClose()||(r.value=!0,clearTimeout(t),t=window.setTimeout(l,400),i.visible=!1,(h=e.closed)==null||h.call(e))}function l(){if(!r.value)return;const h=i.parent;r.value=!1,h.vLoadingAddClassList=void 0,n()}const u=xx(_e({name:"ElLoading",setup(h,{expose:p}){const{ns:g,zIndex:f}=Ob("loading");return p({ns:g,zIndex:f}),()=>{const m=i.spinner||i.svg,v=yr("svg",{class:"circular",viewBox:i.svgViewBox?i.svgViewBox:"0 0 50 50",...m?{innerHTML:m}:{}},[yr("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),w=i.text?yr("p",{class:g.b("text")},[i.text]):void 0;return yr(Hn,{name:g.b("fade"),onAfterLeave:l},{default:ze(()=>[Yr(ye("div",{style:{backgroundColor:i.background||""},class:[g.b("mask"),i.customClass,i.fullscreen?"is-fullscreen":""]},[yr("div",{class:g.b("spinner")},[v,w])]),[[en,i.visible]])])})}}})),d=u.mount(document.createElement("div"));return{...Pc(i),setText:s,removeElLoadingChild:o,close:a,handleAfterLeave:l,vm:d,get $el(){return d.$el}}}let mu;const CV=function(e={}){if(!Nt)return;const t=wV(e);if(t.fullscreen&&mu)return mu;const r=vV({...t,closed:()=>{var s;(s=t.closed)==null||s.call(t),t.fullscreen&&(mu=void 0)}});SV(t,t.parent,r),hw(t,t.parent,r),t.parent.vLoadingAddClassList=()=>hw(t,t.parent,r);let i=t.parent.getAttribute("loading-number");return i?i=`${Number.parseInt(i)+1}`:i="1",t.parent.setAttribute("loading-number",i),t.parent.appendChild(r.$el),Tt(()=>r.visible.value=t.visible),t.fullscreen&&(mu=r),r},wV=e=>{var t,r,i,s;let n;return ct(e.target)?n=(t=document.querySelector(e.target))!=null?t:document.body:n=e.target||document.body,{parent:n===document.body||e.body?document.body:n,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:n===document.body&&((r=e.fullscreen)!=null?r:!0),lock:(i=e.lock)!=null?i:!1,customClass:e.customClass||"",visible:(s=e.visible)!=null?s:!0,target:n}},SV=async(e,t,r)=>{const{nextZIndex:i}=r.vm.zIndex||r.vm._.exposed.zIndex,s={};if(e.fullscreen)r.originalPosition.value=ll(document.body,"position"),r.originalOverflow.value=ll(document.body,"overflow"),s.zIndex=i();else if(e.parent===document.body){r.originalPosition.value=ll(document.body,"position"),await Tt();for(const n of["top","left"]){const o=n==="top"?"scrollTop":"scrollLeft";s[n]=`${e.target.getBoundingClientRect()[n]+document.body[o]+document.documentElement[o]-Number.parseInt(ll(document.body,`margin-${n}`),10)}px`}for(const n of["height","width"])s[n]=`${e.target.getBoundingClientRect()[n]}px`}else r.originalPosition.value=ll(t,"position");for(const[n,o]of Object.entries(s))r.$el.style[n]=o},hw=(e,t,r)=>{const i=r.vm.ns||r.vm._.exposed.ns;["absolute","fixed","sticky"].includes(r.originalPosition.value)?md(t,i.bm("parent","relative")):oC(t,i.bm("parent","relative")),e.fullscreen&&e.lock?oC(t,i.bm("parent","hidden")):md(t,i.bm("parent","hidden"))},qu=Symbol("ElLoading"),fw=(e,t)=>{var r,i,s,n;const o=t.instance,a=h=>ot(t.value)?t.value[h]:void 0,l=h=>{const p=ct(h)&&(o==null?void 0:o[h])||h;return p&&we(p)},c=h=>l(a(h)||e.getAttribute(`element-loading-${Gn(h)}`)),u=(r=a("fullscreen"))!=null?r:t.modifiers.fullscreen,d={text:c("text"),svg:c("svg"),svgViewBox:c("svgViewBox"),spinner:c("spinner"),background:c("background"),customClass:c("customClass"),fullscreen:u,target:(i=a("target"))!=null?i:u?void 0:e,body:(s=a("body"))!=null?s:t.modifiers.body,lock:(n=a("lock"))!=null?n:t.modifiers.lock};e[qu]={options:d,instance:CV(d)}},yV=(e,t)=>{for(const r of Object.keys(t))pr(t[r])&&(t[r].value=e[r])},xV={mounted(e,t){t.value&&fw(e,t)},updated(e,t){const r=e[qu];t.oldValue!==t.value&&(t.value&&!t.oldValue?fw(e,t):t.value&&t.oldValue?ot(t.value)&&yV(t.value,r.options):r==null||r.instance.close())},unmounted(e){var t;(t=e[qu])==null||t.instance.close(),e[qu]=null}},_1=["success","info","warning","error"],Zr=qs({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Nt?document.body:void 0}),bV=it({customClass:{type:String,default:Zr.customClass},center:{type:Boolean,default:Zr.center},dangerouslyUseHTMLString:{type:Boolean,default:Zr.dangerouslyUseHTMLString},duration:{type:Number,default:Zr.duration},icon:{type:Ao,default:Zr.icon},id:{type:String,default:Zr.id},message:{type:Me([String,Object,Function]),default:Zr.message},onClose:{type:Me(Function),required:!1},showClose:{type:Boolean,default:Zr.showClose},type:{type:String,values:_1,default:Zr.type},offset:{type:Number,default:Zr.offset},zIndex:{type:Number,default:Zr.zIndex},grouping:{type:Boolean,default:Zr.grouping},repeatNum:{type:Number,default:Zr.repeatNum}}),RV={destroy:()=>!0},Yi=xg([]),EV=e=>{const t=Yi.findIndex(s=>s.id===e),r=Yi[t];let i;return t>0&&(i=Yi[t-1]),{current:r,prev:i}},FV=e=>{const{prev:t}=EV(e);return t?t.vm.exposed.bottom.value:0},TV=(e,t)=>Yi.findIndex(i=>i.id===e)>0?16:t,AV=["id"],PV=["innerHTML"],DV=_e({name:"ElMessage"}),MV=_e({...DV,props:bV,emits:RV,setup(e,{expose:t}){const r=e,{Close:i}=pO,{ns:s,zIndex:n}=Ob("message"),{currentZIndex:o,nextZIndex:a}=n,l=we(),c=we(!1),u=we(0);let d;const h=Q(()=>r.type?r.type==="error"?"danger":r.type:"info"),p=Q(()=>{const y=r.type;return{[s.bm("icon",y)]:y&&aC[y]}}),g=Q(()=>r.icon||aC[r.type]||""),f=Q(()=>FV(r.id)),m=Q(()=>TV(r.id,r.offset)+f.value),v=Q(()=>u.value+m.value),w=Q(()=>({top:`${m.value}px`,zIndex:o.value}));function C(){r.duration!==0&&({stop:d}=mD(()=>{D()},r.duration))}function F(){d==null||d()}function D(){c.value=!1}function R({code:y}){y===ys.esc&&D()}return Gt(()=>{C(),a(),c.value=!0}),Qe(()=>r.repeatNum,()=>{F(),C()}),Ji(document,"keydown",R),ri(l,()=>{u.value=l.value.getBoundingClientRect().height}),t({visible:c,bottom:v,close:D}),(y,b)=>(ue(),Je(Hn,{name:S(s).b("fade"),onBeforeLeave:y.onClose,onAfterLeave:b[0]||(b[0]=x=>y.$emit("destroy")),persisted:""},{default:ze(()=>[Yr(Oe("div",{id:y.id,ref_key:"messageRef",ref:l,class:Ae([S(s).b(),{[S(s).m(y.type)]:y.type},S(s).is("center",y.center),S(s).is("closable",y.showClose),y.customClass]),style:kt(S(w)),role:"alert",onMouseenter:F,onMouseleave:C},[y.repeatNum>1?(ue(),Je(S(E4),{key:0,value:y.repeatNum,type:S(h),class:Ae(S(s).e("badge"))},null,8,["value","type","class"])):We("v-if",!0),S(g)?(ue(),Je(S(It),{key:1,class:Ae([S(s).e("icon"),S(p)])},{default:ze(()=>[(ue(),Je(kr(S(g))))]),_:1},8,["class"])):We("v-if",!0),Xe(y.$slots,"default",{},()=>[y.dangerouslyUseHTMLString?(ue(),Ie(Dt,{key:1},[We(" Caution here, message could've been compromised, never use user's input as message "),Oe("p",{class:Ae(S(s).e("content")),innerHTML:y.message},null,10,PV)],2112)):(ue(),Ie("p",{key:0,class:Ae(S(s).e("content"))},Ut(y.message),3))]),y.showClose?(ue(),Je(S(It),{key:2,class:Ae(S(s).e("closeBtn")),onClick:zt(D,["stop"])},{default:ze(()=>[ye(S(i))]),_:1},8,["class","onClick"])):We("v-if",!0)],46,AV),[[en,c.value]])]),_:3},8,["name","onBeforeLeave"]))}});var kV=bt(MV,[["__file","message.vue"]]);let _V=1;const I1=e=>{const t=!e||ct(e)||Lr(e)||Ye(e)?{message:e}:e,r={...Zr,...t};if(!r.appendTo)r.appendTo=document.body;else if(ct(r.appendTo)){let i=document.querySelector(r.appendTo);Ra(i)||(i=document.body),r.appendTo=i}return r},IV=e=>{const t=Yi.indexOf(e);if(t===-1)return;Yi.splice(t,1);const{handler:r}=e;r.close()},OV=({appendTo:e,...t},r)=>{const i=`message_${_V++}`,s=t.onClose,n=document.createElement("div"),o={...t,id:i,onClose:()=>{s==null||s(),IV(u)},onDestroy:()=>{cd(null,n)}},a=ye(kV,o,Ye(o.message)||Lr(o.message)?{default:Ye(o.message)?o.message:()=>o.message}:null);a.appContext=r||Ma._context,cd(a,n),e.appendChild(n.firstElementChild);const l=a.component,u={id:i,vnode:a,vm:l,handler:{close:()=>{l.exposed.visible.value=!1}},props:a.component.props};return u},Ma=(e={},t)=>{if(!Nt)return{close:()=>{}};if(dt(op.max)&&Yi.length>=op.max)return{close:()=>{}};const r=I1(e);if(r.grouping&&Yi.length){const s=Yi.find(({vnode:n})=>{var o;return((o=n.props)==null?void 0:o.message)===r.message});if(s)return s.props.repeatNum+=1,s.props.type=r.type,s.handler}const i=OV(r,t);return Yi.push(i),i.handler};_1.forEach(e=>{Ma[e]=(t={},r)=>{const i=I1(t);return Ma({...i,type:e},r)}});function LV(e){for(const t of Yi)(!e||e===t.props.type)&&t.handler.close()}Ma.closeAll=LV;Ma._context=null;const cf=gO(Ma,"$message");/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var O1=1252,NV=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S0=function(e){NV.indexOf(e)!=-1&&(O1=w0[0]=e)};function BV(){S0(1252)}var Xi=function(e){S0(e)};function L1(){Xi(1200),BV()}function pw(e){for(var t=[],r=0,i=e.length;r<i;++r)t[r]=e.charCodeAt(r);return t}function GV(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function N1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Cl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?GV(e.slice(2)):t==254&&r==255?N1(e.slice(2)):t==65279?e.slice(1):e},vu=function(t){return String.fromCharCode(t)},gw=function(t){return String.fromCharCode(t)},xn,Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mw(e){for(var t="",r=0,i=0,s=0,n=0,o=0,a=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),n=r>>2,i=e.charCodeAt(c++),o=(r&3)<<4|i>>4,s=e.charCodeAt(c++),a=(i&15)<<2|s>>6,l=s&63,isNaN(i)?a=l=64:isNaN(s)&&(l=64),t+=Fn.charAt(n)+Fn.charAt(o)+Fn.charAt(a)+Fn.charAt(l);return t}function wi(e){var t="",r=0,i=0,s=0,n=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=Fn.indexOf(e.charAt(c++)),o=Fn.indexOf(e.charAt(c++)),r=n<<2|o>>4,t+=String.fromCharCode(r),a=Fn.indexOf(e.charAt(c++)),i=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(i)),l=Fn.indexOf(e.charAt(c++)),s=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Go=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function On(e){return Ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function vw(e){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ki=function(t){return Ct?Go(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ho(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function y0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return y0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var bn=Ct?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Go(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var i=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)i.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";i.set(new Uint8Array(e[t]),r)}return i}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function HV(e){for(var t=[],r=0,i=e.length+250,s=On(e.length+255),n=0;n<e.length;++n){var o=e.charCodeAt(n);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++n)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|a>>6&15|(o&3)<<4,s[r++]=128|a&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>i&&(t.push(s.slice(0,r)),r=0,s=On(65535),i=65530)}return t.push(s.slice(0,r)),bn(t)}var Xr=/\u0000/g,wl=/[\u0001-\u0006]/g;function va(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Qi(e,t){var r=""+e;return r.length>=t?r:Yt("0",t-r.length)+r}function x0(e,t){var r=""+e;return r.length>=t?r:Yt(" ",t-r.length)+r}function yd(e,t){var r=""+e;return r.length>=t?r:r+Yt(" ",t-r.length)}function VV(e,t){var r=""+Math.round(e);return r.length>=t?r:Yt("0",t-r.length)+r}function WV(e,t){var r=""+e;return r.length>=t?r:Yt("0",t-r.length)+r}var Cw=Math.pow(2,32);function ea(e,t){if(e>Cw||e<-Cw)return VV(e,t);var r=Math.round(e);return WV(r,t)}function xd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ww=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],uf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zV(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Sw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$V={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bd(e,t,r){for(var i=e<0?-1:1,s=e*i,n=0,o=1,a=0,l=1,c=0,u=0,d=Math.floor(s);c<t&&(d=Math.floor(s),a=d*o+n,u=d*c+l,!(s-d<5e-8));)s=1/(s-d),n=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=n):(u=c,a=o)),!r)return[0,i*a,u];var h=Math.floor(i*a/u);return[h,i*a-h*u,u]}function fo(e,t,r){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),n=0,o=[],a={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(i+=1462),a.u>.9999&&(a.u=0,++s==86400&&(a.T=s=0,++i,++a.D)),i===60)o=r?[1317,10,29]:[1900,2,29],n=3;else if(i===0)o=r?[1317,8,29]:[1900,1,0],n=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),i<60&&(n=(n+6)%7),r&&(n=XV(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=s%60,s=Math.floor(s/60),a.M=s%60,s=Math.floor(s/60),a.H=s,a.q=n,a}var B1=new Date(1899,11,31,0,0,0),UV=B1.getTime(),KV=new Date(1900,2,1,0,0,0);function G1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=KV&&(r+=24*60*60*1e3),(r-(UV+(e.getTimezoneOffset()-B1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function b0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jV(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qV(e){var t=e<0?12:11,r=b0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function YV(e){var t=b0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function pc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=qV(e):t===10?r=e.toFixed(10).substr(0,12):r=YV(e),b0(jV(r.toUpperCase()))}function Mo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Oi(14,G1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function XV(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function QV(e,t,r,i){var s="",n=0,o=0,a=r.y,l,c=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return uf[r.m-1][1];case 5:return uf[r.m-1][0];default:return uf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return ww[r.q][0];default:return ww[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Qi(r.S,t.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,n=Math.round(o*(r.S+r.u)),n>=60*o&&(n=0),t==="s"?n===0?"0":""+n/o:(s=Qi(n,2+i),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Qi(l,c):"";return u}function Tn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,i=e.substr(0,r);r!=e.length;r+=t)i+=(i.length>0?",":"")+e.substr(r,t);return i}var H1=/%/g;function JV(e,t,r){var i=t.replace(H1,""),s=t.length-i.length;return zs(e,i,r*Math.pow(10,2*s))+Yt("%",s)}function ZV(e,t,r){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return zs(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}function V1(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+V1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(s+n)%s)+"."+u.substr(n)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var W1=/# (\?+)( ?)\/( ?)(\d+)/;function e8(e,t,r){var i=parseInt(e[4],10),s=Math.round(t*i),n=Math.floor(s/i),o=s-n*i,a=i;return r+(n===0?"":""+n)+" "+(o===0?Yt(" ",e[1].length+1+e[4].length):x0(o,e[1].length)+e[2]+"/"+e[3]+Qi(a,e[4].length))}function t8(e,t,r){return r+(t===0?"":""+t)+Yt(" ",e[1].length+2+e[4].length)}var z1=/^#*0*\.([0#]+)/,$1=/\).*[0#]/,U1=/\(###\) ###\\?-####/;function Wr(e){for(var t="",r,i=0;i!=e.length;++i)switch(r=e.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function yw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function xw(e,t){var r=e-Math.floor(e),i=Math.pow(10,t);return t<(""+Math.round(r*i)).length?0:Math.round(r*i)}function r8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function i8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function bi(e,t,r){if(e.charCodeAt(0)===40&&!t.match($1)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bi("n",i,r):"("+bi("n",i,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ZV(e,t,r);if(t.indexOf("%")!==-1)return JV(e,t,r);if(t.indexOf("E")!==-1)return V1(t,r);if(t.charCodeAt(0)===36)return"$"+bi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ea(l,t.length);if(t.match(/^[#?]+$/))return s=ea(r,0),s==="0"&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(W1))return e8(n,l,c);if(t.match(/^#+0+$/))return c+ea(l,t.length-t.indexOf("0"));if(n=t.match(z1))return s=yw(r,n[1].length).replace(/^([^\.]+)$/,"$1."+Wr(n[1])).replace(/\.$/,"."+Wr(n[1])).replace(/\.(\d*)$/,function(g,f){return"."+f+Yt("0",Wr(n[1]).length-f.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+yw(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Tn(ea(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bi(e,t,-r):Tn(""+(Math.floor(r)+r8(r,n[1].length)))+"."+Qi(xw(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return bi(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=va(bi(e,t.replace(/[\\-]/g,""),r)),o=0,va(va(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(U1))return s=bi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=bd(l,Math.pow(10,o)-1,!1),s=""+c,u=zs("n",n[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+n[2]+"/"+n[3],u=yd(a[2],o),u.length<n[4].length&&(u=Wr(n[4].substr(n[4].length-u.length))+u),s+=u,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),a=bd(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?x0(a[1],o)+n[2]+"/"+n[3]+yd(a[2],o):Yt(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=ea(r,0),t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=t.indexOf(".")-o,h=t.length-s.length-d;return Wr(t.substr(0,d)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return o=xw(r,n[1].length),r<0?"-"+bi(e,t,-r):Tn(i8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Qi(0,3-g.length):"")+g})+"."+Qi(o,n[1].length);switch(t){case"###,##0.00":return bi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Tn(ea(l,0));return p!=="0"?c+p:"";case"###,###.00":return bi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return bi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function s8(e,t,r){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return zs(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}function n8(e,t,r){var i=t.replace(H1,""),s=t.length-i.length;return zs(e,i,r*Math.pow(10,2*s))+Yt("%",s)}function K1(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(s+n)%s)+"."+u.substr(n)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function gs(e,t,r){if(e.charCodeAt(0)===40&&!t.match($1)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gs("n",i,r):"("+gs("n",i,-r)+")"}if(t.charCodeAt(t.length-1)===44)return s8(e,t,r);if(t.indexOf("%")!==-1)return n8(e,t,r);if(t.indexOf("E")!==-1)return K1(t,r);if(t.charCodeAt(0)===36)return"$"+gs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Qi(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(W1))return t8(n,l,c);if(t.match(/^#+0+$/))return c+Qi(l,t.length-t.indexOf("0"));if(n=t.match(z1))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Wr(n[1])).replace(/\.$/,"."+Wr(n[1])),s=s.replace(/\.(\d*)$/,function(g,f){return"."+f+Yt("0",Wr(n[1]).length-f.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Tn(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gs(e,t,-r):Tn(""+r)+"."+Yt("0",n[1].length);if(n=t.match(/^#,#*,#0/))return gs(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=va(gs(e,t.replace(/[\\-]/g,""),r)),o=0,va(va(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(U1))return s=gs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=bd(l,Math.pow(10,o)-1,!1),s=""+c,u=zs("n",n[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+n[2]+"/"+n[3],u=yd(a[2],o),u.length<n[4].length&&(u=Wr(n[4].substr(n[4].length-u.length))+u),s+=u,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),a=bd(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?x0(a[1],o)+n[2]+"/"+n[3]+yd(a[2],o):Yt(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=t.indexOf(".")-o,h=t.length-s.length-d;return Wr(t.substr(0,d)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+gs(e,t,-r):Tn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Qi(0,3-g.length):"")+g})+"."+Qi(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Tn(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return gs(e,t.slice(0,t.lastIndexOf(".")),r)+Wr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function zs(e,t,r){return(r|0)===r?gs(e,t,r):bi(e,t,r)}function o8(e){for(var t=[],r=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=e.substr(s,i-s),s=i+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var j1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ka(e){for(var t=0,r="",i="";t<e.length;)switch(r=e.charAt(t)){case"G":xd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=r;e.charAt(t++)!=="]"&&t<e.length;)i+=e.charAt(t);if(i.match(j1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function a8(e,t,r,i){for(var s=[],n="",o=0,a="",l="t",c,u,d,h="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!xd(e,o))throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";(d=e.charCodeAt(++o))!==34&&o<e.length;)n+=String.fromCharCode(d);s[s.length]={t:"t",v:n},++o;break;case"\\":var p=e.charAt(++o),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=fo(t,r,e.charAt(o+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=fo(t,r),c==null))return"";for(n=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)n+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=h),s[s.length]={t:a,v:n},l=a;break;case"A":case"a":case"上":var f={t:a,v:a};if(c==null&&(c=fo(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(f.v=c.H>=12?"P":"A"),f.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(f.v=c.H>=12?"PM":"AM"),f.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(f.v=c.H>=12?"下午":"上午"),f.t="T",o+=5,h="h"):(f.t="t",++o),c==null&&f.t==="T")return"";s[s.length]=f,l=a;break;case"[":for(n=a;e.charAt(o++)!=="]"&&o<e.length;)n+=e.charAt(o);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(j1)){if(c==null&&(c=fo(t,r),c==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ka(e)||(s[s.length]={t:"t",v:n}));break;case".":if(c!=null){for(n=a;++o<e.length&&(a=e.charAt(o))==="0";)n+=a;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)n+=a;s[s.length]={t:"n",v:n};break;case"?":for(n=a;e.charAt(++o)===a;)n+=a;s[s.length]={t:a,v:n},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:i===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)n+=e.charAt(o);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:a,v:a},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"t",v:a},++o;break}var m=0,v=0,w;for(o=s.length-1,l="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,l="h",m<1&&(m=1);break;case"s":(w=s[o].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=s[o].t;break;case"m":l==="s"&&(s[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&s[o].v.match(/[Hh]/)&&(m=1),m<2&&s[o].v.match(/[Mm]/)&&(m=2),m<3&&s[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var C="",F;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=QV(s[o].t.charCodeAt(0),s[o].v,c,v),s[o].t="t";break;case"n":case"?":for(F=o+1;s[F]!=null&&((a=s[F].t)==="?"||a==="D"||(a===" "||a==="t")&&s[F+1]!=null&&(s[F+1].t==="?"||s[F+1].t==="t"&&s[F+1].v==="/")||s[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(s[F].v==="/"||s[F].v===" "&&s[F+1]!=null&&s[F+1].t=="?"));)s[o].v+=s[F].v,s[F]={v:"",t:";"},++F;C+=s[o].v,o=F-1;break;case"G":s[o].t="t",s[o].v=Mo(t,r);break}var D="",R,y;if(C.length>0){C.charCodeAt(0)==40?(R=t<0&&C.charCodeAt(0)===45?-t:t,y=zs("n",C,R)):(R=t<0&&i>1?-t:t,y=zs("n",C,R),R<0&&s[0]&&s[0].t=="t"&&(y=y.substr(1),s[0].v="-"+s[0].v)),F=y.length-1;var b=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){b=o;break}var x=s.length;if(b===s.length&&y.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(F>=s[o].v.length-1?(F-=s[o].v.length,s[o].v=y.substr(F+1,s[o].v.length)):F<0?s[o].v="":(s[o].v=y.substr(0,F+1),F=-1),s[o].t="t",x=o);F>=0&&x<s.length&&(s[x].v=y.substr(0,F+1)+s[x].v)}else if(b!==s.length&&y.indexOf("E")===-1){for(F=y.indexOf(".")-1,o=b;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===b?s[o].v.indexOf(".")-1:s[o].v.length-1,D=s[o].v.substr(u+1);u>=0;--u)F>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(D=y.charAt(F--)+D);s[o].v=D,s[o].t="t",x=o}for(F>=0&&x<s.length&&(s[x].v=y.substr(0,F+1)+s[x].v),F=y.indexOf(".")+1,o=b;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==b)){for(u=s[o].v.indexOf(".")>-1&&o===b?s[o].v.indexOf(".")+1:0,D=s[o].v.substr(0,u);u<s[o].v.length;++u)F<y.length&&(D+=y.charAt(F++));s[o].v=D,s[o].t="t",x=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(R=i>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=zs(s[o].t,s[o].v,R),s[o].t="t");var T="";for(o=0;o!==s.length;++o)s[o]!=null&&(T+=s[o].v);return T}var bw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Rw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function l8(e,t){var r=o8(e),i=r.length,s=r[i-1].indexOf("@");if(i<4&&s>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[i,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(bw),a=r[1].match(bw);return Rw(t,o)?[i,r[0]]:Rw(t,a)?[i,r[1]]:[i,r[o!=null&&a!=null?2:1]]}return[i,n]}function Oi(e,t,r){r==null&&(r={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?i=r.dateNF:i=e;break;case"number":e==14&&r.dateNF?i=r.dateNF:i=(r.table!=null?r.table:lt)[e],i==null&&(i=r.table&&r.table[Sw[e]]||lt[Sw[e]]),i==null&&(i=$V[e]||"General");break}if(xd(i,0))return Mo(t,r);t instanceof Date&&(t=G1(t,r.date1904));var s=l8(i,t);if(xd(s[1]))return Mo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return a8(s[1],t,r,s[0])}function wo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(lt[r]==null){t<0&&(t=r);continue}if(lt[r]==e){t=r;break}}t<0&&(t=391)}return lt[t]=e,t}function q1(){lt=zV()}var c8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Y1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function u8(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(Y1,"(\\d+)"),new RegExp("^"+t+"$")}function d8(e,t,r){var i=-1,s=-1,n=-1,o=-1,a=-1,l=-1;(t.match(Y1)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":i=p;break;case"d":n=p;break;case"h":o=p;break;case"s":l=p;break;case"m":o>=0?a=p:s=p;break}}),l>=0&&a==-1&&s>=0&&(a=s,s=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:i==-1&&s==-1&&n==-1?u:c+"T"+u}var h8=function(){var e={};e.version="1.2.0";function t(){for(var y=0,b=new Array(256),x=0;x!=256;++x)y=x,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,b[x]=y;return typeof Int32Array<"u"?new Int32Array(b):b}var r=t();function i(y){var b=0,x=0,T=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)A[T]=y[T];for(T=0;T!=256;++T)for(x=y[T],b=256+T;b<4096;b+=256)x=A[b]=x>>>8^y[x&255];var P=[];for(T=1;T!=16;++T)P[T-1]=typeof Int32Array<"u"?A.subarray(T*256,T*256+256):A.slice(T*256,T*256+256);return P}var s=i(r),n=s[0],o=s[1],a=s[2],l=s[3],c=s[4],u=s[5],d=s[6],h=s[7],p=s[8],g=s[9],f=s[10],m=s[11],v=s[12],w=s[13],C=s[14];function F(y,b){for(var x=b^-1,T=0,A=y.length;T<A;)x=x>>>8^r[(x^y.charCodeAt(T++))&255];return~x}function D(y,b){for(var x=b^-1,T=y.length-15,A=0;A<T;)x=C[y[A++]^x&255]^w[y[A++]^x>>8&255]^v[y[A++]^x>>16&255]^m[y[A++]^x>>>24]^f[y[A++]]^g[y[A++]]^p[y[A++]]^h[y[A++]]^d[y[A++]]^u[y[A++]]^c[y[A++]]^l[y[A++]]^a[y[A++]]^o[y[A++]]^n[y[A++]]^r[y[A++]];for(T+=15;A<T;)x=x>>>8^r[(x^y[A++])&255];return~x}function R(y,b){for(var x=b^-1,T=0,A=y.length,P=0,U=0;T<A;)P=y.charCodeAt(T++),P<128?x=x>>>8^r[(x^P)&255]:P<2048?(x=x>>>8^r[(x^(192|P>>6&31))&255],x=x>>>8^r[(x^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,U=y.charCodeAt(T++)&1023,x=x>>>8^r[(x^(240|P>>8&7))&255],x=x>>>8^r[(x^(128|P>>2&63))&255],x=x>>>8^r[(x^(128|U>>6&15|(P&3)<<4))&255],x=x>>>8^r[(x^(128|U&63))&255]):(x=x>>>8^r[(x^(224|P>>12&15))&255],x=x>>>8^r[(x^(128|P>>6&63))&255],x=x>>>8^r[(x^(128|P&63))&255]);return~x}return e.table=r,e.bstr=F,e.buf=D,e.str=R,e}(),yt=function(){var t={};t.version="1.2.1";function r(E,k){for(var O=E.split("/"),N=k.split("/"),K=0,q=0,de=Math.min(O.length,N.length);K<de;++K){if(q=O[K].length-N[K].length)return q;if(O[K]!=N[K])return O[K]<N[K]?-1:1}return O.length-N.length}function i(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:i(E.slice(0,-1));var k=E.lastIndexOf("/");return k===-1?E:E.slice(0,k+1)}function s(E){if(E.charAt(E.length-1)=="/")return s(E.slice(0,-1));var k=E.lastIndexOf("/");return k===-1?E:E.slice(k+1)}function n(E,k){typeof k=="string"&&(k=new Date(k));var O=k.getHours();O=O<<6|k.getMinutes(),O=O<<5|k.getSeconds()>>>1,E.write_shift(2,O);var N=k.getFullYear()-1980;N=N<<4|k.getMonth()+1,N=N<<5|k.getDate(),E.write_shift(2,N)}function o(E){var k=E.read_shift(2)&65535,O=E.read_shift(2)&65535,N=new Date,K=O&31;O>>>=5;var q=O&15;O>>>=4,N.setMilliseconds(0),N.setFullYear(O+1980),N.setMonth(q-1),N.setDate(K);var de=k&31;k>>>=5;var Ee=k&63;return k>>>=6,N.setHours(k),N.setMinutes(Ee),N.setSeconds(de<<1),N}function a(E){wr(E,0);for(var k={},O=0;E.l<=E.length-4;){var N=E.read_shift(2),K=E.read_shift(2),q=E.l+K,de={};switch(N){case 21589:O=E.read_shift(1),O&1&&(de.mtime=E.read_shift(4)),K>5&&(O&2&&(de.atime=E.read_shift(4)),O&4&&(de.ctime=E.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}E.l=q,k[N]=de}return k}var l;function c(){return l||(l={})}function u(E,k){if(E[0]==80&&E[1]==75)return Cr(E,k);if((E[0]|32)==109&&(E[1]|32)==105)return kh(E,k);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var O=3,N=512,K=0,q=0,de=0,Ee=0,ce=0,ge=[],Se=E.slice(0,512);wr(Se,0);var Le=d(Se);switch(O=Le[0],O){case 3:N=512;break;case 4:N=4096;break;case 0:if(Le[1]==0)return Cr(E,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}N!==512&&(Se=E.slice(0,N),wr(Se,28));var Ge=E.slice(0,N);h(Se,O);var je=Se.read_shift(4,"i");if(O===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);Se.l+=4,de=Se.read_shift(4,"i"),Se.l+=4,Se.chk("00100000","Mini Stream Cutoff Size: "),Ee=Se.read_shift(4,"i"),K=Se.read_shift(4,"i"),ce=Se.read_shift(4,"i"),q=Se.read_shift(4,"i");for(var Be=-1,Ke=0;Ke<109&&(Be=Se.read_shift(4,"i"),!(Be<0));++Ke)ge[Ke]=Be;var nt=p(E,N);m(ce,q,nt,N,ge);var jt=w(nt,de,ge,N);jt[de].name="!Directory",K>0&&Ee!==U&&(jt[Ee].name="!MiniFAT"),jt[ge[0]].name="!FAT",jt.fat_addrs=ge,jt.ssz=N;var qt={},Fr=[],rl=[],il=[];C(de,jt,nt,Fr,K,qt,rl,Ee),g(rl,il,Fr),Fr.shift();var sl={FileIndex:rl,FullPaths:il};return k&&k.raw&&(sl.raw={header:Ge,sectors:nt}),sl}function d(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(J,"Header Signature: "),E.l+=16;var k=E.read_shift(2,"u");return[E.read_shift(2,"u"),k]}function h(E,k){var O=9;switch(E.l+=2,O=E.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function p(E,k){for(var O=Math.ceil(E.length/k)-1,N=[],K=1;K<O;++K)N[K-1]=E.slice(K*k,(K+1)*k);return N[O-1]=E.slice(O*k),N}function g(E,k,O){for(var N=0,K=0,q=0,de=0,Ee=0,ce=O.length,ge=[],Se=[];N<ce;++N)ge[N]=Se[N]=N,k[N]=O[N];for(;Ee<Se.length;++Ee)N=Se[Ee],K=E[N].L,q=E[N].R,de=E[N].C,ge[N]===N&&(K!==-1&&ge[K]!==K&&(ge[N]=ge[K]),q!==-1&&ge[q]!==q&&(ge[N]=ge[q])),de!==-1&&(ge[de]=N),K!==-1&&N!=ge[N]&&(ge[K]=ge[N],Se.lastIndexOf(K)<Ee&&Se.push(K)),q!==-1&&N!=ge[N]&&(ge[q]=ge[N],Se.lastIndexOf(q)<Ee&&Se.push(q));for(N=1;N<ce;++N)ge[N]===N&&(q!==-1&&ge[q]!==q?ge[N]=ge[q]:K!==-1&&ge[K]!==K&&(ge[N]=ge[K]));for(N=1;N<ce;++N)if(E[N].type!==0){if(Ee=N,Ee!=ge[Ee])do Ee=ge[Ee],k[N]=k[Ee]+"/"+k[N];while(Ee!==0&&ge[Ee]!==-1&&Ee!=ge[Ee]);ge[N]=-1}for(k[0]+="/",N=1;N<ce;++N)E[N].type!==2&&(k[N]+="/")}function f(E,k,O){for(var N=E.start,K=E.size,q=[],de=N;O&&K>0&&de>=0;)q.push(k.slice(de*P,de*P+P)),K-=P,de=so(O,de*4);return q.length===0?sr(0):bn(q).slice(0,E.size)}function m(E,k,O,N,K){var q=U;if(E===U){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var de=O[E],Ee=(N>>>2)-1;if(!de)return;for(var ce=0;ce<Ee&&(q=so(de,ce*4))!==U;++ce)K.push(q);m(so(de,N-4),k-1,O,N,K)}}function v(E,k,O,N,K){var q=[],de=[];K||(K=[]);var Ee=N-1,ce=0,ge=0;for(ce=k;ce>=0;){K[ce]=!0,q[q.length]=ce,de.push(E[ce]);var Se=O[Math.floor(ce*4/N)];if(ge=ce*4&Ee,N<4+ge)throw new Error("FAT boundary crossed: "+ce+" 4 "+N);if(!E[Se])break;ce=so(E[Se],ge)}return{nodes:q,data:Iw([de])}}function w(E,k,O,N){var K=E.length,q=[],de=[],Ee=[],ce=[],ge=N-1,Se=0,Le=0,Ge=0,je=0;for(Se=0;Se<K;++Se)if(Ee=[],Ge=Se+k,Ge>=K&&(Ge-=K),!de[Ge]){ce=[];var Be=[];for(Le=Ge;Le>=0;){Be[Le]=!0,de[Le]=!0,Ee[Ee.length]=Le,ce.push(E[Le]);var Ke=O[Math.floor(Le*4/N)];if(je=Le*4&ge,N<4+je)throw new Error("FAT boundary crossed: "+Le+" 4 "+N);if(!E[Ke]||(Le=so(E[Ke],je),Be[Le]))break}q[Ge]={nodes:Ee,data:Iw([ce])}}return q}function C(E,k,O,N,K,q,de,Ee){for(var ce=0,ge=N.length?2:0,Se=k[E].data,Le=0,Ge=0,je;Le<Se.length;Le+=128){var Be=Se.slice(Le,Le+128);wr(Be,64),Ge=Be.read_shift(2),je=A0(Be,0,Ge-ge),N.push(je);var Ke={name:je,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},nt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);nt!==0&&(Ke.ct=F(Be,Be.l-8));var jt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);jt!==0&&(Ke.mt=F(Be,Be.l-8)),Ke.start=Be.read_shift(4,"i"),Ke.size=Be.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=U,Ke.name=""),Ke.type===5?(ce=Ke.start,K>0&&ce!==U&&(k[ce].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",k[Ke.start]===void 0&&(k[Ke.start]=v(O,Ke.start,k.fat_addrs,k.ssz)),k[Ke.start].name=Ke.name,Ke.content=k[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:ce!==U&&Ke.start!==U&&k[ce]&&(Ke.content=f(Ke,k[ce].data,(k[Ee]||{}).data))),Ke.content&&wr(Ke.content,0),q[je]=Ke,de.push(Ke)}}function F(E,k){return new Date((fi(E,k+4)/1e7*Math.pow(2,32)+fi(E,k)/1e7-11644473600)*1e3)}function D(E,k){return c(),u(l.readFileSync(E),k)}function R(E,k){var O=k&&k.type;switch(O||Ct&&Buffer.isBuffer(E)&&(O="buffer"),O||"base64"){case"file":return D(E,k);case"base64":return u(Ki(wi(E)),k);case"binary":return u(Ki(E),k)}return u(E,k)}function y(E,k){var O=k||{},N=O.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=N+"/",E.FileIndex[0]={name:N,type:5}),O.CLSID&&(E.FileIndex[0].clsid=O.CLSID),b(E)}function b(E){var k="Sh33tJ5";if(!yt.find(E,"/"+k)){var O=sr(4);O[0]=55,O[1]=O[3]=50,O[2]=54,E.FileIndex.push({name:k,type:2,content:O,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+k),x(E)}}function x(E,k){y(E);for(var O=!1,N=!1,K=E.FullPaths.length-1;K>=0;--K){var q=E.FileIndex[K];switch(q.type){case 0:N?O=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(q.R*q.L*q.C)&&(O=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!k)){var de=new Date(1987,1,19),Ee=0,ce=Object.create?Object.create(null):{},ge=[];for(K=0;K<E.FullPaths.length;++K)ce[E.FullPaths[K]]=!0,E.FileIndex[K].type!==0&&ge.push([E.FullPaths[K],E.FileIndex[K]]);for(K=0;K<ge.length;++K){var Se=i(ge[K][0]);N=ce[Se],N||(ge.push([Se,{name:s(Se).replace("/",""),type:1,clsid:H,ct:de,mt:de,content:null}]),ce[Se]=!0)}for(ge.sort(function(je,Be){return r(je[0],Be[0])}),E.FullPaths=[],E.FileIndex=[],K=0;K<ge.length;++K)E.FullPaths[K]=ge[K][0],E.FileIndex[K]=ge[K][1];for(K=0;K<ge.length;++K){var Le=E.FileIndex[K],Ge=E.FullPaths[K];if(Le.name=s(Ge).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||H,K===0)Le.C=ge.length>1?1:-1,Le.size=0,Le.type=5;else if(Ge.slice(-1)=="/"){for(Ee=K+1;Ee<ge.length&&i(E.FullPaths[Ee])!=Ge;++Ee);for(Le.C=Ee>=ge.length?-1:Ee,Ee=K+1;Ee<ge.length&&i(E.FullPaths[Ee])!=i(Ge);++Ee);Le.R=Ee>=ge.length?-1:Ee,Le.type=1}else i(E.FullPaths[K+1]||"")==i(Ge)&&(Le.R=K+1),Le.type=2}}}function T(E,k){var O=k||{};if(O.fileType=="mad")return _h(E,O);switch(x(E),O.fileType){case"zip":return el(E,O)}var N=function(je){for(var Be=0,Ke=0,nt=0;nt<je.FileIndex.length;++nt){var jt=je.FileIndex[nt];if(jt.content){var qt=jt.content.length;qt>0&&(qt<4096?Be+=qt+63>>6:Ke+=qt+511>>9)}}for(var Fr=je.FullPaths.length+3>>2,rl=Be+7>>3,il=Be+127>>7,sl=rl+Ke+Fr+il,jn=sl+127>>7,Nh=jn<=109?0:Math.ceil((jn-109)/127);sl+jn+Nh+127>>7>jn;)Nh=++jn<=109?0:Math.ceil((jn-109)/127);var Ds=[1,Nh,jn,il,Fr,Ke,Be,0];return je.FileIndex[0].size=Be<<6,Ds[7]=(je.FileIndex[0].start=Ds[0]+Ds[1]+Ds[2]+Ds[3]+Ds[4]+Ds[5])+(Ds[6]+7>>3),Ds}(E),K=sr(N[7]<<9),q=0,de=0;{for(q=0;q<8;++q)K.write_shift(1,B[q]);for(q=0;q<8;++q)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),q=0;q<3;++q)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,N[2]),K.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:U),K.write_shift(4,N[3]),K.write_shift(-4,N[1]?N[0]-1:U),K.write_shift(4,N[1]),q=0;q<109;++q)K.write_shift(-4,q<N[2]?N[1]+q:-1)}if(N[1])for(de=0;de<N[1];++de){for(;q<236+de*127;++q)K.write_shift(-4,q<N[2]?N[1]+q:-1);K.write_shift(-4,de===N[1]-1?U:de+1)}var Ee=function(je){for(de+=je;q<de-1;++q)K.write_shift(-4,q+1);je&&(++q,K.write_shift(-4,U))};for(de=q=0,de+=N[1];q<de;++q)K.write_shift(-4,_.DIFSECT);for(de+=N[2];q<de;++q)K.write_shift(-4,_.FATSECT);Ee(N[3]),Ee(N[4]);for(var ce=0,ge=0,Se=E.FileIndex[0];ce<E.FileIndex.length;++ce)Se=E.FileIndex[ce],Se.content&&(ge=Se.content.length,!(ge<4096)&&(Se.start=de,Ee(ge+511>>9)));for(Ee(N[6]+7>>3);K.l&511;)K.write_shift(-4,_.ENDOFCHAIN);for(de=q=0,ce=0;ce<E.FileIndex.length;++ce)Se=E.FileIndex[ce],Se.content&&(ge=Se.content.length,!(!ge||ge>=4096)&&(Se.start=de,Ee(ge+63>>6)));for(;K.l&511;)K.write_shift(-4,_.ENDOFCHAIN);for(q=0;q<N[4]<<2;++q){var Le=E.FullPaths[q];if(!Le||Le.length===0){for(ce=0;ce<17;++ce)K.write_shift(4,0);for(ce=0;ce<3;++ce)K.write_shift(4,-1);for(ce=0;ce<12;++ce)K.write_shift(4,0);continue}Se=E.FileIndex[q],q===0&&(Se.start=Se.size?Se.start-1:U);var Ge=q===0&&O.root||Se.name;if(ge=2*(Ge.length+1),K.write_shift(64,Ge,"utf16le"),K.write_shift(2,ge),K.write_shift(1,Se.type),K.write_shift(1,Se.color),K.write_shift(-4,Se.L),K.write_shift(-4,Se.R),K.write_shift(-4,Se.C),Se.clsid)K.write_shift(16,Se.clsid,"hex");else for(ce=0;ce<4;++ce)K.write_shift(4,0);K.write_shift(4,Se.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,Se.start),K.write_shift(4,Se.size),K.write_shift(4,0)}for(q=1;q<E.FileIndex.length;++q)if(Se=E.FileIndex[q],Se.size>=4096)if(K.l=Se.start+1<<9,Ct&&Buffer.isBuffer(Se.content))Se.content.copy(K,K.l,0,Se.size),K.l+=Se.size+511&-512;else{for(ce=0;ce<Se.size;++ce)K.write_shift(1,Se.content[ce]);for(;ce&511;++ce)K.write_shift(1,0)}for(q=1;q<E.FileIndex.length;++q)if(Se=E.FileIndex[q],Se.size>0&&Se.size<4096)if(Ct&&Buffer.isBuffer(Se.content))Se.content.copy(K,K.l,0,Se.size),K.l+=Se.size+63&-64;else{for(ce=0;ce<Se.size;++ce)K.write_shift(1,Se.content[ce]);for(;ce&63;++ce)K.write_shift(1,0)}if(Ct)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function A(E,k){var O=E.FullPaths.map(function(ce){return ce.toUpperCase()}),N=O.map(function(ce){var ge=ce.split("/");return ge[ge.length-(ce.slice(-1)=="/"?2:1)]}),K=!1;k.charCodeAt(0)===47?(K=!0,k=O[0].slice(0,-1)+k):K=k.indexOf("/")!==-1;var q=k.toUpperCase(),de=K===!0?O.indexOf(q):N.indexOf(q);if(de!==-1)return E.FileIndex[de];var Ee=!q.match(wl);for(q=q.replace(Xr,""),Ee&&(q=q.replace(wl,"!")),de=0;de<O.length;++de)if((Ee?O[de].replace(wl,"!"):O[de]).replace(Xr,"")==q||(Ee?N[de].replace(wl,"!"):N[de]).replace(Xr,"")==q)return E.FileIndex[de];return null}var P=64,U=-2,J="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],H="00000000000000000000000000000000",_={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(E,k,O){c();var N=T(E,O);l.writeFileSync(k,N)}function G(E){for(var k=new Array(E.length),O=0;O<E.length;++O)k[O]=String.fromCharCode(E[O]);return k.join("")}function he(E,k){var O=T(E,k);switch(k&&k.type||"buffer"){case"file":return c(),l.writeFileSync(k.filename,O),O;case"binary":return typeof O=="string"?O:G(O);case"base64":return mw(typeof O=="string"?O:G(O));case"buffer":if(Ct)return Buffer.isBuffer(O)?O:Go(O);case"array":return typeof O=="string"?Ki(O):O}return O}var Re;function M(E){try{var k=E.InflateRaw,O=new k;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Re=E;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function X(E,k){if(!Re)return Ps(E,k);var O=Re.InflateRaw,N=new O,K=N._processChunk(E.slice(E.l),N._finishFlushFlag);return E.l+=N.bytesRead,K}function z(E){return Re?Re.deflateRawSync(E):$e(E)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(E){var k=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(k>>16|k>>8|k)&255}for(var Z=typeof Uint8Array<"u",ee=Z?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)ee[Fe]=re(Fe);function L(E,k){var O=ee[E&255];return k<=8?O>>>8-k:(O=O<<8|ee[E>>8&255],k<=16?O>>>16-k:(O=O<<8|ee[E>>16&255],O>>>24-k))}function I(E,k){var O=k&7,N=k>>>3;return(E[N]|(O<=6?0:E[N+1]<<8))>>>O&3}function V(E,k){var O=k&7,N=k>>>3;return(E[N]|(O<=5?0:E[N+1]<<8))>>>O&7}function ie(E,k){var O=k&7,N=k>>>3;return(E[N]|(O<=4?0:E[N+1]<<8))>>>O&15}function ne(E,k){var O=k&7,N=k>>>3;return(E[N]|(O<=3?0:E[N+1]<<8))>>>O&31}function j(E,k){var O=k&7,N=k>>>3;return(E[N]|(O<=1?0:E[N+1]<<8))>>>O&127}function oe(E,k,O){var N=k&7,K=k>>>3,q=(1<<O)-1,de=E[K]>>>N;return O<8-N||(de|=E[K+1]<<8-N,O<16-N)||(de|=E[K+2]<<16-N,O<24-N)||(de|=E[K+3]<<24-N),de&q}function pe(E,k,O){var N=k&7,K=k>>>3;return N<=5?E[K]|=(O&7)<<N:(E[K]|=O<<N&255,E[K+1]=(O&7)>>8-N),k+3}function fe(E,k,O){var N=k&7,K=k>>>3;return O=(O&1)<<N,E[K]|=O,k+1}function Ce(E,k,O){var N=k&7,K=k>>>3;return O<<=N,E[K]|=O&255,O>>>=8,E[K+1]=O,k+8}function le(E,k,O){var N=k&7,K=k>>>3;return O<<=N,E[K]|=O&255,O>>>=8,E[K+1]=O&255,E[K+2]=O>>>8,k+16}function be(E,k){var O=E.length,N=2*O>k?2*O:k+5,K=0;if(O>=k)return E;if(Ct){var q=vw(N);if(E.copy)E.copy(q);else for(;K<E.length;++K)q[K]=E[K];return q}else if(Z){var de=new Uint8Array(N);if(de.set)de.set(E);else for(;K<O;++K)de[K]=E[K];return de}return E.length=N,E}function De(E){for(var k=new Array(E),O=0;O<E;++O)k[O]=0;return k}function te(E,k,O){var N=1,K=0,q=0,de=0,Ee=0,ce=E.length,ge=Z?new Uint16Array(32):De(32);for(q=0;q<32;++q)ge[q]=0;for(q=ce;q<O;++q)E[q]=0;ce=E.length;var Se=Z?new Uint16Array(ce):De(ce);for(q=0;q<ce;++q)ge[K=E[q]]++,N<K&&(N=K),Se[q]=0;for(ge[0]=0,q=1;q<=N;++q)ge[q+16]=Ee=Ee+ge[q-1]<<1;for(q=0;q<ce;++q)Ee=E[q],Ee!=0&&(Se[q]=ge[Ee+16]++);var Le=0;for(q=0;q<ce;++q)if(Le=E[q],Le!=0)for(Ee=L(Se[q],N)>>N-Le,de=(1<<N+4-Le)-1;de>=0;--de)k[Ee|de<<Le]=Le&15|q<<4;return N}var Pe=Z?new Uint16Array(512):De(512),Ne=Z?new Uint16Array(32):De(32);if(!Z){for(var Ve=0;Ve<512;++Ve)Pe[Ve]=0;for(Ve=0;Ve<32;++Ve)Ne[Ve]=0}(function(){for(var E=[],k=0;k<32;k++)E.push(5);te(E,Ne,32);var O=[];for(k=0;k<=143;k++)O.push(8);for(;k<=255;k++)O.push(9);for(;k<=279;k++)O.push(7);for(;k<=287;k++)O.push(8);te(O,Pe,288)})();var qe=function(){for(var k=Z?new Uint8Array(32768):[],O=0,N=0;O<W.length-1;++O)for(;N<W[O+1];++N)k[N]=O;for(;N<32768;++N)k[N]=29;var K=Z?new Uint8Array(259):[];for(O=0,N=0;O<ae.length-1;++O)for(;N<ae[O+1];++N)K[N]=O;function q(Ee,ce){for(var ge=0;ge<Ee.length;){var Se=Math.min(65535,Ee.length-ge),Le=ge+Se==Ee.length;for(ce.write_shift(1,+Le),ce.write_shift(2,Se),ce.write_shift(2,~Se&65535);Se-- >0;)ce[ce.l++]=Ee[ge++]}return ce.l}function de(Ee,ce){for(var ge=0,Se=0,Le=Z?new Uint16Array(32768):[];Se<Ee.length;){var Ge=Math.min(65535,Ee.length-Se);if(Ge<10){for(ge=pe(ce,ge,+(Se+Ge==Ee.length)),ge&7&&(ge+=8-(ge&7)),ce.l=ge/8|0,ce.write_shift(2,Ge),ce.write_shift(2,~Ge&65535);Ge-- >0;)ce[ce.l++]=Ee[Se++];ge=ce.l*8;continue}ge=pe(ce,ge,+(Se+Ge==Ee.length)+2);for(var je=0;Ge-- >0;){var Be=Ee[Se];je=(je<<5^Be)&32767;var Ke=-1,nt=0;if((Ke=Le[je])&&(Ke|=Se&-32768,Ke>Se&&(Ke-=32768),Ke<Se))for(;Ee[Ke+nt]==Ee[Se+nt]&&nt<250;)++nt;if(nt>2){Be=K[nt],Be<=22?ge=Ce(ce,ge,ee[Be+1]>>1)-1:(Ce(ce,ge,3),ge+=5,Ce(ce,ge,ee[Be-23]>>5),ge+=3);var jt=Be<8?0:Be-4>>2;jt>0&&(le(ce,ge,nt-ae[Be]),ge+=jt),Be=k[Se-Ke],ge=Ce(ce,ge,ee[Be]>>3),ge-=3;var qt=Be<4?0:Be-2>>1;qt>0&&(le(ce,ge,Se-Ke-W[Be]),ge+=qt);for(var Fr=0;Fr<nt;++Fr)Le[je]=Se&32767,je=(je<<5^Ee[Se])&32767,++Se;Ge-=nt-1}else Be<=143?Be=Be+48:ge=fe(ce,ge,1),ge=Ce(ce,ge,ee[Be]),Le[je]=Se&32767,++Se}ge=Ce(ce,ge,0)-1}return ce.l=(ge+7)/8|0,ce.l}return function(ce,ge){return ce.length<8?q(ce,ge):de(ce,ge)}}();function $e(E){var k=sr(50+Math.floor(E.length*1.1)),O=qe(E,k);return k.slice(0,O)}var et=Z?new Uint16Array(32768):De(32768),ht=Z?new Uint16Array(32768):De(32768),Rt=Z?new Uint16Array(128):De(128),At=1,mr=1;function Kt(E,k){var O=ne(E,k)+257;k+=5;var N=ne(E,k)+1;k+=5;var K=ie(E,k)+4;k+=4;for(var q=0,de=Z?new Uint8Array(19):De(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ge=Z?new Uint8Array(8):De(8),Se=Z?new Uint8Array(8):De(8),Le=de.length,Ge=0;Ge<K;++Ge)de[Y[Ge]]=q=V(E,k),ce<q&&(ce=q),ge[q]++,k+=3;var je=0;for(ge[0]=0,Ge=1;Ge<=ce;++Ge)Se[Ge]=je=je+ge[Ge-1]<<1;for(Ge=0;Ge<Le;++Ge)(je=de[Ge])!=0&&(Ee[Ge]=Se[je]++);var Be=0;for(Ge=0;Ge<Le;++Ge)if(Be=de[Ge],Be!=0){je=ee[Ee[Ge]]>>8-Be;for(var Ke=(1<<7-Be)-1;Ke>=0;--Ke)Rt[je|Ke<<Be]=Be&7|Ge<<3}var nt=[];for(ce=1;nt.length<O+N;)switch(je=Rt[j(E,k)],k+=je&7,je>>>=3){case 16:for(q=3+I(E,k),k+=2,je=nt[nt.length-1];q-- >0;)nt.push(je);break;case 17:for(q=3+V(E,k),k+=3;q-- >0;)nt.push(0);break;case 18:for(q=11+j(E,k),k+=7;q-- >0;)nt.push(0);break;default:nt.push(je),ce<je&&(ce=je);break}var jt=nt.slice(0,O),qt=nt.slice(O);for(Ge=O;Ge<286;++Ge)jt[Ge]=0;for(Ge=N;Ge<30;++Ge)qt[Ge]=0;return At=te(jt,et,286),mr=te(qt,ht,30),k}function vr(E,k){if(E[0]==3&&!(E[1]&3))return[On(k),2];for(var O=0,N=0,K=vw(k||1<<18),q=0,de=K.length>>>0,Ee=0,ce=0;!(N&1);){if(N=V(E,O),O+=3,N>>>1)N>>1==1?(Ee=9,ce=5):(O=Kt(E,O),Ee=At,ce=mr);else{O&7&&(O+=8-(O&7));var ge=E[O>>>3]|E[(O>>>3)+1]<<8;if(O+=32,ge>0)for(!k&&de<q+ge&&(K=be(K,q+ge),de=K.length);ge-- >0;)K[q++]=E[O>>>3],O+=8;continue}for(;;){!k&&de<q+32767&&(K=be(K,q+32767),de=K.length);var Se=oe(E,O,Ee),Le=N>>>1==1?Pe[Se]:et[Se];if(O+=Le&15,Le>>>=4,!(Le>>>8&255))K[q++]=Le;else{if(Le==256)break;Le-=257;var Ge=Le<8?0:Le-4>>2;Ge>5&&(Ge=0);var je=q+ae[Le];Ge>0&&(je+=oe(E,O,Ge),O+=Ge),Se=oe(E,O,ce),Le=N>>>1==1?Ne[Se]:ht[Se],O+=Le&15,Le>>>=4;var Be=Le<4?0:Le-2>>1,Ke=W[Le];for(Be>0&&(Ke+=oe(E,O,Be),O+=Be),!k&&de<je&&(K=be(K,je+100),de=K.length);q<je;)K[q]=K[q-Ke],++q}}}return k?[K,O+7>>>3]:[K.slice(0,q),O+7>>>3]}function Ps(E,k){var O=E.slice(E.l||0),N=vr(O,k);return E.l+=N[1],N[0]}function Un(E,k){if(E)typeof console<"u"&&console.error(k);else throw new Error(k)}function Cr(E,k){var O=E;wr(O,0);var N=[],K=[],q={FileIndex:N,FullPaths:K};y(q,{root:k.root});for(var de=O.length-4;(O[de]!=80||O[de+1]!=75||O[de+2]!=5||O[de+3]!=6)&&de>=0;)--de;O.l=de+4,O.l+=4;var Ee=O.read_shift(2);O.l+=6;var ce=O.read_shift(4);for(O.l=ce,de=0;de<Ee;++de){O.l+=20;var ge=O.read_shift(4),Se=O.read_shift(4),Le=O.read_shift(2),Ge=O.read_shift(2),je=O.read_shift(2);O.l+=8;var Be=O.read_shift(4),Ke=a(O.slice(O.l+Le,O.l+Le+Ge));O.l+=Le+Ge+je;var nt=O.l;O.l=Be+4,Za(O,ge,Se,q,Ke),O.l=nt}return q}function Za(E,k,O,N,K){E.l+=2;var q=E.read_shift(2),de=E.read_shift(2),Ee=o(E);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var ce=E.read_shift(4),ge=E.read_shift(4),Se=E.read_shift(4),Le=E.read_shift(2),Ge=E.read_shift(2),je="",Be=0;Be<Le;++Be)je+=String.fromCharCode(E[E.l++]);if(Ge){var Ke=a(E.slice(E.l,E.l+Ge));(Ke[21589]||{}).mt&&(Ee=Ke[21589].mt),((K||{})[21589]||{}).mt&&(Ee=K[21589].mt)}E.l+=Ge;var nt=E.slice(E.l,E.l+ge);switch(de){case 8:nt=X(E,Se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var jt=!1;q&8&&(ce=E.read_shift(4),ce==134695760&&(ce=E.read_shift(4),jt=!0),ge=E.read_shift(4),Se=E.read_shift(4)),ge!=k&&Un(jt,"Bad compressed size: "+k+" != "+ge),Se!=O&&Un(jt,"Bad uncompressed size: "+O+" != "+Se),tl(N,je,nt,{unsafe:!0,mt:Ee})}function el(E,k){var O=k||{},N=[],K=[],q=sr(1),de=O.compression?8:0,Ee=0,ce=0,ge=0,Se=0,Le=0,Ge=E.FullPaths[0],je=Ge,Be=E.FileIndex[0],Ke=[],nt=0;for(ce=1;ce<E.FullPaths.length;++ce)if(je=E.FullPaths[ce].slice(Ge.length),Be=E.FileIndex[ce],!(!Be.size||!Be.content||je=="Sh33tJ5")){var jt=Se,qt=sr(je.length);for(ge=0;ge<je.length;++ge)qt.write_shift(1,je.charCodeAt(ge)&127);qt=qt.slice(0,qt.l),Ke[Le]=h8.buf(Be.content,0);var Fr=Be.content;de==8&&(Fr=z(Fr)),q=sr(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Ee),q.write_shift(2,de),Be.mt?n(q,Be.mt):q.write_shift(4,0),q.write_shift(-4,Ke[Le]),q.write_shift(4,Fr.length),q.write_shift(4,Be.content.length),q.write_shift(2,qt.length),q.write_shift(2,0),Se+=q.length,N.push(q),Se+=qt.length,N.push(qt),Se+=Fr.length,N.push(Fr),q=sr(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Ee),q.write_shift(2,de),q.write_shift(4,0),q.write_shift(-4,Ke[Le]),q.write_shift(4,Fr.length),q.write_shift(4,Be.content.length),q.write_shift(2,qt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,jt),nt+=q.l,K.push(q),nt+=qt.length,K.push(qt),++Le}return q=sr(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Le),q.write_shift(2,Le),q.write_shift(4,nt),q.write_shift(4,Se),q.write_shift(2,0),bn([bn(N),bn(K),q])}var Ni={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Hr(E,k){if(E.ctype)return E.ctype;var O=E.name||"",N=O.match(/\.([^\.]+)$/);return N&&Ni[N[1]]||k&&(N=(O=k).match(/[\.\\]([^\.\\])+$/),N&&Ni[N[1]])?Ni[N[1]]:"application/octet-stream"}function Si(E){for(var k=mw(E),O=[],N=0;N<k.length;N+=76)O.push(k.slice(N,N+76));return O.join(`\r
`)+`\r
`}function Dh(E){var k=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var Se=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(Se.length==1?"0"+Se:Se)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],N=k.split(`\r
`),K=0;K<N.length;++K){var q=N[K];if(q.length==0){O.push("");continue}for(var de=0;de<q.length;){var Ee=76,ce=q.slice(de,de+Ee);ce.charAt(Ee-1)=="="?Ee--:ce.charAt(Ee-2)=="="?Ee-=2:ce.charAt(Ee-3)=="="&&(Ee-=3),ce=q.slice(de,de+Ee),de+=Ee,de<q.length&&(ce+="="),O.push(ce)}}return O.join(`\r
`)}function Kn(E){for(var k=[],O=0;O<E.length;++O){for(var N=E[O];O<=E.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+E[++O];k.push(N)}for(var K=0;K<k.length;++K)k[K]=k[K].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Ki(k.join(`\r
`))}function Mh(E,k,O){for(var N="",K="",q="",de,Ee=0;Ee<10;++Ee){var ce=k[Ee];if(!ce||ce.match(/^\s*$/))break;var ge=ce.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":N=ge[2].trim();break;case"content-type":q=ge[2].trim();break;case"content-transfer-encoding":K=ge[2].trim();break}}switch(++Ee,K.toLowerCase()){case"base64":de=Ki(wi(k.slice(Ee).join("")));break;case"quoted-printable":de=Kn(k.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var Se=tl(E,N.slice(O.length),de,{unsafe:!0});q&&(Se.ctype=q)}function kh(E,k){if(G(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=k&&k.root||"",N=(Ct&&Buffer.isBuffer(E)?E.toString("binary"):G(E)).split(`\r
`),K=0,q="";for(K=0;K<N.length;++K)if(q=N[K],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),O||(O=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),q.slice(0,O.length)!=O););var de=(N[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ee="--"+(de[1]||""),ce=[],ge=[],Se={FileIndex:ce,FullPaths:ge};y(Se);var Le,Ge=0;for(K=0;K<N.length;++K){var je=N[K];je!==Ee&&je!==Ee+"--"||(Ge++&&Mh(Se,N.slice(Le,K),O),Le=K)}return Se}function _h(E,k){var O=k||{},N=O.boundary||"SheetJS";N="------="+N;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],q=E.FullPaths[0],de=q,Ee=E.FileIndex[0],ce=1;ce<E.FullPaths.length;++ce)if(de=E.FullPaths[ce].slice(q.length),Ee=E.FileIndex[ce],!(!Ee.size||!Ee.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var ge=Ee.content,Se=Ct&&Buffer.isBuffer(ge)?ge.toString("binary"):G(ge),Le=0,Ge=Math.min(1024,Se.length),je=0,Be=0;Be<=Ge;++Be)(je=Se.charCodeAt(Be))>=32&&je<128&&++Le;var Ke=Le>=Ge*4/5;K.push(N),K.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+de),K.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),K.push("Content-Type: "+Hr(Ee,de)),K.push(""),K.push(Ke?Dh(Se):Si(Se))}return K.push(N+`--\r
`),K.join(`\r
`)}function Xc(E){var k={};return y(k,E),k}function tl(E,k,O,N){var K=N&&N.unsafe;K||y(E);var q=!K&&yt.find(E,k);if(!q){var de=E.FullPaths[0];k.slice(0,de.length)==de?de=k:(de.slice(-1)!="/"&&(de+="/"),de=(de+k).replace("//","/")),q={name:s(k),type:2},E.FileIndex.push(q),E.FullPaths.push(de),K||yt.utils.cfb_gc(E)}return q.content=O,q.size=O?O.length:0,N&&(N.CLSID&&(q.clsid=N.CLSID),N.mt&&(q.mt=N.mt),N.ct&&(q.ct=N.ct)),q}function Ih(E,k){y(E);var O=yt.find(E,k);if(O){for(var N=0;N<E.FileIndex.length;++N)if(E.FileIndex[N]==O)return E.FileIndex.splice(N,1),E.FullPaths.splice(N,1),!0}return!1}function Oh(E,k,O){y(E);var N=yt.find(E,k);if(N){for(var K=0;K<E.FileIndex.length;++K)if(E.FileIndex[K]==N)return E.FileIndex[K].name=s(O),E.FullPaths[K]=O,!0}return!1}function Lh(E){x(E,!0)}return t.find=A,t.read=R,t.parse=u,t.write=he,t.writeFile=se,t.utils={cfb_new:Xc,cfb_add:tl,cfb_del:Ih,cfb_mov:Oh,cfb_gc:Lh,ReadShift:Ol,CheckField:vR,prep_blob:wr,bconcat:bn,use_zlib:M,_deflateRaw:$e,_inflateRaw:Ps,consts:_},t}();function f8(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function Fs(e){for(var t=Object.keys(e),r=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(e,t[i])&&r.push(t[i]);return r}function R0(e){for(var t=[],r=Fs(e),i=0;i!==r.length;++i)t[e[r[i]]]=r[i];return t}var Rd=new Date(1899,11,30,0,0,0);function Qr(e,t){var r=e.getTime(),i=Rd.getTime()+(e.getTimezoneOffset()-Rd.getTimezoneOffset())*6e4;return(r-i)/(24*60*60*1e3)}var X1=new Date,p8=Rd.getTime()+(X1.getTimezoneOffset()-Rd.getTimezoneOffset())*6e4,Ew=X1.getTimezoneOffset();function wh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+p8),t.getTimezoneOffset()!==Ew&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ew)*6e4),t}function g8(e){var t=0,r=0,i=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(i=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(i)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[n],10)}return t}var Fw=new Date("2017-02-19T19:06:09.000Z"),Q1=isNaN(Fw.getFullYear())?new Date("2/19/17"):Fw,m8=Q1.getFullYear()==2017;function fr(e,t){var r=new Date(e);if(m8)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Q1.getFullYear()==1917&&!isNaN(r.getFullYear())){var i=r.getFullYear();return e.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function ko(e,t){if(Ct&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return yl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return yl(N1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return yl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return yl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(n){return r[n]||n})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function br(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=br(e[r]));return t}function Yt(e,t){for(var r="";r.length<t;)r+=e;return r}function Zi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(t=Number(i)))?t/r:t}var v8=["january","february","march","april","may","june","july","august","september","october","november","december"];function ka(e){var t=new Date(e),r=new Date(NaN),i=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v8.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return i<0||i>8099?r:(s>0||n>1)&&i!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var C8=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,i,s){if(e||typeof i=="string")return r.split(i);for(var n=r.split(i),o=[n[0]],a=1;a<n.length;++a)o.push(s),o.push(n[a]);return o}}();function J1(e){return e?e.content&&e.type?ko(e.content,!0):e.data?Cl(e.data):e.asNodeBuffer&&Ct?Cl(e.asNodeBuffer().toString("binary")):e.asBinary?Cl(e.asBinary()):e._data&&e._data.getContent?Cl(ko(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Z1(e){if(!e)return null;if(e.data)return pw(e.data);if(e.asNodeBuffer&&Ct)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?pw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function w8(e){return e&&e.name.slice(-4)===".bin"?Z1(e):J1(e)}function Ri(e,t){for(var r=e.FullPaths||Fs(e.files),i=t.toLowerCase().replace(/[\/]/g,"\\"),s=i.replace(/\\/g,"/"),n=0;n<r.length;++n){var o=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==o||s==o)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function E0(e,t){var r=Ri(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function er(e,t,r){if(!r)return w8(E0(e,t));if(!t)return null;try{return er(e,t)}catch{return null}}function gi(e,t,r){if(!r)return J1(E0(e,t));if(!t)return null;try{return gi(e,t)}catch{return null}}function S8(e,t,r){return Z1(E0(e,t))}function Tw(e){for(var t=e.FullPaths||Fs(e.files),r=[],i=0;i<t.length;++i)t[i].slice(-1)!="/"&&r.push(t[i].replace(/^Root Entry[\/]/,""));return r.sort()}function y8(e,t,r){if(e.FullPaths){if(typeof r=="string"){var i;return Ct?i=Go(r):i=HV(r),yt.utils.cfb_add(e,t,i)}yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function eR(e,t){switch(t.type){case"base64":return yt.read(e,{type:"base64"});case"binary":return yt.read(e,{type:"binary"});case"buffer":case"array":return yt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var i=e.split("/");i.length!==0;){var s=i.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var tR=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,x8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Aw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,b8=/<[^>]*>/g,Gr=tR.match(Aw)?Aw:b8,R8=/<\w*:/,E8=/<(\/?)\w+:/;function tt(e,t,r){for(var i={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(i[0]=e.slice(0,s)),s===e.length)return i;var o=e.match(x8),a=0,l="",c=0,u="",d="",h=1;if(o)for(c=0;c!=o.length;++c){for(d=o[c],n=0;n!=d.length&&d.charCodeAt(n)!==61;++n);for(u=d.slice(0,n).trim();d.charCodeAt(n+1)==32;)++n;for(h=(s=d.charCodeAt(n+1))==34||s==39?1:0,l=d.slice(n+1+h,d.length-h),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),i[u]=l,i[u.toLowerCase()]=l;else{var p=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(i[p]&&u.slice(a-3,a)=="ext")continue;i[p]=l,i[p.toLowerCase()]=l}}return i}function Ts(e){return e.replace(E8,"<$1")}var rR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F8=R0(rR),Et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(i){var s=i+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(a,l){return rR[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(t,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,o)+r(s.slice(o+3))}}(),T8=/[&<>'"]/g,A8=/[\u0000-\u001f]/g;function F0(e){var t=e+"";return t.replace(T8,function(r){return F8[r]}).replace(/\n/g,"<br/>").replace(A8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Pw=function(){var e=/&#(\d+);/g;function t(r,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,t)}}();function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function df(e){for(var t="",r=0,i=0,s=0,n=0,o=0,a=0;r<e.length;){if(i=e.charCodeAt(r++),i<128){t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),i>191&&i<224){o=(i&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(n=e.charCodeAt(r++),i<240){t+=String.fromCharCode((i&15)<<12|(s&63)<<6|n&63);continue}o=e.charCodeAt(r++),a=((i&7)<<18|(s&63)<<12|(n&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function Dw(e){var t=On(2*e.length),r,i,s=1,n=0,o=0,a;for(i=0;i<e.length;i+=s)s=1,(a=e.charCodeAt(i))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(i+1)&63),s=2):a<240?(r=(a&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,r=(a&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[n++]=o&255,t[n++]=o>>>8,o=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function Mw(e){return Go(e,"binary").toString("utf8")}var Cu="foo bar bazâð£",Lt=Ct&&(Mw(Cu)==df(Cu)&&Mw||Dw(Cu)==df(Cu)&&Dw)||df,yl=Ct?function(e){return Go(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,i=0,s=0;r<e.length;)switch(i=e.charCodeAt(r++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(r++)-56320+(i<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},gc=function(){var e={};return function(r,i){var s=r+"|"+(i||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",i||"")}}(),iR=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}}(),P8=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),D8=/<\/?(?:vt:)?variant>/g,M8=/<(?:vt:)([^>]*)>([\s\S]*)</;function kw(e,t){var r=tt(e),i=e.match(P8(r.baseType))||[],s=[];if(i.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+i.length+" != "+r.size);return s}return i.forEach(function(n){var o=n.replace(D8,"").match(M8);o&&s.push({v:Lt(o[2]),t:o[1]})}),s}var k8=/(^\s|\s$|\n)/;function _8(e){return Fs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function I8(e,t,r){return"<"+e+(r!=null?_8(r):"")+(t!=null?(t.match(k8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function T0(e){if(Ct&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Lt(Ho(y0(e)));throw new Error("Bad input format: expected Buffer or string")}var mc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,O8={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},L8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function N8(e,t){for(var r=1-2*(e[t+7]>>>7),i=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return i==2047?s==0?r*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),r*Math.pow(2,i-52)*s)}function B8(e,t,r){var i=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,o=i?-t:t;isFinite(o)?o==0?s=n=0:(s=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var a=0;a<=5;++a,n/=256)e[r+a]=n&255;e[r+6]=(s&15)<<4|n&15,e[r+7]=s>>4|i}var _w=function(e){for(var t=[],r=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,n=e[0][i].length;s<n;s+=r)t.push.apply(t,e[0][i].slice(s,s+r));return t},Iw=Ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Go(t)})):_w(e)}:_w,Ow=function(e,t,r){for(var i=[],s=t;s<r;s+=2)i.push(String.fromCharCode(Vs(e,s)));return i.join("").replace(Xr,"")},A0=Ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Xr,""):Ow(e,t,r)}:Ow,Lw=function(e,t,r){for(var i=[],s=t;s<t+r;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},sR=Ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Lw(e,t,r)}:Lw,Nw=function(e,t,r){for(var i=[],s=t;s<r;s++)i.push(String.fromCharCode(na(e,s)));return i.join("")},Vc=Ct?function(t,r,i){return Buffer.isBuffer(t)?t.toString("utf8",r,i):Nw(t,r,i)}:Nw,nR=function(e,t){var r=fi(e,t);return r>0?Vc(e,t+4,t+4+r-1):""},oR=nR,aR=function(e,t){var r=fi(e,t);return r>0?Vc(e,t+4,t+4+r-1):""},lR=aR,cR=function(e,t){var r=2*fi(e,t);return r>0?Vc(e,t+4,t+4+r-1):""},uR=cR,dR=function(t,r){var i=fi(t,r);return i>0?A0(t,r+4,r+4+i):""},hR=dR,fR=function(e,t){var r=fi(e,t);return r>0?Vc(e,t+4,t+4+r):""},pR=fR,gR=function(e,t){return N8(e,t)},Ed=gR,mR=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ct&&(oR=function(t,r){if(!Buffer.isBuffer(t))return nR(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},lR=function(t,r){if(!Buffer.isBuffer(t))return aR(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},uR=function(t,r){if(!Buffer.isBuffer(t))return cR(t,r);var i=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i-1)},hR=function(t,r){if(!Buffer.isBuffer(t))return dR(t,r);var i=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i)},pR=function(t,r){if(!Buffer.isBuffer(t))return fR(t,r);var i=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+i)},Ed=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):gR(t,r)},mR=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var na=function(e,t){return e[t]},Vs=function(e,t){return e[t+1]*256+e[t]},G8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},so=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},H8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ol(e,t){var r="",i,s,n=[],o,a,l,c;switch(t){case"dbcs":if(c=this.l,Ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Vs(this,c)),c+=2;e*=2;break;case"utf8":r=Vc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=A0(this,this.l,this.l+e);break;case"wstr":return Ol.call(this,e,"dbcs");case"lpstr-ansi":r=oR(this,this.l),e=4+fi(this,this.l);break;case"lpstr-cp":r=lR(this,this.l),e=4+fi(this,this.l);break;case"lpwstr":r=uR(this,this.l),e=4+2*fi(this,this.l);break;case"lpp4":e=4+fi(this,this.l),r=hR(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fi(this,this.l),r=pR(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=na(this,this.l+e++))!==0;)n.push(vu(o));r=n.join("");break;case"_wstr":for(e=0,r="";(o=Vs(this,this.l+e))!==0;)n.push(vu(o)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=na(this,c),this.l=c+1,a=Ol.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(vu(Vs(this,c))),c+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=na(this,c),this.l=c+1,a=Ol.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(vu(na(this,c))),c+=1}r=n.join("");break;default:switch(e){case 1:return i=na(this,this.l),this.l++,i;case 2:return i=(t==="i"?G8:Vs)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(i=(e>0?so:H8)(this,this.l),this.l+=4,i):(s=fi(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Ed(this,this.l):s=Ed([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=sR(this,this.l,e);break}}return this.l+=e,r}var V8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},W8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},z8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function $8(e,t,r){var i=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)z8(this,t.charCodeAt(s),this.l+2*s);i=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;i=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,V8(this,t,this.l);break;case 8:if(i=8,r==="f"){B8(this,t,this.l);break}case 16:break;case-4:i=4,W8(this,t,this.l);break}return this.l+=i,this}function vR(e,t){var r=sR(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=Ol,e.chk=vR,e.write_shift=$8}function Nr(e,t){e.l+=t}function sr(e){var t=On(e);return wr(t,0),t}function nn(e,t,r){if(e){var i,s,n;wr(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var c=Md[a]||Md[65535];for(i=e.read_shift(1),n=i&127,s=1;s<4&&i&128;++s)n+=((i=e.read_shift(1))&127)<<7*s;l=e.l+n;var u=c.f&&c.f(e,n,r);if(e.l=l,t(u,c,a))return}}}function Ap(){var e=[],t=Ct?256:2048,r=function(c){var u=sr(c);return wr(u,0),u},i=r(t),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},n=function(c){return i&&c<i.length-i.l?i:(s(),i=r(Math.max(c+1,t)))},o=function(){return s(),bn(e)},a=function(c){s(),i=c,i.l==null&&(i.l=i.length),n(t)};return{next:n,push:a,end:o,_bufs:e}}function Ll(e,t,r){var i=br(e);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Bw(e,t,r){var i=br(e);return i.s=Ll(i.s,t.s,r),i.e=Ll(i.e,t.s,r),i}function Nl(e,t){if(e.cRel&&e.c<0)for(e=br(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=br(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=j8(r)),!e.rRel&&e.rRel!=null&&(r=U8(r)),r}function hf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rr(e.s.r)+":"+(e.e.rRel?"":"$")+Rr(e.e.r):Nl(e.s,t.biff)+":"+Nl(e.e,t.biff)}function P0(e){return parseInt(K8(e),10)-1}function Rr(e){return""+(e+1)}function U8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K8(e){return e.replace(/\$(\d+)$/,"$1")}function D0(e){for(var t=q8(e),r=0,i=0;i!==t.length;++i)r=26*r+t.charCodeAt(i)-64;return r-1}function or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function j8(e){return e.replace(/^([A-Z])/,"$$$1")}function q8(e){return e.replace(/^\$([A-Z])/,"$1")}function Y8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kr(e){for(var t=0,r=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ja(e){var t=e.indexOf(":");return t==-1?{s:Kr(e),e:Kr(e)}:{s:Kr(e.slice(0,t)),e:Kr(e.slice(t+1))}}function xt(e,t){return typeof t>"u"||typeof t=="number"?xt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function Xt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,s=0,n=e.length;for(r=0;i<n&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.s.c=--r,r=0;i<n&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;if(t.s.r=--r,i===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,r=0;i!=n&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.e.c=--r,r=0;i!=n&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;return t.e.r=--r,t}function Gw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Oi(e.z,r?Qr(t):t)}catch{}try{return e.w=Oi((e.XF||{}).numFmtId||(r?14:0),r?Qr(t):t)}catch{return""+t}}function Xs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zo[e.v]||e.v:t==null?Gw(e,e.v):Gw(e,t))}function zn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",i={};return i[r]=e,{SheetNames:[r],Sheets:i}}function CR(e,t,r){var i=r||{},s=e?Array.isArray(e):i.dense,n=e||(s?[]:{}),o=0,a=0;if(n&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var l=typeof i.origin=="string"?Kr(i.origin):i.origin;o=l.r,a=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var u=Xt(n["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},g=o+d,f=a+h;if(c.s.r>g&&(c.s.r=g),c.s.c>f&&(c.s.c=f),c.e.r<g&&(c.e.r=g),c.e.c<f&&(c.e.c=f),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(i.nullError)p.t="e",p.v=0;else if(i.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=i.dateNF||lt[14],i.cellDates?(p.t="d",p.w=Oi(p.z,Qr(p.v))):(p.t="n",p.v=Qr(p.v),p.w=Oi(p.z,p.v))):p.t="s";if(s)n[g]||(n[g]=[]),n[g][f]&&n[g][f].z&&(p.z=n[g][f].z),n[g][f]=p;else{var m=st({c:f,r:g});n[m]&&n[m].z&&(p.z=n[m].z),n[m]=p}}}return c.s.c<1e7&&(n["!ref"]=xt(c)),n}function qa(e,t){return CR(null,e,t)}function X8(e){return e.read_shift(4,"i")}function Ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Q8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function M0(e,t){var r=e.l,i=e.read_shift(1),s=Ir(e),n=[],o={t:s,h:s};if(i&1){for(var a=e.read_shift(4),l=0;l!=a;++l)n.push(Q8(e));o.r=n}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var J8=M0;function Li(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Z8=Ir;function k0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var e6=Ir,Pp=k0;function _0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,i=t[0]&2;e.l+=4;var s=i===0?Ed([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):so(t,0)>>2;return r?s/100:s}function wR(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Wo=wR;function Mr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function t6(e){var t={},r=e.read_shift(1),i=r>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,i){case 0:t.auto=1;break;case 1:t.index=s;var c=So[s];c&&(t.rgb=Cc(c));break;case 2:t.rgb=Cc([o,a,l]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function r6(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function SR(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function i6(e){return SR(e,1)}function s6(e){return SR(e,2)}var I0=2,ti=3,wu=11,Hw=12,Fd=19,Su=64,n6=65,o6=71,a6=4108,l6=4126,cr=80,yR=81,c6=[cr,yR],u6={1:{n:"CodePage",t:I0},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:ti},5:{n:"LineCount",t:ti},6:{n:"ParagraphCount",t:ti},7:{n:"SlideCount",t:ti},8:{n:"NoteCount",t:ti},9:{n:"HiddenCount",t:ti},10:{n:"MultimediaClipCount",t:ti},11:{n:"ScaleCrop",t:wu},12:{n:"HeadingPairs",t:a6},13:{n:"TitlesOfParts",t:l6},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:wu},17:{n:"CharacterCount",t:ti},19:{n:"SharedDoc",t:wu},22:{n:"HyperlinksChanged",t:wu},23:{n:"AppVersion",t:ti,p:"version"},24:{n:"DigSig",t:n6},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:Fd},2147483651:{n:"Behavior",t:Fd},1919054434:{}},d6={1:{n:"CodePage",t:I0},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:Su},11:{n:"LastPrinted",t:Su},12:{n:"CreatedDate",t:Su},13:{n:"ModifiedDate",t:Su},14:{n:"PageCount",t:ti},15:{n:"WordCount",t:ti},16:{n:"CharCount",t:ti},17:{n:"Thumbnail",t:o6},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:ti},255:{},2147483648:{n:"Locale",t:Fd},2147483651:{n:"Behavior",t:Fd},1919054434:{}},Vw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},h6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function f6(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var p6=f6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),So=br(p6),zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xR={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ww={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function g6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function m6(e){var t=g6();if(!e||!e.match)return t;var r={};if((e.match(Gr)||[]).forEach(function(i){var s=tt(i);switch(s[0].replace(R8,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Ww[s.ContentType]]!==void 0&&t[Ww[s.ContentType]].push(s.PartName);break}}),t.xmlns!==O8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ca={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Dp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Bl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var i={};return(e.match(Gr)||[]).forEach(function(s){var n=tt(s);if(n[0]==="<Relationship"){var o={};o.Type=n.Type,o.Target=n.Target,o.Id=n.Id,n.TargetMode&&(o.TargetMode=n.TargetMode);var a=n.TargetMode==="External"?n.Target:Sl(n.Target,t);r[a]=o,i[n.Id]=o}}),r["!id"]=i,r}var v6="application/vnd.oasis.opendocument.spreadsheet";function C6(e,t){for(var r=T0(e),i,s;i=mc.exec(r);)switch(i[3]){case"manifest":break;case"file-entry":if(s=tt(i[0],!1),s.path=="/"&&s.type!==v6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw i}}var Gl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w6=function(){for(var e=new Array(Gl.length),t=0;t<Gl.length;++t){var r=Gl[t],i="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e}();function bR(e){var t={};e=Lt(e);for(var r=0;r<Gl.length;++r){var i=Gl[r],s=e.match(w6[r]);s!=null&&s.length>0&&(t[i[1]]=Et(s[1])),i[2]==="date"&&t[i[1]]&&(t[i[1]]=fr(t[i[1]]))}return t}var S6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function RR(e,t,r,i){var s=[];if(typeof e=="string")s=kw(e,i);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(u){return{v:u}}));var o=typeof t=="string"?kw(t,i).map(function(u){return u.v}):t,a=0,l=0;if(o.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function y6(e,t,r){var i={};return t||(t={}),e=Lt(e),S6.forEach(function(s){var n=(e.match(gc(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=Et(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(i[s[1]]=o[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&RR(i.HeadingPairs,i.TitlesOfParts,t,r),t}var x6=/<[^>]+>[^<]*/g;function b6(e,t){var r={},i="",s=e.match(x6);if(s)for(var n=0;n!=s.length;++n){var o=s[n],a=tt(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Et(a.name);break;case"</property>":i=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[i]=Et(u);break;case"bool":r[i]=$t(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[i]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[i]=parseFloat(u);break;case"filetime":case"date":r[i]=fr(u);break;case"cy":case"error":r[i]=Et(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var R6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ff;function E6(e,t,r){ff||(ff=R0(R6)),t=ff[t]||t,e[t]=r}function O0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ER(e,t,r){var i=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-i&3;)++e.l;return s}function FR(e,t,r){var i=e.read_shift(0,"lpwstr");return i}function TR(e,t,r){return t===31?FR(e):ER(e,t,r)}function Mp(e,t,r){return TR(e,t,r===!1?0:4)}function F6(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return TR(e,t,0)}function T6(e){for(var t=e.read_shift(4),r=[],i=0;i!=t;++i){var s=e.l;r[i]=e.read_shift(0,"lpwstr").replace(Xr,""),e.l-s&2&&(e.l+=2)}return r}function A6(e){for(var t=e.read_shift(4),r=[],i=0;i!=t;++i)r[i]=e.read_shift(0,"lpstr-cp").replace(Xr,"");return r}function P6(e){var t=e.l,r=Td(e,yR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var i=Td(e,ti);return[r,i]}function D6(e){for(var t=e.read_shift(4),r=[],i=0;i<t/2;++i)r.push(P6(e));return r}function zw(e,t){for(var r=e.read_shift(4),i={},s=0;s!=r;++s){var n=e.read_shift(4),o=e.read_shift(4);i[n]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Xr,"").replace(wl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function AR(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function M6(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Td(e,t,r){var i=e.read_shift(2),s,n=r||{};if(e.l+=2,t!==Hw&&i!==t&&c6.indexOf(t)===-1&&!((t&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+t+" saw "+i);switch(t===Hw?i:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return ER(e,i,4).replace(Xr,"");case 31:return FR(e);case 64:return O0(e);case 65:return AR(e);case 71:return M6(e);case 80:return Mp(e,i,!n.raw).replace(Xr,"");case 81:return F6(e,i).replace(Xr,"");case 4108:return D6(e);case 4126:case 4127:return i==4127?T6(e):A6(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function $w(e,t){var r=e.l,i=e.read_shift(4),s=e.read_shift(4),n=[],o=0,a=0,l=-1,c={};for(o=0;o!=s;++o){var u=e.read_shift(4),d=e.read_shift(4);n[o]=[u,d+r]}n.sort(function(w,C){return w[1]-C[1]});var h={};for(o=0;o!=s;++o){if(e.l!==n[o][1]){var p=!0;if(o>0&&t)switch(t[n[o-1][0]].t){case 2:e.l+2===n[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=n[o][1]&&(e.l=n[o][1],p=!1);break;case 4108:e.l<=n[o][1]&&(e.l=n[o][1],p=!1);break}if((!t||o==0)&&e.l<=n[o][1]&&(p=!1,e.l=n[o][1]),p)throw new Error("Read Error: Expected address "+n[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[n[o][0]];if(h[g.n]=Td(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xi(a=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(n[o][0]===1){if(a=h.CodePage=Td(e,I0),Xi(a),l!==-1){var f=e.l;e.l=n[l][1],c=zw(e,a),e.l=f}}else if(n[o][0]===0){if(a===0){l=o,e.l=n[o+1][1];continue}c=zw(e,a)}else{var m=c[n[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=AR(e);break;case 30:e.l+=4,v=Mp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Mp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Qt(e,4);break;case 64:e.l+=4,v=fr(O0(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=v}}return e.l=r+i,h}function Uw(e,t,r){var i=e.content;if(!i)return{};wr(i,0);var s,n,o,a,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var c=i.read_shift(4),u=i.read_shift(16);if(u!==yt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=i.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=i.read_shift(16),a=i.read_shift(4),s===1&&a!==i.l)throw new Error("Length mismatch: "+a+" !== "+i.l);s===2&&(o=i.read_shift(16),l=i.read_shift(4));var d=$w(i,t),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=n,s===1)return h;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var g;try{g=$w(i,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[n,o],h}function un(e,t){return e.read_shift(t),null}function k6(e,t,r){for(var i=[],s=e.l+t;e.l<s;)i.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return i}function Qt(e,t){return e.read_shift(t)===1}function tr(e){return e.read_shift(2,"u")}function PR(e,t){return k6(e,t,tr)}function _6(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Wc(e,t,r){var i=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=i?e.read_shift(i,s):"";return o}function I6(e){var t=e.read_shift(2),r=e.read_shift(1),i=r&4,s=r&8,n=1+(r&1),o=0,a,l={};s&&(o=e.read_shift(2)),i&&(a=e.read_shift(4));var c=n==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*o),i&&(e.l+=a),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function _o(e,t,r){var i;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(t,"sbcs-cont"):i=e.read_shift(t,"dbcs-cont"),i}function zc(e,t,r){var i=e.read_shift(r&&r.biff==2?1:2);return i===0?(e.l++,""):_o(e,i,r)}function $o(e,t,r){if(r.biff>5)return zc(e,t,r);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function O6(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function L6(e){var t=e.read_shift(4),r=e.l,i=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=r);var s=e.read_shift((i?t-24:t)>>1,"utf16le").replace(Xr,"");return i&&(e.l+=24),s}function N6(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+i.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(n>>1,"utf16le").replace(Xr,"");return r+o}function B6(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return L6(e);case"0303000000000000c000000000000046":return N6(e);default:throw new Error("Unsupported Moniker "+r)}}function yu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Xr,""):"";return r}function G6(e,t){var r=e.l+t,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var s=e.read_shift(2);e.l+=2;var n,o,a,l,c="",u,d;s&16&&(n=yu(e,r-e.l)),s&128&&(o=yu(e,r-e.l)),(s&257)===257&&(a=yu(e,r-e.l)),(s&257)===1&&(l=B6(e,r-e.l)),s&8&&(c=yu(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(d=O0(e)),e.l=r;var h=o||a||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),d&&(p.time=d),n&&(p.Tooltip=n),p}function DR(e){var t=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);return[t,r,i,s]}function MR(e,t){var r=DR(e);return r[3]=0,r}function As(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{r:t,c:r,ixfe:i}}function H6(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function V6(e,t,r){return t===0?"":$o(e,t,r)}function W6(e,t,r){var i=r.biff>8?4:2,s=e.read_shift(i),n=e.read_shift(i,"i"),o=e.read_shift(i,"i");return[s,n,o]}function kR(e){var t=e.read_shift(2),r=_0(e);return[t,r]}function z6(e,t,r){e.l+=4,t-=4;var i=e.l+t,s=Wc(e,t,r),n=e.read_shift(2);if(i-=e.l,n!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+n);return e.l+=n,s}function Sh(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r:t},e:{c:s,r}}}function _R(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1);return{s:{c:i,r:t},e:{c:s,r}}}var $6=_R;function IR(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[r,t,i]}function U6(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function K6(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Tr(e){e.l+=2,e.l+=e.read_shift(2)}var j6={0:Tr,4:Tr,5:Tr,6:Tr,7:K6,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:U6,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:IR};function q6(e,t){for(var r=e.l+t,i=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{i.push(j6[s](e,r-e.l))}catch{return e.l=r,i}}return e.l!=r&&(e.l=r),i}function xu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Y6(e,t){return t===0||e.read_shift(2),1200}function X6(e,t,r){if(r.enc)return e.l+=t,"";var i=e.l,s=$o(e,0,r);return e.read_shift(t+i-e.l),s}function Q6(e,t,r){var i=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function J6(e,t,r){var i=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var o=Wc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:i,hs:s,dt:n,name:o}}function Z6(e,t){for(var r=e.l+t,i=e.read_shift(4),s=e.read_shift(4),n=[],o=0;o!=s&&e.l<r;++o)n.push(I6(e));return n.Count=i,n.Unique=s,n}function eW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(t.level=i&7),i&32&&(t.hidden=!0),i&64&&(t.hpt=r/20),t}function rW(e){var t=H6(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function iW(e){return e.read_shift(2),e.read_shift(4)}function Kw(e,t,r){var i=0;r&&r.biff==2||(i=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(i=1-(s>>15),s&=32767);var n={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[n,s]}function sW(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[i,s],Flags:n,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function nW(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function oW(){}function aW(e,t,r){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=Wc(e,0,r),i}function lW(e){var t=As(e);return t.isst=e.read_shift(4),t}function cW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var i=e.l+t,s=As(e);r.biff==2&&e.l++;var n=zc(e,i-e.l,r);return s.val=n,s}function uW(e,t,r){var i=e.read_shift(2),s=$o(e,0,r);return[i,s]}var dW=$o;function jw(e,t,r){var i=e.l+t,s=r.biff==8||!r.biff?4:2,n=e.read_shift(s),o=e.read_shift(s),a=e.read_shift(2),l=e.read_shift(2);return e.l=i,{s:{r:n,c:a},e:{r:o,c:l}}}function hW(e){var t=e.read_shift(2),r=e.read_shift(2),i=kR(e);return{r:t,c:r,ixfe:i[0],rknum:i[1]}}function fW(e,t){for(var r=e.l+t-2,i=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(kR(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(n.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:i,c:s,C:o,rkrec:n}}function pW(e,t){for(var r=e.l+t-2,i=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(n.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:i,c:s,C:o,ixfe:n}}function gW(e,t,r,i){var s={},n=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return s.patternType=h6[a>>26],i.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=a&127,s.icvBottom=a>>7&127,s.icvDiag=a>>14&127,s.dgDiag=a>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function mW(e,t,r){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,t-=6,i.data=gW(e,t,i.fStyle,r),i}function vW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function qw(e,t,r){var i=As(e);(r.biff==2||t==9)&&++e.l;var s=_6(e);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function CW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var i=As(e),s=Mr(e);return i.val=s,i}var Yw=V6;function wW(e,t,r){var i=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var o=_o(e,n),a=[];i>e.l;)a.push(zc(e));return[n,s,o,a]}function Xw(e,t,r){var i=e.read_shift(2),s,n={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return r.sbcch===14849&&(s=z6(e,t-2,r)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var SW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Qw(e,t,r){var i=e.l+t,s=e.read_shift(2),n=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=_o(e,o,r);s&32&&(c=SW[c.charCodeAt(0)]);var u=i-e.l;r&&r.biff==2&&--u;var d=i==e.l||a===0||!(u>0)?[]:tU(e,u,r,a);return{chKey:n,Name:c,itab:l,rgce:d}}function OR(e,t,r){if(r.biff<8)return yW(e,t,r);for(var i=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)i.push(W6(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function yW(e,t,r){e[e.l+1]==3&&e[e.l]++;var i=Wc(e,t,r);return i.charCodeAt(0)==3?i.slice(1):i}function xW(e,t,r){if(r.biff<8){e.l+=t;return}var i=e.read_shift(2),s=e.read_shift(2),n=_o(e,i,r),o=_o(e,s,r);return[n,o]}function bW(e,t,r){var i=_R(e);e.l++;var s=e.read_shift(1);return t-=8,[rU(e,t,r),s,i]}function Jw(e,t,r){var i=$6(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[i,Z$(e,t,r)]}function RW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,i=e.read_shift(4);return[t,r,i]}function EW(e,t,r){if(!(r.biff<8)){var i=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),a=$o(e,0,r);return r.biff<8&&e.read_shift(1),[{r:i,c:s},a,o,n]}}function FW(e,t,r){return EW(e,t,r)}function TW(e,t){for(var r=[],i=e.read_shift(2);i--;)r.push(Sh(e));return r}function AW(e,t,r){if(r&&r.biff<8)return DW(e,t,r);var i=IR(e),s=q6(e,t-22,i[1]);return{cmo:i,ft:s}}var PW={8:function(e,t){var r=e.l+t;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:i}}};function DW(e,t,r){e.l+=4;var i=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((PW[i]||Nr)(e,t,r)),{cmo:[s,i,n],ft:o}}function MW(e,t,r){var i=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:o=O6(e,6,r);var a=e.read_shift(2);e.read_shift(2),tr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-i!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=_o(e,e.lens[c+1]-e.lens[c]-1);if(s+=d,s.length>=(u?a:2*a))break}if(s.length!==a&&s.length!==a*2)throw new Error("cchText: "+a+" != "+s.length);return e.l=i+t,{t:s}}catch{return e.l=i+t,{t:s}}}function kW(e,t){var r=Sh(e);e.l+=16;var i=G6(e,t-24);return[r,i]}function _W(e,t){e.read_shift(2);var r=Sh(e),i=e.read_shift((t-10)/2,"dbcs-cont");return i=i.replace(Xr,""),[r,i]}function IW(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Vw[r]||r,r=e.read_shift(2),t[1]=Vw[r]||r,t}function OW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(MR(e));return r}function LW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(MR(e));return r}function NW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function LR(e,t,r){if(!r.cellStyles)return Nr(e,t);var i=r&&r.biff>=12?4:2,s=e.read_shift(i),n=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(i),l=e.read_shift(2);i==2&&(e.l+=2);var c={s,e:n,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function BW(e,t){var r={};return t<32||(e.l+=16,r.header=Mr(e),r.footer=Mr(e),e.l+=2),r}function GW(e,t,r){var i={area:!1};if(r.biff!=5)return e.l+=t,i;var s=e.read_shift(1);return e.l+=3,s&16&&(i.area=!0),i}var HW=As,VW=PR,WW=zc;function zW(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(4),s={fmt:t,env:r,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,s}function $W(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var i=As(e);++e.l;var s=$o(e,t-7,r);return i.t="str",i.val=s,i}function UW(e){var t=As(e);++e.l;var r=Mr(e);return t.t="n",t.val=r,t}function KW(e){var t=As(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function jW(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function qW(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function YW(e,t,r){var i=e.l+t,s=As(e),n=e.read_shift(2),o=_o(e,n,r);return e.l=i,s.t="str",s.val=o,s}var XW=[2,3,48,49,131,139,140,245],Zw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=R0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=On(1);switch(l.type){case"base64":u=Ki(wi(a));break;case"binary":u=Ki(a);break;case"buffer":case"array":u=a;break}wr(u,0);var d=u.read_shift(1),h=!!(d&136),p=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var f=0,m=521;d==2&&(f=u.read_shift(2)),u.l+=3,d!=2&&(f=u.read_shift(4)),f>1048576&&(f=1e6),d!=2&&(m=u.read_shift(2));var v=u.read_shift(2),w=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var C=[],F={},D=Math.min(u.length,d==2?521:m-10-(p?264:0)),R=g?32:11;u.l<D&&u[u.l]!=13;)switch(F={},F.name=xn.utils.decode(w,u.slice(u.l,u.l+R)).replace(/[\u0000\r\n].*$/g,""),u.l+=R,F.type=String.fromCharCode(u.read_shift(1)),d!=2&&!g&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),d==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&C.push(F),d!=2&&(u.l+=g?13:14),F.type){case"B":(!p||F.len!=8)&&l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var y=0,b=0;for(c[0]=[],b=0;b!=C.length;++b)c[0][b]=C[b].name;for(;f-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++y]=[],b=0,b=0;b!=C.length;++b){var x=u.slice(u.l,u.l+C[b].len);u.l+=C[b].len,wr(x,0);var T=xn.utils.decode(w,x);switch(C[b].type){case"C":T.trim().length&&(c[y][b]=T.replace(/\s+$/,""));break;case"D":T.length===8?c[y][b]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):c[y][b]=T;break;case"F":c[y][b]=parseFloat(T.trim());break;case"+":case"I":c[y][b]=g?x.read_shift(-4,"i")^2147483648:x.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":c[y][b]=!0;break;case"N":case"F":c[y][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[y][b]="##MEMO##"+(g?parseInt(T.trim(),10):x.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(c[y][b]=+T||0);break;case"@":c[y][b]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":c[y][b]=new Date((x.read_shift(4)-2440588)*864e5+x.read_shift(4));break;case"Y":c[y][b]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][b]=-x.read_shift(-8,"f");break;case"B":if(p&&C[b].len==8){c[y][b]=x.read_shift(8,"f");break}case"G":case"P":x.l+=C[b].len;break;case"0":if(C[b].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[b].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=C,c}function i(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=qa(r(a,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function s(a,l){try{return zn(i(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&Xi(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ap(),d=Bp(a,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),g=a["!cols"]||[],f=0,m=0,v=0,w=1;for(f=0;f<h.length;++f){if(((g[f]||{}).DBF||{}).name){h[f]=g[f].DBF.name,++v;continue}if(h[f]!=null){if(++v,typeof h[f]=="number"&&(h[f]=h[f].toString(10)),typeof h[f]!="string")throw new Error("DBF Invalid column name "+h[f]+" |"+typeof h[f]+"|");if(h.indexOf(h[f])!==f){for(m=0;m<1024;++m)if(h.indexOf(h[f]+"_"+m)==-1){h[f]+="_"+m;break}}}}var C=Xt(a["!ref"]),F=[],D=[],R=[];for(f=0;f<=C.e.c-C.s.c;++f){var y="",b="",x=0,T=[];for(m=0;m<p.length;++m)p[m][f]!=null&&T.push(p[m][f]);if(T.length==0||h[f]==null){F[f]="?";continue}for(m=0;m<T.length;++m){switch(typeof T[m]){case"number":b="B";break;case"string":b="C";break;case"boolean":b="L";break;case"object":b=T[m]instanceof Date?"D":"C";break;default:b="C"}x=Math.max(x,String(T[m]).length),y=y&&y!=b?"C":b}x>250&&(x=250),b=((g[f]||{}).DBF||{}).type,b=="C"&&g[f].DBF.len>x&&(x=g[f].DBF.len),y=="B"&&b=="N"&&(y="N",R[f]=g[f].DBF.dec,x=g[f].DBF.len),D[f]=y=="C"||b=="N"?x:n[y]||0,w+=D[f],F[f]=y}var A=u.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*v),A.write_shift(2,w),f=0;f<4;++f)A.write_shift(4,0);for(A.write_shift(4,0|(+t[O1]||3)<<8),f=0,m=0;f<h.length;++f)if(h[f]!=null){var P=u.next(32),U=(h[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,U,"sbcs"),P.write_shift(1,F[f]=="?"?"C":F[f],"sbcs"),P.write_shift(4,m),P.write_shift(1,D[f]||n[F[f]]||0),P.write_shift(1,R[f]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),m+=D[f]||n[F[f]]||0}var J=u.next(264);for(J.write_shift(4,13),f=0;f<65;++f)J.write_shift(4,0);for(f=0;f<p.length;++f){var B=u.next(w);for(B.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(F[m]){case"L":B.write_shift(1,p[f][m]==null?63:p[f][m]?84:70);break;case"B":B.write_shift(8,p[f][m]||0,"f");break;case"N":var H="0";for(typeof p[f][m]=="number"&&(H=p[f][m].toFixed(R[m]||0)),v=0;v<D[m]-H.length;++v)B.write_shift(1,32);B.write_shift(1,H,"sbcs");break;case"D":p[f][m]?(B.write_shift(4,("0000"+p[f][m].getFullYear()).slice(-4),"sbcs"),B.write_shift(2,("00"+(p[f][m].getMonth()+1)).slice(-2),"sbcs"),B.write_shift(2,("00"+p[f][m].getDate()).slice(-2),"sbcs")):B.write_shift(8,"00000000","sbcs");break;case"C":var _=String(p[f][m]!=null?p[f][m]:"").slice(0,D[m]);for(B.write_shift(1,_,"sbcs"),v=0;v<D[m]-_.length;++v)B.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:i,from_sheet:o}}(),QW=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Fs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=e[p];return typeof g=="number"?gw(g):g},i=function(h,p,g){var f=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return f==59?h:gw(f)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return n(wi(h),p);case"binary":return n(h,p);case"buffer":return n(Ct&&Buffer.isBuffer(h)?h.toString("binary"):Ho(h),p);case"array":return n(ko(h),p)}throw new Error("Unrecognized type "+p.type)}function n(h,p){var g=h.split(/[\n\r]+/),f=-1,m=-1,v=0,w=0,C=[],F=[],D=null,R={},y=[],b=[],x=[],T=0,A;for(+p.codepage>=0&&Xi(+p.codepage);v!==g.length;++v){T=0;var P=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,r),U=P.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),J=U[0],B;if(P.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&F.push(P.slice(3).replace(/;;/g,";"));break;case"C":var H=!1,_=!1,se=!1,G=!1,he=-1,Re=-1;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"A":break;case"X":m=parseInt(U[w].slice(1))-1,_=!0;break;case"Y":for(f=parseInt(U[w].slice(1))-1,_||(m=0),A=C.length;A<=f;++A)C[A]=[];break;case"K":B=U[w].slice(1),B.charAt(0)==='"'?B=B.slice(1,B.length-1):B==="TRUE"?B=!0:B==="FALSE"?B=!1:isNaN(Zi(B))?isNaN(ka(B).getDate())||(B=fr(B)):(B=Zi(B),D!==null&&Ka(D)&&(B=wh(B))),H=!0;break;case"E":G=!0;var M=Ca(U[w].slice(1),{r:f,c:m});C[f][m]=[C[f][m],M];break;case"S":se=!0,C[f][m]=[C[f][m],"S5S"];break;case"G":break;case"R":he=parseInt(U[w].slice(1))-1;break;case"C":Re=parseInt(U[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(H&&(C[f][m]&&C[f][m].length==2?C[f][m][0]=B:C[f][m]=B,D=null),se){if(G)throw new Error("SYLK shared formula cannot have own formula");var X=he>-1&&C[he][Re];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");C[f][m][1]=KR(X[1],{r:f-he,c:m-Re})}break;case"F":var z=0;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"X":m=parseInt(U[w].slice(1))-1,++z;break;case"Y":for(f=parseInt(U[w].slice(1))-1,A=C.length;A<=f;++A)C[A]=[];break;case"M":T=parseInt(U[w].slice(1))/20;break;case"F":break;case"G":break;case"P":D=F[parseInt(U[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(x=U[w].slice(1).split(" "),A=parseInt(x[0],10);A<=parseInt(x[1],10);++A)T=parseInt(x[2],10),b[A-1]=T===0?{hidden:!0}:{wch:T},_a(b[A-1]);break;case"C":m=parseInt(U[w].slice(1))-1,b[m]||(b[m]={});break;case"R":f=parseInt(U[w].slice(1))-1,y[f]||(y[f]={}),T>0?(y[f].hpt=T,y[f].hpx=wc(T)):T===0&&(y[f].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}z<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return y.length>0&&(R["!rows"]=y),b.length>0&&(R["!cols"]=b),p&&p.sheetRows&&(C=C.slice(0,p.sheetRows)),[C,R]}function o(h,p){var g=s(h,p),f=g[0],m=g[1],v=qa(f,p);return Fs(m).forEach(function(w){v[w]=m[w]}),v}function a(h,p){return zn(o(h,p),p)}function l(h,p,g,f){var m="C;Y"+(g+1)+";X"+(f+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+Nz(h.f,{r:g,c:f}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(h,p){p.forEach(function(g,f){var m="F;W"+(f+1)+" "+(f+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Pd(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Dd(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function u(h,p){p.forEach(function(g,f){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*zR(g.hpx)+";"),m.length>2&&h.push(m+"R"+(f+1))})}function d(h,p){var g=["ID;PWXL;N;E"],f=[],m=Xt(h["!ref"]),v,w=Array.isArray(h),C=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var F=m.s.r;F<=m.e.r;++F)for(var D=m.s.c;D<=m.e.c;++D){var R=st({r:F,c:D});v=w?(h[F]||[])[D]:h[R],!(!v||v.v==null&&(!v.f||v.F))&&f.push(l(v,h,F,D))}return g.join(C)+C+f.join(C)+C+"E"+C}return{to_workbook:a,to_sheet:o,from_sheet:d}}(),JW=function(){function e(n,o){switch(o.type){case"base64":return t(wi(n),o);case"binary":return t(n,o);case"buffer":return t(Ct&&Buffer.isBuffer(n)?n.toString("binary"):Ho(n),o);case"array":return t(ko(n),o)}throw new Error("Unrecognized type "+o.type)}function t(n,o){for(var a=n.split(`
`),l=-1,c=-1,u=0,d=[];u!==a.length;++u){if(a[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=a[u].trim().split(","),p=h[0],g=h[1];++u;for(var f=a[u]||"";(f.match(/["]/g)||[]).length&1&&u<a.length-1;)f+=`
`+a[++u];switch(f=f.trim(),+p){case-1:if(f==="BOT"){d[++l]=[],c=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:f==="TRUE"?d[l][c]=!0:f==="FALSE"?d[l][c]=!1:isNaN(Zi(g))?isNaN(ka(g).getDate())?d[l][c]=g:d[l][c]=fr(g):d[l][c]=Zi(g),++c;break;case 1:f=f.slice(1,f.length-1),f=f.replace(/""/g,'"'),f&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),d[l][c++]=f!==""?f:null;break}if(f==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(n,o){return qa(e(n,o),o)}function i(n,o){return zn(r(n,o),o)}var s=function(){var n=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=Xt(l["!ref"]),d,h=Array.isArray(l);n(c,"TABLE",0,1,"sheetjs"),n(c,"VECTORS",0,u.e.r-u.s.r+1,""),n(c,"TUPLES",0,u.e.c-u.s.c+1,""),n(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){o(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var f=st({r:p,c:g});if(d=h?(l[p]||[])[g]:l[f],!d){o(c,1,0,"");continue}switch(d.t){case"n":var m=d.w;!m&&d.v!=null&&(m=d.v),m==null?d.f&&!d.F?o(c,1,0,"="+d.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Oi(d.z||lt[14],Qr(fr(d.v)))),o(c,0,d.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}}();return{to_workbook:i,to_sheet:r,from_sheet:s}}(),ZW=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),g=-1,f=-1,m=0,v=[];m!==p.length;++m){var w=p[m].trim().split(":");if(w[0]==="cell"){var C=Kr(w[1]);if(v.length<=C.r)for(g=v.length;g<=C.r;++g)v[g]||(v[g]=[]);switch(g=C.r,f=C.c,w[2]){case"t":v[g][f]=e(w[3]);break;case"v":v[g][f]=+w[3];break;case"vtf":var F=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[g][f]=!!+w[4];break;default:v[g][f]=+w[4];break}w[2]=="vtf"&&(v[g][f]=[v[g][f],F])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function i(d,h){return qa(r(d,h),h)}function s(d,h){return zn(i(d,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],g,f="",m=ja(d["!ref"]),v=Array.isArray(d),w=m.s.r;w<=m.e.r;++w)for(var C=m.s.c;C<=m.e.c;++C)if(f=st({r:w,c:C}),g=v?(d[w]||[])[C]:d[f],!(!g||g.v==null||g.t==="z")){switch(p=["cell",f,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var F=Qr(fr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+F,p[5]=g.w||Oi(g.z||lt[14],F);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[n,o,a,o,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:u}}(),vc=function(){function e(u,d,h,p,g){g.raw?d[h][p]=u:u===""||(u==="TRUE"?d[h][p]=!0:u==="FALSE"?d[h][p]=!1:isNaN(Zi(u))?isNaN(ka(u).getDate())?d[h][p]=u:d[h][p]=fr(u):d[h][p]=Zi(u))}function t(u,d){var h=d||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),f=g.length-1;f>=0&&g[f].length===0;)--f;for(var m=10,v=0,w=0;w<=f;++w)v=g[w].indexOf(" "),v==-1?v=g[w].length:v++,m=Math.max(m,v);for(w=0;w<=f;++w){p[w]=[];var C=0;for(e(g[w].slice(0,m).trim(),p,w,C,h),C=1;C<=(g[w].length-m)/10+1;++C)e(g[w].slice(m+(C-1)*10,m+C*10).trim(),p,w,C,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(u){for(var d={},h=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p]);if(!g.length){d=i;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p])}return g.sort(function(f,m){return f[0]-m[0]||i[f[1]]-i[m[1]]}),r[g.pop()[1]]||44}function n(u,d){var h=d||{},p="",g=h.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var m=0,v=0,w=0,C=0,F=0,D=p.charCodeAt(0),R=!1,y=0,b=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var x=h.dateNF!=null?u8(h.dateNF):null;function T(){var A=u.slice(C,F),P={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)P.t="z";else if(h.raw)P.t="s",P.v=A;else if(A.trim().length===0)P.t="s",P.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(P.t="s",P.v=A.slice(2,-1).replace(/""/g,'"')):Gz(A)?(P.t="n",P.f=A.slice(1)):(P.t="s",P.v=A);else if(A=="TRUE")P.t="b",P.v=!0;else if(A=="FALSE")P.t="b",P.v=!1;else if(!isNaN(w=Zi(A)))P.t="n",h.cellText!==!1&&(P.w=A),P.v=w;else if(!isNaN(ka(A).getDate())||x&&A.match(x)){P.z=h.dateNF||lt[14];var U=0;x&&A.match(x)&&(A=d8(A,h.dateNF,A.match(x)||[]),U=1),h.cellDates?(P.t="d",P.v=fr(A,U)):(P.t="n",P.v=Qr(fr(A,U))),h.cellText!==!1&&(P.w=Oi(P.z,P.v instanceof Date?Qr(P.v):P.v)),h.cellNF||delete P.z}else P.t="s",P.v=A;if(P.t=="z"||(h.dense?(g[m]||(g[m]=[]),g[m][v]=P):g[st({c:v,r:m})]=P),C=F+1,b=u.charCodeAt(C),f.e.c<v&&(f.e.c=v),f.e.r<m&&(f.e.r=m),y==D)++v;else if(v=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;F<u.length;++F)switch(y=u.charCodeAt(F)){case 34:b===34&&(R=!R);break;case D:case 10:case 13:if(!R&&T())break e;break}return F-C>0&&T(),g["!ref"]=xt(f),g}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?n(u,d):qa(t(u,d),d)}function a(u,d){var h="",p=d.type=="string"?[0,0,0,0]:z0(u,d);switch(d.type){case"base64":h=wi(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof xn<"u"?h=xn.utils.decode(d.codepage,u):h=Ct&&Buffer.isBuffer(u)?u.toString("binary"):Ho(u);break;case"array":h=ko(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Lt(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Lt(h):d.type=="binary"&&typeof xn<"u"&&d.codepage&&(h=xn.utils.decode(d.codepage,xn.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?ZW.to_sheet(d.type=="string"?h:Lt(h),d):o(h,d)}function l(u,d){return zn(a(u,d),d)}function c(u){for(var d=[],h=Xt(u["!ref"]),p,g=Array.isArray(u),f=h.s.r;f<=h.e.r;++f){for(var m=[],v=h.s.c;v<=h.e.c;++v){var w=st({r:f,c:v});if(p=g?(u[f]||[])[v]:u[w],!p||p.v==null){m.push("          ");continue}for(var C=(p.w||(Xs(p),p.w)||"").slice(0,10);C.length<10;)C+=" ";m.push(C+(v===0?" ":""))}d.push(m.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function e5(e,t){var r=t||{},i=!!r.WTF;r.WTF=!0;try{var s=QW.to_workbook(e,r);return r.WTF=i,s}catch(n){if(r.WTF=i,!n.message.match(/SYLK bad record ID/)&&i)throw n;return vc.to_workbook(e,t)}}var Hl=function(){function e(M,X,z){if(M){wr(M,M.l||0);for(var Y=z.Enum||he;M.l<M.length;){var ae=M.read_shift(2),W=Y[ae]||Y[65535],re=M.read_shift(2),Z=M.l+re,ee=W.f&&W.f(M,re,z);if(M.l=Z,X(ee,W,ae))return}}}function t(M,X){switch(X.type){case"base64":return r(Ki(wi(M)),X);case"binary":return r(Ki(M),X);case"buffer":case"array":return r(M,X)}throw"Unsupported type "+X.type}function r(M,X){if(!M)return M;var z=X||{},Y=z.dense?[]:{},ae="Sheet1",W="",re=0,Z={},ee=[],Fe=[],L={s:{r:0,c:0},e:{r:0,c:0}},I=z.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)z.Enum=he,e(M,function(j,oe,pe){switch(pe){case 0:z.vers=j,j>=4096&&(z.qpro=!0);break;case 6:L=j;break;case 204:j&&(W=j);break;case 222:W=j;break;case 15:case 51:z.qpro||(j[1].v=j[1].v.slice(1));case 13:case 14:case 16:pe==14&&(j[2]&112)==112&&(j[2]&15)>1&&(j[2]&15)<15&&(j[1].z=z.dateNF||lt[14],z.cellDates&&(j[1].t="d",j[1].v=wh(j[1].v))),z.qpro&&j[3]>re&&(Y["!ref"]=xt(L),Z[ae]=Y,ee.push(ae),Y=z.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},re=j[3],ae=W||"Sheet"+(re+1),W="");var fe=z.dense?(Y[j[0].r]||[])[j[0].c]:Y[st(j[0])];if(fe){fe.t=j[1].t,fe.v=j[1].v,j[1].z!=null&&(fe.z=j[1].z),j[1].f!=null&&(fe.f=j[1].f);break}z.dense?(Y[j[0].r]||(Y[j[0].r]=[]),Y[j[0].r][j[0].c]=j[1]):Y[st(j[0])]=j[1];break}},z);else if(M[2]==26||M[2]==14)z.Enum=Re,M[2]==14&&(z.qpro=!0,M.l=0),e(M,function(j,oe,pe){switch(pe){case 204:ae=j;break;case 22:j[1].v=j[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(j[3]>re&&(Y["!ref"]=xt(L),Z[ae]=Y,ee.push(ae),Y=z.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},re=j[3],ae="Sheet"+(re+1)),I>0&&j[0].r>=I)break;z.dense?(Y[j[0].r]||(Y[j[0].r]=[]),Y[j[0].r][j[0].c]=j[1]):Y[st(j[0])]=j[1],L.e.c<j[0].c&&(L.e.c=j[0].c),L.e.r<j[0].r&&(L.e.r=j[0].r);break;case 27:j[14e3]&&(Fe[j[14e3][0]]=j[14e3][1]);break;case 1537:Fe[j[0]]=j[1],j[0]==re&&(ae=j[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(Y["!ref"]=xt(L),Z[W||ae]=Y,ee.push(W||ae),!Fe.length)return{SheetNames:ee,Sheets:Z};for(var V={},ie=[],ne=0;ne<Fe.length;++ne)Z[ee[ne]]?(ie.push(Fe[ne]||ee[ne]),V[Fe[ne]]=Z[Fe[ne]]||Z[ee[ne]]):(ie.push(Fe[ne]),V[Fe[ne]]={"!ref":"A1"});return{SheetNames:ie,Sheets:V}}function i(M,X){var z=X||{};if(+z.codepage>=0&&Xi(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Ap(),ae=Xt(M["!ref"]),W=Array.isArray(M),re=[];Hi(Y,0,n(1030)),Hi(Y,6,l(ae));for(var Z=Math.min(ae.e.r,8191),ee=ae.s.r;ee<=Z;++ee)for(var Fe=Rr(ee),L=ae.s.c;L<=ae.e.c;++L){ee===ae.s.r&&(re[L]=or(L));var I=re[L]+Fe,V=W?(M[ee]||[])[L]:M[I];if(!(!V||V.t=="z"))if(V.t=="n")(V.v|0)==V.v&&V.v>=-32768&&V.v<=32767?Hi(Y,13,p(ee,L,V.v)):Hi(Y,14,f(ee,L,V.v));else{var ie=Xs(V);Hi(Y,15,d(ee,L,ie.slice(0,239)))}}return Hi(Y,1),Y.end()}function s(M,X){var z=X||{};if(+z.codepage>=0&&Xi(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Ap();Hi(Y,0,o(M));for(var ae=0,W=0;ae<M.SheetNames.length;++ae)(M.Sheets[M.SheetNames[ae]]||{})["!ref"]&&Hi(Y,27,G(M.SheetNames[ae],W++));var re=0;for(ae=0;ae<M.SheetNames.length;++ae){var Z=M.Sheets[M.SheetNames[ae]];if(!(!Z||!Z["!ref"])){for(var ee=Xt(Z["!ref"]),Fe=Array.isArray(Z),L=[],I=Math.min(ee.e.r,8191),V=ee.s.r;V<=I;++V)for(var ie=Rr(V),ne=ee.s.c;ne<=ee.e.c;++ne){V===ee.s.r&&(L[ne]=or(ne));var j=L[ne]+ie,oe=Fe?(Z[V]||[])[ne]:Z[j];if(!(!oe||oe.t=="z"))if(oe.t=="n")Hi(Y,23,T(V,ne,re,oe.v));else{var pe=Xs(oe);Hi(Y,22,y(V,ne,re,pe.slice(0,239)))}}++re}}return Hi(Y,1),Y.end()}function n(M){var X=sr(2);return X.write_shift(2,M),X}function o(M){var X=sr(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var z=0,Y=0,ae=0,W=0;W<M.SheetNames.length;++W){var re=M.SheetNames[W],Z=M.Sheets[re];if(!(!Z||!Z["!ref"])){++ae;var ee=ja(Z["!ref"]);z<ee.e.r&&(z=ee.e.r),Y<ee.e.c&&(Y=ee.e.c)}}return z>8191&&(z=8191),X.write_shift(2,z),X.write_shift(1,ae),X.write_shift(1,Y),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function a(M,X,z){var Y={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&z.qpro?(Y.s.c=M.read_shift(1),M.l++,Y.s.r=M.read_shift(2),Y.e.c=M.read_shift(1),M.l++,Y.e.r=M.read_shift(2),Y):(Y.s.c=M.read_shift(2),Y.s.r=M.read_shift(2),X==12&&z.qpro&&(M.l+=2),Y.e.c=M.read_shift(2),Y.e.r=M.read_shift(2),X==12&&z.qpro&&(M.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(M){var X=sr(8);return X.write_shift(2,M.s.c),X.write_shift(2,M.s.r),X.write_shift(2,M.e.c),X.write_shift(2,M.e.r),X}function c(M,X,z){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(Y[0].c=M.read_shift(1),Y[3]=M.read_shift(1),Y[0].r=M.read_shift(2),M.l+=2):(Y[2]=M.read_shift(1),Y[0].c=M.read_shift(2),Y[0].r=M.read_shift(2)),Y}function u(M,X,z){var Y=M.l+X,ae=c(M,X,z);if(ae[1].t="s",z.vers==20768){M.l++;var W=M.read_shift(1);return ae[1].v=M.read_shift(W,"utf8"),ae}return z.qpro&&M.l++,ae[1].v=M.read_shift(Y-M.l,"cstr"),ae}function d(M,X,z){var Y=sr(7+z.length);Y.write_shift(1,255),Y.write_shift(2,X),Y.write_shift(2,M),Y.write_shift(1,39);for(var ae=0;ae<Y.length;++ae){var W=z.charCodeAt(ae);Y.write_shift(1,W>=128?95:W)}return Y.write_shift(1,0),Y}function h(M,X,z){var Y=c(M,X,z);return Y[1].v=M.read_shift(2,"i"),Y}function p(M,X,z){var Y=sr(7);return Y.write_shift(1,255),Y.write_shift(2,X),Y.write_shift(2,M),Y.write_shift(2,z,"i"),Y}function g(M,X,z){var Y=c(M,X,z);return Y[1].v=M.read_shift(8,"f"),Y}function f(M,X,z){var Y=sr(13);return Y.write_shift(1,255),Y.write_shift(2,X),Y.write_shift(2,M),Y.write_shift(8,z,"f"),Y}function m(M,X,z){var Y=M.l+X,ae=c(M,X,z);if(ae[1].v=M.read_shift(8,"f"),z.qpro)M.l=Y;else{var W=M.read_shift(2);F(M.slice(M.l,M.l+W),ae),M.l+=W}return ae}function v(M,X,z){var Y=X&32768;return X&=-32769,X=(Y?M:0)+(X>=8192?X-16384:X),(Y?"":"$")+(z?or(X):Rr(X))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(M,X){wr(M,0);for(var z=[],Y=0,ae="",W="",re="",Z="";M.l<M.length;){var ee=M[M.l++];switch(ee){case 0:z.push(M.read_shift(8,"f"));break;case 1:W=v(X[0].c,M.read_shift(2),!0),ae=v(X[0].r,M.read_shift(2),!1),z.push(W+ae);break;case 2:{var Fe=v(X[0].c,M.read_shift(2),!0),L=v(X[0].r,M.read_shift(2),!1);W=v(X[0].c,M.read_shift(2),!0),ae=v(X[0].r,M.read_shift(2),!1),z.push(Fe+L+":"+W+ae)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(M.read_shift(2));break;case 6:{for(var I="";ee=M[M.l++];)I+=String.fromCharCode(ee);z.push('"'+I.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Z=z.pop(),re=z.pop(),z.push(["AND","OR"][ee-20]+"("+re+","+Z+")");break;default:if(ee<32&&C[ee])Z=z.pop(),re=z.pop(),z.push(re+C[ee]+Z);else if(w[ee]){if(Y=w[ee][1],Y==69&&(Y=M[M.l++]),Y>z.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+z.join("|")+"|");return}var V=z.slice(-Y);z.length-=Y,z.push(w[ee][0]+"("+V.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}z.length==1?X[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function D(M){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=M.read_shift(2),X[3]=M[M.l++],X[0].c=M[M.l++],X}function R(M,X){var z=D(M);return z[1].t="s",z[1].v=M.read_shift(X-4,"cstr"),z}function y(M,X,z,Y){var ae=sr(6+Y.length);ae.write_shift(2,M),ae.write_shift(1,z),ae.write_shift(1,X),ae.write_shift(1,39);for(var W=0;W<Y.length;++W){var re=Y.charCodeAt(W);ae.write_shift(1,re>=128?95:re)}return ae.write_shift(1,0),ae}function b(M,X){var z=D(M);z[1].v=M.read_shift(2);var Y=z[1].v>>1;if(z[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return z[1].v=Y,z}function x(M,X){var z=D(M),Y=M.read_shift(4),ae=M.read_shift(4),W=M.read_shift(2);if(W==65535)return Y===0&&ae===3221225472?(z[1].t="e",z[1].v=15):Y===0&&ae===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var re=W&32768;return W=(W&32767)-16446,z[1].v=(1-re*2)*(ae*Math.pow(2,W+32)+Y*Math.pow(2,W)),z}function T(M,X,z,Y){var ae=sr(14);if(ae.write_shift(2,M),ae.write_shift(1,z),ae.write_shift(1,X),Y==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var W=0,re=0,Z=0,ee=0;return Y<0&&(W=1,Y=-Y),re=Math.log2(Y)|0,Y/=Math.pow(2,re-31),ee=Y>>>0,ee&2147483648||(Y/=2,++re,ee=Y>>>0),Y-=ee,ee|=2147483648,ee>>>=0,Y*=Math.pow(2,32),Z=Y>>>0,ae.write_shift(4,Z),ae.write_shift(4,ee),re+=16383+(W?32768:0),ae.write_shift(2,re),ae}function A(M,X){var z=x(M);return M.l+=X-14,z}function P(M,X){var z=D(M),Y=M.read_shift(4);return z[1].v=Y>>6,z}function U(M,X){var z=D(M),Y=M.read_shift(8,"f");return z[1].v=Y,z}function J(M,X){var z=U(M);return M.l+=X-10,z}function B(M,X){return M[M.l+X-1]==0?M.read_shift(X,"cstr"):""}function H(M,X){var z=M[M.l++];z>X-1&&(z=X-1);for(var Y="";Y.length<z;)Y+=String.fromCharCode(M[M.l++]);return Y}function _(M,X,z){if(!(!z.qpro||X<21)){var Y=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ae=M.read_shift(X-21,"cstr");return[Y,ae]}}function se(M,X){for(var z={},Y=M.l+X;M.l<Y;){var ae=M.read_shift(2);if(ae==14e3){for(z[ae]=[0,""],z[ae][0]=M.read_shift(2);M[M.l];)z[ae][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return z}function G(M,X){var z=sr(5+M.length);z.write_shift(2,14e3),z.write_shift(2,X);for(var Y=0;Y<M.length;++Y){var ae=M.charCodeAt(Y);z[z.l++]=ae>127?95:ae}return z[z.l++]=0,z}var he={0:{n:"BOF",f:tr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:B},222:{n:"SHEETNAMELP",f:H},65535:{n:""}},Re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:x},24:{n:"NUMBER18",f:b},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:B},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:t}}();function t5(e){var t={},r=e.match(Gr),i=0,s=!1;if(r)for(;i!=r.length;++i){var n=tt(r[i]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=w0[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var r5=function(){var e=gc("t"),t=gc("rPr");function r(n){var o=n.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:Et(o[1])},l=n.match(t);return l&&(a.s=t5(l[1])),a}var i=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(i,"").split(s).map(r).filter(function(a){return a.v})}}(),i5=function(){var t=/(\r\n|\n)/g;function r(s,n,o){var a=[];s.u&&a.push("text-decoration: underline;"),s.uval&&a.push("text-underline-style:"+s.uval+";"),s.sz&&a.push("font-size:"+s.sz+"pt;"),s.outline&&a.push("text-effect: outline;"),s.shadow&&a.push("text-shadow: auto;"),n.push('<span style="'+a.join("")+'">'),s.b&&(n.push("<b>"),o.push("</b>")),s.i&&(n.push("<i>"),o.push("</i>")),s.strike&&(n.push("<s>"),o.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),s}function i(s){var n=[[],s.v,[]];return s.v?(s.s&&r(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(i).join("")}}(),s5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,n5=/<(?:\w+:)?r>/,o5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function L0(e,t){var r=t?t.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Et(Lt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=Lt(e),r&&(i.h=F0(i.t))):e.match(n5)&&(i.r=Lt(e),i.t=Et(Lt((e.replace(o5,"").match(s5)||[]).join("").replace(Gr,""))),r&&(i.h=i5(r5(i.r)))),i):{t:""}}var a5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,l5=/<(?:\w+:)?(?:si|sstItem)>/g,c5=/<\/(?:\w+:)?(?:si|sstItem)>/;function u5(e,t){var r=[],i="";if(!e)return r;var s=e.match(a5);if(s){i=s[2].replace(l5,"").split(c5);for(var n=0;n!=i.length;++n){var o=L0(i[n].trim(),t);o!=null&&(r[r.length]=o)}s=tt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function d5(e){return[e.read_shift(4),e.read_shift(4)]}function h5(e,t){var r=[],i=!1;return nn(e,function(n,o,a){switch(a){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(o.T,!i||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function NR(e){for(var t=[],r=e.split(""),i=0;i<r.length;++i)t[i]=r[i].charCodeAt(0);return t}function $s(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function f5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=$s(e,4),t.U=$s(e,4),t.W=$s(e,4),t}function p5(e){for(var t=e.read_shift(4),r=e.l+t-4,i={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return i}function g5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(p5(e));return t}function m5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function v5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=$s(e,4),t.U=$s(e,4),t.W=$s(e,4),t}function C5(e){var t=v5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function BR(e,t){var r=e.l+t,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var s=!1;switch(i.AlgID){case 26126:case 26127:case 26128:s=i.Flags==36;break;case 26625:s=i.Flags==4;break;case 0:s=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,i}function GR(e,t){var r={},i=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,i),e.l=i,r}function w5(e){var t=$s(e);switch(t.Minor){case 2:return[t.Minor,S5(e)];case 3:return[t.Minor,y5()];case 4:return[t.Minor,x5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function S5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),i=BR(e,r),s=GR(e,e.length-e.l);return{t:"Std",h:i,v:s}}function y5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function x5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),i={};return r.replace(Gr,function(n){var o=tt(n);switch(Ts(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(a){i[a]=o[a]});break;case"<dataIntegrity":i.encryptedHmacKey=o.encryptedHmacKey,i.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(o);break;default:throw o[0]}}),i}function b5(e,t){var r={},i=r.EncryptionVersionInfo=$s(e,4);if(t-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=BR(e,s),t-=s,r.EncryptionVerifier=GR(e,t),r}function R5(e){var t={},r=t.EncryptionVersionInfo=$s(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function E5(e){var t=0,r,i=NR(e),s=i.length+1,n,o,a,l,c;for(r=On(s),r[0]=i.length,n=1;n!=s;++n)r[n]=i[n-1];for(n=s-1;n>=0;--n)o=r[n],a=t&16384?1:0,l=t<<1&32767,c=a|l,t=c^o;return t^52811}var HR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(o){return(o/2|o*128)&255},s=function(o,a){return i(o^a)},n=function(o){for(var a=t[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],d=0;d!=7;++d)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=NR(o),l=n(a),c=a.length,u=On(16),d=0;d!=16;++d)u[d]=0;var h,p,g;for((c&1)===1&&(h=l>>8,u[c]=s(e[0],h),--c,h=l&255,p=a[a.length-1],u[c]=s(p,h));c>0;)--c,h=l>>8,u[c]=s(a[c],h),--c,h=l&255,u[c]=s(a[c],h);for(c=15,g=15-a.length;g>0;)h=l>>8,u[c]=s(e[g],h),--c,--g,h=l&255,u[c]=s(a[c],h),--c,--g;return u}}(),F5=function(e,t,r,i,s){s||(s=t),i||(i=HR(e));var n,o;for(n=0;n!=t.length;++n)o=t[n],o^=i[r],o=(o>>5|o<<3)&255,s[n]=o,++r;return[s,r,i]},T5=function(e){var t=0,r=HR(e);return function(i){var s=F5("",i,t,r);return t=s[1],s[0]}};function A5(e,t,r,i){var s={key:tr(e),verificationBytes:tr(e)};return r.password&&(s.verifier=E5(r.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=T5(r.password)),s}function P5(e,t,r){var i=r||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=R5(e):i.Data=b5(e,t),i}function D5(e,t,r){var i={Type:r.biff>=8?e.read_shift(2):0};return i.Type?P5(e,t-2,i):A5(e,r.biff>=8?t:t-2,r,i),i}var M5=function(){function e(s,n){switch(n.type){case"base64":return t(wi(s),n);case"binary":return t(s,n);case"buffer":return t(Ct&&Buffer.isBuffer(s)?s.toString("binary"):Ho(s),n);case"array":return t(ko(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var o=n||{},a=o.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(a)&&(a[d]=[]);for(var h=/\\\w+\b/g,p=0,g,f=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var m=u.slice(p,h.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++f,m.length){var v={v:m,t:"s"};Array.isArray(a)?a[d][f]=v:a[st({r:d,c:f})]=v}break}p=h.lastIndex}f>c.e.c&&(c.e.c=f)}),a["!ref"]=xt(c),a}function r(s,n){return zn(e(s,n),n)}function i(s){for(var n=["{\\rtf1\\ansi"],o=Xt(s["!ref"]),a,l=Array.isArray(s),c=o.s.r;c<=o.e.r;++c){n.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)n.push("\\cellx"+(u+1));for(n.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=st({r:c,c:u});a=l?(s[c]||[])[u]:s[d],!(!a||a.v==null&&(!a.f||a.F))&&(n.push(" "+(a.w||(Xs(a),a.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:i}}();function k5(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Cc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function _5(e){var t=e[0]/255,r=e[1]/255,i=e[2]/255,s=Math.max(t,r,i),n=Math.min(t,r,i),o=s-n;if(o===0)return[0,0,t];var a=0,l=0,c=s+n;switch(l=o/(c>1?2-c:c),s){case t:a=((r-i)/o+6)%6;break;case r:a=(i-t)/o+2;break;case i:a=(t-r)/o+4;break}return[a/6,l,c/2]}function I5(e){var t=e[0],r=e[1],i=e[2],s=r*2*(i<.5?i:1-i),n=i-s/2,o=[n,n,n],a=6*t,l;if(r!==0)switch(a|0){case 0:case 6:l=s*a,o[0]+=s,o[1]+=l;break;case 1:l=s*(2-a),o[0]+=l,o[1]+=s;break;case 2:l=s*(a-2),o[1]+=s,o[2]+=l;break;case 3:l=s*(4-a),o[1]+=l,o[2]+=s;break;case 4:l=s*(a-4),o[2]+=s,o[0]+=l;break;case 5:l=s*(6-a),o[2]+=l,o[0]+=s;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function Ad(e,t){if(t===0)return e;var r=_5(k5(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Cc(I5(r))}var VR=6,O5=15,L5=1,zr=VR;function Pd(e){return Math.floor((e+Math.round(128/zr)/256)*zr)}function Dd(e){return Math.floor((e-5)/zr*100+.5)/100}function kp(e){return Math.round((e*zr+5)/zr*256)/256}function pf(e){return kp(Dd(Pd(e)))}function N0(e){var t=Math.abs(e-pf(e)),r=zr;if(t>.005)for(zr=L5;zr<O5;++zr)Math.abs(e-pf(e))<=t&&(t=Math.abs(e-pf(e)),r=zr);zr=r}function _a(e){e.width?(e.wpx=Pd(e.width),e.wch=Dd(e.wpx),e.MDW=zr):e.wpx?(e.wch=Dd(e.wpx),e.width=kp(e.wch),e.MDW=zr):typeof e.wch=="number"&&(e.width=kp(e.wch),e.wpx=Pd(e.width),e.MDW=zr),e.customWidth&&delete e.customWidth}var N5=96,WR=N5;function zR(e){return e*96/WR}function wc(e){return e*WR/96}var B5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function G5(e,t,r,i){t.Borders=[];var s={},n=!1;(e[0].match(Gr)||[]).forEach(function(o){var a=tt(o);switch(Ts(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},a.diagonalUp&&(s.diagonalUp=$t(a.diagonalUp)),a.diagonalDown&&(s.diagonalDown=$t(a.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+a[0]+" in borders")}})}function H5(e,t,r,i){t.Fills=[];var s={},n=!1;(e[0].match(Gr)||[]).forEach(function(o){var a=tt(o);switch(Ts(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":a.patternType&&(s.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),a.indexed&&(s.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(s.bgColor.theme=parseInt(a.theme,10)),a.tint&&(s.bgColor.tint=parseFloat(a.tint)),a.rgb&&(s.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),a.theme&&(s.fgColor.theme=parseInt(a.theme,10)),a.tint&&(s.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(s.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+a[0]+" in fills")}})}function V5(e,t,r,i){t.Fonts=[];var s={},n=!1;(e[0].match(Gr)||[]).forEach(function(o){var a=tt(o);switch(Ts(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":a.val&&(s.name=Lt(a.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=a.val?$t(a.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=a.val?$t(a.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(a.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=a.val?$t(a.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=a.val?$t(a.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=a.val?$t(a.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=a.val?$t(a.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=a.val?$t(a.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":a.val&&(s.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(s.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(s.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(s.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=w0[parseInt(a.val,10)];break;case"<color":if(s.color||(s.color={}),a.auto&&(s.color.auto=$t(a.auto)),a.rgb)s.color.rgb=a.rgb.slice(-6);else if(a.indexed){s.color.index=parseInt(a.indexed,10);var l=So[s.color.index];s.color.index==81&&(l=So[1]),l||(l=So[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(s.color.theme=parseInt(a.theme,10),a.tint&&(s.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ad(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+a[0]+" in fonts")}})}function W5(e,t,r){t.NumberFmt=[];for(var i=Fs(lt),s=0;s<i.length;++s)t.NumberFmt[i[s]]=lt[i[s]];var n=e[0].match(Gr);if(n)for(s=0;s<n.length;++s){var o=tt(n[s]);switch(Ts(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Et(Lt(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=a}wo(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var bu=["numFmtId","fillId","fontId","borderId","xfId"],Ru=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function z5(e,t,r){t.CellXf=[];var i,s=!1;(e[0].match(Gr)||[]).forEach(function(n){var o=tt(n),a=0;switch(Ts(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=o,delete i[0],a=0;a<bu.length;++a)i[bu[a]]&&(i[bu[a]]=parseInt(i[bu[a]],10));for(a=0;a<Ru.length;++a)i[Ru[a]]&&(i[Ru[a]]=$t(i[Ru[a]]));if(t.NumberFmt&&i.numFmtId>392){for(a=392;a>60;--a)if(t.NumberFmt[i.numFmtId]==t.NumberFmt[a]){i.numFmtId=a;break}}t.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=$t(o.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var $5=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=a.match(t))&&W5(d,u,c),(d=a.match(s))&&V5(d,u,l,c),(d=a.match(i))&&H5(d,u,l,c),(d=a.match(n))&&G5(d,u,l,c),(d=a.match(r))&&z5(d,u,c),u}}();function U5(e,t){var r=e.read_shift(2),i=Ir(e);return[r,i]}function K5(e,t,r){var i={};i.sz=e.read_shift(2)/20;var s=r6(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var n=e.read_shift(2);switch(n===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(i.underline=o);var a=e.read_shift(1);a>0&&(i.family=a);var l=e.read_shift(1);switch(l>0&&(i.charset=l),e.l++,i.color=t6(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Ir(e),i}var j5=Nr;function q5(e,t){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:i,numFmtId:s}}var Y5=Nr;function X5(e,t,r){var i={};i.NumberFmt=[];for(var s in lt)i.NumberFmt[s]=lt[s];i.CellXf=[],i.Fonts=[];var n=[],o=!1;return nn(e,function(l,c,u){switch(u){case 44:i.NumberFmt[l[0]]=l[1],wo(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ad(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:n.push(u),o=!0;break;case 38:n.pop(),o=!1;break;default:if(c.T>0)n.push(u);else if(c.T<0)n.pop();else if(!o||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),i}var Q5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function J5(e,t,r){t.themeElements.clrScheme=[];var i={};(e[0].match(Gr)||[]).forEach(function(s){var n=tt(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=n.val;break;case"<a:sysClr":i.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[Q5.indexOf(n[0])]=i,i={}):i.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function Z5(){}function ez(){}var tz=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,rz=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iz=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sz(e,t,r){t.themeElements={};var i;[["clrScheme",tz,J5],["fontScheme",rz,Z5],["fmtScheme",iz,ez]].forEach(function(s){if(!(i=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](i,t,r)})}var nz=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $R(e,t){(!e||e.length===0)&&(e=oz());var r,i={};if(!(r=e.match(nz)))throw new Error("themeElements not found in theme");return sz(r[0],i,t),i.raw=e,i}function oz(e,t){var r=[tR];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function az(e,t,r){var i=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=i;return}var n=e.slice(e.l);e.l=i;var o;try{o=eR(n,{type:"array"})}catch{return}var a=gi(o,"theme/theme/theme1.xml",!0);if(a)return $R(a,r)}}function lz(e){return e.read_shift(4)}function cz(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=uz(e,4);break;case 2:t.xclrValue=DR(e);break;case 3:t.xclrValue=lz(e);break;case 4:e.l+=4;break}return e.l+=8,t}function uz(e,t){return Nr(e,t)}function dz(e,t){return Nr(e,t)}function hz(e){var t=e.read_shift(2),r=e.read_shift(2)-4,i=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=cz(e);break;case 6:i[1]=dz(e,r);break;case 14:case 15:i[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return i}function fz(e,t){var r=e.l+t;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(hz(e,r-e.l));return{ixfe:i,ext:n}}function pz(e,t){t.forEach(function(r){switch(r[0]){}})}function gz(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ir(e)}}function mz(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function vz(e){return e.l+=4,e.read_shift(4)!=0}function Cz(e,t,r){var i={Types:[],Cell:[],Value:[]},s=r||{},n=[],o=!1,a=2;return nn(e,function(l,c,u){switch(u){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(d){a==1?i.Cell.push({type:i.Types[d[0]-1].name,index:d[1]}):a==0&&i.Value.push({type:i.Types[d[0]-1].name,index:d[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:n.push(u),o=!0;break;case 36:n.pop(),o=!1;break;default:if(!c.T){if(!o||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),i}function wz(e,t,r){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var s=!1,n=2,o;return e.replace(Gr,function(a){var l=tt(a);switch(Ts(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<i.Types.length;++c)i.Types[c].name==l.name&&(o=i.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):n==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),i}function Sz(e){var t=[];if(!e)return t;var r=1;return(e.match(Gr)||[]).forEach(function(i){var s=tt(i);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function yz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var i=e.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}function xz(e,t,r){var i=[];return nn(e,function(n,o,a){switch(a){case 63:i.push(n);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),i}function bz(e,t,r,i){if(!e)return e;var s=i||{},n=!1;nn(e,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!l.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function Rz(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function eS(e,t,r,i){var s=Array.isArray(e),n;t.forEach(function(o){var a=Kr(o.ref);if(s?(e[a.r]||(e[a.r]=[]),n=e[a.r][a.c]):n=e[o.ref],!n){n={t:"z"},s?e[a.r][a.c]=n:e[o.ref]=n;var l=Xt(e["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=xt(l);c!==e["!ref"]&&(e["!ref"]=c)}n.c||(n.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&i){for(d=0;d<i.length;++d)if(u.a==i[d].id){u.a=i[d].name||u.a;break}}n.c.push(u)})}function Ez(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],i=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=tt(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Kr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&L0(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),i.push(c)}}}}),i}function Fz(e,t){var r=[],i=!1,s={},n=0;return e.replace(Gr,function(a,l){var c=tt(a);switch(Ts(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":n=l+a.length;break;case"</text>":s.t=e.slice(n,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function Tz(e,t){var r=[],i=!1;return e.replace(Gr,function(n){var o=tt(n);switch(Ts(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return n}),r}function Az(e){var t={};t.iauthor=e.read_shift(4);var r=Wo(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}var Pz=Ir;function Dz(e,t){var r=[],i=[],s={},n=!1;return nn(e,function(a,l,c){switch(c){case 632:i.push(a);break;case 635:s=a;break;case 637:s.t=a.t,s.h=a.h,s.r=a.r;break;case 636:if(s.author=i[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Mz="application/vnd.ms-office.vbaProject";function kz(e){var t=yt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,i){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(t,s,e.FileIndex[i].content)}}),yt.write(t)}function _z(){return{"!type":"dialog"}}function Iz(){return{"!type":"dialog"}}function Oz(){return{"!type":"macro"}}function Lz(){return{"!type":"macro"}}var Ca=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(i,s,n,o){var a=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=n.length>0?parseInt(n,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=t.c:--u,l?c+=t.r:--c,s+(a?"":"$")+or(u)+(l?"":"$")+Rr(c)}return function(s,n){return t=n,s.replace(e,r)}}(),UR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Nz=function(){return function(t,r){return t.replace(UR,function(i,s,n,o,a,l){var c=D0(o)-(n?0:r.c),u=P0(l)-(a?0:r.r),d=u==0?"":a?u+1:"["+u+"]",h=c==0?"":n?c+1:"["+c+"]";return s+"R"+d+"C"+h})}}();function KR(e,t){return e.replace(UR,function(r,i,s,n,o,a){return i+(s=="$"?s+n:or(D0(n)+t.c))+(o=="$"?o+a:Rr(P0(a)+t.r))})}function Bz(e,t,r){var i=ja(t),s=i.s,n=Kr(r),o={r:n.r-s.r,c:n.c-s.c};return KR(e,o)}function Gz(e){return e.length!=1}function tS(e){return e.replace(/_xlfn\./g,"")}function Zt(e){e.l+=1}function Ln(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function jR(e,t,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return qR(e);r.biff==12&&(i=4)}var s=e.read_shift(i),n=e.read_shift(i),o=Ln(e),a=Ln(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function qR(e){var t=Ln(e),r=Ln(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Hz(e,t,r){if(r.biff<8)return qR(e);var i=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),n=Ln(e),o=Ln(e);return{s:{r:i,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function YR(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Vz(e);var i=e.read_shift(r&&r.biff==12?4:2),s=Ln(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function Vz(e){var t=Ln(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Wz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function zz(e,t,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return $z(e);var s=e.read_shift(i>=12?4:2),n=e.read_shift(2),o=(n&16384)>>14,a=(n&32768)>>15;if(n&=16383,a==1)for(;s>524287;)s-=1048576;if(o==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:o,rRel:a}}function $z(e){var t=e.read_shift(2),r=e.read_shift(1),i=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:i}}function Uz(e,t,r){var i=(e[e.l++]&96)>>5,s=jR(e,r.biff>=2&&r.biff<=5?6:8,r);return[i,s]}function Kz(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var o=jR(e,n,r);return[i,s,o]}function jz(e,t,r){var i=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}function qz(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[i,s]}function Yz(e,t,r){var i=(e[e.l++]&96)>>5,s=Hz(e,t-1,r);return[i,s]}function Xz(e,t,r){var i=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[i]}function rS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Qz(e,t,r){e.l+=2;for(var i=e.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=i;++n)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Jz(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(r&&r.biff==2?1:2)]}function Zz(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(r&&r.biff==2?1:2)]}function e$(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function t$(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[i]}function XR(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function r$(e){return e.read_shift(2),XR(e)}function i$(e){return e.read_shift(2),XR(e)}function s$(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=YR(e,0,r);return[i,s]}function n$(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=zz(e,0,r);return[i,s]}function o$(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=YR(e,0,r);return[i,s,n]}function a$(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[lU[s],ZR[s],i]}function l$(e,t,r){var i=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[i==88?-1:0,e.read_shift(1)]:c$(e);return[s,(n[0]===0?ZR:aU)[n[1]]]}function c$(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function u$(e,t,r){e.l+=r&&r.biff==2?3:4}function d$(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function h$(e){return e.l++,zo[e.read_shift(1)]}function f$(e){return e.l++,e.read_shift(2)}function p$(e){return e.l++,e.read_shift(1)!==0}function g$(e){return e.l++,Mr(e)}function m$(e,t,r){return e.l++,Wc(e,t-1,r)}function v$(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Qt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Mr(e);break;case 2:r[1]=$o(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function C$(e,t,r){for(var i=e.read_shift(r.biff==12?4:2),s=[],n=0;n!=i;++n)s.push((r.biff==12?Wo:Sh)(e));return s}function w$(e,t,r){var i=0,s=0;r.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,--s==0&&(s=256));for(var n=0,o=[];n!=i&&(o[n]=[]);++n)for(var a=0;a!=s;++a)o[n][a]=v$(e,r.biff);return o}function S$(e,t,r){var i=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,n]}function y$(e,t,r){if(r.biff==5)return x$(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[i,s,n]}function x$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[t,r,i]}function b$(e,t,r){var i=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function R$(e,t,r){var i=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function E$(e,t,r){var i=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[i]}function F$(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[i,s]}var T$=Nr,A$=Nr,P$=Nr;function $c(e,t,r){return e.l+=2,[Wz(e)]}function B0(e){return e.l+=6,[]}var D$=$c,M$=B0,k$=B0,_$=$c;function QR(e){return e.l+=2,[tr(e),e.read_shift(2)&1]}var I$=$c,O$=QR,L$=B0,N$=$c,B$=$c,G$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H$(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),o=G$[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:i,c:s,C:n}}function V$(e){return e.l+=2,[e.read_shift(4)]}function W$(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function z$(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function U$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function K$(e){return e.l+=4,[0,0]}var iS={1:{n:"PtgExp",f:d$},2:{n:"PtgTbl",f:P$},3:{n:"PtgAdd",f:Zt},4:{n:"PtgSub",f:Zt},5:{n:"PtgMul",f:Zt},6:{n:"PtgDiv",f:Zt},7:{n:"PtgPower",f:Zt},8:{n:"PtgConcat",f:Zt},9:{n:"PtgLt",f:Zt},10:{n:"PtgLe",f:Zt},11:{n:"PtgEq",f:Zt},12:{n:"PtgGe",f:Zt},13:{n:"PtgGt",f:Zt},14:{n:"PtgNe",f:Zt},15:{n:"PtgIsect",f:Zt},16:{n:"PtgUnion",f:Zt},17:{n:"PtgRange",f:Zt},18:{n:"PtgUplus",f:Zt},19:{n:"PtgUminus",f:Zt},20:{n:"PtgPercent",f:Zt},21:{n:"PtgParen",f:Zt},22:{n:"PtgMissArg",f:Zt},23:{n:"PtgStr",f:m$},26:{n:"PtgSheet",f:W$},27:{n:"PtgEndSheet",f:z$},28:{n:"PtgErr",f:h$},29:{n:"PtgBool",f:p$},30:{n:"PtgInt",f:f$},31:{n:"PtgNum",f:g$},32:{n:"PtgArray",f:Xz},33:{n:"PtgFunc",f:a$},34:{n:"PtgFuncVar",f:l$},35:{n:"PtgName",f:S$},36:{n:"PtgRef",f:s$},37:{n:"PtgArea",f:Uz},38:{n:"PtgMemArea",f:b$},39:{n:"PtgMemErr",f:T$},40:{n:"PtgMemNoMem",f:A$},41:{n:"PtgMemFunc",f:R$},42:{n:"PtgRefErr",f:E$},43:{n:"PtgAreaErr",f:jz},44:{n:"PtgRefN",f:n$},45:{n:"PtgAreaN",f:Yz},46:{n:"PtgMemAreaN",f:$$},47:{n:"PtgMemNoMemN",f:U$},57:{n:"PtgNameX",f:y$},58:{n:"PtgRef3d",f:o$},59:{n:"PtgArea3d",f:Kz},60:{n:"PtgRefErr3d",f:F$},61:{n:"PtgAreaErr3d",f:qz},255:{}},j$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},q$={1:{n:"PtgElfLel",f:QR},2:{n:"PtgElfRw",f:N$},3:{n:"PtgElfCol",f:D$},6:{n:"PtgElfRwV",f:B$},7:{n:"PtgElfColV",f:_$},10:{n:"PtgElfRadical",f:I$},11:{n:"PtgElfRadicalS",f:L$},13:{n:"PtgElfColS",f:M$},15:{n:"PtgElfColSV",f:k$},16:{n:"PtgElfRadicalLel",f:O$},25:{n:"PtgList",f:H$},29:{n:"PtgSxName",f:V$},255:{}},Y$={0:{n:"PtgAttrNoop",f:K$},1:{n:"PtgAttrSemi",f:t$},2:{n:"PtgAttrIf",f:Zz},4:{n:"PtgAttrChoose",f:Qz},8:{n:"PtgAttrGoto",f:Jz},16:{n:"PtgAttrSum",f:u$},32:{n:"PtgAttrBaxcel",f:rS},33:{n:"PtgAttrBaxcel",f:rS},64:{n:"PtgAttrSpace",f:r$},65:{n:"PtgAttrSpaceSemi",f:i$},128:{n:"PtgAttrIfError",f:e$},255:{}};function Uc(e,t,r,i){if(i.biff<8)return Nr(e,t);for(var s=e.l+t,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=w$(e,0,i),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=C$(e,r[o][1],i),n.push(r[o][2]);break;case"PtgExp":i&&i.biff==12&&(r[o][1][1]=e.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&n.push(Nr(e,t)),n}function Kc(e,t,r){for(var i=e.l+t,s,n,o=[];i!=e.l;)t=i-e.l,n=e[e.l],s=iS[n]||iS[j$[n]],(n===24||n===25)&&(s=(n===24?q$:Y$)[e[e.l+1]]),!s||!s.f?Nr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function X$(e){for(var t=[],r=0;r<e.length;++r){for(var i=e[r],s=[],n=0;n<i.length;++n){var o=i[n];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Q$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function J$(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function JR(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!i)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[i[0]][0];case 355:default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function sS(e,t,r){var i=JR(e,t,r);return i=="#REF"?i:J$(i,r)}function Pr(e,t,r,i,s){var n=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,d=0,h=0,p,g="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,w=e[0].length;v<w;++v){var C=e[0][v];switch(C[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=Yt(" ",e[0][f][1][1]);break;case 1:m=Yt("\r",e[0][f][1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}c=c+m,f=-1}a.push(c+Q$[C[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ll(C[1][1],o,s),a.push(Nl(u,n));break;case"PtgRefN":u=r?Ll(C[1][1],r,s):C[1][1],a.push(Nl(u,n));break;case"PtgRef3d":d=C[1][1],u=Ll(C[1][2],o,s),g=sS(i,d,s),a.push(g+"!"+Nl(u,n));break;case"PtgFunc":case"PtgFuncVar":var F=C[1][0],D=C[1][1];F||(F=0),F&=127;var R=F==0?[]:a.slice(-F);a.length-=F,D==="User"&&(D=R.shift()),a.push(D+"("+R.join(",")+")");break;case"PtgBool":a.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(C[1]);break;case"PtgNum":a.push(String(C[1]));break;case"PtgStr":a.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(C[1]);break;case"PtgAreaN":p=Bw(C[1][1],r?{s:r}:o,s),a.push(hf(p,s));break;case"PtgArea":p=Bw(C[1][1],o,s),a.push(hf(p,s));break;case"PtgArea3d":d=C[1][1],p=C[1][2],g=sS(i,d,s),a.push(g+"!"+hf(p,s));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=C[1][2];var y=(i.names||[])[h-1]||(i[0]||[])[h],b=y?y.Name:"SH33TJSNAME"+String(h);b&&b.slice(0,6)=="_xlfn."&&!s.xlfn&&(b=b.slice(6)),a.push(b);break;case"PtgNameX":var x=C[1][1];h=C[1][2];var T;if(s.biff<=5)x<0&&(x=-x),i[x]&&(T=i[x][h]);else{var A="";if(((i[x]||[])[0]||[])[0]==14849||(((i[x]||[])[0]||[])[0]==1025?i[x][h]&&i[x][h].itab>0&&(A=i.SheetNames[i[x][h].itab-1]+"!"):A=i.SheetNames[h-1]+"!"),i[x]&&i[x][h])A+=i[x][h].Name;else if(i[0]&&i[0][h])A+=i[0][h].Name;else{var P=(JR(i,x,s)||"").split(";;");P[h-1]?A=P[h-1]:A+="SH33TJSERRX"}a.push(A);break}T||(T={Name:"SH33TJSERRY"}),a.push(T.Name);break;case"PtgParen":var U="(",J=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:U=Yt(" ",e[0][f][1][1])+U;break;case 3:U=Yt("\r",e[0][f][1][1])+U;break;case 4:J=Yt(" ",e[0][f][1][1])+J;break;case 5:J=Yt("\r",e[0][f][1][1])+J;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}a.push(U+a.pop()+J);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:C[1][1],r:C[1][0]};var B={c:r.c,r:r.r};if(i.sharedf[st(u)]){var H=i.sharedf[st(u)];a.push(Pr(H,o,B,i,s))}else{var _=!1;for(l=0;l!=i.arrayf.length;++l)if(c=i.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(Pr(c[1],o,B,i,s)),_=!0;break}_||a.push(C[1])}break;case"PtgArray":a.push("{"+X$(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&f>=0&&se.indexOf(e[0][v][0])==-1){C=e[0][f];var G=!0;switch(C[1][0]){case 4:G=!1;case 0:m=Yt(" ",C[1][1]);break;case 5:G=!1;case 1:m=Yt("\r",C[1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}a.push((G?m:"")+a.pop()+(G?"":m)),f=-1}}if(a.length>1&&s.WTF)throw new Error("bad formula stack");return a[0]}function Z$(e,t,r){var i=e.l+t,s=r.biff==2?1:2,n,o=e.read_shift(s);if(o==65535)return[[],Nr(e,t-2)];var a=Kc(e,o,r);return t!==o+s&&(n=Uc(e,t-o-s,a,r)),e.l=i,[a,n]}function eU(e,t,r){var i=e.l+t,s=r.biff==2?1:2,n,o=e.read_shift(s);if(o==65535)return[[],Nr(e,t-2)];var a=Kc(e,o,r);return t!==o+s&&(n=Uc(e,t-o-s,a,r)),e.l=i,[a,n]}function tU(e,t,r,i){var s=e.l+t,n=Kc(e,i,r),o;return s!==e.l&&(o=Uc(e,s-e.l,n,r)),[n,o]}function rU(e,t,r){var i=e.l+t,s,n=e.read_shift(2),o=Kc(e,n,r);return n==65535?[[],Nr(e,t-2)]:(t!==n+2&&(s=Uc(e,i-n-2,o,r)),[o,s])}function iU(e){var t;if(Vs(e,e.l+6)!==65535)return[Mr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function gf(e,t,r){var i=e.l+t,s=As(e);r.biff==2&&++e.l;var n=iU(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=eU(e,i-e.l,r);return{cell:s,val:n[0],formula:a,shared:o>>3&1,tt:n[1]}}function yh(e,t,r){var i=e.read_shift(4),s=Kc(e,i,r),n=e.read_shift(4),o=n>0?Uc(e,n,s,r):null;return[s,o]}var sU=yh,xh=yh,nU=yh,oU=yh,aU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function mf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Vl={},wa={};function Wl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function eE(e,t,r,i,s,n){try{i.cellNF&&(e.z=lt[t])}catch(a){if(i.WTF)throw a}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=fr(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(lt[t]==null&&wo(c8[t]||"General",t),e.t==="e")e.w=e.w||zo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pc(e.v);else if(e.t==="d"){var o=Qr(e.v);(o|0)===o?e.w=o.toString(10):e.w=pc(o)}else{if(e.v===void 0)return"";e.w=Mo(e.v,wa)}else e.t==="d"?e.w=Oi(t,Qr(e.v),wa):e.w=Oi(t,e.v,wa)}catch(a){if(i.WTF)throw a}if(i.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ad(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ad(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(i.WTF&&n.Fills)throw a}}}function cU(e,t){var r=Xt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=xt(r))}var uU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hU=/<(?:\w:)?hyperlink [^>]*>/mg,fU=/"(\w*:\w*)"/,pU=/<(?:\w:)?col\b[^>]*[\/]?>/g,gU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,mU=/<(?:\w:)?pageMargins[^>]*\/>/g,tE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,CU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wU(e,t,r,i,s,n,o){if(!e)return e;i||(i={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(dU);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(tE);h?G0(h[0],a,s,r):(h=c.match(vU))&&SU(h[0],h[1]||"",a,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(fU);g&&cU(a,g[1])}var f=c.match(CU);f&&f[1]&&FU(f[1],s);var m=[];if(t.cellStyles){var v=c.match(pU);v&&bU(m,v)}d&&TU(d[1],a,t,l,n,o);var w=u.match(gU);w&&(a["!autofilter"]=RU(w[0]));var C=[],F=u.match(uU);if(F)for(p=0;p!=F.length;++p)C[p]=Xt(F[p].slice(F[p].indexOf('"')+1));var D=u.match(hU);D&&yU(a,D,i);var R=u.match(mU);if(R&&(a["!margins"]=xU(tt(R[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=xt(l)),t.sheetRows>0&&a["!ref"]){var y=Xt(a["!ref"]);t.sheetRows<=+y.e.r&&(y.e.r=t.sheetRows-1,y.e.r>l.e.r&&(y.e.r=l.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>l.e.c&&(y.e.c=l.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),a["!fullref"]=a["!ref"],a["!ref"]=xt(y))}return m.length>0&&(a["!cols"]=m),C.length>0&&(a["!merges"]=C),a}function G0(e,t,r,i){var s=tt(e);r.Sheets[i]||(r.Sheets[i]={}),s.codeName&&(r.Sheets[i].CodeName=Et(Lt(s.codeName)))}function SU(e,t,r,i,s){G0(e.slice(0,e.indexOf(">")),r,i,s)}function yU(e,t,r){for(var i=Array.isArray(e),s=0;s!=t.length;++s){var n=tt(Lt(t[s]),!0);if(!n.ref)return;var o=((r||{})["!id"]||[])[n.id];o?(n.Target=o.Target,n.location&&(n.Target+="#"+Et(n.location))):(n.Target="#"+Et(n.location),o={Target:n.Target,TargetMode:"Internal"}),n.Rel=o,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var a=Xt(n.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=st({c,r:l});i?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=n):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=n)}}}function xU(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function bU(e,t){for(var r=!1,i=0;i!=t.length;++i){var s=tt(t[i],!0);s.hidden&&(s.hidden=$t(s.hidden));var n=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,N0(s.width)),_a(s);n<=o;)e[n++]=br(s)}}function RU(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var EU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FU(e,t){t.Views||(t.Views=[{}]),(e.match(EU)||[]).forEach(function(r,i){var s=tt(r);t.Views[i]||(t.Views[i]={}),+s.zoomScale&&(t.Views[i].zoom=+s.zoomScale),$t(s.rightToLeft)&&(t.Views[i].RTL=!0)})}var TU=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=gc("v"),o=gc("f");return function(l,c,u,d,h,p){for(var g=0,f="",m=[],v=[],w=0,C=0,F=0,D="",R,y,b=0,x=0,T,A,P=0,U=0,J=Array.isArray(p.CellXf),B,H=[],_=[],se=Array.isArray(c),G=[],he={},Re=!1,M=!!u.sheetStubs,X=l.split(t),z=0,Y=X.length;z!=Y;++z){f=X[z].trim();var ae=f.length;if(ae!==0){var W=0;e:for(g=0;g<ae;++g)switch(f[g]){case">":if(f[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(y=tt(f.slice(W,g),!0),b=y.r!=null?parseInt(y.r,10):b+1,x=-1,u.sheetRows&&u.sheetRows<b)continue;he={},Re=!1,y.ht&&(Re=!0,he.hpt=parseFloat(y.ht),he.hpx=wc(he.hpt)),y.hidden=="1"&&(Re=!0,he.hidden=!0),y.outlineLevel!=null&&(Re=!0,he.level=+y.outlineLevel),Re&&(G[b-1]=he)}break;case"<":W=g;break}if(W>=g)break;if(y=tt(f.slice(W,g),!0),b=y.r!=null?parseInt(y.r,10):b+1,x=-1,!(u.sheetRows&&u.sheetRows<b)){d.s.r>b-1&&(d.s.r=b-1),d.e.r<b-1&&(d.e.r=b-1),u&&u.cellStyles&&(he={},Re=!1,y.ht&&(Re=!0,he.hpt=parseFloat(y.ht),he.hpx=wc(he.hpt)),y.hidden=="1"&&(Re=!0,he.hidden=!0),y.outlineLevel!=null&&(Re=!0,he.level=+y.outlineLevel),Re&&(G[b-1]=he)),m=f.slice(g).split(e);for(var re=0;re!=m.length&&m[re].trim().charAt(0)=="<";++re);for(m=m.slice(re),g=0;g!=m.length;++g)if(f=m[g].trim(),f.length!==0){if(v=f.match(r),w=g,C=0,F=0,f="<c "+(f.slice(0,1)=="<"?">":"")+f,v!=null&&v.length===2){for(w=0,D=v[1],C=0;C!=D.length&&!((F=D.charCodeAt(C)-64)<1||F>26);++C)w=26*w+F;--w,x=w}else++x;for(C=0;C!=f.length&&f.charCodeAt(C)!==62;++C);if(++C,y=tt(f.slice(0,C),!0),y.r||(y.r=st({r:b-1,c:x})),D=f.slice(C),R={t:""},(v=D.match(n))!=null&&v[1]!==""&&(R.v=Et(v[1])),u.cellFormula){if((v=D.match(o))!=null&&v[1]!==""){if(R.f=Et(Lt(v[1])).replace(/\r\n/g,`
`),u.xlfn||(R.f=tS(R.f)),v[0].indexOf('t="array"')>-1)R.F=(D.match(s)||[])[1],R.F.indexOf(":")>-1&&H.push([Xt(R.F),R.F]);else if(v[0].indexOf('t="shared"')>-1){A=tt(v[0]);var Z=Et(Lt(v[1]));u.xlfn||(Z=tS(Z)),_[parseInt(A.si,10)]=[A,Z,y.r]}}else(v=D.match(/<f[^>]*\/>/))&&(A=tt(v[0]),_[A.si]&&(R.f=Bz(_[A.si][1],_[A.si][2],y.r)));var ee=Kr(y.r);for(C=0;C<H.length;++C)ee.r>=H[C][0].s.r&&ee.r<=H[C][0].e.r&&ee.c>=H[C][0].s.c&&ee.c<=H[C][0].e.c&&(R.F=H[C][1])}if(y.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(M)R.t="z";else continue;else R.t=y.t||"n";switch(d.s.c>x&&(d.s.c=x),d.e.c<x&&(d.e.c=x),R.t){case"n":if(R.v==""||R.v==null){if(!M)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!M)continue;R.t="z"}else T=Vl[parseInt(R.v,10)],R.v=T.t,R.r=T.r,u.cellHTML&&(R.h=T.h);break;case"str":R.t="s",R.v=R.v!=null?Lt(R.v):"",u.cellHTML&&(R.h=F0(R.v));break;case"inlineStr":v=D.match(i),R.t="s",v!=null&&(T=L0(v[1]))?(R.v=T.t,u.cellHTML&&(R.h=T.h)):R.v="";break;case"b":R.v=$t(R.v);break;case"d":u.cellDates?R.v=fr(R.v,1):(R.v=Qr(fr(R.v,1)),R.t="n");break;case"e":(!u||u.cellText!==!1)&&(R.w=R.v),R.v=xR[R.v];break}if(P=U=0,B=null,J&&y.s!==void 0&&(B=p.CellXf[y.s],B!=null&&(B.numFmtId!=null&&(P=B.numFmtId),u.cellStyles&&B.fillId!=null&&(U=B.fillId))),eE(R,P,U,u,h,p),u.cellDates&&J&&R.t=="n"&&Ka(lt[P])&&(R.t="d",R.v=wh(R.v)),y.cm&&u.xlmeta){var Fe=(u.xlmeta.Cell||[])[+y.cm-1];Fe&&Fe.type=="XLDAPR"&&(R.D=!0)}if(se){var L=Kr(y.r);c[L.r]||(c[L.r]=[]),c[L.r][L.c]=R}else c[y.r]=R}}}}G.length>0&&(c["!rows"]=G)}}();function AU(e,t){var r={},i=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=i,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}var PU=Wo;function DU(){}function MU(e,t){var r={},i=e[e.l];return++e.l,r.above=!(i&64),r.left=!(i&128),e.l+=18,r.name=Z8(e),r}function kU(e){var t=Li(e);return[t]}function _U(e){var t=Vo(e);return[t]}function IU(e){var t=Li(e),r=e.read_shift(1);return[t,r,"b"]}function OU(e){var t=Vo(e),r=e.read_shift(1);return[t,r,"b"]}function LU(e){var t=Li(e),r=e.read_shift(1);return[t,r,"e"]}function NU(e){var t=Vo(e),r=e.read_shift(1);return[t,r,"e"]}function BU(e){var t=Li(e),r=e.read_shift(4);return[t,r,"s"]}function GU(e){var t=Vo(e),r=e.read_shift(4);return[t,r,"s"]}function HU(e){var t=Li(e),r=Mr(e);return[t,r,"n"]}function rE(e){var t=Vo(e),r=Mr(e);return[t,r,"n"]}function VU(e){var t=Li(e),r=_0(e);return[t,r,"n"]}function WU(e){var t=Vo(e),r=_0(e);return[t,r,"n"]}function zU(e){var t=Li(e),r=M0(e);return[t,r,"is"]}function $U(e){var t=Li(e),r=Ir(e);return[t,r,"str"]}function UU(e){var t=Vo(e),r=Ir(e);return[t,r,"str"]}function KU(e,t,r){var i=e.l+t,s=Li(e);s.r=r["!row"];var n=e.read_shift(1),o=[s,n,"b"];if(r.cellFormula){e.l+=2;var a=xh(e,i-e.l,r);o[3]=Pr(a,null,s,r.supbooks,r)}else e.l=i;return o}function jU(e,t,r){var i=e.l+t,s=Li(e);s.r=r["!row"];var n=e.read_shift(1),o=[s,n,"e"];if(r.cellFormula){e.l+=2;var a=xh(e,i-e.l,r);o[3]=Pr(a,null,s,r.supbooks,r)}else e.l=i;return o}function qU(e,t,r){var i=e.l+t,s=Li(e);s.r=r["!row"];var n=Mr(e),o=[s,n,"n"];if(r.cellFormula){e.l+=2;var a=xh(e,i-e.l,r);o[3]=Pr(a,null,s,r.supbooks,r)}else e.l=i;return o}function YU(e,t,r){var i=e.l+t,s=Li(e);s.r=r["!row"];var n=Ir(e),o=[s,n,"str"];if(r.cellFormula){e.l+=2;var a=xh(e,i-e.l,r);o[3]=Pr(a,null,s,r.supbooks,r)}else e.l=i;return o}var XU=Wo;function QU(e,t){var r=e.l+t,i=Wo(e),s=k0(e),n=Ir(e),o=Ir(e),a=Ir(e);e.l=r;var l={rfx:i,relId:s,loc:n,display:a};return o&&(l.Tooltip=o),l}function JU(){}function ZU(e,t,r){var i=e.l+t,s=wR(e),n=e.read_shift(1),o=[s];if(o[2]=n,r.cellFormula){var a=sU(e,i-e.l,r);o[1]=a}else e.l=i;return o}function e9(e,t,r){var i=e.l+t,s=Wo(e),n=[s];if(r.cellFormula){var o=oU(e,i-e.l,r);n[1]=o,e.l=i}else e.l=i;return n}var t9=["left","right","top","bottom","header","footer"];function r9(e){var t={};return t9.forEach(function(r){t[r]=Mr(e)}),t}function i9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function s9(){}function n9(){}function o9(e,t,r,i,s,n,o){if(!e)return e;var a=t||{};i||(i={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,g,f,m,v,w,C,F,D,R=[];a.biff=12,a["!row"]=0;var y=0,b=!1,x=[],T={},A=a.supbooks||s.supbooks||[[]];if(A.sharedf=T,A.arrayf=x,A.SheetNames=s.SheetNames||s.Sheets.map(function(se){return se.name}),!a.supbooks&&(a.supbooks=A,s.Names))for(var P=0;P<s.Names.length;++P)A[0][P+1]=s.Names[P];var U=[],J=[],B=!1;Md[16]={n:"BrtShortReal",f:rE};var H;if(nn(e,function(G,he,Re){if(!h)switch(Re){case 148:c=G;break;case 0:p=G,a.sheetRows&&a.sheetRows<=p.r&&(h=!0),F=Rr(m=p.r),a["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=wc(G.hpt)),J[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:G[2]},G[2]){case"n":g.v=G[1];break;case"s":C=Vl[G[1]],g.v=C.t,g.r=C.r;break;case"b":g.v=!!G[1];break;case"e":g.v=G[1],a.cellText!==!1&&(g.w=zo[g.v]);break;case"str":g.t="s",g.v=G[1];break;case"is":g.t="s",g.v=G[1].t;break}if((f=o.CellXf[G[0].iStyleRef])&&eE(g,f.numFmtId,null,a,n,o),v=G[0].c==-1?v+1:G[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=g):l[or(v)+F]=g,a.cellFormula){for(b=!1,y=0;y<x.length;++y){var M=x[y];p.r>=M[0].s.r&&p.r<=M[0].e.r&&v>=M[0].s.c&&v<=M[0].e.c&&(g.F=xt(M[0]),b=!0)}!b&&G.length>3&&(g.f=G[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),a.cellDates&&f&&g.t=="n"&&Ka(lt[f.numFmtId])){var X=fo(g.v);X&&(g.t="d",g.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}H&&(H.type=="XLDAPR"&&(g.D=!0),H=void 0);break;case 1:case 12:if(!a.sheetStubs||d)break;g={t:"z",v:void 0},v=G[0].c==-1?v+1:G[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=g):l[or(v)+F]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),H&&(H.type=="XLDAPR"&&(g.D=!0),H=void 0);break;case 176:R.push(G);break;case 49:H=((a.xlmeta||{}).Cell||[])[G-1];break;case 494:var z=i["!id"][G.relId];for(z?(G.Target=z.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=z):G.relId==""&&(G.Target="#"+G.loc),m=G.rfx.s.r;m<=G.rfx.e.r;++m)for(v=G.rfx.s.c;v<=G.rfx.e.c;++v)a.dense?(l[m]||(l[m]=[]),l[m][v]||(l[m][v]={t:"z",v:void 0}),l[m][v].l=G):(w=st({c:v,r:m}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=G);break;case 426:if(!a.cellFormula)break;x.push(G),D=a.dense?l[m][v]:l[or(v)+F],D.f=Pr(G[1],u,{r:p.r,c:v},A,a),D.F=xt(G[0]);break;case 427:if(!a.cellFormula)break;T[st(G[0].s)]=G[1],D=a.dense?l[m][v]:l[or(v)+F],D.f=Pr(G[1],u,{r:p.r,c:v},A,a);break;case 60:if(!a.cellStyles)break;for(;G.e>=G.s;)U[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},B||(B=!0,N0(G.w/256)),_a(U[G.e+1]);break;case 161:l["!autofilter"]={ref:xt(G)};break;case 476:l["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!he.T){if(!d||a.WTF)throw new Error("Unexpected record 0x"+Re.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=xt(c||u)),a.sheetRows&&l["!ref"]){var _=Xt(l["!ref"]);a.sheetRows<=+_.e.r&&(_.e.r=a.sheetRows-1,_.e.r>u.e.r&&(_.e.r=u.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>u.e.c&&(_.e.c=u.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(_))}return R.length>0&&(l["!merges"]=R),U.length>0&&(l["!cols"]=U),J.length>0&&(l["!rows"]=J),l}function a9(e){var t=[],r=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var o=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){i=n.replace(/<.*?>/g,"")}),[t,s,i]}function l9(e,t,r,i,s,n){var o=n||{"!type":"chart"};if(!e)return n;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=a9(d);u.s.r=u.s.c=0,u.e.c=a,c=or(a),h[0].forEach(function(p,g){o[c+Rr(g)]={t:"n",v:p,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=xt(u)),o}function c9(e,t,r,i,s){if(!e)return e;i||(i={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(tE);return a&&G0(a[0],n,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=o[1]),i["!id"][n["!rel"]]&&(n["!drawel"]=i["!id"][n["!rel"]]),n}function u9(e,t){e.l+=10;var r=Ir(e);return{name:r}}function d9(e,t,r,i,s){if(!e)return e;i||(i={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o=!1;return nn(e,function(l,c,u){switch(u){case 550:n["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),i["!id"][n["!rel"]]&&(n["!drawel"]=i["!id"][n["!rel"]]),n}var iE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],h9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],f9=[],p9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function oS(e,t){for(var r=0;r!=e.length;++r)for(var i=e[r],s=0;s!=t.length;++s){var n=t[s];if(i[n[0]]==null)i[n[0]]=n[1];else switch(n[2]){case"bool":typeof i[n[0]]=="string"&&(i[n[0]]=$t(i[n[0]]));break;case"int":typeof i[n[0]]=="string"&&(i[n[0]]=parseInt(i[n[0]],10));break}}}function aS(e,t){for(var r=0;r!=t.length;++r){var i=t[r];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=$t(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function sE(e){aS(e.WBProps,iE),aS(e.CalcPr,p9),oS(e.WBView,h9),oS(e.Sheets,f9),wa.date1904=$t(e.WBProps.date1904)}var g9="][*?/\\".split("");function m9(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return g9.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var v9=/<\w+:workbook/;function C9(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,s="xmlns",n={},o=0;if(e.replace(Gr,function(l,c){var u=tt(l);switch(Ts(u[0])){case"<?xml":break;case"<workbook":l.match(v9)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":iE.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=$t(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Lt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Et(Lt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":n={},n.Name=Lt(u.name),u.comment&&(n.Comment=u.comment),u.localSheetId&&(n.Sheet=+u.localSheetId),$t(u.hidden||"0")&&(n.Hidden=!0),o=c+l.length;break;case"</definedName>":n.Ref=Et(Lt(e.slice(o,c))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),L8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return sE(r),r}function w9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pp(e),r.name=Ir(e),r}function S9(e,t){var r={},i=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ir(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(i&65536),r.backupFile=!!(i&64),r.checkCompatibility=!!(i&4096),r.date1904=!!(i&1),r.filterPrivacy=!!(i&8),r.hidePivotFieldList=!!(i&1024),r.promptedSolutions=!!(i&16),r.publishItems=!!(i&2048),r.refreshAllConnections=!!(i&262144),r.saveExternalLinkValues=!!(i&128),r.showBorderUnselectedTables=!!(i&4),r.showInkAnnotation=!!(i&32),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(i&32768),r.updateLinks=["userSet","never","always"][i>>8&3],r}function y9(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function x9(e,t,r){var i=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=e6(e),o=nU(e,0,r),a=k0(e);e.l=i;var l={Name:n,Ptg:o};return s<268435455&&(l.Sheet=s),a&&(l.Comment=a),l}function b9(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],s=!1;t||(t={}),t.biff=12;var n=[],o=[[]];return o.SheetNames=[],o.XTI=[],Md[16]={n:"BrtFRTArchID$",f:y9},nn(e,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Pr(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),sE(r),r.Names=n,r.supbooks=o,r}function R9(e,t,r){return t.slice(-4)===".bin"?b9(e,r):C9(e,r)}function E9(e,t,r,i,s,n,o,a){return t.slice(-4)===".bin"?o9(e,i,r,s,n,o,a):wU(e,i,r,s,n,o,a)}function F9(e,t,r,i,s,n,o,a){return t.slice(-4)===".bin"?d9(e,i,r,s,n):c9(e,i,r,s,n)}function T9(e,t,r,i,s,n,o,a){return t.slice(-4)===".bin"?Oz():Lz()}function A9(e,t,r,i,s,n,o,a){return t.slice(-4)===".bin"?_z():Iz()}function P9(e,t,r,i){return t.slice(-4)===".bin"?X5(e,r,i):$5(e,r,i)}function D9(e,t,r){return $R(e,r)}function M9(e,t,r){return t.slice(-4)===".bin"?h5(e,r):u5(e,r)}function k9(e,t,r){return t.slice(-4)===".bin"?Dz(e,r):Ez(e,r)}function _9(e,t,r){return t.slice(-4)===".bin"?xz(e):Sz(e)}function I9(e,t,r,i){return r.slice(-4)===".bin"?bz(e,t,r,i):void 0}function O9(e,t,r){return t.slice(-4)===".bin"?Cz(e,t,r):wz(e,t,r)}var nE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Gi(e,t){var r=e.split(/\s+/),i=[];if(i[0]=r[0],r.length===1)return i;var s=e.match(nE),n,o,a,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(oE),(o=n[1].indexOf(":"))===-1?i[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(o+1),i[a]=n[2].slice(1,n[2].length-1));return i}function L9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var i=e.match(nE),s,n,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(oE),(n=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(n+1),r[o]=s[2].slice(1,s[2].length-1));return r}var zl;function N9(e,t){var r=zl[e]||Et(e);return r==="General"?Mo(t):Oi(r,t)}function B9(e,t,r,i){var s=i;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$t(i);break;case"i2":case"int":s=parseInt(i,10);break;case"r4":case"float":s=parseFloat(i);break;case"date":case"dateTime.tz":s=fr(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Et(t)]=s}function G9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pc(e.v):e.w=Mo(e.v):e.w=N9(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var i=zl[t]||t||"General";if(r.cellNF&&(e.z=i),r.cellDates&&e.t=="n"&&Ka(i)){var s=fo(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(r.WTF)throw n}}}function H9(e,t,r){if(r.cellStyles&&t.Interior){var i=t.Interior;i.Pattern&&(i.patternType=B5[i.Pattern]||i.Pattern)}e[t.ID]=t}function V9(e,t,r,i,s,n,o,a,l,c){var u="General",d=i.StyleID,h={};c=c||{};var p=[],g=0;for(d===void 0&&a&&(d=a.StyleID),d===void 0&&o&&(d=o.StyleID);n[d]!==void 0&&(n[d].nf&&(u=n[d].nf),n[d].Interior&&p.push(n[d].Interior),!!n[d].Parent);)d=n[d].Parent;switch(r.Type){case"Boolean":i.t="b",i.v=$t(e);break;case"String":i.t="s",i.r=Pw(Et(e)),i.v=e.indexOf("<")>-1?Et(t||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(fr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=Et(e):i.v<60&&(i.v=i.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=xR[e],c.cellText!==!1&&(i.w=e);break;default:e==""&&t==""?i.t="z":(i.t="s",i.v=Pw(t||e));break}if(G9(i,u,c),c.cellFormula!==!1)if(i.Formula){var f=Et(i.Formula);f.charCodeAt(0)==61&&(f=f.slice(1)),i.f=Ca(f,s),delete i.Formula,i.ArrayRange=="RC"?i.F=Ca("RC:RC",s):i.ArrayRange&&(i.F=Ca(i.ArrayRange,s),l.push([Xt(i.F),i.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(i.F=l[g][1]);c.cellStyles&&(p.forEach(function(m){!h.patternType&&m.patternType&&(h.patternType=m.patternType)}),i.s=h),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function W9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vf(e,t){var r=t||{};q1();var i=Cl(T0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(i=Lt(i));var s=i.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=br(r);return o.type="string",vc.to_workbook(i,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){s.indexOf("<"+oe)>=0&&(n=!0)}),n)return Q9(i,r);zl={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},d=[],h=r.dense?[]:{},p="",g={},f={},m=Gi('<Data ss:Type="String">'),v=0,w=0,C=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},R={},y="",b=0,x=[],T={},A={},P=0,U=[],J=[],B={},H=[],_,se=!1,G=[],he=[],Re={},M=0,X=0,z={Sheets:[],WBProps:{date1904:!1}},Y={};mc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";a=mc.exec(i);)switch(a[3]=(ae=a[3]).toLowerCase()){case"data":if(ae=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?V9(i.slice(v,a.index),y,m,l[l.length-1][0]=="comment"?B:g,{c:w,r:C},D,H[w],f,G,r):(y="",m=Gi(a[0]),v=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(J.length>0&&(g.c=J),(!r.sheetRows||r.sheetRows>C)&&g.v!==void 0&&(r.dense?(h[C]||(h[C]=[]),h[C][w]=g):h[or(w)+Rr(C)]=g),g.HRef&&(g.l={Target:Et(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(M=w+(parseInt(g.MergeAcross,10)|0),X=C+(parseInt(g.MergeDown,10)|0),x.push({s:{c:w,r:C},e:{c:M,r:X}})),!r.sheetStubs)g.MergeAcross?w=M+1:++w;else if(g.MergeAcross||g.MergeDown){for(var W=w;W<=M;++W)for(var re=C;re<=X;++re)(W>w||re>C)&&(r.dense?(h[re]||(h[re]=[]),h[re][W]={t:"z"}):h[or(W)+Rr(re)]={t:"z"});w=M+1}else++w;else g=L9(a[0]),g.Index&&(w=+g.Index-1),w<F.s.c&&(F.s.c=w),w>F.e.c&&(F.e.c=w),a[0].slice(-2)==="/>"&&++w,J=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(C<F.s.r&&(F.s.r=C),C>F.e.r&&(F.e.r=C),a[0].slice(-2)==="/>"&&(f=Gi(a[0]),f.Index&&(C=+f.Index-1)),w=0,++C):(f=Gi(a[0]),f.Index&&(C=+f.Index-1),Re={},(f.AutoFitHeight=="0"||f.Height)&&(Re.hpx=parseInt(f.Height,10),Re.hpt=zR(Re.hpx),he[C]=Re),f.Hidden=="1"&&(Re.hidden=!0,he[C]=Re));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));d.push(p),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(h["!ref"]=xt(F),r.sheetRows&&r.sheetRows<=F.e.r&&(h["!fullref"]=h["!ref"],F.e.r=r.sheetRows-1,h["!ref"]=xt(F))),x.length&&(h["!merges"]=x),H.length>0&&(h["!cols"]=H),he.length>0&&(h["!rows"]=he),u[p]=h}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=w=0,l.push([a[3],!1]),c=Gi(a[0]),p=Et(c.Name),h=r.dense?[]:{},x=[],G=[],he=[],Y={name:p,Hidden:0},z.Sheets.push(Y);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),H=[],se=!1}break;case"style":a[1]==="/"?H9(D,R,r):R=Gi(a[0]);break;case"numberformat":R.nf=Et(Gi(a[0]).Format||"General"),zl[R.nf]&&(R.nf=zl[R.nf]);for(var Z=0;Z!=392&&lt[Z]!=R.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(lt[Z]==null){wo(R.nf,Z);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(_=Gi(a[0]),_.Hidden&&(_.hidden=!0,delete _.Hidden),_.Width&&(_.wpx=parseInt(_.Width,10)),!se&&_.wpx>10){se=!0,zr=VR;for(var ee=0;ee<H.length;++ee)H[ee]&&_a(H[ee])}se&&_a(_),H[_.Index-1||H.length]=_;for(var Fe=0;Fe<+_.Span;++Fe)H[H.length]=br(_);break;case"namedrange":if(a[1]==="/")break;z.Names||(z.Names=[]);var L=tt(a[0]),I={Name:L.Name,Ref:Ca(L.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(I.Sheet=z.Sheets.length-1),z.Names.push(I);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?y+=i.slice(b,a.index):b=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=Gi(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?E6(T,ae,i.slice(P,a.index)):P=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));W9(B),J.push(B)}else l.push([a[3],!1]),c=Gi(a[0]),B={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var V=Gi(a[0]);h["!autofilter"]={ref:Ca(V.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return fS(i,r);var ie=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ie=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ie=!1}break;case"excelworkbook":switch(a[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ie=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:ie=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(i.slice(P,a.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else P=a.index+a[0].length;break;case"header":h["!margins"]||Wl(h["!margins"]={},"xlml"),isNaN(+tt(a[0]).Margin)||(h["!margins"].header=+tt(a[0]).Margin);break;case"footer":h["!margins"]||Wl(h["!margins"]={},"xlml"),isNaN(+tt(a[0]).Margin)||(h["!margins"].footer=+tt(a[0]).Margin);break;case"pagemargins":var ne=tt(a[0]);h["!margins"]||Wl(h["!margins"]={},"xlml"),isNaN(+ne.Top)||(h["!margins"].top=+ne.Top),isNaN(+ne.Left)||(h["!margins"].left=+ne.Left),isNaN(+ne.Right)||(h["!margins"].right=+ne.Right),isNaN(+ne.Bottom)||(h["!margins"].bottom=+ne.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ie=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ie=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ie=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ie=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ie=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ie=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ie=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ie=!1}break;case"smarttags":break;default:ie=!1;break}if(ie||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?B9(A,ae,U,i.slice(P,a.index)):(U=a,P=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var j={};return!r.bookSheets&&!r.bookProps&&(j.Sheets=u),j.SheetNames=d,j.Workbook=z,j.SSF=br(lt),j.Props=T,j.Custprops=A,j}function _p(e,t){switch(W0(t=t||{}),t.type||"base64"){case"base64":return vf(wi(e),t);case"binary":case"buffer":case"file":return vf(e,t);case"array":return vf(Ho(e),t)}}function z9(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=i6(r),r.length-r.l<=4)return t;var i=r.read_shift(4);if(i==0||i>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(i=r.read_shift(4),i!==1907505652)||(t.UnicodeClipboardFormat=s6(r),i=r.read_shift(4),i==0||i>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var $9=[60,1084,2066,2165,2175];function U9(e,t,r,i,s){var n=i,o=[],a=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(a)}o.push(a),r.l+=n;for(var l=Vs(r,r.l),c=Ip[l],u=0;c!=null&&$9.indexOf(l)>-1;)n=Vs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+n),o.push(a),r.l+=4+n,c=Ip[l=Vs(r,r.l)];var d=bn(o);wr(d,0);var h=0;d.lens=[];for(var p=0;p<o.length;++p)d.lens.push(h),h+=o[p].length;if(d.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+i;return t.f(d,d.length,s)}function ds(e,t,r){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=lt[i])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zo[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pc(e.v):e.w=Mo(e.v):e.w=Oi(i,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&i&&e.t=="n"&&Ka(lt[i]||String(i))){var s=fo(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Eu(e,t,r){return{v:e,ixfe:t,t:r}}function K9(e,t){var r={opts:{}},i={},s=t.dense?[]:{},n={},o={},a=null,l=[],c="",u={},d,h="",p,g,f,m,v={},w=[],C,F,D=[],R=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},b={},x=function($e){return $e<8?So[$e]:$e<64&&R[$e-8]||So[$e]},T=function($e,et,ht){var Rt=et.XF.data;if(!(!Rt||!Rt.patternType||!ht||!ht.cellStyles)){et.s={},et.s.patternType=Rt.patternType;var At;(At=Cc(x(Rt.icvFore)))&&(et.s.fgColor={rgb:At}),(At=Cc(x(Rt.icvBack)))&&(et.s.bgColor={rgb:At})}},A=function($e,et,ht){if(!(Re>1)&&!(ht.sheetRows&&$e.r>=ht.sheetRows)){if(ht.cellStyles&&et.XF&&et.XF.data&&T($e,et,ht),delete et.ixfe,delete et.XF,d=$e,h=st($e),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),$e.r<o.s.r&&(o.s.r=$e.r),$e.c<o.s.c&&(o.s.c=$e.c),$e.r+1>o.e.r&&(o.e.r=$e.r+1),$e.c+1>o.e.c&&(o.e.c=$e.c+1),ht.cellFormula&&et.f){for(var Rt=0;Rt<w.length;++Rt)if(!(w[Rt][0].s.c>$e.c||w[Rt][0].s.r>$e.r)&&!(w[Rt][0].e.c<$e.c||w[Rt][0].e.r<$e.r)){et.F=xt(w[Rt][0]),(w[Rt][0].s.c!=$e.c||w[Rt][0].s.r!=$e.r)&&delete et.f,et.f&&(et.f=""+Pr(w[Rt][1],o,$e,G,P));break}}ht.dense?(s[$e.r]||(s[$e.r]=[]),s[$e.r][$e.c]=et):s[h]=et}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var U,J=[],B=[],H=[],_=[],se=!1,G=[];G.SheetNames=P.snames,G.sharedf=P.sharedf,G.arrayf=P.arrayf,G.names=[],G.XTI=[];var he=0,Re=0,M=0,X=[],z=[],Y;P.codepage=1200,Xi(1200);for(var ae=!1;e.l<e.length-1;){var W=e.l,re=e.read_shift(2);if(re===0&&he===10)break;var Z=e.l===e.length?0:e.read_shift(2),ee=Ip[re];if(ee&&ee.f){if(t.bookSheets&&he===133&&re!==133)break;if(he=re,ee.r===2||ee.r==12){var Fe=e.read_shift(2);if(Z-=2,!P.enc&&Fe!==re&&((Fe&255)<<8|Fe>>8)!==re)throw new Error("rt mismatch: "+Fe+"!="+re);ee.r==12&&(e.l+=10,Z-=10)}var L={};if(re===10?L=ee.f(e,Z,P):L=U9(re,ee,e,Z,P),Re==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(re){case 34:r.opts.Date1904=y.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=L;break;case 66:var I=Number(L);switch(I){case 21010:I=1200;break;case 32768:I=1e4;break;case 32769:I=1252;break}Xi(P.codepage=I),ae=!0;break;case 317:P.rrtabid=L;break;case 25:P.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:P.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(s["!type"]="dialog"),L.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),L.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(L);break;case 430:G.push([L]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(L);break;case 24:case 536:Y={Name:L.Name,Ref:Pr(L.rgce,o,null,G,P)},L.itab>0&&(Y.Sheet=L.itab-1),G.names.push(Y),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(z[L.itab-1]={ref:xt(L.rgce[0][0][1][2])});break;case 22:P.ExternCount=L;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(L),G.XTI=G.XTI.concat(L);break;case 2196:if(P.biff<8)break;Y!=null&&(Y.Comment=L[1]);break;case 18:s["!protect"]=L;break;case 19:L!==0&&P.WTF&&console.error("Password verifier: "+L);break;case 133:n[L.pos]=L,P.snames.push(L.name);break;case 10:{if(--Re)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=xt(o),t.sheetRows&&t.sheetRows<=o.e.r){var V=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=xt(o),o.e.r=V}o.e.r++,o.e.c++}J.length>0&&(s["!merges"]=J),B.length>0&&(s["!objects"]=B),H.length>0&&(s["!cols"]=H),_.length>0&&(s["!rows"]=_),y.Sheets.push(b)}c===""?u=s:i[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),P.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(P.biff=5,ae=!0,Xi(P.codepage=28591)),P.biff==8&&L.BIFFVer==0&&L.dt==16&&(P.biff=2),Re++)break;if(s=t.dense?[]:{},P.biff<8&&!ae&&(ae=!0,Xi(P.codepage=t.codepage||1252)),P.biff<5||L.BIFFVer==0&&L.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ie={pos:e.l-Z,name:c};n[ie.pos]=ie,P.snames.push(c)}else c=(n[W]||{name:""}).name;L.dt==32&&(s["!type"]="chart"),L.dt==64&&(s["!type"]="macro"),J=[],B=[],P.arrayf=w=[],H=[],_=[],se=!1,b={Hidden:(n[W]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[L.r]||[])[L.c]:s[st({c:L.c,r:L.r})])&&++L.c,C={ixfe:L.ixfe,XF:D[L.ixfe]||{},v:L.val,t:"n"},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t);break;case 5:case 517:C={ixfe:L.ixfe,XF:D[L.ixfe],v:L.val,t:L.t},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t);break;case 638:C={ixfe:L.ixfe,XF:D[L.ixfe],v:L.rknum,t:"n"},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t);break;case 189:for(var ne=L.c;ne<=L.C;++ne){var j=L.rkrec[ne-L.c][0];C={ixfe:j,XF:D[j],v:L.rkrec[ne-L.c][1],t:"n"},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:ne,r:L.r},C,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){a=L;break}if(C=Eu(L.val,L.cell.ixfe,L.tt),C.XF=D[C.ixfe],t.cellFormula){var oe=L.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var pe=oe[0][0][1][0],fe=oe[0][0][1][1],Ce=st({r:pe,c:fe});v[Ce]?C.f=""+Pr(L.formula,o,L.cell,G,P):C.F=((t.dense?(s[pe]||[])[fe]:s[Ce])||{}).F}else C.f=""+Pr(L.formula,o,L.cell,G,P)}M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A(L.cell,C,t),a=L}break;case 7:case 519:if(a)a.val=L,C=Eu(L,a.cell.ixfe,"s"),C.XF=D[C.ixfe],t.cellFormula&&(C.f=""+Pr(a.formula,o,a.cell,G,P)),M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A(a.cell,C,t),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(L);var le=st(L[0].s);if(p=t.dense?(s[L[0].s.r]||[])[L[0].s.c]:s[le],t.cellFormula&&p){if(!a||!le||!p)break;p.f=""+Pr(L[1],o,L[0],G,P),p.F=xt(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!a)break;v[st(a.cell)]=L[0],p=t.dense?(s[a.cell.r]||[])[a.cell.c]:s[st(a.cell)],(p||{}).f=""+Pr(L[0],o,d,G,P)}}break;case 253:C=Eu(l[L.isst].t,L.ixfe,"s"),l[L.isst].h&&(C.h=l[L.isst].h),C.XF=D[C.ixfe],M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:L.ixfe,XF:D[L.ixfe],t:"z"},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t));break;case 190:if(t.sheetStubs)for(var be=L.c;be<=L.C;++be){var De=L.ixfe[be-L.c];C={ixfe:De,XF:D[De],t:"z"},M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:be,r:L.r},C,t)}break;case 214:case 516:case 4:C=Eu(L.val,L.ixfe,"s"),C.XF=D[C.ixfe],M>0&&(C.z=X[C.ixfe>>8&63]),ds(C,t,r.opts.Date1904),A({c:L.c,r:L.r},C,t);break;case 0:case 512:Re===1&&(o=L);break;case 252:l=L;break;case 1054:if(P.biff==4){X[M++]=L[1];for(var te=0;te<M+163&&lt[te]!=L[1];++te);te>=163&&wo(L[1],M+163)}else wo(L[1],L[0]);break;case 30:{X[M++]=L;for(var Pe=0;Pe<M+163&&lt[Pe]!=L;++Pe);Pe>=163&&wo(L,M+163)}break;case 229:J=J.concat(L);break;case 93:B[L.cmo[0]]=P.lastobj=L;break;case 438:P.lastobj.TxO=L;break;case 127:P.lastobj.ImData=L;break;case 440:for(m=L[0].s.r;m<=L[0].e.r;++m)for(f=L[0].s.c;f<=L[0].e.c;++f)p=t.dense?(s[m]||[])[f]:s[st({c:f,r:m})],p&&(p.l=L[1]);break;case 2048:for(m=L[0].s.r;m<=L[0].e.r;++m)for(f=L[0].s.c;f<=L[0].e.c;++f)p=t.dense?(s[m]||[])[f]:s[st({c:f,r:m})],p&&p.l&&(p.l.Tooltip=L[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[L[0].r]||[])[L[0].c]:s[st(L[0])];var Ne=B[L[2]];p||(t.dense?(s[L[0].r]||(s[L[0].r]=[]),p=s[L[0].r][L[0].c]={t:"z"}):p=s[st(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),p.c||(p.c=[]),g={a:L[1],t:Ne.TxO.t},p.c.push(g)}break;case 2173:pz(D[L.ixfe],L.ext);break;case 125:{if(!P.cellStyles)break;for(;L.e>=L.s;)H[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},se||(se=!0,N0(L.w/256)),_a(H[L.e+1])}break;case 520:{var Ve={};L.level!=null&&(_[L.r]=Ve,Ve.level=L.level),L.hidden&&(_[L.r]=Ve,Ve.hidden=!0),L.hpt&&(_[L.r]=Ve,Ve.hpt=L.hpt,Ve.hpx=wc(L.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Wl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[re]]=L;break;case 161:s["!margins"]||Wl(s["!margins"]={}),s["!margins"].header=L.header,s["!margins"].footer=L.footer;break;case 574:L.RTL&&(y.Views[0].RTL=!0);break;case 146:R=L;break;case 2198:U=L;break;case 140:F=L;break;case 442:c?b.CodeName=L||b.name:y.WBProps.CodeName=L||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+re.toString(16)),e.l+=Z}return r.SheetNames=Fs(n).sort(function(qe,$e){return Number(qe)-Number($e)}).map(function(qe){return n[qe].name}),t.bookSheets||(r.Sheets=i),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&z.forEach(function(qe,$e){r.Sheets[r.SheetNames[$e]]["!autofilter"]=qe}),r.Strings=l,r.SSF=br(lt),P.enc&&(r.Encryption=P.enc),U&&(r.Themes=U),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),G.names.length>0&&(y.Names=G.names),r.Workbook=y,r}var lS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function j9(e,t,r){var i=yt.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var s=Uw(i,u6,lS.DSI);for(var n in s)t[n]=s[n]}catch(c){if(r.WTF)throw c}var o=yt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=Uw(o,d6,lS.SI);for(var l in a)t[l]==null&&(t[l]=a[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(RR(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function aE(e,t){t||(t={}),W0(t),L1(),t.codepage&&S0(t.codepage);var r,i;if(e.FullPaths){if(yt.find(e,"/encryption"))throw new Error("File is password-protected");r=yt.find(e,"!CompObj"),i=yt.find(e,"/Workbook")||yt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ki(wi(e));break;case"binary":e=Ki(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),i={content:e}}var s,n;if(r&&z9(r),t.bookProps&&!t.bookSheets)s={};else{var o=Ct?"buffer":"array";if(i&&i.content)s=K9(i.content,t);else if((n=yt.find(e,"PerfectOffice_MAIN"))&&n.content)s=Hl.to_workbook(n.content,(t.type=o,t));else if((n=yt.find(e,"NativeContent_MAIN"))&&n.content)s=Hl.to_workbook(n.content,(t.type=o,t));else throw(n=yt.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&yt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=kz(e))}var a={};return e.FullPaths&&j9(e,a,t),s.Props=s.Custprops=a,t.bookFiles&&(s.cfb=e),s}var Md={0:{f:AU},1:{f:kU},2:{f:VU},3:{f:LU},4:{f:IU},5:{f:HU},6:{f:$U},7:{f:BU},8:{f:YU},9:{f:qU},10:{f:KU},11:{f:jU},12:{f:_U},13:{f:WU},14:{f:NU},15:{f:OU},16:{f:rE},17:{f:UU},18:{f:GU},19:{f:M0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:x9},40:{},42:{},43:{f:K5},44:{f:U5},45:{f:j5},46:{f:Y5},47:{f:q5},48:{},49:{f:X8},50:{},51:{f:mz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:LR},62:{f:zU},63:{f:yz},64:{f:s9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:i9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MU},148:{f:PU,p:16},151:{f:JU},152:{},153:{f:S9},154:{},155:{},156:{f:w9},157:{},158:{},159:{T:1,f:d5},160:{T:-1},161:{T:1,f:Wo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gz},336:{T:-1},337:{f:vz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:OR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZU},427:{f:e9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:r9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:DU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Pz},633:{T:1},634:{T:-1},635:{T:1,f:Az},636:{T:-1},637:{f:J8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:u9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:n9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ip={6:{f:gf},10:{f:un},12:{f:tr},13:{f:tr},14:{f:Qt},15:{f:Qt},16:{f:Mr},17:{f:Qt},18:{f:Qt},19:{f:tr},20:{f:Yw},21:{f:Yw},23:{f:OR},24:{f:Qw},25:{f:Qt},26:{},27:{},28:{f:FW},29:{},34:{f:Qt},35:{f:Xw},38:{f:Mr},39:{f:Mr},40:{f:Mr},41:{f:Mr},42:{f:Qt},43:{f:Qt},47:{f:D5},49:{f:aW},51:{f:tr},60:{},61:{f:sW},64:{f:Qt},65:{f:oW},66:{f:tr},77:{},80:{},81:{},82:{},85:{f:tr},89:{},90:{},91:{},92:{f:X6},93:{f:AW},94:{},95:{f:Qt},96:{},97:{},99:{f:Qt},125:{f:LR},128:{f:vW},129:{f:Q6},130:{f:tr},131:{f:Qt},132:{f:Qt},133:{f:J6},134:{},140:{f:IW},141:{f:tr},144:{},146:{f:LW},151:{},152:{},153:{},154:{},155:{},156:{f:tr},157:{},158:{},160:{f:VW},161:{f:BW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:fW},190:{f:pW},193:{f:un},197:{},198:{},199:{},200:{},201:{},202:{f:Qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:tr},220:{},221:{f:Qt},222:{},224:{f:mW},225:{f:Y6},226:{f:un},227:{},229:{f:TW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z6},253:{f:lW},255:{f:eW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:PR},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qt},353:{f:un},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wW},431:{f:Qt},432:{},433:{},434:{},437:{},438:{f:MW},439:{f:Qt},440:{f:kW},441:{},442:{f:zc},443:{},444:{f:tr},445:{},446:{},448:{f:un},449:{f:iW,r:2},450:{f:un},512:{f:jw},513:{f:HW},515:{f:CW},516:{f:cW},517:{f:qw},519:{f:WW},520:{f:tW},523:{},545:{f:Jw},549:{f:Kw},566:{},574:{f:nW},638:{f:hW},659:{},1048:{},1054:{f:uW},1084:{},1212:{f:bW},2048:{f:_W},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:un},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:NW,r:12},2173:{f:fz,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xW,r:12},2197:{},2198:{f:az,r:12},2199:{},2200:{},2201:{},2202:{f:RW,r:12},2203:{f:un},2204:{},2205:{},2206:{},2207:{},2211:{f:rW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:tr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:GW},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OW},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:jw},1:{},2:{f:KW},3:{f:UW},4:{f:$W},5:{f:qw},7:{f:jW},8:{},9:{f:xu},11:{},22:{f:tr},30:{f:dW},31:{},32:{},33:{f:Jw},36:{},37:{f:Kw},50:{f:qW},62:{},52:{},67:{},68:{f:tr},69:{},86:{},126:{},127:{f:zW},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:YW},223:{},234:{},354:{},421:{},518:{f:gf},521:{f:xu},536:{f:Qw},547:{f:Xw},561:{},579:{},1030:{f:gf},1033:{f:xu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hi(e,t,r,i){var s=t;if(!isNaN(s)){var n=(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,n),n>0&&mR(r)&&e.push(r)}}function cS(e,t){var r=t||{},i=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),o=s.index,a=n&&n.index||e.length,l=C8(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var f=l[o].trim(),m=f.slice(0,3).toLowerCase();if(m=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(m!="<td"&&m!="<th")){var v=f.split(/<\/t[dh]>/i);for(a=0;a<v.length;++a){var w=v[a].trim();if(w.match(/<t[dh]/i)){for(var C=w,F=0;C.charAt(0)=="<"&&(F=C.indexOf(">"))>-1;)C=C.slice(F+1);for(var D=0;D<g.length;++D){var R=g[D];R.s.c==u&&R.s.r<c&&c<=R.e.r&&(u=R.e.c+1,D=-1)}var y=tt(w.slice(0,w.indexOf(">")));h=y.colspan?+y.colspan:1,((d=+y.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var b=y.t||y["data-t"]||"";if(!C.length){u+=h;continue}if(C=iR(C),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!C.length){u+=h;continue}var x={t:"s",v:C};r.raw||!C.trim().length||b=="s"||(C==="TRUE"?x={t:"b",v:!0}:C==="FALSE"?x={t:"b",v:!1}:isNaN(Zi(C))?isNaN(ka(C).getDate())||(x={t:"d",v:fr(C)},r.cellDates||(x={t:"n",v:Qr(x.v)}),x.z=r.dateNF||lt[14]):x={t:"n",v:Zi(C)}),r.dense?(i[c]||(i[c]=[]),i[c][u]=x):i[st({r:c,c:u})]=x,u+=h}}}}return i["!ref"]=xt(p),g.length&&(i["!merges"]=g),i}function q9(e,t,r,i){for(var s=e["!merges"]||[],n=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>o)&&!(s[c].e.r<r||s[c].e.c<o)){if(s[c].s.r<r||s[c].s.c<o){a=-1;break}a=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(a<0)){var u=st({r,c:o}),d=i.dense?(e[r]||[])[o]:e[u],h=d&&d.v!=null&&(d.h||F0(d.w||(Xs(d),d.w)||""))||"",p={};a>1&&(p.rowspan=a),l>1&&(p.colspan=l),i.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(i.id||"sjs")+"-"+u,n.push(I8("td",h,p))}}var g="<tr>";return g+n.join("")+"</tr>"}var Y9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',X9="</body></html>";function Q9(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return zn(cS(r[0],t),t);var i=$0();return r.forEach(function(s,n){U0(i,cS(s,t),"Sheet"+(n+1))}),i}function J9(e,t,r){var i=[];return i.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Z9(e,t){var r=t||{},i=r.header!=null?r.header:Y9,s=r.footer!=null?r.footer:X9,n=[i],o=ja(e["!ref"]);r.dense=Array.isArray(e),n.push(J9(e,o,r));for(var a=o.s.r;a<=o.e.r;++a)n.push(q9(e,o,a,r));return n.push("</table>"+s),n.join("")}function lE(e,t,r){var i=r||{},s=0,n=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var o=typeof i.origin=="string"?Kr(i.origin):i.origin;s=o.r,n=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var u=ja(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,f=0,m=0,v=0,w=0,C=0;for(e["!cols"]||(e["!cols"]=[]);g<a.length&&f<l;++g){var F=a[g];if(uS(F)){if(i.display)continue;p[f]={hidden:!0}}var D=F.children;for(m=v=0;m<D.length;++m){var R=D[m];if(!(i.display&&uS(R))){var y=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):iR(R.innerHTML),b=R.getAttribute("data-z")||R.getAttribute("z");for(h=0;h<d.length;++h){var x=d[h];x.s.c==v+n&&x.s.r<f+s&&f+s<=x.e.r&&(v=x.e.c+1-n,h=-1)}C=+R.getAttribute("colspan")||1,((w=+R.getAttribute("rowspan")||1)>1||C>1)&&d.push({s:{r:f+s,c:v+n},e:{r:f+s+(w||1)-1,c:v+n+(C||1)-1}});var T={t:"s",v:y},A=R.getAttribute("data-t")||R.getAttribute("t")||"";y!=null&&(y.length==0?T.t=A||"z":i.raw||y.trim().length==0||A=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Zi(y))?isNaN(ka(y).getDate())||(T={t:"d",v:fr(y)},i.cellDates||(T={t:"n",v:Qr(T.v)}),T.z=i.dateNF||lt[14]):T={t:"n",v:Zi(y)})),T.z===void 0&&b!=null&&(T.z=b);var P="",U=R.getElementsByTagName("A");if(U&&U.length)for(var J=0;J<U.length&&!(U[J].hasAttribute("href")&&(P=U[J].getAttribute("href"),P.charAt(0)!="#"));++J);P&&P.charAt(0)!="#"&&(T.l={Target:P}),i.dense?(e[f+s]||(e[f+s]=[]),e[f+s][v+n]=T):e[st({c:v+n,r:f+s})]=T,c.e.c<v+n&&(c.e.c=v+n),v+=C}}++f}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,f-1+s),e["!ref"]=xt(c),f>=l&&(e["!fullref"]=xt((c.e.r=a.length-g+f-1+s,c))),e}function cE(e,t){var r=t||{},i=r.dense?[]:{};return lE(i,e,t)}function e7(e,t){return zn(cE(e,t),t)}function uS(e){var t="",r=t7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function t7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function r7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Et(t.replace(/<[^>]*>/g,""));return[r]}var dS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uE(e,t){var r=t||{},i=T0(e),s=[],n,o,a={name:""},l="",c=0,u,d,h={},p=[],g=r.dense?[]:{},f,m,v={value:""},w="",C=0,F=[],D=-1,R=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},b=0,x={},T=[],A={},P=0,U=0,J=[],B=1,H=1,_=[],se={Names:[]},G={},he=["",""],Re=[],M={},X="",z=0,Y=!1,ae=!1,W=0;for(mc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");f=mc.exec(i);)switch(f[3]=f[3].replace(/_.*$/,"")){case"table":case"工作表":f[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?g["!ref"]=xt(y):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(g["!fullref"]=g["!ref"],y.e.r=r.sheetRows-1,g["!ref"]=xt(y)),T.length&&(g["!merges"]=T),J.length&&(g["!rows"]=J),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=g,ae=!1):f[0].charAt(f[0].length-2)!=="/"&&(u=tt(f[0],!1),D=R=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,g=r.dense?[]:{},T=[],J=[],ae=!0);break;case"table-row-group":f[1]==="/"?--b:++b;break;case"table-row":case"行":if(f[1]==="/"){D+=B,B=1;break}if(d=tt(f[0],!1),d.行号?D=d.行号-1:D==-1&&(D=0),B=+d["number-rows-repeated"]||1,B<10)for(W=0;W<B;++W)b>0&&(J[D+W]={level:b});R=-1;break;case"covered-table-cell":f[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(g[D]||(g[D]=[]),g[D][R]={t:"z"}):g[st({r:D,c:R})]={t:"z"}),w="",F=[];break;case"table-cell":case"数据":if(f[0].charAt(f[0].length-2)==="/")++R,v=tt(f[0],!1),H=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(m.f=nS(Et(v.formula))),(v.数据类型||v["value-type"])=="string"&&(m.t="s",m.v=Et(v["string-value"]||""),r.dense?(g[D]||(g[D]=[]),g[D][R]=m):g[st({r:D,c:R})]=m),R+=H-1;else if(f[1]!=="/"){++R,w="",C=0,F=[],H=1;var re=B?D+B-1:D;if(R>y.e.c&&(y.e.c=R),R<y.s.c&&(y.s.c=R),D<y.s.r&&(y.s.r=D),re>y.e.r&&(y.e.r=re),v=tt(f[0],!1),Re=[],M={},m={t:v.数据类型||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Et(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,U=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:D,c:R},e:{r:D+P-1,c:R+U-1}},m.F=xt(A),_.push([A,m.F])),v.formula)m.f=nS(v.formula);else for(W=0;W<_.length;++W)D>=_[W][0].s.r&&D<=_[W][0].e.r&&R>=_[W][0].s.c&&R<=_[W][0].e.c&&(m.F=_[W][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,U=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:D,c:R},e:{r:D+P-1,c:R+U-1}},T.push(A)),v["number-columns-repeated"]&&(H=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=$t(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=fr(v["date-value"]),r.cellDates||(m.t="n",m.v=Qr(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=g8(v["time-value"])/86400,r.cellDates&&(m.t="d",m.v=wh(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(w=Et(v["string-value"]),F=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(Y=!1,m.t==="s"&&(m.v=w||"",F.length&&(m.R=F),Y=C==0),G.Target&&(m.l=G),Re.length>0&&(m.c=Re,Re=[]),w&&r.cellText!==!1&&(m.w=w),Y&&(m.t="z",delete m.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var Z=0;Z<B;++Z){if(H=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(g[D+Z]||(g[D+Z]=[]),g[D+Z][R]=Z==0?m:br(m);--H>0;)g[D+Z][R+H]=br(m);else for(g[st({r:D+Z,c:R})]=m;--H>0;)g[st({r:D+Z,c:R+H})]=br(m);y.e.c<=R&&(y.e.c=R)}H=parseInt(v["number-columns-repeated"]||"1",10),R+=H-1,H=0,m={},w="",F=[]}G={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(f[1]==="/"){if((n=s.pop())[0]!==f[3])throw"Bad state: "+n}else f[0].charAt(f[0].length-2)!=="/"&&s.push([f[3],!0]);break;case"annotation":if(f[1]==="/"){if((n=s.pop())[0]!==f[3])throw"Bad state: "+n;M.t=w,F.length&&(M.R=F),M.a=X,Re.push(M)}else f[0].charAt(f[0].length-2)!=="/"&&s.push([f[3],!1]);X="",z=0,w="",C=0,F=[];break;case"creator":f[1]==="/"?X=i.slice(z,f.index):z=f.index+f[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(f[1]==="/"){if((n=s.pop())[0]!==f[3])throw"Bad state: "+n}else f[0].charAt(f[0].length-2)!=="/"&&s.push([f[3],!1]);w="",C=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(f[1]==="/"){if(x[a.name]=l,(n=s.pop())[0]!==f[3])throw"Bad state: "+n}else f[0].charAt(f[0].length-2)!=="/"&&(l="",a=tt(f[0],!1),s.push([f[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=tt(f[0],!1),l+=dS[f[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=tt(f[0],!1),l+=dS[f[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(f[0].slice(-2)==="/>")break;if(f[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(c,f.index);break}else c=f.index+f[0].length;break;case"named-range":o=tt(f[0],!1),he=mf(o["cell-range-address"]);var ee={Name:o.name,Ref:he[0]+"!"+he[1]};ae&&(ee.Sheet=p.length),se.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(f[1]==="/"&&(!v||!v["string-value"])){var Fe=r7(i.slice(C,f.index));w=(w.length>0?w+`
`:"")+Fe[0]}else tt(f[0],!1),C=f.index+f[0].length;break;case"s":break;case"database-range":if(f[1]==="/")break;try{he=mf(tt(f[0])["target-range-address"]),h[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(f[1]!=="/"){if(G=tt(f[0],!1),!G.href)break;G.Target=Et(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(he=mf(G.Target.slice(1)),G.Target="#"+he[0]+"!"+he[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(f[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(f)}}var L={Sheets:h,SheetNames:p,Workbook:se};return r.bookSheets&&delete L.Sheets,L}function hS(e,t){t=t||{},Ri(e,"META-INF/manifest.xml")&&C6(er(e,"META-INF/manifest.xml"),t);var r=gi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var i=uE(Lt(r),t);return Ri(e,"meta.xml")&&(i.Props=bR(er(e,"meta.xml"))),i}function fS(e,t){return uE(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function H0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Op(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Lt(Ho(e))}function Lp(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),i=0;return e.forEach(function(s){r.set(s,i),i+=s.length}),r}function pS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function i7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,i=e[t+14]&1,s=t+13;s>=t;--s)i=i*256+e[s];return(e[t+15]&128?-i:i)*Math.pow(10,r-6176)}function Sc(e,t){var r=t?t[0]:0,i=e[r]&127;e:if(e[r++]>=128&&(i|=(e[r]&127)<<7,e[r++]<128||(i|=(e[r]&127)<<14,e[r++]<128)||(i|=(e[r]&127)<<21,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),i}function ar(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function _r(e){for(var t=[],r=[0];r[0]<e.length;){var i=r[0],s=Sc(e,r),n=s&7;s=Math.floor(s/8);var o=0,a;if(s==0)break;switch(n){case 0:{for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0])}break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Sc(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(i))}var c={data:a,type:n};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function V0(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function s7(e){for(var t,r=[],i=[0];i[0]<e.length;){var s=Sc(e,i),n=_r(e.slice(i[0],i[0]+s));i[0]+=s;var o={id:ar(n[1][0].data),messages:[]};n[2].forEach(function(a){var l=_r(a.data),c=ar(l[3][0].data);o.messages.push({meta:l,data:e.slice(i[0],i[0]+c)}),i[0]+=c}),(t=n[3])!=null&&t[0]&&(o.merge=ar(n[3][0].data)>>>0>0),r.push(o)}return r}function n7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],i=Sc(t,r),s=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(n==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,n==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Lp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Lp(s);if(u.length!=i)throw new Error("Unexpected length: ".concat(u.length," != ").concat(i));return u}function o7(e){for(var t=[],r=0;r<e.length;){var i=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(n7(i,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Lp(t)}function a7(e,t,r,i){var s=H0(e),n=s.getUint32(4,!0),o=(i>1?12:8)+pS(n&(i>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);n&512&&(a=s.getUint32(o,!0),o+=4),o+=pS(n&(i>1?12288:4096))*4,n&16&&(l=s.getUint32(o,!0),o+=4),n&32&&(c=s.getFloat64(o,!0),o+=8),n&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function l7(e,t,r){var i=H0(e),s=i.getUint32(8,!0),n=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=i7(e,n),n+=16),s&2&&(c=i.getFloat64(n,!0),n+=8),s&4&&(u.setTime(u.getTime()+i.getFloat64(n,!0)*1e3),n+=8),s&8&&(a=i.getUint32(n,!0),n+=4),s&16&&(o=i.getUint32(n,!0),n+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[a]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function c7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return a7(e,t,r,e[0]);case 5:return l7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Dn(e){var t=_r(e);return Sc(t[1][0].data)}function gS(e,t){var r=_r(t.data),i=ar(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(o){var a=_r(o.data),l=ar(a[1][0].data)>>>0;switch(i){case 1:n[l]=Op(a[3][0].data);break;case 8:{var c=e[Dn(a[9][0].data)][0],u=_r(c.data),d=e[Dn(u[1][0].data)][0],h=ar(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=_r(d.data);n[l]=p[3].map(function(g){return Op(g.data)}).join("")}break}}),n}function u7(e,t){var r,i,s,n,o,a,l,c,u,d,h,p,g,f,m=_r(e),v=ar(m[1][0].data)>>>0,w=ar(m[2][0].data)>>>0,C=((i=(r=m[8])==null?void 0:r[0])==null?void 0:i.data)&&ar(m[8][0].data)>0||!1,F,D;if((n=(s=m[7])==null?void 0:s[0])!=null&&n.data&&t!=0)F=(a=(o=m[7])==null?void 0:o[0])==null?void 0:a.data,D=(c=(l=m[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=m[4])==null?void 0:u[0])!=null&&d.data&&t!=1)F=(p=(h=m[4])==null?void 0:h[0])==null?void 0:p.data,D=(f=(g=m[3])==null?void 0:g[0])==null?void 0:f.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=C?4:1,y=H0(F),b=[],x=0;x<F.length/2;++x){var T=y.getUint16(x*2,!0);T<65535&&b.push([x,T])}if(b.length!=w)throw"Expected ".concat(w," cells, found ").concat(b.length);var A=[];for(x=0;x<b.length-1;++x)A[b[x][0]]=D.subarray(b[x][1]*R,b[x+1][1]*R);return b.length>=1&&(A[b[b.length-1][0]]=D.subarray(b[b.length-1][1]*R)),{R:v,cells:A}}function d7(e,t){var r,i=_r(t.data),s=(r=i==null?void 0:i[7])!=null&&r[0]?ar(i[7][0].data)>>>0>0?1:0:-1,n=V0(i[5],function(o){return u7(o,s)});return{nrows:ar(i[4][0].data)>>>0,data:n.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function h7(e,t,r){var i,s=_r(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(ar(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(ar(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=xt(n);var o=_r(s[4][0].data),a=gS(e,e[Dn(o[4][0].data)][0]),l=(i=o[17])!=null&&i[0]?gS(e,e[Dn(o[17][0].data)][0]):[],c=_r(o[3][0].data),u=0;c[1].forEach(function(d){var h=_r(d.data),p=e[Dn(h[2][0].data)][0],g=ar(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var f=d7(e,p);f.data.forEach(function(m,v){m.forEach(function(w,C){var F=st({r:u+v,c:C}),D=c7(w,a,l);D&&(r[F]=D)})}),u+=f.nrows})}function f7(e,t){var r=_r(t.data),i={"!ref":"A1"},s=e[Dn(r[2][0].data)],n=ar(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return h7(e,s[0],i),i}function p7(e,t){var r,i=_r(t.data),s={name:(r=i[1])!=null&&r[0]?Op(i[1][0].data):"",sheets:[]},n=V0(i[2],Dn);return n.forEach(function(o){e[o].forEach(function(a){var l=ar(a.meta[1][0].data);l==6e3&&s.sheets.push(f7(e,a))})}),s}function g7(e,t){var r=$0(),i=_r(t.data),s=V0(i[1],Dn);if(s.forEach(function(n){e[n].forEach(function(o){var a=ar(o.meta[1][0].data);if(a==2){var l=p7(e,o);l.sheets.forEach(function(c,u){U0(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Cf(e){var t,r,i,s,n={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=o7(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=s7(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){n[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var a=((s=(i=(r=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:i[1])==null?void 0:s[0].data)&&ar(n[1][0].meta[1][0].data)==1&&n[1][0];if(a||o.forEach(function(l){n[l].forEach(function(c){var u=ar(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return g7(n,a)}function m7(e){return function(r){for(var i=0;i!=e.length;++i){var s=e[i];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function W0(e){m7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function v7(e){return ca.WS.indexOf(e)>-1?"sheet":e==ca.CS?"chart":e==ca.DS?"dialog":e==ca.MS?"macro":e&&e.length?e:"sheet"}function C7(e,t){if(!e)return 0;try{e=t.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,v7(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function w7(e,t,r,i,s,n,o,a,l,c,u,d){try{n[i]=Bl(gi(e,r,!0),t);var h=er(e,t),p;switch(a){case"sheet":p=E9(h,t,s,l,n[i],c,u,d);break;case"chart":if(p=F9(h,t,s,l,n[i],c,u,d),!p||!p["!drawel"])break;var g=Sl(p["!drawel"].Target,t),f=Dp(g),m=Rz(gi(e,g,!0),Bl(gi(e,f,!0),g)),v=Sl(m,g),w=Dp(v);p=l9(gi(e,v,!0),v,l,Bl(gi(e,w,!0),v),c,p);break;case"macro":p=T9(h,t,s,l,n[i],c,u,d);break;case"dialog":p=A9(h,t,s,l,n[i],c,u,d);break;default:throw new Error("Unrecognized sheet type "+a)}o[i]=p;var C=[];n&&n[i]&&Fs(n[i]).forEach(function(F){var D="";if(n[i][F].Type==ca.CMNT){D=Sl(n[i][F].Target,t);var R=k9(er(e,D,!0),D,l);if(!R||!R.length)return;eS(p,R,!1)}n[i][F].Type==ca.TCMNT&&(D=Sl(n[i][F].Target,t),C=C.concat(Fz(er(e,D,!0),l)))}),C&&C.length&&eS(p,C,!0,l.people||[])}catch(F){if(l.WTF)throw F}}function xi(e){return e.charAt(0)=="/"?e.slice(1):e}function S7(e,t){if(q1(),t=t||{},W0(t),Ri(e,"META-INF/manifest.xml")||Ri(e,"objectdata.xml"))return hS(e,t);if(Ri(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cf<"u"){if(e.FileIndex)return Cf(e);var r=yt.utils.cfb_new();return Tw(e).forEach(function(J){y8(r,J,S8(e,J))}),Cf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ri(e,"[Content_Types].xml"))throw Ri(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ri(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Tw(e),s=m6(gi(e,"[Content_Types].xml")),n=!1,o,a;if(s.workbooks.length===0&&(a="xl/workbook.xml",er(e,a,!0)&&s.workbooks.push(a)),s.workbooks.length===0){if(a="xl/workbook.bin",!er(e,a,!0))throw new Error("Could not find workbook");s.workbooks.push(a),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Vl=[],s.sst)try{Vl=M9(er(e,xi(s.sst)),s.sst,t)}catch(J){if(t.WTF)throw J}t.cellStyles&&s.themes.length&&(l=D9(gi(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=P9(er(e,xi(s.style)),s.style,l,t))}s.links.map(function(J){try{var B=Bl(gi(e,Dp(xi(J))),J);return I9(er(e,xi(J)),B,J,t)}catch{}});var u=R9(er(e,xi(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&(h=er(e,xi(s.coreprops[0]),!0),h&&(d=bR(h)),s.extprops.length!==0&&(h=er(e,xi(s.extprops[0]),!0),h&&y6(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=gi(e,xi(s.custprops[0]),!0),h&&(p=b6(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(B){return B.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var f={};t.bookDeps&&s.calcchain&&(f=_9(er(e,xi(s.calcchain)),s.calcchain));var m=0,v={},w,C;{var F=u.Sheets;d.Worksheets=F.length,d.SheetNames=[];for(var D=0;D!=F.length;++D)d.SheetNames[D]=F[D].name}var R=n?"bin":"xml",y=s.workbooks[0].lastIndexOf("/"),b=(s.workbooks[0].slice(0,y+1)+"_rels/"+s.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");Ri(e,b)||(b="xl/_rels/workbook."+R+".rels");var x=Bl(gi(e,b,!0),b.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=O9(er(e,xi(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Tz(er(e,xi(s.people[0])),t)),x&&(x=C7(x,u.Sheets));var T=er(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=d.Worksheets;++m){var A="sheet";if(x&&x[m]?(w="xl/"+x[m][1].replace(/[\/]?xl\//,""),Ri(e,w)||(w=x[m][1]),Ri(e,w)||(w=b.replace(/_rels\/.*$/,"")+x[m][1]),A=x[m][2]):(w="xl/worksheets/sheet"+(m+1-T)+"."+R,w=w.replace(/sheet0\./,"sheet.")),C=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(d.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,U=0;U!=t.sheets.length;++U)typeof t.sheets[U]=="number"&&t.sheets[U]==m&&(P=1),typeof t.sheets[U]=="string"&&t.sheets[U].toLowerCase()==d.SheetNames[m].toLowerCase()&&(P=1);if(!P)continue e}}w7(e,w,C,d.SheetNames[m],m,v,o,A,t,u,l,c)}return g={Directory:s,Workbook:u,Props:d,Custprops:p,Deps:f,Sheets:o,SheetNames:d.SheetNames,Strings:Vl,Styles:c,Themes:l,SSF:br(lt)},t&&t.bookFiles&&(e.files?(g.keys=i,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(J,B){J=J.replace(/^Root Entry[\/]/,""),g.keys.push(J),g.files[J]=e.FileIndex[B]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=er(e,xi(s.vba[0]),!0):s.defaults&&s.defaults.bin===Mz&&(g.vbaraw=er(e,"xl/vbaProject.bin",!0))),g}function y7(e,t){var r=t||{},i="Workbook",s=yt.find(e,i);try{if(i="/!DataSpaces/Version",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(f5(s.content),i="/!DataSpaces/DataSpaceMap",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var n=g5(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=m5(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);C5(s.content)}catch{}if(i="/EncryptionInfo",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=w5(s.content);if(i="/EncryptedPackage",s=yt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],s.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function z0(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=wi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function x7(e,t){return yt.find(e,"EncryptedPackage")?y7(e,t):aE(e,t)}function b7(e,t){var r,i=e,s=t||{};return s.type||(s.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),r=eR(i,s),S7(r,s)}function dE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _p(e.slice(r),t);default:break e}return vc.to_workbook(e,t)}function R7(e,t){var r="",i=z0(e,t);switch(t.type){case"base64":r=wi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ko(e);break;default:throw new Error("Unrecognized type "+t.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(r=Lt(r)),t.type="binary",dE(r,t)}function E7(e,t){var r=e;return t.type=="base64"&&(r=wi(r)),r=xn.utils.decode(1200,r.slice(2),"str"),t.type="binary",dE(r,t)}function F7(e){return e.match(/[^\x00-\x7F]/)?yl(e):e}function wf(e,t,r,i){return i?(r.type="string",vc.to_workbook(e,r)):vc.to_workbook(t,r)}function Np(e,t){L1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Np(new Uint8Array(e),(r=br(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var i=e,s=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),wa={},r.dateNF&&(wa.dateNF=r.dateNF),r.type||(r.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ct?"buffer":"binary",i=f8(e),typeof Uint8Array<"u"&&!Ct&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,i=F7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=br(r),r.type="array",Np(y0(i),r)}switch((s=z0(i,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return x7(yt.read(i,r),r);break;case 9:if(s[1]<=8)return aE(i,r);break;case 60:return _p(i,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return e5(i,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return JW.to_workbook(i,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?b7(i,r):wf(e,i,r,n);case 239:return s[3]===60?_p(i,r):wf(e,i,r,n);case 255:if(s[1]===254)return E7(i,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Hl.to_workbook(i,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Hl.to_workbook(i,r);break;case 3:case 131:case 139:case 140:return Zw.to_workbook(i,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return M5.to_workbook(i,r);break;case 10:case 13:case 32:return R7(i,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XW.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Zw.to_workbook(i,r):wf(e,i,r,n)}function T7(e,t,r,i,s,n,o,a){var l=Rr(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[r][p]:e[i[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;n[p]!=null&&(h[n[p]]=c);continue}var f=g.v;switch(g.t){case"z":if(f==null)break;continue;case"e":f=f==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(n[p]!=null){if(f==null)if(g.t=="e"&&f===null)h[n[p]]=null;else if(c!==void 0)h[n[p]]=c;else if(u&&f===null)h[n[p]]=null;else continue;else h[n[p]]=u&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?f:Xs(g,f,a);f!=null&&(d=!1)}}return{row:h,isempty:d}}function Bp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},i=0,s=1,n=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof u){case"string":l=Xt(u);break;case"number":l=Xt(e["!ref"]),l.s.r=u;break;default:l=u}i>0&&(s=0);var d=Rr(l.s.r),h=[],p=[],g=0,f=0,m=Array.isArray(e),v=l.s.r,w=0,C={};m&&!e[v]&&(e[v]=[]);var F=c.skipHidden&&e["!cols"]||[],D=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(F[w]||{}).hidden)switch(h[w]=or(w),r=m?e[v][w]:e[h[w]+d],i){case 1:n[w]=w-l.s.c;break;case 2:n[w]=h[w];break;case 3:n[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Xs(r,null,c),f=C[o]||0,!f)C[o]=1;else{do a=o+"_"+f++;while(C[a]);C[o]=f,C[a]=1}n[w]=a}for(v=l.s.r+s;v<=l.e.r;++v)if(!(D[v]||{}).hidden){var R=T7(e,l,v,h,i,n,m,c);(R.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=R.row)}return p.length=g,p}var mS=/"/g;function A7(e,t,r,i,s,n,o,a){for(var l=!0,c=[],u="",d=Rr(r),h=t.s.c;h<=t.e.c;++h)if(i[h]){var p=a.dense?(e[r]||[])[h]:e[i[h]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(a.rawNumbers&&p.t=="n"?p.v:Xs(p,null,a));for(var g=0,f=0;g!==u.length;++g)if((f=u.charCodeAt(g))===s||f===n||f===34||a.forceQuotes){u='"'+u.replace(mS,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(mS,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function hE(e,t){var r=[],i=t??{};if(e==null||e["!ref"]==null)return"";var s=Xt(e["!ref"]),n=i.FS!==void 0?i.FS:",",o=n.charCodeAt(0),a=i.RS!==void 0?i.RS:`
`,l=a.charCodeAt(0),c=new RegExp((n=="|"?"\\|":n)+"+$"),u="",d=[];i.dense=Array.isArray(e);for(var h=i.skipHidden&&e["!cols"]||[],p=i.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(d[g]=or(g));for(var f=0,m=s.s.r;m<=s.e.r;++m)(p[m]||{}).hidden||(u=A7(e,s,m,d,o,l,n,i),u!=null&&(i.strip&&(u=u.replace(c,"")),(u||i.blankrows!==!1)&&r.push((f++?a:"")+u)));return delete i.dense,r.join("")}function P7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hE(e,t);return r}function D7(e){var t="",r,i="";if(e==null||e["!ref"]==null)return[];var s=Xt(e["!ref"]),n="",o=[],a,l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=or(a);for(var u=s.s.r;u<=s.e.r;++u)for(n=Rr(u),a=s.s.c;a<=s.e.c;++a)if(t=o[a]+n,r=c?(e[u]||[])[a]:e[t],i="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;i=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)i=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}l[l.length]=t+"="+i}return l}function fE(e,t,r){var i=r||{},s=+!i.skipHeader,n=e||{},o=0,a=0;if(n&&i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var l=typeof i.origin=="string"?Kr(i.origin):i.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+s}};if(n["!ref"]){var d=Xt(n["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=i.header||[],p=0;t.forEach(function(f,m){Fs(f).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var w=f[v],C="z",F="",D=st({c:a+p,r:o+m+s});c=yc(n,D),w&&typeof w=="object"&&!(w instanceof Date)?n[D]=w:(typeof w=="number"?C="n":typeof w=="boolean"?C="b":typeof w=="string"?C="s":w instanceof Date?(C="d",i.cellDates||(C="n",w=Qr(w)),F=i.dateNF||lt[14]):w===null&&i.nullError&&(C="e",w=0),c?(c.t=C,c.v=w,delete c.w,delete c.R,F&&(c.z=F)):n[D]=c={t:C,v:w},F&&(c.z=F))})}),u.e.c=Math.max(u.e.c,a+h.length-1);var g=Rr(o);if(s)for(p=0;p<h.length;++p)n[or(p+a)+g]={t:"s",v:h[p]};return n["!ref"]=xt(u),n}function M7(e,t){return fE(null,e,t)}function yc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var i=Kr(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?yc(e,st(t)):yc(e,st({r:t,c:r||0}))}function k7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $0(){return{SheetNames:[],Sheets:{}}}function U0(e,t,r,i){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var o=n&&n[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(m9(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function _7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=k7(e,t);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[i].Hidden=r}function I7(e,t){return e.z=t,e}function pE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function O7(e,t,r){return pE(e,"#"+t,r)}function L7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function N7(e,t,r,i){for(var s=typeof t!="string"?t:Xt(t),n=typeof t=="string"?t:xt(t),o=s.s.r;o<=s.e.r;++o)for(var a=s.s.c;a<=s.e.c;++a){var l=yc(e,o,a);l.t="n",l.F=n,delete l.v,o==s.s.r&&a==s.s.c&&(l.f=r,i&&(l.D=!0))}return e}var B7={encode_col:or,encode_row:Rr,encode_cell:st,encode_range:xt,decode_col:D0,decode_row:P0,split_cell:Y8,decode_cell:Kr,decode_range:ja,format_cell:Xs,sheet_add_aoa:CR,sheet_add_json:fE,sheet_add_dom:lE,aoa_to_sheet:qa,json_to_sheet:M7,table_to_sheet:cE,table_to_book:e7,sheet_to_csv:hE,sheet_to_txt:P7,sheet_to_json:Bp,sheet_to_html:Z9,sheet_to_formulae:D7,sheet_to_row_object_array:Bp,sheet_get_cell:yc,book_new:$0,book_append_sheet:U0,book_set_sheet_visibility:_7,cell_set_number_format:I7,cell_set_hyperlink:pE,cell_set_internal_link:O7,cell_add_comment:L7,sheet_set_array_formula:N7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},gE={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){(function(r,i){e.exports=i()})(ro,function r(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},s=!i.document&&!!i.postMessage,n=i.IS_PAPA_WORKER||!1,o={},a=0,l={parse:function(b,x){var T=(x=x||{}).dynamicTyping||!1;if(y(T)&&(x.dynamicTypingFunction=T,T={}),x.dynamicTyping=T,x.transform=!!y(x.transform)&&x.transform,x.worker&&l.WORKERS_SUPPORTED){var A=function(){if(!l.WORKERS_SUPPORTED)return!1;var U=(B=i.URL||i.webkitURL||null,H=r.toString(),l.BLOB_URL||(l.BLOB_URL=B.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",H,")();"],{type:"text/javascript"})))),J=new i.Worker(U),B,H;return J.onmessage=w,J.id=a++,o[J.id]=J}();return A.userStep=x.step,A.userChunk=x.chunk,A.userComplete=x.complete,A.userError=x.error,x.step=y(x.step),x.chunk=y(x.chunk),x.complete=y(x.complete),x.error=y(x.error),delete x.worker,void A.postMessage({input:b,config:x,workerId:A.id})}var P=null;return l.NODE_STREAM_INPUT,typeof b=="string"?(b=function(U){return U.charCodeAt(0)===65279?U.slice(1):U}(b),P=x.download?new d(x):new p(x)):b.readable===!0&&y(b.read)&&y(b.on)?P=new g(x):(i.File&&b instanceof File||b instanceof Object)&&(P=new h(x)),P.stream(b)},unparse:function(b,x){var T=!1,A=!0,P=",",U=`\r
`,J='"',B=J+J,H=!1,_=null,se=!1;(function(){if(typeof x=="object"){if(typeof x.delimiter!="string"||l.BAD_DELIMITERS.filter(function(M){return x.delimiter.indexOf(M)!==-1}).length||(P=x.delimiter),(typeof x.quotes=="boolean"||typeof x.quotes=="function"||Array.isArray(x.quotes))&&(T=x.quotes),typeof x.skipEmptyLines!="boolean"&&typeof x.skipEmptyLines!="string"||(H=x.skipEmptyLines),typeof x.newline=="string"&&(U=x.newline),typeof x.quoteChar=="string"&&(J=x.quoteChar),typeof x.header=="boolean"&&(A=x.header),Array.isArray(x.columns)){if(x.columns.length===0)throw new Error("Option columns is empty");_=x.columns}x.escapeChar!==void 0&&(B=x.escapeChar+J),(typeof x.escapeFormulae=="boolean"||x.escapeFormulae instanceof RegExp)&&(se=x.escapeFormulae instanceof RegExp?x.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var G=new RegExp(m(J),"g");if(typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(b)){if(!b.length||Array.isArray(b[0]))return he(null,b,H);if(typeof b[0]=="object")return he(_||Object.keys(b[0]),b,H)}else if(typeof b=="object")return typeof b.data=="string"&&(b.data=JSON.parse(b.data)),Array.isArray(b.data)&&(b.fields||(b.fields=b.meta&&b.meta.fields||_),b.fields||(b.fields=Array.isArray(b.data[0])?b.fields:typeof b.data[0]=="object"?Object.keys(b.data[0]):[]),Array.isArray(b.data[0])||typeof b.data[0]=="object"||(b.data=[b.data])),he(b.fields||[],b.data||[],H);throw new Error("Unable to serialize unrecognized input");function he(M,X,z){var Y="";typeof M=="string"&&(M=JSON.parse(M)),typeof X=="string"&&(X=JSON.parse(X));var ae=Array.isArray(M)&&0<M.length,W=!Array.isArray(X[0]);if(ae&&A){for(var re=0;re<M.length;re++)0<re&&(Y+=P),Y+=Re(M[re],re);0<X.length&&(Y+=U)}for(var Z=0;Z<X.length;Z++){var ee=ae?M.length:X[Z].length,Fe=!1,L=ae?Object.keys(X[Z]).length===0:X[Z].length===0;if(z&&!ae&&(Fe=z==="greedy"?X[Z].join("").trim()==="":X[Z].length===1&&X[Z][0].length===0),z==="greedy"&&ae){for(var I=[],V=0;V<ee;V++){var ie=W?M[V]:V;I.push(X[Z][ie])}Fe=I.join("").trim()===""}if(!Fe){for(var ne=0;ne<ee;ne++){0<ne&&!L&&(Y+=P);var j=ae&&W?M[ne]:ne;Y+=Re(X[Z][j],ne)}Z<X.length-1&&(!z||0<ee&&!L)&&(Y+=U)}}return Y}function Re(M,X){if(M==null)return"";if(M.constructor===Date)return JSON.stringify(M).slice(1,25);var z=!1;se&&typeof M=="string"&&se.test(M)&&(M="'"+M,z=!0);var Y=M.toString().replace(G,B);return(z=z||T===!0||typeof T=="function"&&T(M,X)||Array.isArray(T)&&T[X]||function(ae,W){for(var re=0;re<W.length;re++)if(-1<ae.indexOf(W[re]))return!0;return!1}(Y,l.BAD_DELIMITERS)||-1<Y.indexOf(P)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?J+Y+J:Y}}};if(l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!s&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=v,l.ParserHandle=f,l.NetworkStreamer=d,l.FileStreamer=h,l.StringStreamer=p,l.ReadableStreamStreamer=g,i.jQuery){var c=i.jQuery;c.fn.parse=function(b){var x=b.config||{},T=[];return this.each(function(U){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var J=0;J<this.files.length;J++)T.push({file:this.files[J],inputElem:this,instanceConfig:c.extend({},x)})}),A(),this;function A(){if(T.length!==0){var U,J,B,H,_=T[0];if(y(b.before)){var se=b.before(_.file,_.inputElem);if(typeof se=="object"){if(se.action==="abort")return U="AbortError",J=_.file,B=_.inputElem,H=se.reason,void(y(b.error)&&b.error({name:U},J,B,H));if(se.action==="skip")return void P();typeof se.config=="object"&&(_.instanceConfig=c.extend(_.instanceConfig,se.config))}else if(se==="skip")return void P()}var G=_.instanceConfig.complete;_.instanceConfig.complete=function(he){y(G)&&G(he,_.file,_.inputElem),P()},l.parse(_.file,_.instanceConfig)}else y(b.complete)&&b.complete()}function P(){T.splice(0,1),A()}}}function u(b){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(x){var T=D(x);T.chunkSize=parseInt(T.chunkSize),x.step||x.chunk||(T.chunkSize=null),this._handle=new f(T),(this._handle.streamer=this)._config=T}).call(this,b),this.parseChunk=function(x,T){if(this.isFirstChunk&&y(this._config.beforeFirstChunk)){var A=this._config.beforeFirstChunk(x);A!==void 0&&(x=A)}this.isFirstChunk=!1,this._halted=!1;var P=this._partialLine+x;this._partialLine="";var U=this._handle.parse(P,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var J=U.meta.cursor;this._finished||(this._partialLine=P.substring(J-this._baseIndex),this._baseIndex=J),U&&U.data&&(this._rowCount+=U.data.length);var B=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)i.postMessage({results:U,workerId:l.WORKER_ID,finished:B});else if(y(this._config.chunk)&&!T){if(this._config.chunk(U,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);U=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(U.data),this._completeResults.errors=this._completeResults.errors.concat(U.errors),this._completeResults.meta=U.meta),this._completed||!B||!y(this._config.complete)||U&&U.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),B||U&&U.meta.paused||this._nextChunk(),U}this._halted=!0},this._sendError=function(x){y(this._config.error)?this._config.error(x):n&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:x,finished:!1})}}function d(b){var x;(b=b||{}).chunkSize||(b.chunkSize=l.RemoteChunkSize),u.call(this,b),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(x=new XMLHttpRequest,this._config.withCredentials&&(x.withCredentials=this._config.withCredentials),s||(x.onload=R(this._chunkLoaded,this),x.onerror=R(this._chunkError,this)),x.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var T=this._config.downloadRequestHeaders;for(var A in T)x.setRequestHeader(A,T[A])}if(this._config.chunkSize){var P=this._start+this._config.chunkSize-1;x.setRequestHeader("Range","bytes="+this._start+"-"+P)}try{x.send(this._config.downloadRequestBody)}catch(U){this._chunkError(U.message)}s&&x.status===0&&this._chunkError()}},this._chunkLoaded=function(){x.readyState===4&&(x.status<200||400<=x.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:x.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(T){var A=T.getResponseHeader("Content-Range");return A===null?-1:parseInt(A.substring(A.lastIndexOf("/")+1))}(x),this.parseChunk(x.responseText)))},this._chunkError=function(T){var A=x.statusText||T;this._sendError(new Error(A))}}function h(b){var x,T;(b=b||{}).chunkSize||(b.chunkSize=l.LocalChunkSize),u.call(this,b);var A=typeof FileReader<"u";this.stream=function(P){this._input=P,T=P.slice||P.webkitSlice||P.mozSlice,A?((x=new FileReader).onload=R(this._chunkLoaded,this),x.onerror=R(this._chunkError,this)):x=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var P=this._input;if(this._config.chunkSize){var U=Math.min(this._start+this._config.chunkSize,this._input.size);P=T.call(P,this._start,U)}var J=x.readAsText(P,this._config.encoding);A||this._chunkLoaded({target:{result:J}})},this._chunkLoaded=function(P){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(P.target.result)},this._chunkError=function(){this._sendError(x.error)}}function p(b){var x;u.call(this,b=b||{}),this.stream=function(T){return x=T,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var T,A=this._config.chunkSize;return A?(T=x.substring(0,A),x=x.substring(A)):(T=x,x=""),this._finished=!x,this.parseChunk(T)}}}function g(b){u.call(this,b=b||{});var x=[],T=!0,A=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(P){this._input=P,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&x.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),x.length?this.parseChunk(x.shift()):T=!0},this._streamData=R(function(P){try{x.push(typeof P=="string"?P:P.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(x.shift()))}catch(U){this._streamError(U)}},this),this._streamError=R(function(P){this._streamCleanUp(),this._sendError(P)},this),this._streamEnd=R(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=R(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(b){var x,T,A,P=Math.pow(2,53),U=-P,J=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,B=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,H=this,_=0,se=0,G=!1,he=!1,Re=[],M={data:[],errors:[],meta:{}};if(y(b.step)){var X=b.step;b.step=function(Z){if(M=Z,ae())Y();else{if(Y(),M.data.length===0)return;_+=Z.data.length,b.preview&&_>b.preview?T.abort():(M.data=M.data[0],X(M,H))}}}function z(Z){return b.skipEmptyLines==="greedy"?Z.join("").trim()==="":Z.length===1&&Z[0].length===0}function Y(){return M&&A&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),A=!1),b.skipEmptyLines&&(M.data=M.data.filter(function(Z){return!z(Z)})),ae()&&function(){if(!M)return;function Z(Fe,L){y(b.transformHeader)&&(Fe=b.transformHeader(Fe,L)),Re.push(Fe)}if(Array.isArray(M.data[0])){for(var ee=0;ae()&&ee<M.data.length;ee++)M.data[ee].forEach(Z);M.data.splice(0,1)}else M.data.forEach(Z)}(),function(){if(!M||!b.header&&!b.dynamicTyping&&!b.transform)return M;function Z(Fe,L){var I,V=b.header?{}:[];for(I=0;I<Fe.length;I++){var ie=I,ne=Fe[I];b.header&&(ie=I>=Re.length?"__parsed_extra":Re[I]),b.transform&&(ne=b.transform(ne,ie)),ne=W(ie,ne),ie==="__parsed_extra"?(V[ie]=V[ie]||[],V[ie].push(ne)):V[ie]=ne}return b.header&&(I>Re.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+Re.length+" fields but parsed "+I,se+L):I<Re.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+Re.length+" fields but parsed "+I,se+L)),V}var ee=1;return!M.data.length||Array.isArray(M.data[0])?(M.data=M.data.map(Z),ee=M.data.length):M.data=Z(M.data,0),b.header&&M.meta&&(M.meta.fields=Re),se+=ee,M}()}function ae(){return b.header&&Re.length===0}function W(Z,ee){return Fe=Z,b.dynamicTypingFunction&&b.dynamicTyping[Fe]===void 0&&(b.dynamicTyping[Fe]=b.dynamicTypingFunction(Fe)),(b.dynamicTyping[Fe]||b.dynamicTyping)===!0?ee==="true"||ee==="TRUE"||ee!=="false"&&ee!=="FALSE"&&(function(L){if(J.test(L)){var I=parseFloat(L);if(U<I&&I<P)return!0}return!1}(ee)?parseFloat(ee):B.test(ee)?new Date(ee):ee===""?null:ee):ee;var Fe}function re(Z,ee,Fe,L){var I={type:Z,code:ee,message:Fe};L!==void 0&&(I.row=L),M.errors.push(I)}this.parse=function(Z,ee,Fe){var L=b.quoteChar||'"';if(b.newline||(b.newline=function(ie,ne){ie=ie.substring(0,1048576);var j=new RegExp(m(ne)+"([^]*?)"+m(ne),"gm"),oe=(ie=ie.replace(j,"")).split("\r"),pe=ie.split(`
`),fe=1<pe.length&&pe[0].length<oe[0].length;if(oe.length===1||fe)return`
`;for(var Ce=0,le=0;le<oe.length;le++)oe[le][0]===`
`&&Ce++;return Ce>=oe.length/2?`\r
`:"\r"}(Z,L)),A=!1,b.delimiter)y(b.delimiter)&&(b.delimiter=b.delimiter(Z),M.meta.delimiter=b.delimiter);else{var I=function(ie,ne,j,oe,pe){var fe,Ce,le,be;pe=pe||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var De=0;De<pe.length;De++){var te=pe[De],Pe=0,Ne=0,Ve=0;le=void 0;for(var qe=new v({comments:oe,delimiter:te,newline:ne,preview:10}).parse(ie),$e=0;$e<qe.data.length;$e++)if(j&&z(qe.data[$e]))Ve++;else{var et=qe.data[$e].length;Ne+=et,le!==void 0?0<et&&(Pe+=Math.abs(et-le),le=et):le=et}0<qe.data.length&&(Ne/=qe.data.length-Ve),(Ce===void 0||Pe<=Ce)&&(be===void 0||be<Ne)&&1.99<Ne&&(Ce=Pe,fe=te,be=Ne)}return{successful:!!(b.delimiter=fe),bestDelimiter:fe}}(Z,b.newline,b.skipEmptyLines,b.comments,b.delimitersToGuess);I.successful?b.delimiter=I.bestDelimiter:(A=!0,b.delimiter=l.DefaultDelimiter),M.meta.delimiter=b.delimiter}var V=D(b);return b.preview&&b.header&&V.preview++,x=Z,T=new v(V),M=T.parse(x,ee,Fe),Y(),G?{meta:{paused:!0}}:M||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,T.abort(),x=y(b.chunk)?"":x.substring(T.getCharIndex())},this.resume=function(){H.streamer._halted?(G=!1,H.streamer.parseChunk(x,!0)):setTimeout(H.resume,3)},this.aborted=function(){return he},this.abort=function(){he=!0,T.abort(),M.meta.aborted=!0,y(b.complete)&&b.complete(M),x=""}}function m(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(b){var x,T=(b=b||{}).delimiter,A=b.newline,P=b.comments,U=b.step,J=b.preview,B=b.fastMode,H=x=b.quoteChar===void 0||b.quoteChar===null?'"':b.quoteChar;if(b.escapeChar!==void 0&&(H=b.escapeChar),(typeof T!="string"||-1<l.BAD_DELIMITERS.indexOf(T))&&(T=","),P===T)throw new Error("Comment character same as delimiter");P===!0?P="#":(typeof P!="string"||-1<l.BAD_DELIMITERS.indexOf(P))&&(P=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var _=0,se=!1;this.parse=function(G,he,Re){if(typeof G!="string")throw new Error("Input must be a string");var M=G.length,X=T.length,z=A.length,Y=P.length,ae=y(U),W=[],re=[],Z=[],ee=_=0;if(!G)return ht();if(b.header&&!he){var Fe=G.split(A)[0].split(T),L=[],I={},V=!1;for(var ie in Fe){var ne=Fe[ie];y(b.transformHeader)&&(ne=b.transformHeader(ne,ie));var j=ne,oe=I[ne]||0;for(0<oe&&(V=!0,j=ne+"_"+oe),I[ne]=oe+1;L.includes(j);)j=j+"_"+oe;L.push(j)}if(V){var pe=G.split(A);pe[0]=L.join(T),G=pe.join(A)}}if(B||B!==!1&&G.indexOf(x)===-1){for(var fe=G.split(A),Ce=0;Ce<fe.length;Ce++){if(Z=fe[Ce],_+=Z.length,Ce!==fe.length-1)_+=A.length;else if(Re)return ht();if(!P||Z.substring(0,Y)!==P){if(ae){if(W=[],Ve(Z.split(T)),Rt(),se)return ht()}else Ve(Z.split(T));if(J&&J<=Ce)return W=W.slice(0,J),ht(!0)}}return ht()}for(var le=G.indexOf(T,_),be=G.indexOf(A,_),De=new RegExp(m(H)+m(x),"g"),te=G.indexOf(x,_);;)if(G[_]!==x)if(P&&Z.length===0&&G.substring(_,_+Y)===P){if(be===-1)return ht();_=be+z,be=G.indexOf(A,_),le=G.indexOf(T,_)}else if(le!==-1&&(le<be||be===-1))Z.push(G.substring(_,le)),_=le+X,le=G.indexOf(T,_);else{if(be===-1)break;if(Z.push(G.substring(_,be)),et(be+z),ae&&(Rt(),se))return ht();if(J&&W.length>=J)return ht(!0)}else for(te=_,_++;;){if((te=G.indexOf(x,te+1))===-1)return Re||re.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:W.length,index:_}),$e();if(te===M-1)return $e(G.substring(_,te).replace(De,x));if(x!==H||G[te+1]!==H){if(x===H||te===0||G[te-1]!==H){le!==-1&&le<te+1&&(le=G.indexOf(T,te+1)),be!==-1&&be<te+1&&(be=G.indexOf(A,te+1));var Pe=qe(be===-1?le:Math.min(le,be));if(G.substr(te+1+Pe,X)===T){Z.push(G.substring(_,te).replace(De,x)),G[_=te+1+Pe+X]!==x&&(te=G.indexOf(x,_)),le=G.indexOf(T,_),be=G.indexOf(A,_);break}var Ne=qe(be);if(G.substring(te+1+Ne,te+1+Ne+z)===A){if(Z.push(G.substring(_,te).replace(De,x)),et(te+1+Ne+z),le=G.indexOf(T,_),te=G.indexOf(x,_),ae&&(Rt(),se))return ht();if(J&&W.length>=J)return ht(!0);break}re.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:W.length,index:_}),te++}}else te++}return $e();function Ve(At){W.push(At),ee=_}function qe(At){var mr=0;if(At!==-1){var Kt=G.substring(te+1,At);Kt&&Kt.trim()===""&&(mr=Kt.length)}return mr}function $e(At){return Re||(At===void 0&&(At=G.substring(_)),Z.push(At),_=M,Ve(Z),ae&&Rt()),ht()}function et(At){_=At,Ve(Z),Z=[],be=G.indexOf(A,_)}function ht(At){return{data:W,errors:re,meta:{delimiter:T,linebreak:A,aborted:se,truncated:!!At,cursor:ee+(he||0)}}}function Rt(){U(ht()),W=[],re=[]}},this.abort=function(){se=!0},this.getCharIndex=function(){return _}}function w(b){var x=b.data,T=o[x.workerId],A=!1;if(x.error)T.userError(x.error,x.file);else if(x.results&&x.results.data){var P={abort:function(){A=!0,C(x.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(y(T.userStep)){for(var U=0;U<x.results.data.length&&(T.userStep({data:x.results.data[U],errors:x.results.errors,meta:x.results.meta},P),!A);U++);delete x.results}else y(T.userChunk)&&(T.userChunk(x.results,P,x.file),delete x.results)}x.finished&&!A&&C(x.workerId,x.results)}function C(b,x){var T=o[b];y(T.userComplete)&&T.userComplete(x),T.terminate(),delete o[b]}function F(){throw new Error("Not implemented.")}function D(b){if(typeof b!="object"||b===null)return b;var x=Array.isArray(b)?[]:{};for(var T in b)x[T]=D(b[T]);return x}function R(b,x){return function(){b.apply(x,arguments)}}function y(b){return typeof b=="function"}return n&&(i.onmessage=function(b){var x=b.data;if(l.WORKER_ID===void 0&&x&&(l.WORKER_ID=x.workerId),typeof x.input=="string")i.postMessage({workerId:l.WORKER_ID,results:l.parse(x.input,x.config),finished:!0});else if(i.File&&x.input instanceof File||x.input instanceof Object){var T=l.parse(x.input,x.config);T&&i.postMessage({workerId:l.WORKER_ID,results:T,finished:!0})}}),(d.prototype=Object.create(u.prototype)).constructor=d,(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,l})})(gE);var G7=gE.exports;const H7=Jb(G7);var mE={exports:{}};(function(e,t){(function(r,i){i()})(ro,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function i(c,u,d){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){l(h.response,u,d)},h.onerror=function(){console.error("could not download file")},h.send()}function s(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function n(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ro=="object"&&ro.global===ro?ro:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,d){var h=o.URL||o.webkitURL,p=document.createElement("a");u=u||c.name||"download",p.download=u,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?n(p):s(p.href)?i(c,u,d):n(p,p.target="_blank")):(p.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(p.href)},4e4),setTimeout(function(){n(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,d){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,d),u);else if(s(c))i(c,u,d);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){n(h)})}}:function(c,u,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return i(c,u,d);var p=c.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||p&&g||a)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var C=m.result;C=f?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=C:location=C,h=null},m.readAsDataURL(c)}else{var v=o.URL||o.webkitURL,w=v.createObjectURL(c);h?h.location=w:location.href=w,h=null,setTimeout(function(){v.revokeObjectURL(w)},4e4)}});o.saveAs=l.saveAs=l,e.exports=l})})(mE);var V7=mE.exports;const Gp=(e,t)=>t.some(r=>e instanceof r);let vS,CS;function W7(){return vS||(vS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function z7(){return CS||(CS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hp=new WeakMap,Sf=new WeakMap,bh=new WeakMap;function $7(e){const t=new Promise((r,i)=>{const s=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{r(yo(e.result)),s()},o=()=>{i(e.error),s()};e.addEventListener("success",n),e.addEventListener("error",o)});return bh.set(t,e),t}function U7(e){if(Hp.has(e))return;const t=new Promise((r,i)=>{const s=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{r(),s()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)});Hp.set(e,t)}let Vp={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Hp.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return yo(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function vE(e){Vp=e(Vp)}function K7(e){return z7().includes(e)?function(...t){return e.apply(Wp(this),t),yo(this.request)}:function(...t){return yo(e.apply(Wp(this),t))}}function j7(e){return typeof e=="function"?K7(e):(e instanceof IDBTransaction&&U7(e),Gp(e,W7())?new Proxy(e,Vp):e)}function yo(e){if(e instanceof IDBRequest)return $7(e);if(Sf.has(e))return Sf.get(e);const t=j7(e);return t!==e&&(Sf.set(e,t),bh.set(t,e)),t}const Wp=e=>bh.get(e);function q7(e,t,{blocked:r,upgrade:i,blocking:s,terminated:n}={}){const o=indexedDB.open(e,t),a=yo(o);return i&&o.addEventListener("upgradeneeded",l=>{i(yo(o.result),l.oldVersion,l.newVersion,yo(o.transaction),l)}),r&&o.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),a.then(l=>{n&&l.addEventListener("close",()=>n()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Y7=["get","getKey","getAll","getAllKeys","count"],X7=["put","add","delete","clear"],yf=new Map;function wS(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(yf.get(t))return yf.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,s=X7.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Y7.includes(r)))return;const n=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[r](...a),s&&l.done]))[0]};return yf.set(t,n),n}vE(e=>({...e,get:(t,r,i)=>wS(t,r)||e.get(t,r,i),has:(t,r)=>!!wS(t,r)||e.has(t,r)}));const Q7=["continue","continuePrimaryKey","advance"],SS={},zp=new WeakMap,CE=new WeakMap,J7={get(e,t){if(!Q7.includes(t))return e[t];let r=SS[t];return r||(r=SS[t]=function(...i){zp.set(this,CE.get(this)[t](...i))}),r}};async function*Z7(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,J7);for(CE.set(r,t),bh.set(r,Wp(t));t;)yield r,t=await(zp.get(r)||t.continue()),zp.delete(r)}function yS(e,t){return t===Symbol.asyncIterator&&Gp(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Gp(e,[IDBIndex,IDBObjectStore])}vE(e=>({...e,get(t,r,i){return yS(t,r)?Z7:e.get(t,r,i)},has(t,r){return yS(t,r)||e.has(t,r)}}));function eK(){const e="TableDataDB",r=we(null),i=we([]),s=async()=>await q7(e,1,{upgrade(c){c.objectStoreNames.contains("tables")||c.createObjectStore("tables",{keyPath:"fileName"}).createIndex("fileNameIndex","fileName",{unique:!0})}});return{fileList:i,storeData:async c=>{await(await s()).put("tables",JSON.parse(JSON.stringify(c))),console.log("数据存储成功")},retrieveData:async c=>{const u=await s();r.value=await u.get("tables",c)},deleteData:async c=>{await(await s()).delete("tables",c)},getStoreAll:async()=>{const c=await s();i.value=await c.getAll("tables")}}}var Ya=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const i=t?this.allAsyncListeners:this.allSyncListeners;let s=i.get(e);return!s&&r&&(s=new Set,i.set(e,s)),s}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const i=this.getListeners(e,r,!1);i&&(i.delete(t),i.size===0&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const i=(a,l)=>a.forEach(c=>{if(!l.has(c))return;const u=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>c(e)):()=>c(e);t?this.dispatchAsync(u):u()}),s=this.getListeners(r,t,!1)??new Set,n=new Set(s);n.size>0&&i(n,s),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(a=>{const l=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>a(r,e)):()=>a(r,e);t?this.dispatchAsync(l):l()})}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};function ft(e){if(!(!e||!e.length))return e[e.length-1]}function Uo(e,t,r){return e==null&&t==null?!0:e!=null&&t!=null&&e.length===t.length&&e.every((i,s)=>r?r(i,t[s]):t[s]===i)}function tK(e){return e.sort((t,r)=>t-r)}function wE(e,t){const r=e.indexOf(t);r>=0&&(e[r]=e[e.length-1],e.pop())}function jr(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function rK(e,t){for(let r=0;r<t.length;r++)wE(e,t[r])}function iK(e,t){for(let r=0;r<t.length;r++)jr(e,t[r])}function kd(e,t,r){e.splice(r,0,t)}function SE(e,t,r){iK(e,t),t.slice().reverse().forEach(i=>kd(e,i,r))}function xo(e,t){return e.indexOf(t)>-1}function sK(e){return[].concat.apply([],e)}function xS(e,t){t==null||e==null||t.forEach(r=>e.push(r))}var yE="__ag_Grid_Stop_Propagation",nK=["touchstart","touchend","touchmove","touchcancel","scroll"],xf={};function Ia(e){e[yE]=!0}function Mn(e){return e[yE]===!0}var xE=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if(typeof xf[r]=="boolean")return xf[r];const i=document.createElement(e[r]||"div");return r="on"+r,xf[r]=r in i}})();function $p(e,t,r){let i=t;for(;i;){const s=e.getDomData(i,r);if(s)return s;i=i.parentElement}return null}function oK(e,t){return!t||!e?!1:lK(t).indexOf(e)>=0}function aK(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}function lK(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():aK(t)}function cK(e,t,r,i){const n=xo(nK,r)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,r,i,n)}var xe=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.gridId=e.context.getGridId(),this.frameworkOverrides=e.frameworkOverrides,this.stubContext=e.context,this.eventService=e.eventService,this.gos=e.gos,this.localeService=e.localeService}getFrameworkOverrides(){return this.frameworkOverrides}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t){this.localEventService||(this.localEventService=new Ya),this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)}dispatchLocalEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventService,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const i in t){const s=t[i];s&&r.push(this._setupListener(e,i,s))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;e instanceof HTMLElement?cK(this.getFrameworkOverrides(),e,t,r):e.addEventListener(t,r);const i=()=>(e.removeEventListener(t,r),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==i),null)}setupGridOptionListener(e,t){this.gos.addPropertyEventListener(e,t);const r=()=>(this.gos.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==r),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,i=s=>{if(s.changeSet){if(s.changeSet&&s.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=s.changeSet.id}const n={type:"gridPropertyChanged",changeSet:s.changeSet,source:s.source};t(n)};e.forEach(s=>this.setupGridOptionListener(s,i))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}},K0=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=r=>{this.frameworkOverrides.wrapOutgoing(()=>e(r))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(r,i)=>{this.frameworkOverrides.wrapOutgoing(()=>e(r,i))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){return this.wrappedListeners.get(e)??e}unwrapGlobal(e){return this.wrappedGlobalListeners.get(e)??e}};function bo(e){return e==null||e===""?null:e}function ke(e,t=!1){return e!=null&&(e!==""||t)}function ut(e){return!ke(e)}function hr(e){return e==null||e.length===0}function Up(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function Ro(e){if(e===void 0)return;if(e===null||e==="")return null;if(typeof e=="number")return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function Kp(e){if(e!==void 0)return e===null||e===""?!1:jp(e)}function jp(e){return typeof e=="boolean"?e:typeof e=="string"?e.toUpperCase()==="TRUE"||e=="":!1}function _d(e,t){const r=e?JSON.stringify(e):null,i=t?JSON.stringify(t):null;return r===i}function uK(e,t,r=!1){const i=e==null,s=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&s)return 0;if(i)return-1;if(s)return 1;function n(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!r)return n(e,t);try{return e.localeCompare(t)}catch{return n(e,t)}}function Yu(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(r=>t.push(r)),t}return Object.values(e)}var j0=new Set(["__proto__","constructor","prototype"]);function Ei(e,t){if(e!=null){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const[r,i]of Object.entries(e))t(r,i)}}function bE(e){const t={},r=Object.keys(e);for(let i=0;i<r.length;i++){if(j0.has(r[i]))continue;const s=r[i],n=e[s];t[s]=n}return t}function qp(e,t){if(!e)return;const r=e,i={};return Object.keys(r).forEach(s=>{if(t&&t.indexOf(s)>=0||j0.has(s))return;const n=r[s];Yp(n)&&n.constructor===Object?i[s]=qp(n):i[s]=n}),i}function Nn(e){if(!e)return[];const t=Object;if(typeof t.values=="function")return t.values(e);const r=[];for(const i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&r.push(e[i]);return r}function Fi(e,t,r=!0,i=!1){ke(t)&&Ei(t,(s,n)=>{if(j0.has(s))return;let o=e[s];o!==n&&(i&&o==null&&n!=null&&typeof n=="object"&&n.constructor===Object&&(o={},e[s]=o),Yp(n)&&Yp(o)&&!Array.isArray(o)?Fi(o,n,r,i):(r||n!==void 0)&&(e[s]=n))})}function $l(e,t,r){if(!t||!e)return;if(!r)return e[t];const i=t.split(".");let s=e;for(let n=0;n<i.length;n++){if(s==null)return;s=s[i[n]]}return s}function Yp(e){return typeof e=="object"&&e!==null}var dK={resizable:!0,sortable:!0},hK=0;function RE(){return hK++}function Bn(e){return e instanceof FE}var EE=20,FE=class extends xe{constructor(e,t,r,i){super(),this.isColumn=!0,this.instanceId=RE(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.columnEventService=new Ya,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=i,this.setState(e)}wireBeans(e){this.columnHoverService=e.columnHoverService}getInstanceId(){return this.instanceId}setState(e){e.sort!==void 0?(e.sort==="asc"||e.sort==="desc")&&(this.sort=e.sort):(e.initialSort==="asc"||e.initialSort==="desc")&&(this.sort=e.initialSort);const t=e.sortIndex,r=e.initialSortIndex;t!==void 0?t!==null&&(this.sortIndex=t):r!==null&&(this.sortIndex=r);const i=e.hide,s=e.initialHide;i!==void 0?this.visible=!i:this.visible=!s,e.pinned!==void 0?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const n=e.flex,o=e.initialFlex;n!==void 0?this.flex=n:o!==void 0&&(this.flex=o)}setColDef(e,t,r){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.columnEventService.dispatchEvent(this.createColumnEvent("colDefChanged",r))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}postConstruct(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=ke(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=ke(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??EE,this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=ke(this.colDef.tooltipField)||ke(this.colDef.tooltipValueGetter)||ke(this.colDef.tooltipComponent)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=Ro(e.width),i=Ro(e.initialWidth);return r!=null?t=r:i!=null?t=i:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(ut(this.colDef)||ut(this.colDef.showRowGroup))return!1;const t=this.colDef.showRowGroup===!0,r=this.colDef.showRowGroup===e;return t||r}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(e,t){var i;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.columnEventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new K0(this.frameworkOverrides));const r=((i=this.frameworkEventListenerService)==null?void 0:i.wrap(t))??t;this.columnEventService.addEventListener(e,r)}removeEventListener(e,t){var i;const r=((i=this.frameworkEventListenerService)==null?void 0:i.unwrap(t))??t;this.columnEventService.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if(typeof this.colDef.suppressNavigable=="boolean")return this.colDef.suppressNavigable;if(typeof this.colDef.suppressNavigable=="function"){const t=this.createColumnFunctionCallbackParams(e),r=this.colDef.suppressNavigable;return r(t)}return!1}isCellEditable(e){return e.group&&!this.gos.get("enableGroupEdit")?!1:this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??dK[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const r=this.createColumnFunctionCallbackParams(e);return t(r)}return!1}setMoving(e,t){this.moving=e,this.columnEventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t){this.sort!==e&&(this.sort=e,this.columnEventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return ut(this.sort)}isSorting(){return ke(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setMenuVisible(e,t){this.menuVisible!==e&&(this.menuVisible=e,this.columnEventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.columnEventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t,r){this.filterActive!==e&&(this.filterActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const i=this.createColumnEvent("filterChanged",t);r&&Fi(i,r),this.columnEventService.dispatchEvent(i)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){e===!0||e==="left"?this.pinned="left":e==="right"?this.pinned="right":this.pinned=null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const r=e===!0;this.visible!==r&&(this.visible=r,this.columnEventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(ut(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(ut(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.columnEventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t){this.pivotActive!==e&&(this.pivotActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t){this.aggregationActive!==e&&(this.aggregationActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchStateUpdatedEvent(e){this.columnEventService.dispatchEvent({type:"columnStateUpdated",key:e})}};function $r(e){return e instanceof Xu}var Xu=class extends xe{constructor(e,t,r,i){super(),this.isColumn=!1,this.expandable=!1,this.instanceId=RE(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=r,this.level=i}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(t=>{Bn(t)?e.push(t):$r(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const i=this.findChildrenRemovingPadding();for(let n=0,o=i.length;n<o;n++){const a=i[n];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,r=!0):l==="closed"?(t=!0,r=!0):(e=!0,t=!0)}const s=e&&t&&r;this.expandable!==s&&(this.expandable=s,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{r.forEach(i=>{$r(i)&&i.isPadding()?t(i.children):e.push(i)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},fK={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},bS={};function q0(e,t){bS[t]||(e(),bS[t]=!0)}function Ti(e,...t){console.log("AG Grid: "+e,...t)}function Te(e,...t){q0(()=>console.warn("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}function pt(e,...t){q0(()=>console.error("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}function Y0(e){return!!(e&&e.constructor&&e.call&&e.apply)}function pK(e){gK(e,400)}var bf=[],Rf=!1;function RS(e){bf.push(e),!Rf&&(Rf=!0,window.setTimeout(()=>{const t=bf.slice();bf.length=0,Rf=!1,t.forEach(r=>r())},0))}function gK(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(r=>r()),t)}function qr(e,t){let r;return function(...i){const s=this;window.clearTimeout(r),r=window.setTimeout(function(){e.apply(s,i)},t)}}function ES(e,t){let r=0;return function(...i){const s=this,n=new Date().getTime();n-r<t||(r=n,e.apply(s,i))}}function mK(e,t,r=100,i){const s=new Date().getTime();let n=null,o=!1;const a=()=>{const l=new Date().getTime()-s>r;(e()||l)&&(t(),o=!0,n!=null&&(window.clearInterval(n),n=null),l&&i&&Te(i))};a(),o||(n=window.setInterval(a,10))}function vK(...e){return t=>e.reduce((r,i)=>i(r),t)}var CK=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=Up(e);let r=0;for(;;){let i;if(e?(i=e,r!==0&&(i+="_"+r)):t?(i=t,r!==0&&(i+="_"+r)):i=r,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);r++}}},jc="ag-Grid-AutoColumn";function X0(e){const t=[],r=i=>{for(let s=0;s<i.length;s++){const n=i[s];Bn(n)?t.push(n):$r(n)&&r(n.getChildren())}};return r(e),t}function Bs(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function ua(e,t,r){const i={};if(!t)return;Qs(null,t,n=>{i[n.getInstanceId()]=n}),r&&Qs(null,r,n=>{i[n.getInstanceId()]=null});const s=Object.values(i).filter(n=>n!=null);e.destroyBeans(s)}function FS(e){return e.getId().startsWith(jc)}function Qu(e){let t=[];return e instanceof Array?e.some(i=>typeof i!="string")?Te("if colDef.type is supplied an array it should be of type 'string[]'"):t=e:typeof e=="string"?t=e.split(","):Te("colDef.type should be of type 'string' | 'string[]'"),t}var wK=class extends xe{constructor(){super(...arguments),this.beanName="columnFactory"}wireBeans(e){this.dataTypeService=e.dataTypeService}createColumnTree(e,t,r,i){const s=new CK,{existingCols:n,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(r);s.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,n,s,o,i),c=this.findMaxDept(l,0),u=this.balanceColumnTree(l,0,c,s);return Qs(null,u,(h,p)=>{$r(h)&&h.setupExpandable(),h.setOriginalParent(p)}),{columnTree:u,treeDept:c}}extractExistingTreeData(e){const t=[],r=[],i=[];return e&&Qs(null,e,s=>{if($r(s)){const n=s;r.push(n)}else{const n=s;i.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:r,existingColKeys:i}}createForAutoGroups(e,t){const r=[],i=this.findDepth(t);return e.forEach(s=>{let n=s;for(let o=i-1;o>=0;o--){const a=new Xu(null,`FAKE_PATH_${s.getId()}}_${o}`,!0,o);this.createBean(a),a.setChildren([n]),n.setOriginalParent(a),n=a}i===0&&s.setOriginalParent(null),r.push(n)}),[r,i]}findDepth(e){let t=0,r=e;for(;r&&r[0]&&$r(r[0]);)t++,r=r[0].getChildren();return t}balanceColumnTree(e,t,r,i){const s=[];for(let n=0;n<e.length;n++){const o=e[n];if($r(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,r,i);a.setChildren(l),s.push(a)}else{let a,l;for(let c=r-1;c>=t;c--){const u=i.getUniqueKey(null,null),d=this.createMergedColGroupDef(null),h=new Xu(d,u,!0,t);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(s.push(a),e.some(u=>$r(u))){l.setChildren([o]);continue}else{l.setChildren(e);break}s.push(o)}}return s}findMaxDept(e,t){let r=t;for(let i=0;i<e.length;i++){const s=e[i];if($r(s)){const n=s,o=this.findMaxDept(n.getChildren(),t+1);r<o&&(r=o)}}return r}recursivelyCreateColumns(e,t,r,i,s,n,o){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const c=e[l];this.isColumnGroup(c)?a[l]=this.createColumnGroup(r,c,t,i,s,n,o):a[l]=this.createColumn(r,c,i,s,o)}return a}createColumnGroup(e,t,r,i,s,n,o){const a=this.createMergedColGroupDef(t),l=s.getUniqueKey(a.groupId||null,null),c=new Xu(a,l,!1,r);this.createBean(c);const u=this.findExistingGroup(t,n);u&&n.splice(u.idx,1);const d=u==null?void 0:u.group;d&&c.setExpanded(d.isExpanded());const h=this.recursivelyCreateColumns(a.children,r+1,e,i,s,n,o);return c.setChildren(h),c}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,r,i,s){var a;const n=this.findExistingColumn(t,r);n&&(r==null||r.splice(n.idx,1));let o=n==null?void 0:n.column;if(o){const l=this.addColumnDefaultAndTypes(t,o.getColId());o.setColDef(l,t,s),this.applyColumnState(o,l,s)}else{const l=i.getUniqueKey(t.colId,t.field),c=this.addColumnDefaultAndTypes(t,l);o=new FE(c,t,l,e),this.createBean(o)}return(a=this.dataTypeService)==null||a.addColumnListeners(o),o}applyColumnState(e,t,r){const i=Ro(t.flex);if(i!==void 0&&e.setFlex(i),e.getFlex()<=0){const a=Ro(t.width);if(a!=null)e.setActualWidth(a,r);else{const l=e.getActualWidth();e.setActualWidth(l,r)}}t.sort!==void 0&&(t.sort=="asc"||t.sort=="desc"?e.setSort(t.sort,r):e.setSort(void 0,r));const n=Ro(t.sortIndex);n!==void 0&&e.setSortIndex(n);const o=Kp(t.hide);o!==void 0&&e.setVisible(!o,r),t.pinned!==void 0&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let r=0;r<t.length;r++){const i=t[r].getUserProvidedColDef();if(!i)continue;if(e.colId!=null){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(e.field!=null){if(i.field===e.field)return{idx:r,column:t[r]};continue}if(i===e)return{idx:r,column:t[r]}}}findExistingGroup(e,t){if(e.groupId!=null)for(let i=0;i<t.length;i++){const s=t[i];if(s.getColGroupDef()&&s.getId()===e.groupId)return{idx:i,group:s}}}addColumnDefaultAndTypes(e,t){var a;const r={},i=this.gos.get("defaultColDef");Fi(r,i,!1,!0);const s=this.updateColDefAndGetColumnType(r,e,t);s&&this.assignColumnTypes(s,r),Fi(r,e,!1,!0);const n=this.gos.get("autoGroupColumnDef"),o=this.gos.isColumnsSortingCoupledToGroup();return e.rowGroup&&n&&o&&Fi(r,{sort:n.sort,initialSort:n.initialSort},!1,!0),(a=this.dataTypeService)==null||a.validateColDef(r),r}updateColDefAndGetColumnType(e,t,r){var n;const i=(n=this.dataTypeService)==null?void 0:n.updateColDefAndGetColumnType(e,t,r),s=t.type??i??e.type;return e.type=s,s?Qu(s):void 0}assignColumnTypes(e,t){if(!e.length)return;const r=Object.assign({},fK),i=this.gos.get("columnTypes")||{};Ei(i,(s,n)=>{s in r?Te(`the column type '${s}' is a default column type and cannot be overridden.`):(n.type&&Te("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),r[s]=n)}),e.forEach(s=>{const n=r[s.trim()];n?Fi(t,n,!1,!0):Te("colDef.type '"+s+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return e.children!==void 0}};function Qs(e,t,r){if(t)for(let i=0;i<t.length;i++){const s=t[i];$r(s)&&Qs(s,s.getChildren(),r),r(s,e)}}var SK=class extends xe{constructor(){super(...arguments),this.beanName="columnModel",this.pivotMode=!1,this.autoHeightActiveAtLeastOnce=!1,this.ready=!1,this.changeEventsDispatching=!1,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}wireBeans(e){this.context=e.context,this.columnFactory=e.columnFactory,this.columnSizeService=e.columnSizeService,this.visibleColsService=e.visibleColsService,this.columnViewportService=e.columnViewportService,this.pivotResultColsService=e.pivotResultColsService,this.columnAnimationService=e.columnAnimationService,this.autoColService=e.autoColService,this.valueCache=e.valueCache,this.columnDefFactory=e.columnDefFactory,this.columnApplyStateService=e.columnApplyStateService,this.columnGroupStateService=e.columnGroupStateService,this.eventDispatcher=e.columnEventDispatcher,this.columnMoveService=e.columnMoveService,this.columnAutosizeService=e.columnAutosizeService,this.funcColsService=e.funcColsService,this.quickFilterService=e.quickFilterService,this.showRowGroupColsService=e.showRowGroupColsService,this.environment=e.environment}postConstruct(){const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],t=>this.refreshAll(da(t.source))),this.addManagedPropertyListener("autoGroupColumnDef",t=>this.onAutoGroupColumnDefChanged(da(t.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],t=>this.recreateColumnDefs(da(t.source))),this.addManagedPropertyListener("pivotMode",t=>this.setPivotMode(this.gos.get("pivotMode"),da(t.source))),this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}createColsFromColDefs(e,t){var d;const r=e?this.columnApplyStateService.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire();const i=this.colDefCols&&this.colDefCols.list,s=this.colDefCols&&this.colDefCols.tree,n=this.columnFactory.createColumnTree(this.colDefs,!0,s,t);ua(this.context,(d=this.colDefCols)==null?void 0:d.tree,n.columnTree);const o=n.columnTree,a=n.treeDept,l=X0(o),c={};l.forEach(h=>c[h.getId()]=h),this.colDefCols={tree:o,treeDepth:a,list:l,map:c},this.funcColsService.extractCols(t,i),this.ready=!0,this.refreshCols(),e&&!this.showingPivotResult&&!this.gos.get("maintainColumnOrder")&&this.orderColsLikeColDefCols(),this.visibleColsService.refresh(t),this.columnViewportService.checkViewportColumns(),this.eventDispatcher.everythingChanged(t),r&&(this.changeEventsDispatching=!0,r(),this.changeEventsDispatching=!1),this.eventDispatcher.newColumnsLoaded(t),t==="gridInitializing"&&this.columnSizeService.applyAutosizeStrategy()}refreshCols(){var r,i,s;if(!this.colDefCols)return;const e=(r=this.cols)==null?void 0:r.tree;this.saveColOrder(),this.selectCols(),this.createAutoCols(),this.addAutoCols(),this.restoreColOrder(),this.positionLockedCols(),(i=this.showRowGroupColsService)==null||i.refresh(),(s=this.quickFilterService)==null||s.refreshQuickFilterCols(),this.setColSpanActive(),this.setAutoHeightActive(),this.visibleColsService.clear(),this.columnViewportService.clear(),!Uo(e,this.cols.tree)&&this.eventDispatcher.gridColumns()}selectCols(){const e=this.pivotResultColsService.getPivotResultCols();if(this.showingPivotResult=e!=null,e){const{map:t,list:r,tree:i,treeDepth:s}=e;this.cols={list:r.slice(),map:{...t},tree:i.slice(),treeDepth:s},e.list.some(o=>{var a;return((a=this.cols)==null?void 0:a.map[o.getColId()])!==void 0})||(this.lastPivotOrder=null)}else{const{map:t,list:r,tree:i,treeDepth:s}=this.colDefCols;this.cols={list:r.slice(),map:{...t},tree:i.slice(),treeDepth:s}}}getColsToShow(){const e=this.isPivotMode()&&!this.isShowingPivotResult(),t=this.funcColsService.getValueColumns();return this.cols.list.filter(i=>{const s=FS(i);if(e){const n=t&&xo(t,i);return s||n}else return s||i.isVisible()})}addAutoCols(){this.autoCols!=null&&(this.cols.list=this.autoCols.list.concat(this.cols.list),this.cols.tree=this.autoCols.tree.concat(this.cols.tree),yK(this.cols))}createAutoCols(){var g,f;const e=this.gos.isGroupUseEntireRow(this.pivotMode),t=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),r=this.funcColsService.getRowGroupColumns(),s=!(r.length>0||this.gos.get("treeData"))||t||e,n=()=>{this.autoCols&&(ua(this.context,this.autoCols.tree),this.autoCols=null)};if(s||!this.autoColService){n();return}const o=this.autoColService.createAutoCols(r)??[],a=xK(o,((g=this.autoCols)==null?void 0:g.list)||null),l=this.cols.treeDepth,u=(this.autoCols?this.autoCols.treeDepth:-1)==l;if(a&&u)return;n();const[d,h]=this.columnFactory.createForAutoGroups(o,(f=this.cols)==null?void 0:f.tree);this.autoCols={list:o,tree:d,treeDepth:h,map:{}};const p=m=>{if(!m)return null;const v=m.filter(w=>!FS(w));return[...o,...v]};this.lastOrder=p(this.lastOrder),this.lastPivotOrder=p(this.lastPivotOrder)}refreshAll(e){this.isReady()&&(this.refreshCols(),this.visibleColsService.refresh(e))}setColsVisible(e,t=!1,r){this.columnApplyStateService.applyColumnState({state:e.map(i=>({colId:typeof i=="string"?i:i.getColId(),hide:!t}))},r)}setColsPinned(e,t,r){if(!this.cols||hr(e))return;if(this.gos.isDomLayout("print")){Te("Changing the column pinning status is not allowed with domLayout='print'");return}this.columnAnimationService.start();let i;t===!0||t==="left"?i="left":t==="right"?i="right":i=null;const s=[];e.forEach(n=>{if(!n)return;const o=this.getCol(n);o&&o.getPinned()!==i&&(o.setPinned(i),s.push(o))}),s.length&&(this.visibleColsService.refresh(r),this.eventDispatcher.columnPinned(s,r)),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,r){let i;$r(e)?i=e.getId():i=e||"",this.columnGroupStateService.setColumnGroupState([{groupId:i,open:t}],r)}getProvidedColGroup(e){var r;let t=null;return Qs(null,(r=this.cols)==null?void 0:r.tree,i=>{$r(i)&&i.getId()===e&&(t=i)}),t}isColGroupLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||t===0)return!1;if(t===-1)return!0;const i=this.funcColsService.getRowGroupColumns().findIndex(s=>s.getColId()===e.getColId());return t>i}isSuppressAutoCol(){return this.gos.get("groupDisplayType")==="custom"?!0:this.gos.get("treeDataDisplayType")==="custom"}setAutoHeightActive(){this.autoHeightActive=this.cols.list.some(e=>e.isAutoHeight()),this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,this.gos.isRowModelType("clientSide")||this.gos.isRowModelType("serverSide")||Te("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}restoreColOrder(){const e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;const t=new Map(e.map((l,c)=>[l,c]));if(!this.cols.list.some(l=>t.has(l)))return;const i=new Map(this.cols.list.map(l=>[l,!0])),s=e.filter(l=>i.has(l)),n=new Map(s.map(l=>[l,!0])),o=this.cols.list.filter(l=>!n.has(l)),a=s.slice();o.forEach(l=>{let c=l.getOriginalParent();if(!c){a.push(l);return}const u=[];for(;!u.length&&c;)c.getLeafColumns().forEach(g=>{const f=a.indexOf(g)>=0,m=u.indexOf(g)<0;f&&m&&u.push(g)}),c=c.getOriginalParent();if(!u.length){a.push(l);return}const d=u.map(p=>a.indexOf(p)),h=Math.max(...d);kd(a,l,h+1)}),this.cols.list=a}orderColsLikeColDefCols(){if(!this.colDefCols||!this.cols)return;const e=this.colDefCols.list.filter(r=>this.cols.list.indexOf(r)>=0),t=this.cols.list.filter(r=>e.indexOf(r)<0);this.cols.list=[...t,...e],this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}sortColsLikeKeys(e){if(this.cols==null)return;let t=[];const r={};e.forEach(s=>{if(r[s])return;const n=this.cols.map[s];n&&(t.push(n),r[s]=!0)});let i=0;if(this.cols.list.forEach(s=>{const n=s.getColId();if(r[n]!=null)return;n.startsWith(jc)?kd(t,s,i++):t.push(s)}),t=this.columnMoveService.placeLockedColumns(t),!this.columnMoveService.doesMovePassMarryChildren(t)){Te("Applying column order broke a group where columns should be married together. Applying new order has been discarded.");return}this.cols.list=t}sortColsLikeCols(e){!e||e.length<=1||e.filter(r=>this.cols.list.indexOf(r)<0).length>0||e.sort((r,i)=>{const s=this.cols.list.indexOf(r),n=this.cols.list.indexOf(i);return s-n})}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const i=this.columnFactory.addColumnDefaultAndTypes(r,e.getColId());return e.setColDef(i,r,t),!0}queueResizeOperations(){this.shouldQueueResizeOperations=!0}isShouldQueueResizeOperations(){return this.shouldQueueResizeOperations}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}moveInCols(e,t,r){var i;SE((i=this.cols)==null?void 0:i.list,e,t),this.visibleColsService.refresh(r)}positionLockedCols(){this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}saveColOrder(){var e,t;this.showingPivotResult?this.lastPivotOrder=(e=this.cols)==null?void 0:e.list:this.lastOrder=(t=this.cols)==null?void 0:t.list}getColumnDefs(){if(!this.colDefCols)return;const e=this.colDefCols.list.slice();this.showingPivotResult?e.sort((i,s)=>this.lastOrder.indexOf(i)-this.lastOrder.indexOf(s)):this.lastOrder&&e.sort((i,s)=>this.cols.list.indexOf(i)-this.cols.list.indexOf(s));const t=this.funcColsService.getRowGroupColumns(),r=this.funcColsService.getPivotColumns();return this.columnDefFactory.buildColumnDefs(e,t,r)}isShowingPivotResult(){return this.showingPivotResult}isChangeEventsDispatching(){return this.changeEventsDispatching}isColSpanActive(){return this.colSpanActive}isProvidedColGroupsPresent(){var e;return((e=this.colDefCols)==null?void 0:e.treeDepth)>0}setColSpanActive(){this.colSpanActive=this.cols.list.some(e=>e.getColDef().colSpan!=null)}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}getHeaderRowCount(){return this.cols?this.cols.treeDepth+1:-1}isReady(){return this.ready}isPivotMode(){return this.pivotMode}setPivotMode(e,t){e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=e,this.ready&&(this.refreshCols(),this.visibleColsService.refresh(t),this.eventDispatcher.pivotModeChanged()))}isPivotSettingAllowed(e){return e&&this.gos.get("treeData")?(Te("Pivot mode not available with treeData."),!1):!0}isPivotActive(){const e=this.funcColsService.getPivotColumns();return this.pivotMode&&!hr(e)}recreateColumnDefs(e){this.cols&&(this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e),this.createColsFromColDefs(!0,e))}setColumnDefs(e,t){const r=!!this.colDefs;this.colDefs=e,this.createColsFromColDefs(r,t)}destroy(){var e,t;ua(this.context,(e=this.colDefCols)==null?void 0:e.tree),ua(this.context,(t=this.autoCols)==null?void 0:t.tree),super.destroy()}getColTree(){return this.cols.tree}getColDefColTree(){return this.colDefCols.tree}getColDefCols(){var e;return(e=this.colDefCols)!=null&&e.list?this.colDefCols.list:null}getCols(){var e;return((e=this.cols)==null?void 0:e.list)??[]}getAllCols(){var r,i;const e=this.pivotResultColsService.getPivotResultCols(),t=e==null?void 0:e.list;return[].concat(((r=this.colDefCols)==null?void 0:r.list)||[],((i=this.autoCols)==null?void 0:i.list)||[],t||[])}getColsForKeys(e){return e?e.map(r=>this.getCol(r)).filter(r=>r!=null):[]}getColDefCol(e){var t;return(t=this.colDefCols)!=null&&t.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(t==null)return null;const{map:r,list:i}=t;if(typeof e=="string"&&r[e])return r[e];for(let s=0;s<i.length;s++)if(TS(i[s],e))return i[s];return this.getAutoCol(e)}getAutoCol(e){return this.autoCols==null?null:this.autoCols.list.find(t=>TS(t,e))||null}getAutoCols(){var e;return((e=this.autoCols)==null?void 0:e.list)||null}setColHeaderHeight(e,t){e.setAutoHeaderHeight(t)&&this.eventDispatcher.headerHeight(e)}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),r=this.visibleColsService.getAllCols().filter(i=>i.isAutoHeaderHeight()).map(i=>i.getAutoHeaderHeight()||0);return Math.max(e,...r)}getHeaderHeight(){return this.gos.get("headerHeight")??this.environment.getDefaultHeaderHeight()}getFloatingFiltersHeight(){return this.gos.get("floatingFiltersHeight")??this.getHeaderHeight()}getGroupHeaderHeight(){return this.gos.get("groupHeaderHeight")??this.getHeaderHeight()}getPivotHeaderHeight(){return this.gos.get("pivotHeaderHeight")??this.getHeaderHeight()}getPivotGroupHeaderHeight(){return this.gos.get("pivotGroupHeaderHeight")??this.getGroupHeaderHeight()}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if((e==null?void 0:e.type)!=="fitCellContents")return;const{colIds:t,skipHeader:r}=e;setTimeout(()=>{t?this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:r,source:"autosizeColumns"}):this.columnAutosizeService.autoSizeAllColumns("autosizeColumns",r)})}onAutoGroupColumnDefChanged(e){this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e)}};function da(e){return e==="gridOptionsUpdated"?"gridOptionsChanged":e}function yK(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function TS(e,t){const r=e===t,i=e.getColDef()===t,s=e.getColId()==t;return r||i||s}function xK(e,t){return Uo(e,t,(r,i)=>r.getColId()===i.getColId())}var bK=class extends xe{constructor(){super(...arguments),this.beanName="columnAutosizeService",this.timesDelayed=0}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.animationFrameService=e.animationFrameService,this.autoWidthCalculator=e.autoWidthCalculator,this.eventDispatcher=e.columnEventDispatcher,this.ctrlsService=e.ctrlsService,this.renderStatusService=e.renderStatusService}autoSizeCols(e){if(this.columnModel.isShouldQueueResizeOperations()){this.columnModel.pushResizeOperation(()=>this.autoSizeCols(e));return}const{colKeys:t,skipHeader:r,skipHeaderGroups:i,stopAtGroup:s,source:n="api"}=e;if(this.animationFrameService.flushAllFrames(),this.timesDelayed<5&&this.renderStatusService&&!this.renderStatusService.areHeaderCellsRendered()){this.timesDelayed++,setTimeout(()=>this.autoSizeCols(e));return}this.timesDelayed=0;const o=[];let a=-1;const l=r??this.gos.get("skipHeaderOnAutoSize"),c=i??l;for(;a!==0;){a=0;const u=[];t.forEach(d=>{if(!d)return;const h=this.columnModel.getCol(d);if(!h||o.indexOf(h)>=0)return;const p=this.autoWidthCalculator.getPreferredWidthForColumn(h,l);if(p>0){const g=this.normaliseColumnWidth(h,p);h.setActualWidth(g,n),o.push(h),a++}u.push(h)}),u.length&&this.visibleColsService.refresh(n)}c||this.autoSizeColumnGroupsByColumns(t,n,s),this.eventDispatcher.columnResized(o,!0,"autosizeColumns")}autoSizeColumn(e,t,r){e&&this.autoSizeCols({colKeys:[e],skipHeader:r,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,r){const i=new Set;this.columnModel.getColsForKeys(e).forEach(a=>{let l=a.getParent();for(;l&&l!=r;)l.isPadding()||i.add(l),l=l.getParent()});let n;const o=[];for(const a of i){for(const l of this.ctrlsService.getHeaderRowContainerCtrls())if(n=l.getHeaderCtrlForColumn(a),n)break;n&&n.resizeLeafColumnsToFit(t)}return o}autoSizeAllColumns(e,t){if(this.columnModel.isShouldQueueResizeOperations()){this.columnModel.pushResizeOperation(()=>this.autoSizeAllColumns(e,t));return}const r=this.visibleColsService.getAllCols();this.autoSizeCols({colKeys:r,skipHeader:t,source:e})}normaliseColumnWidth(e,t){const r=e.getMinWidth();t<r&&(t=r);const i=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=i),t}},RK=class extends xe{constructor(){super(...arguments),this.beanName="funcColsService",this.rowGroupCols=[],this.valueCols=[],this.pivotCols=[]}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.aggFuncService=e.aggFuncService,this.visibleColsService=e.visibleColsService}getModifyColumnsNoEventsCallbacks(){return{addGroupCol:e=>this.rowGroupCols.push(e),removeGroupCol:e=>jr(this.rowGroupCols,e),addPivotCol:e=>this.pivotCols.push(e),removePivotCol:e=>jr(this.pivotCols,e),addValueCol:e=>this.valueCols.push(e),removeValueCol:e=>jr(this.valueCols,e)}}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(t===!0)return this.rowGroupCols.slice(0);const r=this.columnModel.getColDefCol(t);return r?[r]:null}sortRowGroupColumns(e){this.rowGroupCols.sort(e)}sortPivotColumns(e){this.pivotCols.sort(e)}getValueColumns(){return this.valueCols?this.valueCols:[]}getPivotColumns(){return this.pivotCols?this.pivotCols:[]}getRowGroupColumns(){return this.rowGroupCols?this.rowGroupCols:[]}isRowGroupEmpty(){return hr(this.rowGroupCols)}setColumnAggFunc(e,t,r){if(!e)return;const i=this.columnModel.getColDefCol(e);i&&(i.setAggFunc(t),this.eventDispatcher.columnChanged("columnValueChanged",[i],r))}setRowGroupColumns(e,t){this.setColList(e,this.rowGroupCols,"columnRowGroupChanged",!0,!0,(r,i)=>this.setRowGroupActive(r,i,t),t)}setRowGroupActive(e,t,r){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,r),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.columnModel.setColsVisible([t],!1,r),!e&&!this.gos.get("suppressMakeColumnVisibleAfterUnGroup")&&this.columnModel.setColsVisible([t],!0,r))}addRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!0,!0,r=>this.setRowGroupActive(!0,r,t),"columnRowGroupChanged",t)}removeRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!1,!0,r=>this.setRowGroupActive(!1,r,t),"columnRowGroupChanged",t)}addPivotColumns(e,t){this.updateColList(e,this.pivotCols,!0,!1,r=>r.setPivotActive(!0,t),"columnPivotChanged",t)}setPivotColumns(e,t){this.setColList(e,this.pivotCols,"columnPivotChanged",!0,!1,(r,i)=>{i.setPivotActive(r,t)},t)}removePivotColumns(e,t){this.updateColList(e,this.pivotCols,!1,!1,r=>r.setPivotActive(!1,t),"columnPivotChanged",t)}setValueColumns(e,t){this.setColList(e,this.valueCols,"columnValueChanged",!1,!1,(r,i)=>this.setValueActive(r,i,t),t)}setValueActive(e,t,r){if(e!==t.isValueActive()&&(t.setValueActive(e,r),e&&!t.getAggFunc()&&this.aggFuncService)){const i=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(i)}}addValueColumns(e,t){this.updateColList(e,this.valueCols,!0,!1,r=>this.setValueActive(!0,r,t),"columnValueChanged",t)}removeValueColumns(e,t){this.updateColList(e,this.valueCols,!1,!1,r=>this.setValueActive(!1,r,t),"columnValueChanged",t)}moveRowGroupColumn(e,t,r){if(this.isRowGroupEmpty())return;const i=this.rowGroupCols[e],s=this.rowGroupCols.slice(e,t);this.rowGroupCols.splice(e,1),this.rowGroupCols.splice(t,0,i),this.eventDispatcher.rowGroupChanged(s,r)}setColList(e,t,r,i,s,n,o){const a=this.columnModel.getCols();if(hr(a))return;const l=new Map;t.forEach((u,d)=>l.set(u,d)),t.length=0,ke(e)&&e.forEach(u=>{const d=this.columnModel.getColDefCol(u);d&&t.push(d)}),t.forEach((u,d)=>{const h=l.get(u);if(h===void 0){l.set(u,0);return}i&&h!==d||l.delete(u)}),(this.columnModel.getColDefCols()||[]).forEach(u=>{const d=t.indexOf(u)>=0;n(d,u)}),s&&this.columnModel.refreshCols(),this.visibleColsService.refresh(o),this.eventDispatcher.columnChanged(r,[...l.keys()],o)}updateColList(e,t,r,i,s,n,o){if(!e||hr(e))return;let a=!1;e.forEach(l=>{if(!l)return;const c=this.columnModel.getColDefCol(l);if(c){if(r){if(t.indexOf(c)>=0)return;t.push(c)}else{if(t.indexOf(c)<0)return;jr(t,c)}s(c),a=!0}}),a&&(i&&this.columnModel.refreshCols(),this.visibleColsService.refresh(o),this.eventDispatcher.genericColumnEvent(n,t,o))}extractCols(e,t){this.extractRowGroupCols(e,t),this.extractPivotCols(e,t),this.extractValueCols(e,t)}extractValueCols(e,t){this.valueCols=this.extractColsCommon(t,this.valueCols,(r,i)=>r.setValueActive(i,e),()=>{},()=>{},r=>{const i=r.aggFunc;if(i===null||i==="")return null;if(i!==void 0)return!!i},r=>r.initialAggFunc!=null&&r.initialAggFunc!=""),this.valueCols.forEach(r=>{const i=r.getColDef();i.aggFunc!=null&&i.aggFunc!=""?r.setAggFunc(i.aggFunc):r.getAggFunc()||r.setAggFunc(i.initialAggFunc)})}extractRowGroupCols(e,t){this.rowGroupCols=this.extractColsCommon(t,this.rowGroupCols,(r,i)=>r.setRowGroupActive(i,e),r=>r.rowGroupIndex,r=>r.initialRowGroupIndex,r=>r.rowGroup,r=>r.initialRowGroup)}extractPivotCols(e,t){this.pivotCols=this.extractColsCommon(t,this.pivotCols,(r,i)=>r.setPivotActive(i,e),r=>r.pivotIndex,r=>r.initialPivotIndex,r=>r.pivot,r=>r.initialPivot)}extractColsCommon(e=[],t=[],r,i,s,n,o){const a=[],l=[];(this.columnModel.getColDefCols()||[]).forEach(h=>{const p=e.indexOf(h)<0,g=h.getColDef(),f=Kp(n(g)),m=Kp(o(g)),v=Ro(i(g)),w=Ro(s(g));let C;f!==void 0?C=f:v!==void 0?v===null?C=!1:C=v>=0:p?m!==void 0?C=m:w!==void 0?C=w!=null&&w>=0:C=!1:C=t.indexOf(h)>=0,C&&((p?v!=null||w!=null:v!=null)?a.push(h):l.push(h))});const u=h=>{const p=i(h.getColDef()),g=s(h.getColDef());return p??g};a.sort((h,p)=>{const g=u(h),f=u(p);return g===f?0:g<f?-1:1});const d=[].concat(a);return t.forEach(h=>{l.indexOf(h)>=0&&d.push(h)}),l.forEach(h=>{d.indexOf(h)<0&&d.push(h)}),t.forEach(h=>{d.indexOf(h)<0&&r(h,!1)}),d.forEach(h=>{t.indexOf(h)<0&&r(h,!0)}),d}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},i=(s,n,o,a,l,c)=>{const u=this.columnModel.getColDefCols();if(!n.length||!u)return[];const d=Object.keys(s),h=new Set(d),p=new Set(d),g=new Set(n.map(R=>{const y=R.getColId();return p.delete(y),y}).concat(d)),f=[],m={};let v=0;for(let R=0;R<u.length;R++){const y=u[R].getColId();g.has(y)&&(f.push(y),m[y]=v++)}let w=1e3,C=!1,F=0;const D=R=>{const y=m[R];for(let b=F;b<y;b++){const x=f[b];p.has(x)&&(s[x][l]=w++,p.delete(x))}F=y};n.forEach(R=>{const y=R.getColId();if(h.has(y))D(y),s[y][l]=w++;else{const b=R.getColDef();(b[l]===null||b[l]===void 0&&b[c]==null)&&(C||(b[o]||b[o]===void 0&&b[a]?D(y):(p.forEach(A=>{s[A][l]=w+m[A]}),w+=f.length,C=!0)),r[y]||(r[y]={colId:y}),r[y][l]=w++)}})};return i(e,this.rowGroupCols,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotCols,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(r)}},EK=class extends xe{constructor(){super(...arguments),this.beanName="columnApplyStateService"}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.sortController=e.sortController,this.columnGetStateService=e.columnGetStateService,this.funcColsService=e.funcColsService,this.visibleColsService=e.visibleColsService,this.columnAnimationService=e.columnAnimationService,this.pivotResultColsService=e.pivotResultColsService}applyColumnState(e,t){const r=this.columnModel.getColDefCols()||[];if(hr(r))return!1;if(e&&e.state&&!e.state.forEach)return Te("applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const i=this.funcColsService.getModifyColumnsNoEventsCallbacks(),s=(a,l,c)=>{const u=this.compareColumnStatesAndDispatchEvents(t),d=l.slice(),h={},p={},g=[],f=[];let m=0;const v=this.funcColsService.getRowGroupColumns().slice(),w=this.funcColsService.getPivotColumns().slice();a.forEach(R=>{const y=R.colId||"";if(y.startsWith(jc)){g.push(R),f.push(R);return}const x=c(y);x?(this.syncColumnWithStateItem(x,R,e.defaultState,h,p,!1,t,i),jr(d,x)):(f.push(R),m+=1)});const C=R=>this.syncColumnWithStateItem(R,null,e.defaultState,h,p,!1,t,i);d.forEach(C),this.funcColsService.sortRowGroupColumns(AS.bind(this,h,v)),this.funcColsService.sortPivotColumns(AS.bind(this,p,w)),this.columnModel.refreshCols();const D=(this.columnModel.getAutoCols()||[]).slice();return g.forEach(R=>{const y=this.columnModel.getAutoCol(R.colId);jr(D,y),this.syncColumnWithStateItem(y,R,e.defaultState,null,null,!0,t,i)}),D.forEach(C),this.orderLiveColsLikeState(e),this.visibleColsService.refresh(t),this.eventDispatcher.everythingChanged(t),u(),{unmatchedAndAutoStates:f,unmatchedCount:m}};this.columnAnimationService.start();let{unmatchedAndAutoStates:n,unmatchedCount:o}=s(e.state||[],r,a=>this.columnModel.getColDefCol(a));if(n.length>0||ke(e.defaultState)){const a=this.pivotResultColsService.getPivotResultCols(),l=a==null?void 0:a.list;o=s(n,l||[],c=>this.pivotResultColsService.getPivotResultCol(c)).unmatchedCount}return this.columnAnimationService.finish(),o===0}resetColumnState(e){const t=this.columnModel.getColDefCols();if(hr(t))return;const r=this.columnModel.getColDefColTree(),i=X0(r),s=[];let n=1e3,o=1e3,a=[];const l=this.columnModel.getAutoCols();l&&(a=a.concat(l)),i&&(a=a.concat(i)),a.forEach(c=>{const u=this.getColumnStateFromColDef(c);ut(u.rowGroupIndex)&&u.rowGroup&&(u.rowGroupIndex=n++),ut(u.pivotIndex)&&u.pivot&&(u.pivotIndex=o++),s.push(u)}),this.applyColumnState({state:s,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(g,f)=>g??f??null,r=e.getColDef(),i=t(r.sort,r.initialSort),s=t(r.sortIndex,r.initialSortIndex),n=t(r.hide,r.initialHide),o=t(r.pinned,r.initialPinned),a=t(r.width,r.initialWidth),l=t(r.flex,r.initialFlex);let c=t(r.rowGroupIndex,r.initialRowGroupIndex),u=t(r.rowGroup,r.initialRowGroup);c==null&&(u==null||u==!1)&&(c=null,u=null);let d=t(r.pivotIndex,r.initialPivotIndex),h=t(r.pivot,r.initialPivot);d==null&&(h==null||h==!1)&&(d=null,h=null);const p=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:s,hide:n,pinned:o,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:p}}syncColumnWithStateItem(e,t,r,i,s,n,o,a){if(!e)return;const l=(F,D)=>{const R={value1:void 0,value2:void 0};let y=!1;return t&&(t[F]!==void 0&&(R.value1=t[F],y=!0),ke(D)&&t[D]!==void 0&&(R.value2=t[D],y=!0)),!y&&r&&(r[F]!==void 0&&(R.value1=r[F]),ke(D)&&r[D]!==void 0&&(R.value2=r[D])),R},c=l("hide").value1;c!==void 0&&e.setVisible(!c,o);const u=l("pinned").value1;u!==void 0&&e.setPinned(u);const d=e.getColDef().minWidth??EE,h=l("flex").value1;if(h!==void 0&&e.setFlex(h),h==null){const F=l("width").value1;F!=null&&d!=null&&F>=d&&e.setActualWidth(F,o)}const p=l("sort").value1;p!==void 0&&(p==="desc"||p==="asc"?e.setSort(p,o):e.setSort(void 0,o));const g=l("sortIndex").value1;if(g!==void 0&&e.setSortIndex(g),n||!e.isPrimary())return;const f=l("aggFunc").value1;f!==void 0&&(typeof f=="string"?(e.setAggFunc(f),e.isValueActive()||(e.setValueActive(!0,o),a.addValueCol(e))):(ke(f)&&Te("stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),a.removeValueCol(e))));const{value1:m,value2:v}=l("rowGroup","rowGroupIndex");(m!==void 0||v!==void 0)&&(typeof v=="number"||m?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),a.addGroupCol(e)),i&&typeof v=="number"&&(i[e.getId()]=v)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),a.removeGroupCol(e)));const{value1:w,value2:C}=l("pivot","pivotIndex");(w!==void 0||C!==void 0)&&(typeof C=="number"||w?(e.isPivotActive()||(e.setPivotActive(!0,o),a.addPivotCol(e)),s&&typeof C=="number"&&(s[e.getId()]=C)):e.isPivotActive()&&(e.setPivotActive(!1,o),a.removePivotCol(e)))}orderLiveColsLikeState(e){if(!e.applyOrder||!e.state)return;const t=[];e.state.forEach(r=>{r.colId!=null&&t.push(r.colId)}),this.columnModel.sortColsLikeKeys(t)}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.funcColsService.getRowGroupColumns().slice(),pivotColumns:this.funcColsService.getPivotColumns().slice(),valueColumns:this.funcColsService.getValueColumns().slice()},r=this.columnGetStateService.getColumnState(),i={};return r.forEach(s=>{i[s.colId]=s}),()=>{const s=this.columnModel.getAllCols(),n=(f,m,v,w)=>{const C=m.map(w),F=v.map(w);if(Uo(C,F))return;const R=new Set(m);v.forEach(x=>{R.delete(x)||R.add(x)});const y=[...R],b={type:f,columns:y,column:y.length===1?y[0]:null,source:e};this.eventService.dispatchEvent(b)},o=f=>{const m=[];return s.forEach(v=>{const w=i[v.getColId()];w&&f(w,v)&&m.push(v)}),m},a=f=>f.getColId();n("columnRowGroupChanged",t.rowGroupColumns,this.funcColsService.getRowGroupColumns(),a),n("columnPivotChanged",t.pivotColumns,this.funcColsService.getPivotColumns(),a);const c=o((f,m)=>{const v=f.aggFunc!=null,w=v!=m.isValueActive(),C=v&&f.aggFunc!=m.getAggFunc();return w||C});c.length>0&&this.eventDispatcher.columnChanged("columnValueChanged",c,e);const u=(f,m)=>f.width!=m.getActualWidth();this.eventDispatcher.columnResized(o(u),!0,e);const d=(f,m)=>f.pinned!=m.getPinned();this.eventDispatcher.columnPinned(o(d),e);const h=(f,m)=>f.hide==m.isVisible();this.eventDispatcher.columnVisible(o(h),e);const g=o((f,m)=>f.sort!=m.getSort()||f.sortIndex!=m.getSortIndex());g.length>0&&this.sortController.dispatchSortChangedEvents(e,g),this.normaliseColumnMovedEventForColumnState(r,e)}}normaliseColumnMovedEventForColumnState(e,t){const r=this.columnGetStateService.getColumnState(),i={};r.forEach(l=>i[l.colId]=l);const s={};e.forEach(l=>{i[l.colId]&&(s[l.colId]=!0)});const n=e.filter(l=>s[l.colId]),o=r.filter(l=>s[l.colId]),a=[];o.forEach((l,c)=>{const u=n&&n[c];if(u&&u.colId!==l.colId){const d=this.columnModel.getCol(u.colId);d&&a.push(d)}}),a.length&&this.eventDispatcher.columnMoved({movedColumns:a,source:t,finished:!0})}},AS=(e,t,r,i)=>{const s=e[r.getId()],n=e[i.getId()],o=s!=null,a=n!=null;if(o&&a)return s-n;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(i),u=l>=0,d=c>=0;return u&&d?l-c:u?-1:1},FK=class extends xe{constructor(){super(...arguments),this.beanName="columnMoveService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher}moveColumnByIndex(e,t,r){const i=this.columnModel.getCols();if(!i)return;const s=i[e];this.moveColumns([s],t,r)}moveColumns(e,t,r,i=!0){const s=this.columnModel.getCols();if(!s)return;if(this.columnAnimationService.start(),t>s.length-e.length){Te("tried to insert columns in invalid location, toIndex = ",t),Te("remember that you should not count the moving columns when calculating the new index");return}const n=this.columnModel.getColsForKeys(e);this.doesMovePassRules(n,t)&&(this.columnModel.moveInCols(n,t,r),this.eventDispatcher.columnMoved({movedColumns:n,source:r,toIndex:t,finished:i}),this.columnAnimationService.finish())}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){return!(!this.doesMovePassMarryChildren(e)||!this.doesMovePassLockedPositions(e))}getProposedColumnOrder(e,t){const i=this.columnModel.getCols().slice();return SE(i,e,t),i}doesMovePassLockedPositions(e){const t=n=>n?n==="left"||n===!0?-1:1:0,r=this.gos.get("enableRtl");let i=r?1:-1,s=!0;return e.forEach(n=>{const o=t(n.getColDef().lockPosition);r?o>i&&(s=!1):o<i&&(s=!1),i=o}),s}doesMovePassMarryChildren(e){let t=!0;const r=this.columnModel.getColTree();return Qs(null,r,i=>{if(!$r(i))return;const s=i,n=s.getColGroupDef();if(!(n&&n.marryChildren))return;const a=[];s.getLeafColumns().forEach(h=>{const p=e.indexOf(h);a.push(p)});const l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),u=l-c,d=s.getLeafColumns().length-1;u>d&&(t=!1)}),t}placeLockedColumns(e){const t=[],r=[],i=[];return e.forEach(n=>{const o=n.getColDef().lockPosition;o==="right"?i.push(n):o==="left"||o===!0?t.push(n):r.push(n)}),this.gos.get("enableRtl")?[...i,...r,...t]:[...t,...r,...i]}},TK=/[&<>"']/g,AK={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function bs(e,t){if(e==null)return null;const r=e.toString().toString();return t?r:r.replace(TK,i=>AK[i])}function PK(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,r=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(r,"$1 $2$3").replace(/\./g," ").split(" ").map(s=>s.substring(0,1).toUpperCase()+(s.length>1?s.substring(1,s.length):"")).join(" ")}function DK(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}var MK=class extends xe{constructor(){super(...arguments),this.beanName="columnNameService"}wireBeans(e){this.expressionService=e.expressionService,this.funcColsService=e.funcColsService,this.columnModel=e.columnModel}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t);return r?this.wrapHeaderNameWithAggFunc(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,r){const i=t?t.getColGroupDef():null;return i?this.getHeaderName(i,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,i,s){const n=e.headerValueGetter;if(n){const o=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:r,providedColumnGroup:i,location:s});return typeof n=="function"?n(o):typeof n=="string"?this.expressionService.evaluate(n,o):(Te("headerValueGetter must be a function or a string"),"")}else{if(e.headerName!=null)return e.headerName;if(e.field)return PK(e.field)}return""}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const r=e.getColDef().pivotValueColumn,i=ke(r);let s=null,n;if(i){const o=this.funcColsService.getValueColumns(),a=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&o.length===1,l=e.getColDef().pivotTotalColumnIds!==void 0;if(a&&!l)return t;s=r?r.getAggFunc():null,n=!0}else{const o=e.isValueActive(),a=this.columnModel.isPivotMode()||!this.funcColsService.isRowGroupEmpty();o&&a?(s=e.getAggFunc(),n=!0):n=!1}if(n){const o=typeof s=="string"?s:"func";return`${this.localeService.getLocaleTextFunc()(o,o)}(${t})`}return t}},kK=class extends xe{constructor(){super(...arguments),this.beanName="pivotResultColsService"}wireBeans(e){this.context=e.context,this.columnModel=e.columnModel,this.columnFactory=e.columnFactory,this.visibleColsService=e.visibleColsService}destroy(){var e;ua(this.context,(e=this.pivotResultCols)==null?void 0:e.tree),super.destroy()}isPivotResultColsPresent(){return this.pivotResultCols!=null}lookupPivotResultCol(e,t){if(this.pivotResultCols==null)return null;const r=this.columnModel.getColDefCol(t);let i=null;return this.pivotResultCols.list.forEach(s=>{const n=s.getColDef().pivotKeys,o=s.getColDef().pivotValueColumn;Uo(n,e)&&o===r&&(i=s)}),i}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.columnModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){var r,i;if(this.columnModel.isReady()&&!(e==null&&this.pivotResultCols==null)){if(e){this.processPivotResultColDef(e);const s=this.columnFactory.createColumnTree(e,!1,((r=this.pivotResultCols)==null?void 0:r.tree)||this.previousPivotResultCols||void 0,t);ua(this.context,(i=this.pivotResultCols)==null?void 0:i.tree,s.columnTree);const n=s.columnTree,o=s.treeDept,a=X0(n),l={};this.pivotResultCols={tree:n,treeDepth:o,list:a,map:l},this.pivotResultCols.list.forEach(c=>this.pivotResultCols.map[c.getId()]=c),this.previousPivotResultCols=null}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null;this.columnModel.refreshCols(),this.visibleColsService.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),r=this.gos.get("processPivotResultColGroupDef");if(!t&&!r)return;const i=s=>{s.forEach(n=>{if(ke(n.children)){const a=n;r&&r(a),i(a.children)}else t&&t(n)})};e&&i(e)}},_K=class extends xe{constructor(){super(...arguments),this.beanName="columnSizeService"}wireBeans(e){this.columnModel=e.columnModel,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}setColumnWidths(e,t,r,i){const s=[];e.forEach(n=>{const o=this.columnModel.getColDefCol(n.key)||this.columnModel.getCol(n.key);if(!o)return;if(s.push({width:n.newWidth,ratios:[1],columns:[o]}),this.gos.get("colResizeDefault")==="shift"&&(t=!t),t){const l=this.visibleColsService.getColAfter(o);if(!l)return;const c=o.getActualWidth()-n.newWidth,u=l.getActualWidth()+c;s.push({width:u,ratios:[1],columns:[l]})}}),s.length!==0&&this.resizeColumnSets({resizeSets:s,finished:r,source:i})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:i}=e;if(!(!t||t.every(u=>this.checkMinAndMaxWidthsForSet(u)))){if(r){const u=t&&t.length>0?t[0].columns:null;this.eventDispatcher.columnResized(u,r,i)}return}const n=[],o=[];t.forEach(u=>{const{width:d,columns:h,ratios:p}=u,g={},f={};h.forEach(w=>o.push(w));let m=!0,v=0;for(;m;){if(v++,v>1e3){pt("infinite loop in resizeColumnSets");break}m=!1;const w=[];let C=0,F=d;h.forEach((R,y)=>{if(f[R.getId()])F-=g[R.getId()];else{w.push(R);const x=p[y];C+=x}});const D=1/C;w.forEach((R,y)=>{const b=y===w.length-1;let x;b?x=F:(x=Math.round(p[y]*d*D),F-=x);const T=R.getMinWidth(),A=R.getMaxWidth();x<T?(x=T,f[R.getId()]=!0,m=!0):A>0&&x>A&&(x=A,f[R.getId()]=!0,m=!0),g[R.getId()]=x})}h.forEach(w=>{const C=g[w.getId()];w.getActualWidth()!==C&&(w.setActualWidth(C,i),n.push(w))})});const a=n.length>0;let l=[];a&&(l=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.visibleColsService.setLeftValues(i),this.visibleColsService.updateBodyWidths(),this.columnViewportService.checkViewportColumns());const c=o.concat(l);(a||r)&&this.eventDispatcher.columnResized(c,r,i,l)}checkMinAndMaxWidthsForSet(e){const{columns:t,width:r}=e;let i=0,s=0,n=!0;t.forEach(l=>{const c=l.getMinWidth();i+=c||0;const u=l.getMaxWidth();u>0?s+=u:n=!1});const o=r>=i,a=!n||r<=s;return o&&a}refreshFlexedColumns(e={}){const t=e.source?e.source:"flex";if(e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];const r=this.visibleColsService.getCenterCols();let i=-1;if(e.resizingCols){const h=new Set(e.resizingCols);for(let p=r.length-1;p>=0;p--)if(h.has(r[p])){i=p;break}}let s=0,n=[],o=0,a=0;for(let h=0;h<r.length;h++)r[h].getFlex()&&h>i?(n.push(r[h]),a+=r[h].getFlex(),o+=r[h].getMinWidth()):s+=r[h].getActualWidth();if(!n.length)return[];let l=[];s+o>this.flexViewportWidth&&(n.forEach(h=>h.setActualWidth(h.getMinWidth(),t)),l=n,n=[]);const c=[];let u;e:for(;;){u=this.flexViewportWidth-s;const h=u/a;for(let p=0;p<n.length;p++){const g=n[p],f=h*g.getFlex();let m=0;const v=g.getMinWidth(),w=g.getMaxWidth();if(f<v?m=v:f>w&&(m=w),m){g.setActualWidth(m,t),wE(n,g),a-=g.getFlex(),l.push(g),s+=g.getActualWidth();continue e}c[p]=Math.round(f)}break}let d=u;return n.forEach((h,p)=>{h.setActualWidth(Math.min(c[p],d),t),l.push(h),d-=c[p]}),e.skipSetLeft||this.visibleColsService.setLeftValues(t),e.updateBodyWidths&&this.visibleColsService.updateBodyWidths(),e.fireResizedEvent&&this.eventDispatcher.columnResized(l,!0,t,n),n}sizeColumnsToFit(e,t="sizeColumnsToFit",r,i){var h;if(this.columnModel.isShouldQueueResizeOperations()){this.columnModel.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,r,i));return}const s={};i&&((h=i==null?void 0:i.columnLimits)==null||h.forEach(({key:p,...g})=>{s[typeof p=="string"?p:p.getColId()]=g}));const n=this.visibleColsService.getAllCols(),o=e===Bs(n);if(e<=0||!n.length||o)return;const a=[],l=[];n.forEach(p=>{p.getColDef().suppressSizeToFit===!0?l.push(p):a.push(p)});const c=a.slice(0);let u=!1;const d=p=>{jr(a,p),l.push(p)};for(a.forEach(p=>{p.resetActualWidth(t);const g=s==null?void 0:s[p.getId()],f=(g==null?void 0:g.minWidth)??(i==null?void 0:i.defaultMinWidth),m=(g==null?void 0:g.maxWidth)??(i==null?void 0:i.defaultMaxWidth),v=p.getActualWidth();typeof f=="number"&&v<f?p.setActualWidth(f,t,!0):typeof m=="number"&&v>m&&p.setActualWidth(m,t,!0)});!u;){u=!0;const p=e-Bs(l);if(p<=0)a.forEach(g=>{var m;const f=((m=s==null?void 0:s[g.getId()])==null?void 0:m.minWidth)??(i==null?void 0:i.defaultMinWidth);if(typeof f=="number"){g.setActualWidth(f,t,!0);return}g.setMinimum(t)});else{const g=p/Bs(a);let f=p;for(let m=a.length-1;m>=0;m--){const v=a[m],w=s==null?void 0:s[v.getId()],C=(w==null?void 0:w.minWidth)??(i==null?void 0:i.defaultMinWidth),F=(w==null?void 0:w.maxWidth)??(i==null?void 0:i.defaultMaxWidth),D=v.getMinWidth(),R=v.getMaxWidth(),y=typeof C=="number"&&C>D?C:D,b=typeof F=="number"&&F<R?F:R;let x=Math.round(v.getActualWidth()*g);x<y?(x=y,d(v),u=!1):x>b?(x=b,d(v),u=!1):m===0&&(x=f),v.setActualWidth(x,t,!0),f-=x}}}c.forEach(p=>{p.fireColumnWidthChangedEvent(t)}),this.visibleColsService.setLeftValues(t),this.visibleColsService.updateBodyWidths(),!r&&this.eventDispatcher.columnResized(c,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if(t==="fitGridWidth"){const{columnLimits:r,defaultMinWidth:i,defaultMaxWidth:s}=e,n=r==null?void 0:r.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:i,defaultMaxWidth:s,columnLimits:n})}else t==="fitProvidedWidth"&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}};function TE(e,t){return e+"_"+t}function Jt(e){return e instanceof AE}var AE=class extends xe{constructor(e,t,r,i){super(),this.isColumn=!1,this.displayedChildren=[],this.parent=null,this.groupId=t,this.partId=r,this.providedColumnGroup=e,this.pinned=i}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return TE(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{Jt(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=ft(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{Bn(t)?e.push(t):Jt(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{Bn(t)?e.push(t):Jt(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e||!e.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}this.children.forEach(r=>{if(Jt(r)&&(!r.displayedChildren||!r.displayedChildren.length))return;switch(r.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(r);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(r);break;default:this.displayedChildren.push(r);break}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},PE=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return typeof t!="number"?r=0:r=t+1,this.existingIds[e]=r,r}},IK=class extends xe{constructor(){super(...arguments),this.beanName="visibleColsService",this.colsAndGroupsMap={},this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher}refresh(e,t=!1){t||this.buildTrees(),this.updateOpenClosedVisibilityInColumnGroups(),this.columnsLeft=Ef(this.treeLeft),this.columnsCenter=Ef(this.treeCenter),this.columnsRight=Ef(this.treeRight),this.joinColsAriaOrder(),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.columns.filter(r=>r.isAutoHeight()),this.columnSizeService.refreshFlexedColumns(),this.updateBodyWidths(),this.columnViewportService.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(e),this.eventDispatcher.visibleCols()}updateBodyWidths(){const e=Bs(this.columnsCenter),t=Bs(this.columnsLeft),r=Bs(this.columnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r;const s={type:"columnContainerWidthChanged"};this.eventService.dispatchEvent(s);const n={type:"displayedColumnsWidthChanged"};this.eventService.dispatchEvent(n)}}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e){let t,r;this.gos.get("enableRtl")?(t=this.columnsLeft?this.columnsLeft[0]:null,r=this.columnsRight?ft(this.columnsRight):null):(t=this.columnsLeft?ft(this.columnsLeft):null,r=this.columnsRight?this.columnsRight[0]:null),this.columnModel.getCols().forEach(i=>{i.setLastLeftPinned(i===t,e),i.setFirstRightPinned(i===r,e)})}buildTrees(){const e=this.columnModel.getColsToShow(),t=e.filter(n=>n.getPinned()=="left"),r=e.filter(n=>n.getPinned()=="right"),i=e.filter(n=>n.getPinned()!="left"&&n.getPinned()!="right"),s=new PE;this.treeLeft=this.createGroups({columns:t,idCreator:s,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=this.createGroups({columns:r,idCreator:s,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=this.createGroups({columns:i,idCreator:s,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.ariaOrderColumns=[]}joinColsAriaOrder(){const e=this.columnModel.getCols(),t=[],r=[],i=[];for(const s of e){const n=s.getPinned();n?n===!0||n==="left"?t.push(s):i.push(s):r.push(s)}this.ariaOrderColumns=t.concat(r).concat(i)}getAriaColIndex(e){let t;return Jt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}getAllAutoHeightCols(){return this.autoHeightCols}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(t=>{Jt(t)&&t.checkLeft()})})}setLeftValuesOfCols(e){if(!this.columnModel.getColDefCols())return;const r=this.columnModel.getCols().slice(0),i=this.gos.get("enableRtl");[this.columnsLeft,this.columnsRight,this.columnsCenter].forEach(s=>{if(i){let n=Bs(s);s.forEach(o=>{n-=o.getActualWidth(),o.setLeft(n,e)})}else{let n=0;s.forEach(o=>{o.setLeft(n,e),n+=o.getActualWidth()})}rK(r,s)}),r.forEach(s=>{s.setLeft(null,e)})}joinCols(){this.gos.get("enableRtl")?this.columns=this.columnsRight.concat(this.columnsCenter).concat(this.columnsLeft):this.columns=this.columnsLeft.concat(this.columnsCenter).concat(this.columnsRight)}getColsCenter(){return this.columnsCenter}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}getTreeLeft(){return this.treeLeft}getTreeRight(){return this.treeRight}getTreeCenter(){return this.treeCenter}getAllCols(){return this.columns}isColDisplayed(e){return this.getAllCols().indexOf(e)>=0}getLeftColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsLeft):this.columnsLeft}getRightColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsRight):this.columnsRight}getColsForRow(e,t,r,i){const s=[];let n=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const h=c-1;for(let p=1;p<=h;p++)u.push(t[o+p]);o+=h}let d;r?(d=!1,u.forEach(h=>{r(h)&&(d=!0)})):d=!0,d&&(s.length===0&&n&&(i&&i(a))&&s.push(n),s.push(a)),n=a}return s}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getCenterCols(){return this.columnsCenter}getLeftCols(){return this.columnsLeft}getRightCols(){return this.columnsRight}getColBefore(e){const t=this.getAllCols(),r=t.indexOf(e);return r>0?t[r-1]:null}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),s=t==="After"?ft(i):i[0],n=`getCol${t}`;for(;;){const o=this[n](s);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let r=e.getParent(),i,s;for(;i=r.getProvidedColumnGroup().getLevel(),s=r.getPaddingLevel(),!(i+s<=t);)r=r.getParent();return r}isPinningLeft(){return this.columnsLeft.length>0}isPinningRight(){return this.columnsRight.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};no(this.treeCenter,!1,e),no(this.treeLeft,!1,e),no(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){const e=this.getAllTrees();no(e,!1,t=>{Jt(t)&&t.calculateDisplayedColumns()})}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["getLeftCols","getCenterCols","getRightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const i=this[t[r]]();if(i.length)return e?ft(i):i[0]}return null}getColumnGroup(e,t){if(!e)return null;if(Jt(e))return e;const r=this.getAllTrees(),i=typeof t=="number";let s=null;return no(r,!1,n=>{if(Jt(n)){const o=n;let a;i?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(s=o)}}),s}getColAfter(e){const t=this.getAllCols(),r=t.indexOf(e);return r<t.length-1?t[r+1]:null}isBodyWidthDirty(){return this.bodyWidthDirty}setBodyWidthDirty(){this.bodyWidthDirty=!0}getColsLeftWidth(){return Bs(this.columnsLeft)}getDisplayedColumnsRightWidth(){return Bs(this.columnsRight)}isColAtEdge(e,t){const r=this.getAllCols();if(!r.length)return!1;const i=t==="first";let s;if(Jt(e)){const n=e.getDisplayedLeafColumns();if(!n.length)return!1;s=i?n[0]:ft(n)}else s=e;return(i?r[0]:ft(r))===s}createGroups(e){const{columns:t,idCreator:r,pinned:i,oldDisplayedGroups:s,isStandaloneStructure:n}=e,o=this.mapOldGroupsById(s),a=[];let l=t;for(;l.length;){const c=l;l=[];let u=0;const d=h=>{const p=u;u=h;const g=c[p],m=(Jt(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(m==null){for(let w=p;w<h;w++)a.push(c[w]);return}const v=this.createColGroup(m,r,o,i,n);for(let w=p;w<h;w++)v.addChild(c[w]);l.push(v)};for(let h=1;h<c.length;h++){const p=c[h],f=(Jt(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=c[u],w=(Jt(m)?m.getProvidedColumnGroup():m).getOriginalParent();f!==w&&d(h)}u<c.length&&d(c.length)}return n||this.setupParentsIntoCols(a,null),a}createColGroup(e,t,r,i,s){const n=e.getGroupId(),o=t.getInstanceIdForKey(n),a=TE(n,o);let l=r[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),ke(l)?l.reset():(l=new AE(e,n,o,i),s||this.createBean(l)),l}mapOldGroupsById(e){const t={},r=i=>{i.forEach(s=>{if(Jt(s)){const n=s;t[s.getUniqueId()]=n,r(n.getChildren())}})};return e&&r(e),t}setupParentsIntoCols(e,t){e.forEach(r=>{if(r.setParent(t),Jt(r)){const i=r;this.setupParentsIntoCols(i.getChildren(),i)}})}};function no(e,t,r){if(e)for(let i=0;i<e.length;i++){const s=e[i];if(Jt(s)){const n=t?s.getDisplayedChildren():s.getChildren();no(n,t,r)}r(s)}}function Ef(e){const t=[];return no(e,!0,r=>{Bn(r)&&t.push(r)}),t}var DE=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd"],OK=["scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged"],LK=[...DE,...OK],NK={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},Ar=class{};Ar.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"];Ar.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"];Ar.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"];Ar.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"];Ar.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading"];Ar.OTHER_PROPERTIES=["suppressStickyTotalRow"];Ar.FUNCTION_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"];Ar.ALL_PROPERTIES=[...Ar.ARRAY_PROPERTIES,...Ar.OBJECT_PROPERTIES,...Ar.STRING_PROPERTIES,...Ar.NUMBER_PROPERTIES,...Ar.FUNCTION_PROPERTIES,...Ar.BOOLEAN_PROPERTIES,...Ar.OTHER_PROPERTIES];var xc=Ar,Mi=class{static getCallbackForEvent(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substring(1)}};Mi.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY";Mi.PUBLIC_EVENTS=DE;Mi.EVENT_CALLBACKS=LK.map(e=>Mi.getCallbackForEvent(e));Mi.BOOLEAN_PROPERTIES=xc.BOOLEAN_PROPERTIES;Mi.ALL_PROPERTIES=xc.ALL_PROPERTIES;Mi.ALL_PROPERTIES_AND_CALLBACKS=[...Mi.ALL_PROPERTIES,...Mi.EVENT_CALLBACKS];Mi.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(Mi.ALL_PROPERTIES_AND_CALLBACKS);var ji=Mi;function BK(e,t){typeof e!="object"&&(e={});const r={...e};return ji.ALL_PROPERTIES_AND_CALLBACKS.forEach(s=>{const n=t[s];typeof n<"u"&&n!==ji.VUE_OMITTED_PROPERTY&&(r[s]=n)}),r}function Xp(e,t){if(!e)return;const r={};let i=!1;if(Object.keys(e).filter(o=>ji.ALL_PROPERTIES_AND_CALLBACKS_SET.has(o)).forEach(o=>{r[o]=e[o],i=!0}),!i)return;const s={type:"gridOptionsChanged",options:r};t.dispatchEvent(s);const n={type:"componentStateChanged"};Ei(r,(o,a)=>{n[o]=a}),t.dispatchEvent(n)}var GK=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.addCssClass(i));return}if(this.cssClassStates[e]!==!0&&e.length){const i=this.getGui();i&&i.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.removeCssClass(i));return}if(this.cssClassStates[e]!==!1&&e.length){const i=this.getGui();i&&i.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return t?t.classList.contains(e):!1}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1){i.forEach(s=>this.addOrRemoveCssClass(s,t));return}}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}};function on(e,t,r){r==null||typeof r=="string"&&r==""?ME(e,t):cs(e,t,r)}function cs(e,t,r){e.setAttribute(kE(t),r.toString())}function ME(e,t){e.removeAttribute(kE(t))}function kE(e){return`aria-${e}`}function li(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function HK(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function VK(e){return e.getAttribute("aria-label")}function Oa(e,t){on(e,"label",t)}function bc(e,t){on(e,"labelledby",t)}function _E(e,t){on(e,"live",t)}function WK(e,t){on(e,"atomic",t)}function zK(e,t){on(e,"relevant",t)}function $K(e,t){on(e,"disabled",t)}function Q0(e,t){on(e,"hidden",t)}function Id(e,t){cs(e,"expanded",t)}function UK(e,t){cs(e,"setsize",t)}function KK(e,t){cs(e,"posinset",t)}function jK(e,t){cs(e,"multiselectable",t)}function qK(e,t){cs(e,"rowcount",t)}function IE(e,t){cs(e,"rowindex",t)}function YK(e,t){cs(e,"colcount",t)}function OE(e,t){cs(e,"colindex",t)}function XK(e,t){cs(e,"colspan",t)}function QK(e,t){cs(e,"sort",t)}function JK(e){ME(e,"sort")}function Od(e,t){on(e,"selected",t)}function ZK(e,t){on(e,"controls",t.id),bc(t,e.id)}function J0(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var Ff,Fu,Tf,Af,Pf,Df,Qp,Jp;function Js(){return Ff===void 0&&(Ff=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Ff}function LE(){if(Fu===void 0)if(Js()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(Fu=e[1]!=null?parseFloat(e[1]):0)}else Fu=0;return Fu}function Z0(){if(Tf===void 0){const e=window;Tf=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return Tf}function NE(){return Af===void 0&&(Af=/(firefox)/i.test(navigator.userAgent)),Af}function BE(){return Pf===void 0&&(Pf=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Pf}function $n(){return Df===void 0&&(Df=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),Df}function Zp(){return!Js()||LE()>=15}function eg(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return t===-1&&(r===null||r===""&&!NE())?null:t.toString()}function ej(){if(!document.body)return-1;let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const i=e*2;if(r.style.height=i+"px",i>t||r.clientHeight!==i)break;e=i}return document.body.removeChild(r),e}function tj(){var e,t;return((e=document.body)==null?void 0:e.clientWidth)??(window.innerHeight||((t=document.documentElement)==null?void 0:t.clientWidth)||-1)}function rj(){var e,t;return((e=document.body)==null?void 0:e.clientHeight)??(window.innerHeight||((t=document.documentElement)==null?void 0:t.clientHeight)||-1)}function ij(){return Jp==null&&GE(),Jp}function GE(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;r===0&&t.clientWidth===0&&(r=null),t.parentNode&&t.parentNode.removeChild(t),r!=null&&(Jp=r,Qp=r===0)}function HE(){return Qp==null&&GE(),Qp}var Tu,sj="[tabindex], input, select, button, textarea, [href]",VE="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function em(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),s=t.call(e,VE),n=ss(e);return i&&!s&&n}function Wt(e,t,r={}){const{skipAriaHidden:i}=r;e.classList.toggle("ag-hidden",!t),i||Q0(e,!t)}function nj(e,t,r={}){const{skipAriaHidden:i}=r;e.classList.toggle("ag-invisible",!t),i||Q0(e,!t)}function Rc(e,t){const r="disabled",i=t?s=>s.setAttribute(r,""):s=>s.removeAttribute(r);i(e),qE(e.querySelectorAll("input"),s=>i(s))}function Sa(e,t,r){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof r=="number"){if(++i>r)break}else if(e===r)break}return!1}function Ko(e){const{height:t,width:r,borderTopWidth:i,borderRightWidth:s,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(r||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(s||"0"),borderBottomWidth:parseFloat(n||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(u||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:f}}function tm(e){const t=Ko(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function qc(e){const t=Ko(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function WE(e){const{height:t,marginBottom:r,marginTop:i}=Ko(e);return Math.floor(t+r+i)}function Ld(e){const{width:t,marginLeft:r,marginRight:i}=Ko(e);return Math.floor(t+r+i)}function zE(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:i,borderRightWidth:s,borderBottomWidth:n}=Ko(e);return{top:t.top+(r||0),left:t.left+(i||0),right:t.right+(s||0),bottom:t.bottom+(n||0)}}function Nd(){if(typeof Tu=="boolean")return Tu;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML=`<div style="width: 2px">
            <span style="display: inline-block; width: 1px"></span>
            <span style="display: inline-block; width: 1px"></span>
        </div>`,document.body.appendChild(e),e.scrollLeft=1,Tu=Math.floor(e.scrollLeft)===0,document.body.removeChild(e),Tu}function Bd(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r),Z0()&&!Nd()&&(r=e.scrollWidth-e.clientWidth-r)),r}function Gd(e,t,r){r&&(Nd()?t*=-1:(Js()||Z0())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function Or(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function Cs(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $E(e){return!!e.offsetParent}function ss(e){const t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!$E(e)||window.getComputedStyle(e).visibility!=="visible")}function La(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function UE(e,t,r){r&&r.nextSibling===t||(r?r.nextSibling?e.insertBefore(t,r.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t))}function KE(e,t){for(let r=0;r<t.length;r++){const i=t[r],s=e.children[r];s!==i&&e.insertBefore(i,s)}}function oj(e,t,r){r?r.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function jE(e,t){if(t)for(const[r,i]of Object.entries(t)){if(!r||!r.length||i==null)continue;const s=DK(r),n=i.toString(),o=n.replace(/\s*!important/g,""),a=o.length!=n.length?"important":void 0;e.style.setProperty(s,o,a)}}function aj(e){return e.clientWidth<e.scrollWidth}function lj(e){return e.clientHeight<e.scrollHeight}function Hd(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):es(e,t)}function es(e,t){t=rm(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function Ul(e,t){t=rm(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function rm(e){return typeof e=="number"?`${e}px`:e}function im(e){return e instanceof Node||e instanceof HTMLElement}function cj(e){if(e==null)return[];const t=[];return qE(e,r=>t.push(r)),t}function uj(e,t){if(e)for(let r=0;r<e.length;r++){const i=e[r];t(i.name,i.value)}}function Us(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r.toString())}function qE(e,t){if(e!=null)for(let r=0;r<e.length;r++)t(e[r])}var Na=class{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},dj=1e3,hj=1e3,PS=100,YE=class Zn extends xe{constructor(t,r,i,s){super(),this.parentComp=t,this.tooltipShowDelayOverride=r,this.tooltipHideDelayOverride=i,this.shouldDisplayTooltip=s,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(t){this.popupService=t.popupService,this.userComponentFactory=t.userComponentFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const t=this.parentComp.getGui();this.tooltipTrigger===0&&this.addManagedListeners(t,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(t,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(t,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(t,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(t){const r=this.gos.get(t);return r<0&&Te(`${t} should not be lower than 0`),Math.max(200,r)}getTooltipDelay(t){return t==="show"?this.tooltipShowDelayOverride??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipHideDelayOverride??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const t=this.gos.get("tooltipTrigger");return!t||t==="hover"?0:1}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!$n()&&(Zn.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},PS):this.prepareToShowTooltip(t))}onMouseMove(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(t){var n;const r=t.relatedTarget,i=this.parentComp.getGui(),s=(n=this.tooltipComp)==null?void 0:n.getGui();this.isInteractingWithTooltip||i.contains(r)||this.interactionEnabled&&(s!=null&&s.contains(r))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(t){if(this.state!=0||Zn.isLocked)return;let r=0;t&&(r=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),r),this.state=1}isLastTooltipHiddenRecently(){const t=new Date().getTime(),r=Zn.lastTooltipHideTime;return t-r<dj}setToDoNothing(){this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const t={...this.parentComp.getTooltipParams()};if(!ke(t.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip()){this.setToDoNothing();return}this.state=2,this.tooltipInstanceCount++;const r=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(r)}hideTooltip(t){if(!t&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),Zn.lastTooltipHideTime=new Date().getTime());const r={type:"tooltipHide",parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(r),t&&(this.isInteractingWithTooltip=!1),this.state=0}newTooltipComponentCallback(t,r){if(this.state!==2||this.tooltipInstanceCount!==t){this.destroyBean(r);return}const s=r.getGui();this.tooltipComp=r,s.classList.contains("ag-tooltip")||s.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&s.classList.add("ag-tooltip-animate"),this.interactionEnabled&&s.classList.add("ag-tooltip-interactive");const n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:s,ariaLabel:n("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const l=this.setToDoNothing.bind(this);[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:l,columnMoved:l})}this.interactionEnabled&&(this.tooltipTrigger===0?[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(s,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}):[this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(s,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}));const a={type:"tooltipShow",tooltipGui:s,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(a),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(t){var n;const r=this.parentComp.getGui(),i=(n=this.tooltipComp)==null?void 0:n.getGui(),s=t.relatedTarget;i!=null&&i.contains(s)||(this.isInteractingWithTooltip=!1,r.contains(s)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent({...t,mouseEvent:this.lastMouseEvent}):this.popupService.positionPopupByComponent({...t,eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const t=this.tooltipPopupDestroyFunc,r=this.tooltipComp,i=this.tooltipTrigger===0?hj:0;window.setTimeout(()=>{t(),this.destroyBean(r)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(t=>{t&&t()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Zn.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},PS)}unlockService(){Zn.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};YE.isLocked=!1;var fj=YE,Xa=class extends xe{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}wireBeans(e){this.beans=e}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",r=this.ctrl.getGui();r&&(e!=null&&e!=""?r.setAttribute(t,e):r.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var t,r,i,s;if(this.tooltipManager!=null)return;const e={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new fj(e,(r=(t=this.ctrl).getTooltipShowDelayOverride)==null?void 0:r.call(t),(s=(i=this.ctrl).getTooltipHideDelayOverride)==null?void 0:s.call(i),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?e.getColumn():void 0,r=e.getColDef?e.getColDef():void 0,i=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:r,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:i,data:i?i.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0,hideTooltipCallback:()=>{var s;return(s=this.tooltipManager)==null?void 0:s.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},pj=new Na,He=null,wt=class XE extends xe{constructor(t,r){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=pj.next(),this.cssClassManager=new GK(()=>this.eGui),this.componentSelectors=new Map((r??[]).map(i=>[i.selector,i])),t&&this.setTemplate(t)}preWireBeans(t){super.preWireBeans(t)}preConstruct(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips"),this.wireTemplate(this.getGui())}wireTemplate(t,r){t&&this.gos&&(this.applyElementsToComponent(t),this.createChildComponentsFromTags(t,r))}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(t){const{newTooltipText:r,showDelayOverride:i,hideDelayOverride:s,location:n,shouldDisplayTooltip:o}=t||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==r&&(this.tooltipText=r);const a=()=>this.tooltipText;r!=null&&(this.tooltipFeature=this.createBean(new Xa({getTooltipValue:a,getGui:()=>this.getGui(),getLocation:()=>n??"UNKNOWN",getColDef:t==null?void 0:t.getColDef,getColumn:t==null?void 0:t.getColumn,getTooltipShowDelayOverride:i!=null?()=>i:void 0,getTooltipHideDelayOverride:s!=null?()=>s:void 0,shouldDisplayTooltip:o})))}getDataRefAttribute(t){return t.getAttribute?t.getAttribute("data-ref"):null}applyElementsToComponent(t,r,i,s=null){if(r===void 0&&(r=this.getDataRefAttribute(t)),r){const n=this[r];if(n===He)this[r]=s??t;else{const o=i&&i[r];!this.suppressDataRefValidation&&!o&&Te(`Issue with data-ref: ${r} on ${this.constructor.name} with ${n}`)}}}createChildComponentsFromTags(t,r){cj(t.childNodes).forEach(s=>{if(!(s instanceof HTMLElement))return;const n=this.createComponentFromElement(s,o=>{o.getGui()&&this.copyAttributesFromNode(s,o.getGui())},r);if(n){if(n.addItems&&s.children.length){this.createChildComponentsFromTags(s,r);const o=Array.prototype.slice.call(s.children);n.addItems(o)}this.swapComponentForNode(n,t,s)}else s.childNodes&&this.createChildComponentsFromTags(s,r)})}createComponentFromElement(t,r,i){const s=t.nodeName,n=this.getDataRefAttribute(t),o=s.indexOf("AG-")===0,a=o?this.componentSelectors.get(s):null;let l=null;if(a){XE.elementGettingCreated=t;const c=i&&n?i[n]:void 0;l=new a.component(c),l.setParentComponent(this),this.createBean(l,null,r)}else o&&Te(`Missing selector: ${s}`);return this.applyElementsToComponent(t,n,i,l),l}copyAttributesFromNode(t,r){uj(t.attributes,(i,s)=>r.setAttribute(i,s))}swapComponentForNode(t,r,i){const s=t.getGui();r.replaceChild(s,i),r.insertBefore(document.createComment(i.nodeName),s),this.addDestroyFunc(this.destroyBean.bind(this,t))}activateTabIndex(t){const r=this.gos.get("tabIndex");t||(t=[]),t.length||t.push(this.getGui()),t.forEach(i=>i.setAttribute("tabindex",r.toString()))}setTemplate(t,r,i){const s=La(t);this.setTemplateFromElement(s,r,i)}setTemplateFromElement(t,r,i,s=!1){if(this.eGui=t,this.suppressDataRefValidation=s,r)for(let n=0;n<r.length;n++){const o=r[n];this.componentSelectors.set(o.selector,o)}this.wireTemplate(t,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(t){this.parentComponent=t}getParentComponent(){return this.parentComponent}setGui(t){this.eGui=t}queryForHtmlElement(t){return this.eGui.querySelector(t)}getContainerAndElement(t,r){let i=r;return t==null?null:(i||(i=this.eGui),im(t)?{element:t,parent:i}:{element:t.getGui(),parent:i})}prependChild(t,r){const{element:i,parent:s}=this.getContainerAndElement(t,r)||{};!i||!s||s.insertAdjacentElement("afterbegin",i)}appendChild(t,r){const{element:i,parent:s}=this.getContainerAndElement(t,r)||{};!i||!s||s.appendChild(i)}isDisplayed(){return this.displayed}setVisible(t,r={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:i}=r;nj(this.eGui,t,{skipAriaHidden:i})}}setDisplayed(t,r={}){if(t!==this.displayed){this.displayed=t;const{skipAriaHidden:i}=r;Wt(this.eGui,t,{skipAriaHidden:i});const s={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(s)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}addGuiEventListener(t,r,i){this.eGui.addEventListener(t,r,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(t,r))}addCssClass(t){this.cssClassManager.addCssClass(t)}removeCssClass(t){this.cssClassManager.removeCssClass(t)}containsCssClass(t){return this.cssClassManager.containsCssClass(t)}addOrRemoveCssClass(t,r){this.cssClassManager.addOrRemoveCssClass(t,r)}},gj={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",checkboxChecked:"checkbox-checked",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off"};function ks(e,t,r){const i=vi(e,t,r);if(i){const{className:n}=i;if(typeof n=="string"&&n.indexOf("ag-icon")>-1||typeof n=="object"&&n["ag-icon"])return i}const s=document.createElement("span");return s.appendChild(i),s}function vi(e,t,r,i){let s=null;const n=r&&r.getColDef().icons;if(n&&(s=n[e]),t&&!s){const o=t.get("icons");o&&(s=o[e])}if(s){let o;if(typeof s=="function")o=s();else if(typeof s=="string")o=s;else throw new Error("icon from grid options needs to be a string or a function");if(typeof o=="string")return La(o);if(im(o))return o;Te("iconRenderer should return back a string or a dom object")}else{const o=document.createElement("span");let a=gj[e];return a||(Te(`Did not find icon ${e}`),a=""),o.setAttribute("class",`ag-icon ag-icon-${a}`),o.setAttribute("unselectable","on"),li(o,"presentation"),o}}function QE(e,t,r){if(r===0)return!1;const i=Math.abs(e.clientX-t.clientX),s=Math.abs(e.clientY-t.clientY);return Math.max(i,s)<=r}var kn=class{constructor(e,t=!1){this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new Ya,this.eElement=e,this.preventMouseClick=t;const r=this.onTouchStart.bind(this),i=this.onTouchMove.bind(this),s=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",r,{passive:!0}),this.eElement.addEventListener("touchmove",i,{passive:!0}),this.eElement.addEventListener("touchend",s,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",r,{passive:!0}),this.eElement.removeEventListener("touchmove",i,{passive:!0}),this.eElement.removeEventListener("touchend",s,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout(()=>{const r=this.touchStart===t;if(this.touching&&r&&!this.moved){this.moved=!0;const i={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(i)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!QE(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const t={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(t),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=new Date().getTime();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const r={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(r),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}},mj=`<span class="ag-sort-indicator-container">
        <span data-ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
        <span data-ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>
        <span data-ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>
        <span data-ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>
        <span data-ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>
    </span>`,sm=class extends wt{constructor(e){super(),this.eSortOrder=He,this.eSortAsc=He,this.eSortDesc=He,this.eSortMixed=He,this.eSortNone=He,e||this.setTemplate(mj)}wireBeans(e){this.sortController=e.sortController}attachCustomElements(e,t,r,i,s){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=i,this.eSortNone=s}setupSort(e,t=!1){this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!(!this.column.isSortable()&&!this.column.getColDef().showRowGroup)&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedEventListeners({newColumnsLoaded:this.updateIcons.bind(this),sortChanged:this.onSortChanged.bind(this),columnRowGroupChanged:this.onSortChanged.bind(this)}),this.onSortChanged())}addInIcon(e,t,r){if(t==null)return;const i=vi(e,this.gos,r);i&&t.appendChild(i)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const t=e==="asc";Wt(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){const t=e==="desc";Wt(this.eSortDesc,t,{skipAriaHidden:!0})}if(this.eSortNone){const t=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),r=e==null;Wt(this.eSortNone,!t&&r,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;this.gos.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e=this.sortController.getDisplaySortForColumn(this.column)==="mixed";Wt(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){if(!this.eSortOrder)return;const e=this.sortController.getColumnsWithSortingOrdered(),t=this.sortController.getDisplaySortIndexForColumn(this.column)??-1,r=e.some(s=>this.sortController.getDisplaySortIndexForColumn(s)??!1),i=t>=0&&r;Wt(this.eSortOrder,i,{skipAriaHidden:!0}),t>=0?this.eSortOrder.textContent=(t+1).toString():Or(this.eSortOrder)}},vj={selector:"AG-SORT-INDICATOR",component:sm},Cj=`<div class="ag-cell-label-container" role="presentation">
        <span data-ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>
        <span data-ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>
        <div data-ref="eLabel" class="ag-header-cell-label" role="presentation">
            <span data-ref="eText" class="ag-header-cell-text"></span>
            <span data-ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>
            <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>
        </div>
    </div>`,tg=class extends wt{constructor(){super(...arguments),this.eFilter=He,this.eFilterButton=He,this.eSortIndicator=He,this.eMenu=He,this.eLabel=He,this.eText=He,this.eSortOrder=He,this.eSortAsc=He,this.eSortDesc=He,this.eSortMixed=He,this.eSortNone=He,this.lastMovingChanged=0}wireBeans(e){this.sortController=e.sortController,this.menuService=e.menuService,this.funcColsService=e.funcColsService}destroy(){super.destroy()}refresh(e){const t=this.params;return this.params=e,this.workOutTemplate()!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||this.workOutSort()!=this.currentSort||this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon?!1:(this.setDisplayName(e),!0)}workOutTemplate(){let e=this.params.template??Cj;return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate,[vj]),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const t=bs(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=t)}}addInIcon(e,t,r){if(t==null)return;const i=vi(e,this.gos,r);i&&t.appendChild(i)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const t=new kn(this.getGui(),!0),r=this.shouldSuppressMenuHide(),i=r&&ke(this.eMenu),s=i?new kn(this.eMenu,!0):t;if(this.params.enableMenu){const n=i?"tap":"longTap",o=a=>this.params.showColumnMenuAfterMouseClick(a.touchStart);this.addManagedListeners(s,{[n]:o})}if(this.params.enableSorting){const n=o=>{var l,c;const a=o.touchStart.target;r&&((l=this.eMenu)!=null&&l.contains(a)||(c=this.eFilterButton)!=null&&c.contains(a))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListeners(t,{tap:n})}if(this.params.enableFilterButton){const n=new kn(this.eFilterButton,!0);this.addManagedListeners(n,{tap:()=>this.params.showFilter(this.eFilterButton)}),this.addDestroyFunc(()=>n.destroy())}this.addDestroyFunc(()=>t.destroy()),i&&this.addDestroyFunc(()=>s.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Cs(this.eMenu),this.eMenu=void 0;return}const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedElementListeners(this.eMenu,{click:()=>this.params.showColumnMenu(this.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){const t=this.params.column,r=this.menuService.isLegacyMenuEnabled();if(e&&!r){if(this.menuService.isFilterMenuInHeaderEnabled(t))return this.params.showFilter(this.eFilterButton??this.eMenu??this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu(this.eMenu??this.eFilterButton??this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.createBean(new sm(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListeners(this.params.column,{movingChanged:()=>{this.lastMovingChanged=new Date().getTime()}}),this.eLabel&&this.addManagedElementListeners(this.eLabel,{click:t=>{const r=this.params.column.isMoving(),s=new Date().getTime()-this.lastMovingChanged<50;if(!(r||s)){const a=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.params.progressSort(a)}}});const e=()=>{const t=this.params.column.getSort();if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",t==="asc"),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",t==="desc"),this.addOrRemoveCssClass("ag-header-cell-sorted-none",!t),this.params.column.getColDef().showRowGroup){const r=this.funcColsService.getSourceColumnsForGroupColumn(this.params.column),s=!(r==null?void 0:r.every(n=>this.params.column.getSort()==n.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",s)}};this.addManagedEventListeners({sortChanged:e,columnRowGroupChanged:e})}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedElementListeners(this.eFilterButton,{click:()=>this.params.showFilter(this.eFilterButton)}):this.eFilterButton=void 0}configureFilter(e,t,r){if(!e)return Cs(t),!1;const i=this.params.column;return this.addInIcon("filter",t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();Wt(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){return e?this.eFilterButton??this.eMenu??this.getGui():this.eMenu??this.eFilterButton??this.getGui()}},wj=class extends wt{constructor(){super(`<div class="ag-header-group-cell-label" role="presentation">
            <span data-ref="agLabel" class="ag-header-group-text" role="presentation"></span>
            <span data-ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>
            <span data-ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>
        </div>`),this.agOpened=He,this.agClosed=He,this.agLabel=He}wireBeans(e){this.columnModel=e.columnModel}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&Te("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened",this.agOpened),this.addInIcon("columnGroupClosed",this.agClosed);const e=s=>{if(Mn(s))return;const n=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")};this.addTouchAndClickListeners(this.agClosed,e),this.addTouchAndClickListeners(this.agOpened,e);const t=s=>{Ia(s)};this.addManagedElementListeners(this.agClosed,{dblclick:t}),this.addManagedElementListeners(this.agOpened,{dblclick:t}),this.addManagedElementListeners(this.getGui(),{dblclick:e}),this.updateIconVisibility();const r=this.params.columnGroup.getProvidedColumnGroup(),i=this.updateIconVisibility.bind(this);this.addManagedListeners(r,{expandedChanged:i,expandableChanged:i})}addTouchAndClickListeners(e,t){const r=new kn(e,!0);this.addManagedListeners(r,{tap:t}),this.addDestroyFunc(()=>r.destroy()),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const t=this.params.columnGroup.isExpanded();Wt(this.agOpened,t),Wt(this.agClosed,!t)}else Wt(this.agOpened,!1),Wt(this.agClosed,!1)}addInIcon(e,t){const r=vi(e,this.gos,null);r&&t.appendChild(r)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable()){Wt(this.agOpened,!1),Wt(this.agClosed,!1);return}}setupLabel(){var r;const{displayName:e,columnGroup:t}=this.params;if(ke(e)){const i=bs(e,!0);this.agLabel.textContent=i}this.addOrRemoveCssClass("ag-sticky-label",!((r=t.getColGroupDef())!=null&&r.suppressStickyLabel))}},JE=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(JE||{}),Rh=class Ft{static register(t){Ft.__register(t,!0,void 0)}static registerModules(t){Ft.__registerModules(t,!0,void 0)}static __register(t,r,i){Ft.runVersionChecks(t),i!==void 0?(Ft.areGridScopedModules=!0,Ft.gridModulesMap[i]===void 0&&(Ft.gridModulesMap[i]={}),Ft.gridModulesMap[i][t.moduleName]=t):Ft.globalModulesMap[t.moduleName]=t,Ft.setModuleBased(r)}static __unRegisterGridModules(t){delete Ft.gridModulesMap[t]}static __registerModules(t,r,i){Ft.setModuleBased(r),t&&t.forEach(s=>Ft.__register(s,r,i))}static isValidModuleVersion(t){const[r,i]=t.version.split(".")||[],[s,n]=Ft.currentModuleVersion.split(".")||[];return r===s&&i===n}static runVersionChecks(t){Ft.currentModuleVersion||(Ft.currentModuleVersion=t.version);const r=i=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${i} Please update all modules to the same version.`;if(t.version?Ft.isValidModuleVersion(t)||pt(r(`'${t.moduleName}' is version ${t.version} but the other modules are version ${Ft.currentModuleVersion}.`)):pt(r(`'${t.moduleName}' is incompatible.`)),t.validate){const i=t.validate();i.isValid||pt(`${i.message}`)}}static setModuleBased(t){Ft.moduleBased===void 0?Ft.moduleBased=t:Ft.moduleBased!==t&&(pt("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),pt("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information."))}static __setIsBundled(){Ft.isBundled=!0}static __assertRegistered(t,r,i){var n;if(this.__isRegistered(t,i))return!0;let s;if(Ft.isBundled)s=`AG Grid: unable to use ${r} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(Ft.moduleBased||Ft.moduleBased===void 0){const o=(n=Object.entries(JE).find(([a,l])=>l===t))==null?void 0:n[0];s=`AG Grid: unable to use ${r} as the ${o} is not registered${Ft.areGridScopedModules?` for gridId: ${i}`:""}. Check if you have registered the module:
           
    import { ModuleRegistry } from '@ag-grid-community/core';
    import { ${o} } from '${t}';
    
    ModuleRegistry.registerModules([ ${o} ]);

For more info see: https://www.ag-grid.com/javascript-grid/modules/`}else s=`AG Grid: unable to use ${r} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:
            
    import 'ag-grid-enterprise';`;return pt(s),!1}static __isRegistered(t,r){var i;return!!Ft.globalModulesMap[t]||!!((i=Ft.gridModulesMap[r])!=null&&i[t])}static __getRegisteredModules(t){return[...Yu(Ft.globalModulesMap),...Yu(Ft.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){return Yu(Ft.gridModulesMap[t]??{})||[]}static __isPackageBased(){return!Ft.moduleBased}};Rh.globalModulesMap={};Rh.gridModulesMap={};Rh.areGridScopedModules=!1;var Ur=Rh,Sj="↑",yj="↓",xj=class extends wt{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const r=document.createElement("span");r.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(r),this.setTemplateFromElement(e)}wireBeans(e){this.filterManager=e.filterManager}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const r=Math.abs(t),i=e.formatValue(r),s=ke(i)?i:r,n=t>=0;n?this.eDelta.textContent=Sj+s:this.eDelta.textContent=yj+s,this.eDelta.classList.toggle("ag-value-change-delta-up",n),this.eDelta.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Or(this.eDelta)}refresh(e,t=!1){var i;const r=e.value;if(r===this.lastValue||(ke(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:ke(e.value)?this.eValue.textContent=r:Or(this.eValue),(i=this.filterManager)!=null&&i.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof r=="number"&&typeof this.lastValue=="number"){const s=r-this.lastValue;this.showDelta(e,s)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=r,!0}},bj=class extends wt{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}wireBeans(e){this.filterManager=e.filterManager}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){var i;let r=e.value;return ut(r)&&(r=""),r===this.lastValue||(i=this.filterManager)!=null&&i.isSuppressFlashingCellsBecauseFiltering()?!1:(t||this.addSlideAnimation(),this.lastValue=r,ke(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:ke(e.value)?this.eCurrent.textContent=r:Or(this.eCurrent),!0)}},ve=class{};ve.BACKSPACE="Backspace";ve.TAB="Tab";ve.ENTER="Enter";ve.ESCAPE="Escape";ve.SPACE=" ";ve.LEFT="ArrowLeft";ve.UP="ArrowUp";ve.RIGHT="ArrowRight";ve.DOWN="ArrowDown";ve.DELETE="Delete";ve.F2="F2";ve.PAGE_UP="PageUp";ve.PAGE_DOWN="PageDown";ve.PAGE_HOME="Home";ve.PAGE_END="End";ve.A="KeyA";ve.C="KeyC";ve.D="KeyD";ve.V="KeyV";ve.X="KeyX";ve.Y="KeyY";ve.Z="KeyZ";var Rj=class extends wt{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:i,disabled:s}=this.config;s!=null&&this.setDisabled(s),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),r!=null&&this.setLabelWidth(r),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){Or(this.eLabel),typeof this.label=="string"?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),this.label===""?(Wt(this.eLabel,!1),li(this.eLabel,"presentation")):(Wt(this.eLabel,!0),li(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left",e==="left"),r.toggle("ag-label-align-right",e==="right"),r.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(Hd(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return Rc(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},ZE=class extends Rj{constructor(e,t,r,i){super(e,t,r),this.className=i}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),r!=null&&this.onValueChange(r),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();r==null||r==""||VK(e)!==null?bc(e,""):bc(e,t??"")}setAriaLabel(e){return Oa(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return es(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}},po=class extends ZE{constructor(e,t,r="text",i="input"){super(e,(e==null?void 0:e.template)??`
            <div role="presentation">
                <div data-ref="eLabel" class="ag-input-field-label"></div>
                <div data-ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">
                    <${i} data-ref="eInput" class="ag-input-field-input"></${i}>
                </div>
            </div>`,[],t),this.inputType=r,this.displayFieldTag=i,this.eLabel=He,this.eWrapper=He,this.eInput=He}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;e!=null&&this.setInputName(e),t!=null&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return Hd(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Us(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Oa(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Rc(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Us(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";Us(this.eInput,"autocomplete",t)}return this}},nm=class extends po{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const i=this.getInputElement(),s={type:"checkboxChanged",id:i.id,name:i.name,selected:e,previousValue:t};this.eventService.dispatchEvent(s)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",e===!0),this.eWrapper.classList.toggle("ag-indeterminate",e==null)}},om={selector:"AG-CHECKBOX",component:nm},Ej=class extends wt{constructor(){super(`
            <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">
                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>
            </div>`,[om]),this.eCheckbox=He}init(e){this.params=e,this.updateCheckbox(e);const t=this.eCheckbox.getInputElement();t.setAttribute("tabindex","-1"),_E(t,"polite"),this.addManagedListeners(t,{click:r=>{if(Ia(r),this.eCheckbox.isDisabled())return;const i=this.eCheckbox.getValue();this.onCheckboxChanged(i)},dblclick:r=>{Ia(r)}}),this.addManagedElementListeners(this.params.eGridCell,{keydown:r=>{if(r.key===ve.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===this.gos.getActiveDomElement()&&this.eCheckbox.toggle();const i=this.eCheckbox.getValue();this.onCheckboxChanged(i),r.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var a;let t,r=!0;if(e.node.group&&e.column){const l=e.column.getColId();l.startsWith(jc)?t=e.value==null||e.value===""?void 0:e.value==="true":e.node.aggData&&e.node.aggData[l]!==void 0?t=e.value??void 0:r=!1}else t=e.value??void 0;if(!r){this.eCheckbox.setDisplayed(!1);return}this.eCheckbox.setValue(t);const i=e.disabled!=null?e.disabled:!((a=e.column)!=null&&a.isCellEditable(e.node));this.eCheckbox.setDisabled(i);const s=this.localeService.getLocaleTextFunc(),n=J0(s,t),o=i?n:`${s("ariaToggleCellValue","Press SPACE to toggle cell value")} (${n})`;this.eCheckbox.setInputAriaLabel(o)}onCheckboxChanged(e){const{column:t,node:r,value:i}=this.params,s={type:"cellEditingStarted",column:t,colDef:t==null?void 0:t.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:i};this.eventService.dispatchEvent(s);const n=this.params.node.setDataValue(this.params.column,e,"edit"),o={type:"cellEditingStopped",column:t,colDef:t==null?void 0:t.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:i,oldValue:i,newValue:e,valueChanged:n};this.eventService.dispatchEvent(o)}},Fj=class extends wt{constructor(){super(`<div class="ag-loading">
            <span class="ag-loading-icon" data-ref="eLoadingIcon"></span>
            <span class="ag-loading-text" data-ref="eLoadingText"></span>
        </div>`),this.eLoadingIcon=He,this.eLoadingText=He}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=vi("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}},Tj=class extends wt{constructor(){super('<div class="ag-skeleton-container"></div>')}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>bc(e.eParentOfValue)),bc(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");Oa(this.getGui(),t)}setupLoading(e){const r=this.gos.getDocument().createElement("div");r.classList.add("ag-skeleton-effect");const i=e.node.rowIndex;if(i!=null){const o=75+25*(i%2===0?Math.sin(i):Math.cos(i));r.style.width=`${o}%`}this.getGui().appendChild(r);const n=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");Oa(this.getGui(),n)}refresh(e){return!1}destroy(){super.destroy()}},eF=class extends wt{constructor(){super()}destroy(){super.destroy()}},Aj=class extends eF{init(){const e=this.gos.get("overlayLoadingTemplate");if(this.setTemplate(e??'<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>'),!e){const t=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("loadingOoo","Loading...")})}}},Pj=class extends eF{init(){const e=this.gos.get("overlayNoRowsTemplate");if(this.setTemplate(e??'<span class="ag-overlay-no-rows-center"></span>'),!e){const t=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("noRowsToShow","No Rows To Show")})}}},Qa=class extends wt{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Dj=class extends Qa{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=bs(t,!0)}};function Mj(e,t,r){const i={},s=e.filter(n=>!t.some(o=>o===n));return s.length>0&&s.forEach(n=>i[n]=tF(n,r).values),i}function tF(e,t,r,i){let s=t.map((a,l)=>({value:a,relevance:kj(e.toLowerCase(),a.toLocaleLowerCase()),idx:l}));if(s.sort((a,l)=>l.relevance-a.relevance),r&&(s=s.filter(a=>a.relevance!==0)),s.length>0&&i&&i>0){const l=s[0].relevance*i;s=s.filter(c=>l-c.relevance<0)}const n=[],o=[];for(const a of s)n.push(a.value),o.push(a.idx);return{values:n,indices:o}}function kj(e,t){const r=e.replace(/\s/g,""),i=t.replace(/\s/g,"");let s=0,n=-1;for(let o=0;o<r.length;o++){const a=i.indexOf(r[o],n+1);a!==-1&&(n=a,s+=100-n*100/1e4*100)}return s}var _j=class extends xe{constructor(){super(...arguments),this.beanName="userComponentRegistry",this.agGridDefaults={agColumnHeader:tg,agColumnGroupHeader:wj,agSortIndicator:sm,agAnimateShowChangeCellRenderer:xj,agAnimateSlideCellRenderer:bj,agLoadingCellRenderer:Fj,agSkeletonCellRenderer:Tj,agCheckboxCellRenderer:Ej,agLoadingOverlay:Aj,agNoRowsOverlay:Pj,agTooltipComponent:Dj},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agGroupCellRenderer:"@ag-grid-enterprise/row-grouping",agGroupRowRenderer:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}postConstruct(){const e=this.gos.get("components");e!=null&&Ei(e,(t,r)=>this.registerJsComponent(t,r))}registerDefaultComponent(e,t){this.agGridDefaults[e]=t}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const r=(a,l)=>({componentFromFramework:l,component:a}),i=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(i!=null)return r(i,!0);const s=this.jsComps[t];if(s){const a=this.getFrameworkOverrides().isFrameworkComponent(s);return r(s,a)}const n=this.agGridDefaults[t];if(n)return r(n,!1);const o=this.enterpriseAgDefaultCompsModule[t];return o?Ur.__assertRegistered(o,`AG Grid '${e}' component: ${t}`,this.gridId):q0(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const r=[...Object.keys(this.agGridDefaults).filter(s=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(s)),...Object.keys(this.jsComps)],i=tF(t,r,!0,.8).values;Te(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&Te(`         Did you mean: [${i.slice(0,3)}]?`),Te(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}},pi=class xl{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new xl(r=>{let i=t.length;const s=new Array(i);t.forEach((n,o)=>{n.then(a=>{s[o]=a,i--,i===0&&r(s)})})}):xl.resolve()}static resolve(t=null){return new xl(r=>r(t))}then(t){return new xl(r=>{this.status===1?r(t(this.resolution)):this.waiters.push(i=>r(t(i)))})}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(r=>r(t))}onReject(t){}},Ij={propertyName:"dateComponent",cellRenderer:!1},Oj={propertyName:"headerComponent",cellRenderer:!1},Lj={propertyName:"headerGroupComponent",cellRenderer:!1},DS={propertyName:"cellRenderer",cellRenderer:!0},Nj={propertyName:"cellRenderer",cellRenderer:!1},Bj={propertyName:"loadingCellRenderer",cellRenderer:!0},Gj={propertyName:"cellEditor",cellRenderer:!1},MS={propertyName:"innerRenderer",cellRenderer:!0},Hj={propertyName:"loadingOverlayComponent",cellRenderer:!1},Vj={propertyName:"noRowsOverlayComponent",cellRenderer:!1},Wj={propertyName:"tooltipComponent",cellRenderer:!1},am={propertyName:"filter",cellRenderer:!1},zj={propertyName:"floatingFilterComponent",cellRenderer:!1},$j={propertyName:"toolPanel",cellRenderer:!1},Uj={propertyName:"statusPanel",cellRenderer:!1},Kj={propertyName:"fullWidthCellRenderer",cellRenderer:!0},jj={propertyName:"loadingCellRenderer",cellRenderer:!0},qj={propertyName:"groupRowRenderer",cellRenderer:!0},Yj={propertyName:"detailCellRenderer",cellRenderer:!0},Xj={propertyName:"menuItem",cellRenderer:!1},rF=class iF extends xe{constructor(){super(...arguments),this.beanName="userComponentFactory"}wireBeans(t){this.agComponentUtils=t.agComponentUtils,this.componentMetadataProvider=t.componentMetadataProvider,this.userComponentRegistry=t.userComponentRegistry,this.frameworkComponentWrapper=t.frameworkComponentWrapper,this.gridOptions=t.gridOptions}getHeaderCompDetails(t,r){return this.getCompDetails(t,Oj,"agColumnHeader",r)}getHeaderGroupCompDetails(t){const r=t.columnGroup.getColGroupDef();return this.getCompDetails(r,Lj,"agColumnGroupHeader",t)}getFullWidthCellRendererDetails(t){return this.getCompDetails(this.gridOptions,Kj,null,t,!0)}getFullWidthLoadingCellRendererDetails(t){return this.getCompDetails(this.gridOptions,jj,"agLoadingCellRenderer",t,!0)}getFullWidthGroupCellRendererDetails(t){return this.getCompDetails(this.gridOptions,qj,"agGroupRowRenderer",t,!0)}getFullWidthDetailCellRendererDetails(t){return this.getCompDetails(this.gridOptions,Yj,"agDetailCellRenderer",t,!0)}getInnerRendererDetails(t,r){return this.getCompDetails(t,MS,null,r)}getFullWidthGroupRowInnerCellRenderer(t,r){return this.getCompDetails(t,MS,null,r)}getCellRendererDetails(t,r){return this.getCompDetails(t,DS,null,r)}getEditorRendererDetails(t,r){return this.getCompDetails(t,Nj,null,r)}getLoadingCellRendererDetails(t,r){return this.getCompDetails(t,Bj,"agSkeletonCellRenderer",r,!0)}getCellEditorDetails(t,r){return this.getCompDetails(t,Gj,"agCellEditor",r,!0)}getFilterDetails(t,r,i){return this.getCompDetails(t,am,i,r,!0)}getDateCompDetails(t){return this.getCompDetails(this.gridOptions,Ij,"agDateInput",t,!0)}getLoadingOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,Hj,"agLoadingOverlay",t,!0)}getNoRowsOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,Vj,"agNoRowsOverlay",t,!0)}getTooltipCompDetails(t){return this.getCompDetails(t.colDef,Wj,"agTooltipComponent",t,!0)}getSetFilterCellRendererDetails(t,r){return this.getCompDetails(t,DS,null,r)}getFloatingFilterCompDetails(t,r,i){return this.getCompDetails(t,zj,i,r)}getToolPanelCompDetails(t,r){return this.getCompDetails(t,$j,null,r,!0)}getStatusPanelCompDetails(t,r){return this.getCompDetails(t,Uj,null,r,!0)}getMenuItemCompDetails(t,r){return this.getCompDetails(t,Xj,"agMenuItem",r,!0)}getCompDetails(t,r,i,s,n=!1){const{propertyName:o,cellRenderer:a}=r;let{compName:l,jsComp:c,fwComp:u,paramsFromSelector:d,popupFromSelector:h,popupPositionFromSelector:p}=iF.getCompKeys(this.frameworkOverrides,t,r,s);const g=w=>{const C=this.userComponentRegistry.retrieve(o,w);C&&(c=C.componentFromFramework?void 0:C.component,u=C.componentFromFramework?C.component:void 0)};if(l!=null&&g(l),c==null&&u==null&&i!=null&&g(i),c&&a&&!this.agComponentUtils.doesImplementIComponent(c)&&(c=this.agComponentUtils.adaptFunction(o,c)),!c&&!u){n&&pt(`Could not find component ${l}, did you forget to configure this component?`);return}const f=this.mergeParamsWithApplicationProvidedParams(t,r,s,d),m=c==null,v=c||u;return{componentFromFramework:m,componentClass:v,params:f,type:r,popupFromSelector:h,popupPositionFromSelector:p,newAgStackInstance:()=>this.newAgStackInstance(v,m,f,r)}}static getCompKeys(t,r,i,s){const{propertyName:n}=i;let o,a,l,c,u,d;if(r){const h=r,p=h[n+"Selector"],g=p?p(s):null,f=m=>{typeof m=="string"?o=m:m!=null&&m!==!0&&(t.isFrameworkComponent(m)?l=m:a=m)};g?(f(g.component),c=g.params,u=g.popup,d=g.popupPosition):f(h[n])}return{compName:o,jsComp:a,fwComp:l,paramsFromSelector:c,popupFromSelector:u,popupPositionFromSelector:d}}newAgStackInstance(t,r,i,s){const n=s.propertyName,o=!r;let a;if(o)a=new t;else{const c=this.componentMetadataProvider.retrieve(n);a=this.frameworkComponentWrapper.wrap(t,c.mandatoryMethodList,c.optionalMethodList,s)}const l=this.initComponent(a,i);return l==null?pi.resolve(a):l.then(()=>a)}mergeParamsWithApplicationProvidedParams(t,r,i,s=null){const n=this.gos.getGridCommonParams();Fi(n,i);const o=t,a=o&&o[r.propertyName+"Params"];if(typeof a=="function"){const l=a(i);Fi(n,l)}else typeof a=="object"&&Fi(n,a);return Fi(n,s),n}initComponent(t,r){if(this.createBean(t),t.init!=null)return t.init(r)}};function Kl(e){const t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}var Qj=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,!(!e||!e.beanClasses)&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){var t;Object.entries(e.providedBeanInstances).forEach(([r,i])=>{this.beans[r]=i}),e.beanClasses.forEach(r=>{const i=new r;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${r.name} is missing beanName`),this.createdBeans.push(i)}),(t=e.derivedBeans)==null||t.forEach(r=>{const{beanName:i,bean:s}=r(this);this.beans[i]=s,this.createdBeans.push(s)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.initBeans([e],t),e}initBeans(e,t){e.forEach(r=>{var i,s;(i=r.preWireBeans)==null||i.call(r,this.beans),(s=r.wireBeans)==null||s.call(r,this.beans)}),e.forEach(r=>{var i;return(i=r.preConstruct)==null?void 0:i.call(r)}),t&&e.forEach(t),e.forEach(r=>{var i;return(i=r.postConstruct)==null?void 0:i.call(r)})}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){var t;(t=e==null?void 0:e.destroy)==null||t.call(e)}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},Jj=class extends Qj{init(e){this.gridId=e.gridId,this.beans.context=this,super.init(e)}destroy(){super.destroy(),Ur.__unRegisterGridModules(this.gridId)}getGridId(){return this.gridId}},sF=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(sF||{}),Zj=`<div class="ag-dnd-ghost ag-unselectable">
<span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>
<div class="ag-dnd-ghost-label"></div>
</div>`,eq=class extends xe{constructor(){super(...arguments),this.beanName="dragAndDropService",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.dragService=e.dragService,this.mouseEventService=e.mouseEventService,this.environment=e.environment}postConstruct(){this.dropIconMap={pinned:ks("columnMovePin",this.gos,null),hide:ks("columnMoveHide",this.gos,null),move:ks("columnMoveMove",this.gos,null),left:ks("columnMoveLeft",this.gos,null),right:ks("columnMoveRight",this.gos,null),group:ks("columnMoveGroup",this.gos,null),aggregate:ks("columnMoveValue",this.gos,null),pivot:ks("columnMovePivot",this.gos,null),notAllowed:ks("dropNotAllowed",this.gos,null)}}addDragSource(e,t=!1){const r={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:r,dragSource:e}),this.dragService.addDragSource(r)}removeDragSource(e){const t=this.dragSourceAndParamsList.find(r=>r.dragSource===e);t&&(this.dragService.removeDragSource(t.params),jr(this.dragSourceAndParamsList,t))}destroy(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0,super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=void 0,this.dragItem=null,this.removeGhost()}onDragging(e,t){var o,a,l,c;const r=this.getHorizontalDirection(e),i=this.getVerticalDirection(e);this.eventLastTime=e,this.positionGhost(e);const s=this.dropTargets.filter(u=>this.isMouseOnDropTarget(e,u)),n=this.findCurrentDropTarget(e,s);if(n!==this.lastDropTarget)this.leaveLastTargetIfExists(e,r,i,t),this.lastDropTarget!==null&&n===null&&((a=(o=this.dragSource).onGridExit)==null||a.call(o,this.dragItem)),this.lastDropTarget===null&&n!==null&&((c=(l=this.dragSource).onGridEnter)==null||c.call(l,this.dragItem)),this.enterDragTargetIfExists(n,e,r,i,t),this.lastDropTarget=n;else if(n&&n.onDragging){const u=this.createDropTargetEvent(n,e,r,i,t);n.onDragging(u)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,r=[[e.getContainer()]];return t?r.concat(t):r}allContainersIntersect(e,t){for(const r of t){const i=r.getBoundingClientRect();if(i.width===0||i.height===0)return!1;const s=e.clientX>=i.left&&e.clientX<i.right,n=e.clientY>=i.top&&e.clientY<i.bottom;if(!s||!n)return!1}return!0}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let i=!1;for(const s of r)if(this.allContainersIntersect(e,s)){i=!0;break}return t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement)?!1:i&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement)}findCurrentDropTarget(e,t){const r=t.length;if(r===0)return null;if(r===1)return t[0];const s=this.gos.getRootNode().elementsFromPoint(e.clientX,e.clientY);for(const n of s)for(const o of t)if(sK(this.getAllContainersFromDropTarget(o)).indexOf(n)!==-1)return o;return null}enterDragTargetIfExists(e,t,r,i,s){if(e){if(e.onDragEnter){const n=this.createDropTargetEvent(e,t,r,i,s);e.onDragEnter(n)}this.setGhostIcon(e.getIconName?e.getIconName():null)}}leaveLastTargetIfExists(e,t,r,i){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const s=this.createDropTargetEvent(this.lastDropTarget,e,t,r,i);this.lastDropTarget.onDragLeave(s)}this.setGhostIcon(null)}}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(r=>r.external).find(r=>r.getContainer()===e.getContainer())||null}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,r=e.clientX;return t===r?null:t>r?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,r=e.clientY;return t===r?null:t>r?0:1}createDropTargetEvent(e,t,r,i,s){const n=e.getContainer(),o=n.getBoundingClientRect(),{dragItem:a,dragSource:l}=this,c=t.clientX-o.left,u=t.clientY-o.top;return this.gos.addGridCommonParams({event:t,x:c,y:u,vDirection:i,hDirection:r,dragSource:l,fromNudge:s,dragItem:a,dropZoneTarget:n})}positionGhost(e){const t=this.eGhost;if(!t)return;const i=t.getBoundingClientRect().height,s=tj()-2,n=rj()-2,o=zE(t.offsetParent),{clientY:a,clientX:l}=e;let c=a-o.top-i/2,u=l-o.left-10;const d=this.gos.getDocument(),h=d.defaultView||window,p=h.pageYOffset||d.documentElement.scrollTop,g=h.pageXOffset||d.documentElement.scrollLeft;s>0&&u+t.clientWidth>s+g&&(u=s+g-t.clientWidth),u<0&&(u=0),n>0&&c+t.clientHeight>n+p&&(c=n+p-t.clientHeight),c<0&&(c=0),t.style.left=`${u}px`,t.style.top=`${c}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=La(Zj),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost),this.environment.applyThemeClasses(this.eGhost),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const e=this.eGhost.querySelector(".ag-dnd-ghost-label");let t=this.dragSource.dragItemName;Y0(t)&&(t=t()),e.innerHTML=bs(t)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const r=this.gos.getDocument();let i=null,s=null;try{i=r.fullscreenElement}catch{}finally{i||(i=this.gos.getRootNode());const n=i.querySelector("body");n?s=n:i instanceof ShadowRoot?s=i:i instanceof Document?s=i==null?void 0:i.documentElement:s=i}this.eGhostParent=s,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):Te("Could not find document body, it is needed for dragging columns")}setGhostIcon(e,t=!1){Or(this.eGhostIcon);let r=null;e||(e=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():"notAllowed"),r=this.dropIconMap[e],this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),!(r===this.dropIconMap.hide&&this.gos.get("suppressDragLeaveHidesColumns"))&&r&&this.eGhostIcon.appendChild(r)}},tq=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const r=t||this.shouldSkipVerticalScroll();if(r&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),s=this.scrollByTick;this.tickLeft=e.clientX<i.left+s,this.tickRight=e.clientX>i.right-s,this.tickUp=e.clientY<i.top+s&&!r,this.tickDown=e.clientY>i.bottom-s&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},rq=class extends xe{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.sortController=e.sortController,this.filterManager=e.filterManager,this.selectionService=e.selectionService,this.mouseEventService=e.mouseEventService,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(e=>{const t=e.gridBodyCtrl;this.autoScrollService=new tq({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:r=>t.getScrollFeature().setVerticalScrollPosition(r),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){var i;return!!(this.funcColsService.getRowGroupColumns().length||((i=this.filterManager)==null?void 0:i.isAnyFilterPresent())||this.sortController.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.selectionService.getSelectedNodes()].sort((s,n)=>s.rowIndex==null||n.rowIndex==null?0:this.getRowIndexNumber(s)-this.getRowIndexNumber(n));if(i.indexOf(t)!==-1)return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach(t=>{t.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}isDropZoneWithinThisGrid(e){const r=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return!r.contains(i)}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const r=this.isFromThisGrid(e),i=this.gos.get("rowDragManaged"),s=e.dragItem.rowNodes;i&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!r?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(s[0],t):this.moveRows(s,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(ft(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),r=t&&t.highlighted===1,i=this.mouseEventService.getNormalisedPosition(e).y,s=e.dragItem.rowNodes;let n=r?1:0;if(this.isFromThisGrid(e))s.forEach(o=>{o.rowTop<i&&(n-=1)}),this.moveRows(s,i,n);else{const o=this.gos.getRowIdCallback();let a=this.clientSideRowModel.getRowIndexAtPixel(i)+1;this.clientSideRowModel.getHighlightPosition(i)===0&&a--,this.clientSideRowModel.updateRowData({add:s.filter(l=>!this.clientSideRowModel.getRowNode((o==null?void 0:o({data:l.data,level:0,rowPinned:l.rowPinned}))??l.data.id)).map(l=>l.data),addIndex:a})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,r=0){var s;this.clientSideRowModel.ensureRowsAtPixel(e,t,r)&&(this.focusService.clearFocusedCell(),(s=this.rangeService)==null||s.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer()){Te("addRowDropZone - A container target needs to be provided");return}if(this.dragAndDropService.findExternalZone(e)){Te("addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");return}let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=r=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",r))}),e.onDragLeave&&(t.onDragLeave=r=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",r))}),e.onDragging&&(t.onDragging=r=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",r))}),e.onDragStop&&(t.onDragStop=r=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",r))})),this.dragAndDropService.addDropTarget({isInterestedIn:r=>r===2,getIconName:()=>"move",external:!0,...t})}getRowDropZone(e){const t=this.getContainer.bind(this),r=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),s=this.onDragging.bind(this),n=this.onDragStop.bind(this);return e?{getContainer:t,onDragEnter:e.onDragEnter?o=>{r(o),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",o))}:r,onDragLeave:e.onDragLeave?o=>{i(o),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",o))}:i,onDragging:e.onDragging?o=>{s(o),e.onDragging(this.draggingToRowDragEvent("rowDragMove",o))}:s,onDragStop:e.onDragStop?o=>{n(o),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",o))}:n,fromGrid:!0}:{getContainer:t,onDragEnter:r,onDragLeave:i,onDragging:s,onDragStop:n,fromGrid:!0}}draggingToRowDragEvent(e,t){const r=this.mouseEventService.getNormalisedPosition(t).y,i=r>this.pageBoundsService.getCurrentPageHeight();let s=-1,n;i||(s=this.rowModel.getRowIndexAtPixel(r),n=this.rowModel.getRow(s));let o;switch(t.vDirection){case 1:o="down";break;case 0:o="up";break;default:o=null;break}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:s,overNode:n,y:r,vDirection:o})}dispatchGridEvent(e,t){const r=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(r)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&!this.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{t.setDragging(!1)})}},iq=class extends xe{constructor(){super(...arguments),this.beanName="dragService",this.dragEndFunctions=[],this.dragSources=[]}wireBeans(e){this.mouseEventService=e.mouseEventService}destroy(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,r=e.mouseDownListener;if(t.removeEventListener("mousedown",r),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find(r=>r.dragSource===e);t&&(this.removeListener(t),jr(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:r,includeTouch:i,stopPropagationForTouch:s}=e;r.addEventListener("mousedown",t);let n=null;const o=this.gos.get("suppressTouch");i&&!o&&(n=a=>{em(a.target)||(a.cancelable&&(a.preventDefault(),s&&a.stopPropagation()),this.onTouchStart(e,a))},r.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:n,touchEnabled:!!i})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const r=t.touches[0];this.touchLastTime=r,this.touchStart=r;const i=l=>this.onTouchMove(l,e.eElement),s=l=>this.onTouchUp(l,e.eElement),n=l=>{l.cancelable&&l.preventDefault()},o=t.target,a=[{target:this.gos.getRootNode(),type:"touchmove",listener:n,options:{passive:!1}},{target:o,type:"touchmove",listener:i,options:{passive:!0}},{target:o,type:"touchend",listener:s,options:{passive:!0}},{target:o,type:"touchcancel",listener:s,options:{passive:!0}}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onCommonMove(r,this.touchStart,e.eElement)}onMouseDown(e,t){const r=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||r._alreadyProcessedByDragService||(r._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=l=>this.onMouseMove(l,e.eElement),s=l=>this.onMouseUp(l,e.eElement),n=l=>l.preventDefault(),o=this.gos.getRootNode(),a=[{target:o,type:"mousemove",listener:i},{target:o,type:"mouseup",listener:s},{target:o,type:"contextmenu",listener:n}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:r,type:i,listener:s,options:n}=t;r.addEventListener(i,s,n)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:r,type:i,listener:s,options:n}=t;r.removeEventListener(i,s,n)})})}isEventNearStartEvent(e,t){const{dragStartPixels:r}=this.currentDragParams,i=ke(r)?r:4;return QE(e,t,i)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,r){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;const i={type:"dragStarted",target:r};this.eventService.dispatchEvent(i),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)}onTouchMove(e,t){const r=this.getFirstActiveTouch(e.touches);r&&this.onCommonMove(r,this.touchStart,t)}onMouseMove(e,t){var r;Js()&&((r=this.gos.getDocument().getSelection())==null||r.removeAllRanges()),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),r=e.type==="mousemove";return t&&r&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,r=t==null?void 0:t.tagName.toLocaleLowerCase();return!!(r!=null&&r.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let r=this.getFirstActiveTouch(e.changedTouches);r||(r=this.touchLastTime),this.onUpCommon(r,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);const r={type:"dragStopped",target:t};this.eventService.dispatchEvent(r)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(r=>r()),this.dragEndFunctions.length=0}},rg=class extends wt{constructor(e,t,r,i,s,n){super(),this.cellValueFn=e,this.rowNode=t,this.column=r,this.customGui=i,this.dragStartPixels=s,this.suppressVisibilityChange=n,this.dragSource=null}wireBeans(e){this.beans=e}isCustomGui(){return this.customGui!=null}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(vi("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new nq(this,this.beans,this.rowNode,this.column):new sq(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const t=this.beans.selectionService.getSelectedNodes();return t.indexOf(this.rowNode)!==-1?t:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&Te("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:i=>{i==null||i.preventDefault()}})[0]);const r=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{var o;const i=this.getDragItem(),s=((o=i.rowNodes)==null?void 0:o.length)||1,n=this.getRowDragText(this.column);return n?n(i,s):s===1?this.cellValueFn():`${s} ${r("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},nF=class extends xe{constructor(e,t,r){super(),this.parent=e,this.rowNode=t,this.column=r}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let r=!0,i=!1;this.column&&(r=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),i=Y0(this.column.getColDef().rowDrag)),i?(this.parent.setDisplayed(!0,t),this.parent.setVisible(r,t)):(this.parent.setDisplayed(r,t),this.parent.setVisible(!0,t))}}},sq=class extends nF{constructor(e,t,r,i){super(e,r,i),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},nq=class extends nF{constructor(e,t,r,i){super(e,r,i),this.beans=t}postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventService,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),r=t&&t.shouldPreventRowMove(),i=this.gos.get("suppressRowDrag"),s=this.beans.dragAndDropService.hasExternalDropZones(),n=r&&!s||i;this.setDisplayedOrVisible(n)}},Yc=class oa{constructor(t){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=oa.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(t){this.setDataCommon(t,!1)}updateData(t){this.setDataCommon(t,!0)}setDataCommon(t,r){var n;const i=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const s=this.createDataChangedEvent(t,i,r);(n=this.localEventService)==null||n.dispatchEvent(s)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(t,r,i){return{type:"dataChanged",node:this,oldData:r,newData:t,update:i}}getRowIndexString(){return this.rowIndex==null?(pt("Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid."),null):this.rowPinned==="top"?"t-"+this.rowIndex:this.rowPinned==="bottom"?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new oa(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(t,r){var o;const i=ke(this.id)?this.createDaemonNode():null,s=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(r),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,i);const n=this.createDataChangedEvent(t,s,!1);(o=this.localEventService)==null||o.dispatchEvent(n)}checkRowSelectable(){const t=this.beans.gos.get("isRowSelectable");this.setRowSelectable(t?t(this):!0)}setRowSelectable(t,r){if(this.selectable!==t){if(this.selectable=t,this.dispatchRowEvent("selectableChanged"),r)return;if(this.beans.gos.get("groupSelectsChildren")){const s=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:s??!1,source:"selectableChanged"});return}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const r=this.beans.gos.getRowIdCallback();if(r)if(this.data){const i=this.getGroupKeys(!0);this.id=r({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(oa.ID_PREFIX_ROW_GROUP)&&pt(`Row IDs cannot start with ${oa.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`)}else this.id=void 0;else this.id=t}getGroupKeys(t=!1){const r=[];let i=this;for(t&&(i=i.parent);i&&i.level>=0;)r.push(i.key),i=i.parent;return r.reverse(),r}isPixelInRange(t){return!ke(this.rowTop)||!ke(this.rowHeight)?!1:t>=this.rowTop&&t<this.rowTop+this.rowHeight}updateIfDifferent(t,r,i){this[t]!==r&&(this[t]=r,this.dispatchRowEvent(i))}setFirstChild(t){this.updateIfDifferent("firstChild",t,"firstChildChanged")}setLastChild(t){this.updateIfDifferent("lastChild",t,"lastChildChanged")}setChildIndex(t){this.updateIfDifferent("childIndex",t,"childIndexChanged")}setRowTop(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.dispatchRowEvent("topChanged"),this.setDisplayed(t!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(t){this.updateIfDifferent("displayed",t,"displayedChanged")}setDragging(t){this.updateIfDifferent("dragging",t,"draggingChanged")}setHighlighted(t){this.updateIfDifferent("highlighted",t,"rowHighlightChanged")}setHovered(t){this.hovered!==t&&(this.hovered=t)}isHovered(){return this.hovered}setAllChildrenCount(t){this.updateIfDifferent("allChildrenCount",t,"allChildrenCountChanged")}setMaster(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.dispatchRowEvent("masterChanged"))}setGroup(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.checkRowSelectable(),this.dispatchRowEvent("groupChanged"))}setRowHeight(t,r=!1){this.rowHeight=t,this.rowHeightEstimated=r,this.dispatchRowEvent("heightChanged")}setRowAutoHeight(t,r){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[r.getId()]=t,t!=null&&(this.checkAutoHeightsDebounced==null&&(this.checkAutoHeightsDebounced=qr(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let t=!1,r=!0,i=0;const s=this.__autoHeights;if(s==null||(this.beans.visibleColsService.getAllAutoHeightCols().forEach(a=>{let l=s[a.getId()];if(l==null)if(this.beans.columnModel.isColSpanActive()){let c=[];switch(a.getPinned()){case"left":c=this.beans.visibleColsService.getLeftColsForRow(this);break;case"right":c=this.beans.visibleColsService.getRightColsForRow(this);break;case null:c=this.beans.columnViewportService.getColsWithinViewport(this);break}if(c.includes(a)){t=!0;return}l=-1}else{t=!0;return}else r=!1;l>i&&(i=l)}),t)||((r||i<10)&&(i=this.beans.gos.getRowHeightForNode(this).height),i==this.rowHeight))return;this.setRowHeight(i);const o=this.beans.rowModel;o.onRowHeightChangedDebounced&&o.onRowHeightChangedDebounced()}setRowIndex(t){this.updateIfDifferent("rowIndex",t,"rowIndexChanged")}setUiLevel(t){this.updateIfDifferent("uiLevel",t,"uiLevelChanged")}setExpanded(t,r,i){if(this.expanded===t)return;this.expanded=t,this.dispatchRowEvent("expandedChanged");const s={...this.createGlobalRowEvent("rowGroupOpened"),expanded:t,event:r||null};this.beans.rowNodeEventThrottle.dispatchExpanded(s,i),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(t){return this.beans.gos.addGridCommonParams({type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}setDataValue(t,r,i){const n=typeof t!="string"?t:this.beans.columnModel.getCol(t)??this.beans.columnModel.getColDefCol(t),o=this.getValueFromValueService(n);if(this.beans.gos.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,o,r,i),!1;const a=this.beans.valueService.setValue(this,n,r,i);return this.dispatchCellChangedEvent(n,r,o),this.checkRowSelectable(),a}getValueFromValueService(t){const r=this.leafGroup&&this.beans.columnModel.isPivotMode(),i=this.group&&this.expanded&&!this.footer&&!r;let s=!1;const n=this.beans.gos.get("groupTotalRow")??this.beans.gos.get("groupIncludeFooter");typeof n!="function"?s=!!n:s=!!(this.beans.gos.getCallback("groupTotalRow")??this.beans.gos.getCallback("groupIncludeFooter"))({node:this});const o=this.beans.gos.get("groupSuppressBlankHeader"),a=i&&s&&!o;return this.beans.valueService.getValue(t,this,!1,a)}dispatchEventForSaveValueReadOnly(t,r,i,s){const n=this.beans.gos.addGridCommonParams({type:"cellEditRequest",event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),data:this.data,node:this,oldValue:r,newValue:i,value:i,source:s});this.beans.eventService.dispatchEvent(n)}setGroupValue(t,r){const i=this.beans.columnModel.getCol(t);ut(this.groupData)&&(this.groupData={});const s=i.getColId(),n=this.groupData[s];n!==r&&(this.groupData[s]=r,this.dispatchCellChangedEvent(i,r,n))}setAggData(t){const r=this.aggData;if(this.aggData=t,this.localEventService){const i=s=>{const n=this.aggData?this.aggData[s]:void 0,o=r?r[s]:void 0;if(n===o)return;const a=this.beans.columnModel.getCol(s);a&&this.dispatchCellChangedEvent(a,n,o)};for(const s in this.aggData)i(s);for(const s in t)s in this.aggData||i(s)}}updateHasChildren(){let t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gos.isRowModelType("serverSide")){const i=this.beans.gos.get("treeData"),s=this.beans.gos.get("isServerSideGroup");t=!this.stub&&!this.footer&&(i?!!s&&s(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return(this.group&&hr(this.childrenAfterGroup))??!1}dispatchCellChangedEvent(t,r,i){var n;const s={type:"cellChanged",node:this,column:t,newValue:r,oldValue:i};(n=this.localEventService)==null||n.dispatchEvent(s)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.footer?!1:this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(r=>r.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){var s;let t=!1,r=!1,i=!1;if(!((s=this.childrenAfterGroup)!=null&&s.length))return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const o=this.childrenAfterGroup[n];let a=o.isSelected();if(!o.selectable){const l=o.calculateSelectedFromChildren();if(l===null)continue;a=l}switch(a){case!0:t=!0;break;case!1:r=!0;break;default:i=!0;break}}if(!(i||t&&r))return t?!0:r?!1:this.selectable?this.selected:null}setSelectedInitialValue(t){this.selected=t}dispatchRowEvent(t){var i;const r={type:t,node:this};(i=this.localEventService)==null||i.dispatchEvent(r)}selectThisNode(t,r,i="api"){const s=!this.selectable&&t,n=this.selected===t;if(s||n)return!1;this.selected=t,this.dispatchRowEvent("rowSelected");const o=this.sibling;o&&o.footer&&o.localEventService&&o.dispatchRowEvent("rowSelected");const a={...this.createGlobalRowEvent("rowSelected"),event:r||null,source:i};return this.beans.eventService.dispatchEvent(a),!0}setSelected(t,r=!1,i="api"){if(typeof i=="boolean"){Te("since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");return}this.setSelectedParams({newValue:t,clearSelection:r,rangeSelect:!1,source:i})}setSelectedParams(t){return this.rowPinned?(Te("cannot select pinned rows"),0):this.id===void 0?(Te("cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected({...t,nodes:[this.footer?this.sibling:this]})}isRowPinned(){return this.rowPinned==="top"||this.rowPinned==="bottom"}isParentOfNode(t){let r=this.parent;for(;r;){if(r===t)return!0;r=r.parent}return!1}addEventListener(t,r){var s;this.localEventService||(this.localEventService=new Ya),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.localEventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new K0(this.beans.frameworkOverrides));const i=((s=this.frameworkEventListenerService)==null?void 0:s.wrap(r))??r;this.localEventService.addEventListener(t,i)}removeEventListener(t,r){var s;if(!this.localEventService)return;const i=((s=this.frameworkEventListenerService)==null?void 0:s.unwrap(r))??r;this.localEventService.removeEventListener(t,i),this.localEventService.noRegisteredListenersExist()&&(this.localEventService=null)}onMouseEnter(){this.dispatchRowEvent("mouseEnter")}onMouseLeave(){this.dispatchRowEvent("mouseLeave")}getFirstChildOfFirstChild(t){let r=this,i=!0,s=!1,n=null;for(;i&&!s;){const o=r.parent;ke(o)&&r.firstChild?o.rowGroupColumn===t&&(s=!0,n=o):i=!1,r=o}return s?n:null}isFullWidthCell(){if(this.detail)return!0;const t=this.beans.gos.getCallback("isFullWidthRow");return t?t({rowNode:this}):!1}getRoute(){if(this.key==null)return;const t=[];let r=this;for(;r&&r.key!=null;)t.push(r.key),r=r.parent;return t.reverse()}createFooter(){if(this.sibling)return;const t=new Set(["eventService","__objectId","sticky"]),r=new oa(this.beans);Object.keys(this).forEach(i=>{t.has(i)||(r[i]=this[i])}),r.footer=!0,r.setRowTop(null),r.setRowIndex(null),r.oldRowTop=null,r.id="rowGroupFooter_"+this.id,r.sibling=this,this.sibling=r}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}};Yc.ID_PREFIX_ROW_GROUP="row-group-";Yc.ID_PREFIX_TOP_PINNED="t-";Yc.ID_PREFIX_BOTTOM_PINNED="b-";Yc.OBJECT_ID_SEQUENCE=0;var Ks=Yc,oq=class extends xe{constructor(){super(...arguments),this.beanName="filterManager",this.advancedFilterModelUpdateQueue=[]}wireBeans(e){this.columnModel=e.columnModel,this.dataTypeService=e.dataTypeService,this.quickFilterService=e.quickFilterService,this.advancedFilterService=e.advancedFilterService,this.columnFilterService=e.columnFilterService}postConstruct(){this.addManagedEventListeners({columnValueChanged:this.refreshFiltersForAggregations.bind(this),columnPivotChanged:this.refreshFiltersForAggregations.bind(this),columnPivotModeChanged:this.refreshFiltersForAggregations.bind(this),newColumnsLoaded:this.updateAdvancedFilterColumns.bind(this),columnVisible:this.updateAdvancedFilterColumns.bind(this),advancedFilterEnabledChanged:({enabled:e})=>this.onAdvancedFilterEnabledChanged(e),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",e=>this.setAdvancedFilterModel(e.currentValue)),this.quickFilterService&&this.addManagedListeners(this.quickFilterService,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"?e({}):!1}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"?t(e):!1}setFilterModel(e,t="api"){var r;if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}(r=this.columnFilterService)==null||r.setFilterModel(e,t)}getFilterModel(){var e;return((e=this.columnFilterService)==null?void 0:e.getFilterModel())??{}}isColumnFilterPresent(){var e;return!!((e=this.columnFilterService)!=null&&e.isColumnFilterPresent())}isAggregateFilterPresent(){var e;return!!((e=this.columnFilterService)!=null&&e.isAggregateFilterPresent())}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){var t,r;e?(t=this.columnFilterService)!=null&&t.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):(r=this.advancedFilterService)!=null&&r.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var e;return!!((e=this.advancedFilterService)!=null&&e.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}resetQuickFilterCache(){var e;(e=this.quickFilterService)==null||e.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gos.getGroupAggFiltering()&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:r,columns:i=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.columnFilterService?this.columnFilterService.updateBeforeFilterChanged(e):pi.resolve()).then(()=>{var n;const s={source:t,type:"filterChanged",columns:i};r&&Fi(s,r),this.eventService.dispatchEvent(s),(n=this.columnFilterService)==null||n.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){var e;return!!((e=this.columnFilterService)!=null&&e.isSuppressFlashingCellsBecauseFiltering())}isQuickFilterPresent(){var e;return!!((e=this.quickFilterService)!=null&&e.isQuickFilterPresent())}updateAggFiltering(){this.aggFiltering=!!this.gos.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isAggregateFilterPresent()&&!this.columnFilterService.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode)||this.isColumnFilterPresent()&&!this.columnFilterService.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))}isFilterActive(e){var t;return!!((t=this.columnFilterService)!=null&&t.isFilterActive(e))}getOrCreateFilterWrapper(e){var t;return((t=this.columnFilterService)==null?void 0:t.getOrCreateFilterWrapper(e))??null}getDefaultFloatingFilter(e){return this.columnFilterService.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.columnFilterService.createFilterParams(e,t)}isFilterAllowed(e){var t;return this.isAdvancedFilterEnabled()?!1:!!((t=this.columnFilterService)!=null&&t.isFilterAllowed(e))}getFloatingFilterCompDetails(e,t){var r;return(r=this.columnFilterService)==null?void 0:r.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){var t;return(t=this.columnFilterService)==null?void 0:t.getCurrentFloatingFilterParentModel(e)}destroyFilter(e,t="api"){var r;(r=this.columnFilterService)==null||r.destroyFilter(e,t)}areFilterCompsDifferent(e,t){var r;return!!((r=this.columnFilterService)!=null&&r.areFilterCompsDifferent(e,t))}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){var t;if(this.isAdvancedFilterEnabled()){if((t=this.dataTypeService)!=null&&t.isPendingInference()){this.advancedFilterModelUpdateQueue.push(e);return}this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})}}toggleAdvancedFilterBuilder(e,t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(t,e)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){var e;return this.isAdvancedFilterEnabled()?!1:!!((e=this.columnFilterService)!=null&&e.hasFloatingFilters())}getFilterInstance(e,t){var r;if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}return(r=this.columnFilterService)==null?void 0:r.getFilterInstance(e,t)}getColumnFilterInstance(e){var t;return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve(void 0)):((t=this.columnFilterService)==null?void 0:t.getColumnFilterInstance(e))??Promise.resolve(void 0)}warnAdvancedFilters(){Te("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){var t;(t=this.advancedFilterService)==null||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advancedFilterModelUpdateQueue.forEach(e=>this.setAdvancedFilterModel(e)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){var t;return(t=this.columnFilterService)==null?void 0:t.getColumnFilterModel(e)}setColumnFilterModel(e,t){var r;return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve()):((r=this.columnFilterService)==null?void 0:r.setColumnFilterModel(e,t))??Promise.resolve()}},aq=class extends wt{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){var e;return((e=this.filterWrapper)==null?void 0:e.filterPromise)??null}afterInit(){var e,t;return((t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null?void 0:t.then(()=>{}))??pi.resolve()}afterGuiAttached(e){var t,r;(r=(t=this.filterWrapper)==null?void 0:t.filterPromise)==null||r.then(i=>{var s;(s=i==null?void 0:i.afterGuiAttached)==null||s.call(i,e)})}afterGuiDetached(){var e,t;(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null||t.then(r=>{var i;(i=r==null?void 0:r.afterGuiDetached)==null||i.call(r)})}createFilter(e){var i,s;const{column:t,source:r}=this;this.filterWrapper=((i=this.filterManager)==null?void 0:i.getOrCreateFilterWrapper(t))??null,(s=this.filterWrapper)!=null&&s.filterPromise&&this.filterWrapper.filterPromise.then(n=>{const o=n.getGui();if(ke(o)||Te(`getGui method from filter returned ${o}; it should be a DOM element.`),this.appendChild(o),e){const a={type:"filterOpened",column:t,source:r,eGui:this.getGui()};this.eventService.dispatchEvent(a)}})}onFilterDestroyed(e){(e.source==="api"||e.source==="paramsUpdated")&&e.column.getId()===this.column.getId()&&this.columnModel.getColDefCol(this.column)&&(Or(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},oF="ag-resizer-wrapper",lq=`<div class="${oF}">
        <div data-ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>
        <div data-ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>
        <div data-ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>
        <div data-ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>
        <div data-ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>
        <div data-ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>
        <div data-ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>
        <div data-ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>
    </div>`,cq=class extends xe{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupService=e.popupService,this.resizeObserverService=e.resizeObserverService,this.dragService=e.dragService}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,r=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(r,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:r,width:i,minHeight:s,height:n,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=ss(this.element);if(u){const d=this.findBoundaryElement(),h=window.getComputedStyle(d);if(h.minWidth!=null){const p=d.offsetWidth-this.element.offsetWidth;c=parseInt(h.minWidth,10)-p}if(h.minHeight!=null){const p=d.offsetHeight-this.element.offsetHeight;l=parseInt(h.minHeight,10)-p}}if(this.minHeight=s||l,this.minWidth=r||c,i&&this.setWidth(i),n&&this.setHeight(n),(!i||!n)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(u&&t){let d=this.boundaryEl,h=!0;if(d||(d=this.findBoundaryElement(),h=!1),d){const p=parseFloat(d.style.top),g=parseFloat(d.style.left);h?this.offsetElement(isNaN(g)?0:g,isNaN(p)?0:p):this.setPosition(g,p)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(r),this.moveElementDragListener=r):(this.dragService.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],s=this.getResizerElement(t),n={dragStartPixels:0,eElement:s,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragService.addDragSource(n),this.resizeListeners.push(n),s.style.pointerEvents="all"):s.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)Ul(r,e),e=WE(r),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const s=this.getAvailableHeight();s&&e>s&&(e=s)}this.getHeight()!==e&&(i?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?Ul(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),n=e?this.position.y:i.top,o=e?0:s.top;let a=0;if(t){const c=this.element.parentElement;if(c){const{bottom:u}=c.getBoundingClientRect();a=u-i.bottom}}return r+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)es(t,e),e=Ld(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:s}=this.offsetParent,n=r?this.position.x:this.element.getBoundingClientRect().left;s&&e+n>s&&(e=s-n)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?es(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:r}=this.config,i=r?this.boundaryEl:this.element;i&&(this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const r=this.getAvailableHeight();this.element.style.setProperty("max-height",`${r}px`)};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:i,anywhereWithin:s,topBuffer:n}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!r,!!s,o)?0:o,c=this.shouldSkipY(t,!!i,n,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,r,i){const s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:s.left;let l=a<=0&&n.left>=e.clientX||n.right<=e.clientX&&n.right<=o.right;return l?!0:(t?l=i<0&&e.clientX>a+n.left||i>0&&e.clientX<a+n.left:r?l=i<0&&e.clientX>o.right||i>0&&e.clientX<a+n.left:l=i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,r=0,i){const s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:s.top;let l=a<=0&&n.top>=e.clientY||n.bottom<=e.clientY&&n.bottom<=o.bottom;return l?!0:(t?l=i<0&&e.clientY>a+n.top+r||i>0&&e.clientY<a+n.top:l=i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[data-ref=eTopLeftResizer]")},top:{element:e.querySelector("[data-ref=eTopResizer]")},topRight:{element:e.querySelector("[data-ref=eTopRightResizer]")},right:{element:e.querySelector("[data-ref=eRightResizer]")},bottomRight:{element:e.querySelector("[data-ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[data-ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[data-ref=eBottomLeftResizer]")},left:{element:e.querySelector("[data-ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const r=new DOMParser().parseFromString(lq,"text/html").body;e.appendChild(r.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${oF}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:i}=this.config;!r&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(r=>!r.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(let i=0;i<e.length;i++){const s=e[i],n=!!s.style.flex&&s.style.flex!=="0 0 auto";if(s===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(n){const l=window.getComputedStyle(s);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=s.offsetHeight,a=s.offsetWidth;t+=o,r+=a}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let i=0;i<r.length;i++){const s=r[i];s!==t&&(e?s.style.height=`${s.offsetHeight}px`:s.style.width=`${s.offsetWidth}px`,s.style.flex="0 0 auto",s===this.element&&(t=r[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:i,isRight:s,isBottom:n,isLeft:o}=this.currentResizer,a=s||o,l=n||i,{movementX:c,movementY:u}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),d=this.position.x,h=this.position.y;let p=0,g=0;if(a&&c){const f=o?-1:1,m=this.getWidth(),v=m+c*f;let w=!1;o&&(p=m-v,(d+p<=0||v<=this.minWidth)&&(w=!0,p=0)),w||this.setWidth(v)}if(l&&u){const f=i?-1:1,m=this.getHeight(),v=m+u*f;let w=!1;i?(g=m-v,(h+g<=0||v<=this.minHeight)&&(w=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<v&&this.getMinSizeOfSiblings().height+v>this.element.parentElement.offsetHeight&&(w=!0),w||this.setHeight(v)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&p||g)&&this.offsetElement(d+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:s,movementY:n}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+s,r+n),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},aF=class lF extends xe{constructor(t,r={}){super(),this.eFocusableElement=t,this.callbacks=r,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;const s=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,i.shiftKey);s&&(s.focus(),i.preventDefault())},...r}}wireBeans(t){this.focusService=t.focusService}postConstruct(){this.eFocusableElement.classList.add(lF.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedElementListeners(this.eFocusableElement,{focusin:this.callbacks.onFocusIn}),this.callbacks.onFocusOut&&this.addManagedElementListeners(this.eFocusableElement,{focusout:this.callbacks.onFocusOut})}addKeyDownListeners(t){this.addManagedElementListeners(t,{keydown:r=>{if(!(r.defaultPrevented||Mn(r))){if(this.callbacks.shouldStopEventPropagation(r)){Ia(r);return}r.key===ve.TAB?this.callbacks.onTabKeyDown(r):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(r)}}})}};aF.FOCUS_MANAGED_CLASS="ag-focus-managed";var jo=aF,cF={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function lm(e,t){return Vd(e)?(e.debounceMs!=null&&Te("debounceMs is ignored when apply button is present"),0):e.debounceMs!=null?e.debounceMs:t}function Vd(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}var uq=class extends wt{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=He,this.buttonListeners=[]}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.resetTemplate(),this.createManagedBean(new jo(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new cq(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const r=`
            <form class="ag-filter-wrapper">
                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" data-ref="eFilterBody">
                    ${this.createBodyTemplate()}
                </div>
            </form>`;this.setTemplate(r,this.getAgComponents(),e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Vd(e),this.resetButtonsPanel()}updateParams(e){this.providedFilterParams=e,this.applyActive=Vd(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons:e}=this.providedFilterParams,t=e&&e.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Or(this.eButtonsPanel),this.buttonListeners.forEach(s=>s()),this.buttonListeners=[]):t&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!t){this.eButtonsPanel&&Cs(this.eButtonsPanel);return}const r=document.createDocumentFragment(),i=s=>{let n,o;switch(s){case"apply":n=this.translate("applyFilter"),o=c=>this.onBtApply(!1,!1,c);break;case"clear":n=this.translate("clearFilter"),o=()=>this.onBtClear();break;case"reset":n=this.translate("resetFilter"),o=()=>this.onBtReset();break;case"cancel":n=this.translate("cancelFilter"),o=c=>{this.onBtCancel(c)};break;default:Te("Unknown button type specified");return}const l=La(`<button
                    type="${s==="apply"?"submit":"button"}"
                    data-ref="${s}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${n}
                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(l,{click:o})),r.append(l)};e.forEach(s=>i(s)),this.eButtonsPanel.append(r),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=lm(this.providedFilterParams,this.getDefaultDebounceMs()),t=qr(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(e!=null?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const r=()=>{this.onUiChanged(!1,"prevent"),t==null||t()};e!=null?this.setModelIntoUi(e).then(r):this.resetUiToDefaults().then(r)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const r=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(r,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,r){r&&r.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:"columnFilter"});const{closeOnApply:i}=this.providedFilterParams;i&&this.applyActive&&!e&&!t&&this.close(r)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,r=t&&t.key;let i;(r==="Enter"||r==="Space")&&(i={keyboardEvent:t}),this.hidePopup(i),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const r=this.isModelValid(this.getModelFromUi()),i=this.queryForHtmlElement('[data-ref="applyFilterButton"]');i&&Rc(i,!r)}e&&!t||t==="immediately"?this.onBtApply(e):(!this.applyActive&&!t||t==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e==null?void 0:e.container)}refreshFilterResizer(e){if(!this.positionableFeature||e==="toolPanel")return;const t=e==="floatingFilter"||e==="columnFilter",{positionableFeature:r,gos:i}=this;t?(r.restoreLastSize(),r.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}refresh(e){return this.providedFilterParams=e,!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,cF[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}},dq=class extends nm{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},hq=class extends wt{constructor(e="default",t=!1){super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),!this.unFocusable&&this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case ve.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const r=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(r)}break;case ve.DOWN:case ve.UP:e.preventDefault(),this.navigate(t);break;case ve.PAGE_DOWN:case ve.PAGE_UP:case ve.PAGE_HOME:case ve.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}navigate(e){const t=e===ve.DOWN;let r;if(!this.highlightedEl)r=this.itemEls[t?0:this.itemEls.length-1];else{let s=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);s=Math.min(Math.max(s,0),this.itemEls.length-1),r=this.itemEls[s]}this.highlightItem(r)}navigateToPage(e){if(!this.highlightedEl||this.itemEls.length===0)return;const t=this.itemEls.indexOf(this.highlightedEl),r=this.options.length-1,i=this.itemEls[0].clientHeight,s=Math.floor(this.getGui().clientHeight/i);let n=-1;e===ve.PAGE_HOME?n=0:e===ve.PAGE_END?n=r:e===ve.PAGE_DOWN?n=Math.min(t+s,r):e===ve.PAGE_UP&&(n=Math.max(t-s,0)),n!==-1&&this.highlightItem(this.itemEls[n])}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){const{value:t,text:r}=e,i=r||t;return this.options.push({value:t,text:i}),this.renderOption(t,i),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{Cs(e)}),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((t,r)=>{KK(t,r+1),UK(t,e.length)})}renderOption(e,t){const r=this.gos.getDocument(),i=r.createElement("div");li(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const s=r.createElement("span");i.appendChild(s),s.textContent=t,this.unFocusable||(i.tabIndex=-1),this.itemEls.push(i),this.addManagedListeners(i,{mouseover:()=>this.highlightItem(i),mousedown:n=>{n.preventDefault(),n.stopPropagation(),this.setValue(e)}}),this.createManagedBean(new Xa({getTooltipValue:()=>t,getGui:()=>i,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>s.scrollWidth>s.clientWidth})),this.getGui().appendChild(i)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const r=this.options.findIndex(i=>i.value===e);if(r!==-1){const i=this.options[r];this.value=i.value,this.displayValue=i.text,this.highlightItem(this.itemEls[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!ss(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(this.activeClass),Od(this.highlightedEl,!0);const t=this.getGui(),{scrollTop:r,clientHeight:i}=t,{offsetTop:s,offsetHeight:n}=e;(s+n>r+i||s<r)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!ss(this.highlightedEl)||(this.highlightedEl.classList.remove(this.activeClass),Od(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},fq=class extends ZE{constructor(e){if(super(e,(e==null?void 0:e.template)||`
            <div class="ag-picker-field" role="presentation">
                <div data-ref="eLabel"></div>
                    <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">
                    <div data-ref="eDisplayField" class="ag-picker-field-display"></div>
                    <div data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
                </div>
            </div>`,(e==null?void 0:e.agComponents)||[],e==null?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=He,this.eWrapper=He,this.eDisplayField=He,this.eIcon=He,this.ariaRole=e==null?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:i,minPickerWidth:s,maxPickerWidth:n}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!i,r!=null&&this.setPickerMaxHeight(r),s!=null&&this.setPickerMinWidth(s),n!=null&&this.setPickerMaxWidth(n)}wireBeans(e){this.popupService=e.popupService}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:i}=this.config;if(r){const s=vi(r,this.gos);s&&this.eIcon.appendChild(s)}i!=null&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Id(e,!1),this.ariaRole&&li(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(e==null?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case ve.UP:case ve.DOWN:case ve.ENTER:case ve.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case ve.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.gos.getDocument(),t=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const r=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:i,pickerAriaLabelValue:s,modalPicker:n=!0}=this.config,o={modal:n,eChild:t,closeOnEsc:!0,closedCallback:()=>{const p=this.gos.getActiveDomElement(),g=!p||p===e.body;this.beforeHidePicker(),g&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:r(i,s)},a=this.popupService.addPopup(o),{maxPickerHeight:l,minPickerWidth:c,maxPickerWidth:u,variableWidth:d}=this;d?(c&&(t.style.minWidth=c),t.style.width=rm(Ld(this.eWrapper)),u&&(t.style.maxWidth=u)):Hd(t,u??Ld(this.eWrapper));const h=l??`${tm(this.popupService.getPopupParent())}px`;return t.style.setProperty("max-height",h),t.style.position="absolute",this.alignPickerToComponent(),a.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,r=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:r,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();Id(t,e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;(t=this.pickerComponent)!=null&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return Hd(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},cm=class extends fq{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox",...e})}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),r&&t==null&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new hq("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),t=`ag-select-list-${this.listComponent.getCompId()}`;e.setAttribute("id",t),ZK(this.getAriaElement(),e),this.listComponent.addManagedListeners(this.listComponent,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})}}),this.listComponent.addManagedListeners(this.listComponent,{fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){var r;const{key:t}=e;switch(t===ve.TAB&&this.hidePicker(),t){case ve.ENTER:case ve.UP:case ve.DOWN:case ve.PAGE_UP:case ve.PAGE_DOWN:case ve.PAGE_HOME:case ve.PAGE_END:e.preventDefault(),this.isPickerDisplayed?(r=this.listComponent)==null||r.handleKeyDown(e):super.onKeyDown(e);break;case ve.ESCAPE:super.onKeyDown(e);break}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){var e;return(e=this.listComponent)==null||e.clearOptions(),this}setValue(e,t,r){if(this.value===e||!this.listComponent)return this;if(r||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue())return this;let s=this.listComponent.getDisplayValue();return s==null&&this.config.placeholder&&(s=this.config.placeholder),this.eDisplayField.textContent=s,this.setTooltip({newTooltipText:s??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,t)}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}},pq={selector:"AG-SELECT",component:cm},uF=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(e=>{if(typeof e=="string")return;const t=[["displayKey"],["displayName"],["predicate","test"]],r=i=>i.some(s=>e[s]!=null)?!0:(Te(`ignoring FilterOptionDef as it doesn't contain one of '${i}'`),!1);if(!t.every(r)){this.filterOptions=this.filterOptions.filter(i=>i===e)||[];return}this.customFilterOptions[e.displayKey]=e})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const t=this.filterOptions[0];typeof t=="string"?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:Te("invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else Te("no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},dF=class extends uq{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:i}=t;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,r)=>{r===0?t.setValue(e,!0):t.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return this.eJoinOperatorsOr.length===0?this.defaultJoinOperator:this.eJoinOperatorsOr[0].getValue()===!0?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const r=!e.operator,i=!t.operator;if(!r&&i||r&&!i)return!1;let n;if(r){const o=e,a=t;n=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;n=o.operator===a.operator&&Uo(o.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return n}shouldRefresh(e){var n;const t=this.getModel(),r=t?t.conditions??[t]:null,i=((n=e.filterOptions)==null?void 0:n.map(o=>typeof o=="string"?o:o.displayKey))??this.getDefaultFilterOptions();return!(!(!r||r.every(o=>i.find(a=>a===o.type)!==void 0))||typeof e.maxNumConditions=="number"&&r&&r.length>e.maxNumConditions)}refresh(e){return!this.shouldRefresh(e)||!super.refresh(e)?!1:(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const r=e;let i=r.conditions;i==null&&(i=[],Te("Filter model is missing 'conditions'"));const s=this.validateAndUpdateConditions(i),n=this.getNumConditions();if(s<n)this.removeConditionsAndOperators(s);else if(s>n)for(let a=n;a<s;a++)this.createJoinOperatorPanel(),this.createOption();const o=r.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const r=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(r.type,!0),this.setConditionIntoUi(r,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),pi.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),Te('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),t=this.maxNumConditions),t}doesFilterPass(e){const t=this.getModel();if(t==null)return!0;const{operator:r}=t,i=[];if(r){const n=t;i.push(...n.conditions??[])}else i.push(t);return i[r&&r==="OR"?"some":"every"](n=>this.individualConditionPasses(e,n))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new uF,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){this.maxNumConditions=e.maxNumConditions??2,this.maxNumConditions<1&&(Te('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=e.numAlwaysVisibleConditions??1,this.numAlwaysVisibleConditions<1&&(Te('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(Te('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new cm);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const r=this.getNumConditions()-1;this.forEachPositionInput(r,i=>this.resetInput(i)),this.addChangedListeners(e,r)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),r=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const i=this.eJoinOperatorPanels.length-1,s=this.joinOperatorId++;this.resetJoinOperatorAnd(t,i,s),this.resetJoinOperatorOr(r,i,s),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const i=this.createManagedBean(new dq);return e.push(i),i.addCssClass("ag-filter-condition-operator"),i.addCssClass(`ag-filter-condition-operator-${r}`),t.appendChild(i.getGui()),i}getDefaultJoinOperator(e){return e==="AND"||e==="OR"?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(t=>typeof t=="string"?this.createBoilerplateListOption(t):this.createCustomListOption(t))}putOptionsIntoDropdown(e){this.filterListOptions.forEach(t=>{e.addOption(t)}),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.localeService.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return""}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const r=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);const i=e+1,s=r-i;s>0&&this.removeConditionsAndOperators(i,s),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((i,s)=>{const n=this.isConditionDisabled(s,e);i.setDisabled(n||this.filterListOptions.length<=1),s===1&&(Rc(this.eJoinOperatorPanels[0],n),this.eJoinOperatorsAnd[0].setDisabled(n),this.eJoinOperatorsOr[0].setDisabled(n))}),this.eConditionBodies.forEach((i,s)=>{Wt(i,this.isConditionBodyVisible(s))});const r=(t??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach(i=>{i.setValue(!r,!0)}),this.eJoinOperatorsOr.forEach(i=>{i.setValue(r,!0)}),this.forEachInput((i,s,n,o)=>{this.setElementDisplayed(i,s<o),this.setElementDisabled(i,this.isConditionDisabled(n,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const r=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,r,t),this.removeComponents(this.eJoinOperatorsAnd,r,t),this.removeComponents(this.eJoinOperatorsOr,r,t)}removeElements(e,t,r){this.removeItems(e,t,r).forEach(s=>Cs(s))}removeComponents(e,t,r){this.removeItems(e,t,r).forEach(s=>{Cs(s.getGui()),this.destroyBean(s)})}removeItems(e,t,r){return r==null?e.splice(t):e.splice(t,r)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!(e!=null&&e.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const t=this.getInputs(0)[0];if(!t)return;t instanceof po&&t.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,r=-1,i=!1;const s=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))t===-1&&(t=o,r=o);else{const a=o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1),l=o<t;(a||l)&&(this.removeConditionsAndOperators(o,1),i=!0,l&&r--)}let n=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),n=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),n=!0),n&&this.updateConditionStatusesAndValues(r,s),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getPlaceholderText(e,t){let r=this.translate(e);if(Y0(this.filterPlaceholder)){const i=this.filterPlaceholder,s=this.eTypes[t].getValue(),n=this.translate(s);r=i({filterOptionKey:s,filterOption:n,placeholder:r})}else typeof this.filterPlaceholder=="string"&&(r=this.filterPlaceholder);return r}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput((t,r,i,s)=>{if(!(t instanceof po))return;const n=r===0&&s>1?"inRangeStart":r===0?"filterOoo":"inRangeEnd",o=r===0&&s>1?e("ariaFilterFromValue","Filter from value"):r===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(n,i)),t.setInputAriaLabel(o)})}setElementValue(e,t,r){e instanceof po&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){e instanceof wt&&Wt(e.getGui(),t)}setElementDisabled(e,t){e instanceof wt&&Rc(e.getGui(),t)}attachElementOnChange(e,t){e instanceof po&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,r)=>{this.forEachPositionTypeInput(r,t,e)})}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const i=this.getNumberOfInputs(t),s=this.getInputs(e);for(let n=0;n<s.length;n++){const o=s[n];o!=null&&r(o,n,e,i)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(r=>r==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinOperatorsAnd.forEach((t,r)=>this.resetJoinOperatorAnd(t,r,this.joinOperatorId+r)),this.eJoinOperatorsOr.forEach((t,r)=>this.resetJoinOperatorOr(t,r,this.joinOperatorId+r)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),pi.resolve()}resetType(e){const r=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(r).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),r)}resetJoinOperator(e,t,r,i,s){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${s}`).setLabel(i),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t)),this.eJoinOperatorsOr.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e);this.forEachInput((i,s,n)=>{n===t&&this.setElementValue(i,r[s]!=null?r[s]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,r,i)=>{this.setElementValue(t,r===0&&i===0?e:null,!0)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,r=>{this.attachElementOnChange(r,this.listener)}))}individualConditionPasses(e,t){const r=this.getCellValue(e.node),i=this.mapValuesFromModel(t),s=this.optionsFactory.getCustomOption(t.type),n=this.evaluateCustomFilter(s,i,r);return n??(r==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,r,t,e))}evaluateCustomFilter(e,t,r){if(e==null)return;const{predicate:i}=e;if(i!=null&&!t.some(s=>s==null))return i(t,r)}isBlank(e){return e==null||typeof e=="string"&&e.trim().length===0}hasInvalidInputs(){return!1}},hF=class extends dF{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case"equals":case"notEqual":if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case"lessThan":case"lessThanOrEqual":if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case"inRange":if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const i=this.comparator(),s=e[0]!=null?i(e[0],t):0;switch(r.type){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const n=i(e[1],t);return this.scalarFilterParams.inRangeInclusive?s>=0&&n<=0:s>0&&n<0}case"blank":return this.isBlank(t);case"notBlank":return!this.isBlank(t);default:return Te('Unexpected type of filter "'+r.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},gq=65,mq=67,vq=86,Cq=68,wq=90,Sq=89;function fF(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key.length===1}function ig(e,t,r,i,s){const n=i?i.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=e.addGridCommonParams({event:t,editing:s,column:i,node:r,data:r.data,colDef:i.getColDef()});return!!(n&&n(o))}function yq(e,t,r,i){const s=i.getDefinition(),n=s&&s.suppressHeaderKeyboardEvent;if(!ke(n))return!1;const o=e.addGridCommonParams({colDef:s,column:i,headerRowIndex:r,event:t});return!!n(o)}function xq(e){const{keyCode:t}=e;let r;switch(t){case gq:r=ve.A;break;case mq:r=ve.C;break;case vq:r=ve.V;break;case Cq:r=ve.D;break;case wq:r=ve.Z;break;case Sq:r=ve.Y;break;default:r=e.code}return r}function bq(e,t=!1){return e===ve.DELETE?!0:!t&&e===ve.BACKSPACE?BE():!1}var qo=class extends po{constructor(e,t="ag-text-field",r="text"){super(e,t,r)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=ke(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=r=>{fF(r)&&r.key&&!e.test(r.key)&&r.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:r=>{var s;const i=(s=r.clipboardData)==null?void 0:s.getData("text");i&&i.split("").some(n=>!e.test(n))&&r.preventDefault()}})}},Eh={selector:"AG-INPUT-TEXT-FIELD",component:qo},um=class extends qo{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListeners(this.eInput,{blur:()=>{const s=parseFloat(this.eInput.value),n=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==n&&this.setValue(n)},wheel:this.onWheel.bind(this)}),this.eInput.step="any";const{precision:e,min:t,max:r,step:i}=this.config;typeof e=="number"&&this.setPrecision(e),typeof t=="number"&&this.setMin(t),typeof r=="number"&&this.setMax(r),typeof i=="number"&&this.setStep(i)}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}normalizeValue(e){if(e==="")return"";this.precision!=null&&(e=this.adjustPrecision(e));const t=parseFloat(e);return this.min!=null&&t<this.min?e=this.min.toString():this.max!=null&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(this.precision==null)return e;if(t){const i=parseFloat(e).toFixed(this.precision);return parseFloat(i).toString()}const r=String(e).split(".");if(r.length>1){if(r[1].length<=this.precision)return e;if(this.precision>0)return`${r[0]}.${r[1].slice(0,this.precision)}`}return r[0]}setMin(e){return this.min===e?this:(this.min=e,Us(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Us(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Us(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(r=>super.setValue(r,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,r){if(ke(r)){let i=this.isScientificNotation(r);if(i&&this.eInput.validity.valid)return e(r);if(!i){r=this.adjustPrecision(r);const s=this.normalizeValue(r);i=r!=s}if(i)return t(r)}return e(r)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},Rq={selector:"AG-INPUT-NUMBER-FIELD",component:um},pF=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],dm=class{constructor(e,t,r){this.localeService=e,this.optionsFactory=t,this.valueFormatter=r}getModelAsString(e){if(!e)return null;const t=e.operator!=null,r=this.localeService.getLocaleTextFunc();if(t){const i=e,n=(i.conditions??[]).map(a=>this.getModelAsString(a)),o=i.operator==="AND"?"andCondition":"orCondition";return n.join(` ${r(o,cF[o])} `)}else{if(e.type==="blank"||e.type==="notBlank")return r(e.type,e.type);{const i=e,s=this.optionsFactory.getCustomOption(i.type),{displayKey:n,displayName:o,numberOfInputs:a}=s||{};return n&&o&&a===0?(r(n,o),o):this.conditionToString(i,s)}}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){return this.valueFormatter?this.valueFormatter(e??null)??"":String(e)}},gF=class extends dm{conditionToString(e,t){const{numberOfInputs:r}=t||{};return e.type=="inRange"||r===2?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:e.filter!=null?this.formatValue(e.filter):`${e.type}`}};function sg(e){const{allowedCharPattern:t}=e??{};return t??null}var Eq=class extends hF{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern!==e.allowedCharPattern?!1:super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:i}=e||{};return[this.processValue(t),this.processValue(r)].slice(0,this.getNumberOfInputs(i))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new gF(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return pF}setElementValue(e,t,r){const i=!r&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(t??null):t;super.setElementValue(e,i)}createValueElement(){const e=sg(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),li(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,r,i){const s=this.createManagedBean(i?new qo({allowedCharPattern:i}):new um);s.addCssClass(`ag-filter-${r}`),s.addCssClass("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const t=[];return this.forEachPositionInput(e,(r,i,s,n)=>{i<n&&t.push(this.processValue(this.stringToFloat(r.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return e==null||isNaN(e)?null:e}stringToFloat(e){if(typeof e=="number")return e;let t=bo(e);return t!=null&&t.trim()===""&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):t==null||t.trim()==="-"?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),r={filterType:this.getFilterType(),type:t},i=this.getValues(e);return i.length>0&&(r.filter=i[0]),i.length>1&&(r.filterTo=i[1]),r}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{if(!t.getInputElement().validity.valid){e=!0;return}}),e}},mF=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],vF=class extends dm{conditionToString(e,t){const{numberOfInputs:r}=t||{};return e.type=="inRange"||r===2?`${e.filter}-${e.filterTo}`:e.filter!=null?`${e.filter}`:`${e.type}`}};function CF(e){const t=e&&e.trim();return t===""?e:t}var Fq=class extends dF{constructor(){super("textFilter"),this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>e==null?null:e.toString().toLowerCase(),this.defaultMatcher=({filterOption:e,value:t,filterText:r})=>{if(r==null)return!1;switch(e){case"contains":return t.indexOf(r)>=0;case"notContains":return t.indexOf(r)<0;case"equals":return t===r;case"notEqual":return t!=r;case"startsWith":return t.indexOf(r)===0;case"endsWith":{const i=t.lastIndexOf(r);return i>=0&&i===t.length-r.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[]}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new vF(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(Te("textCustomComparator is deprecated, use textMatcher instead."),({filterOption:t,value:r,filterText:i})=>e(t,r,i)):this.textFilterParams.textMatcher||this.defaultMatcher}createCondition(e){const t=this.getConditionType(e),r={filterType:this.getFilterType(),type:t},i=this.getValuesWithSideEffects(e,!0);return i.length>0&&(r.filter=i[0]),i.length>1&&(r.filterTo=i[1]),r}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const r=[];return this.forEachPositionInput(e,(i,s,n,o)=>{if(s<o){let a=bo(i.getValue());t&&this.textFilterParams.trimInput&&(a=CF(a)??null,i.setValue(a,!0)),r.push(a)}}),r}getDefaultFilterOptions(){return mF}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),li(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,r){const i=this.createManagedBean(new qo);i.addCssClass(`ag-filter-${r}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:i}=e||{};return[t||null,r||null].slice(0,this.getNumberOfInputs(i))}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,r,i){const s=e.map(h=>this.formatter(h))||[],n=this.formatter(t),{api:o,colDef:a,column:l,context:c,textFormatter:u}=this.textFilterParams;if(r.type==="blank")return this.isBlank(t);if(r.type==="notBlank")return!this.isBlank(t);const d={api:o,colDef:a,column:l,context:c,node:i.node,data:i.data,filterOption:r.type,value:n,textFormatter:u};return s.some(h=>this.matcher({...d,filterText:h}))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}};function wF(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseInt(e);return isNaN(t)?void 0:t}}function hs(e,t=Number.MAX_VALUE){return r=>{const i=wF(r);if(!(i==null||i<e||i>t))return i}}function jl(e,t){return e.toString().padStart(t,"0")}function Tq(e,t){const r=[];for(let i=e;i<=t;i++)r.push(i);return r}function Aq(e,t,r){return typeof e!="number"?"":e.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}function ki(e,t=!0,r="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(s=>jl(s,2)).join(r);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(s=>jl(s,2)).join(":")),i}var Mf=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function ql(e,t="YYYY-MM-DD"){const r=jl(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:()=>r.slice(r.length-4,r.length),YY:()=>r.slice(r.length-2,r.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>jl(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${Mf(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${Mf(e.getDate())}`,DD:()=>jl(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>s[e.getDay()],ddd:()=>s[e.getDay()].slice(0,3),dd:()=>s[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${Mf(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,a=>a in n?n[a]():a)}function si(e){if(!e)return null;const[t,r]=e.split(" ");if(!t)return null;const i=t.split("-").map(d=>parseInt(d,10));if(i.filter(d=>!isNaN(d)).length!==3)return null;const[s,n,o]=i,a=new Date(s,n-1,o);if(a.getFullYear()!==s||a.getMonth()!==n-1||a.getDate()!==o)return null;if(!r||r==="00:00:00")return a;const[l,c,u]=r.split(":").map(d=>parseInt(d,10));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}var SF=class{constructor(e,t,r,i,s){this.alive=!0,this.context=e,this.eParent=i,t.getDateCompDetails(r).newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}this.dateComp=a,a&&(i.appendChild(a.getGui()),a.afterGuiAttached&&a.afterGuiAttached(),this.tempValue&&a.setDate(this.tempValue),this.disabled!=null&&this.setDateCompDisabled(this.disabled),s==null||s(this))})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){Wt(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&typeof this.dateComp.afterGuiAttached=="function"&&this.dateComp.afterGuiAttached(e)}updateParams(e){var r,i;let t=!1;(r=this.dateComp)!=null&&r.refresh&&typeof this.dateComp.refresh=="function"&&this.dateComp.refresh(e)!==null&&(t=!0),!t&&((i=this.dateComp)!=null&&i.onParamsUpdated)&&typeof this.dateComp.onParamsUpdated=="function"&&this.dateComp.onParamsUpdated(e)!==null&&Te("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(e){this.dateComp!=null&&this.dateComp.setDisabled!=null&&this.dateComp.setDisabled(e)}},yF=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],xF=class extends dm{constructor(e,t,r){super(t,r),this.dateFilterParams=e}conditionToString(e,t){const{type:r}=e,{numberOfInputs:i}=t||{},s=r=="inRange"||i===2,n=si(e.dateFrom),o=si(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(s){const l=n!==null?ql(n,a):"null",c=o!==null?ql(o,a):"null";return`${l}-${c}`}return n!=null?ql(n,a):`${r}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},kS=1e3,_S=1/0,Pq=class extends hF{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=kS,this.maxValidYear=_S,this.minValidDate=null,this.maxValidDate=null}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:r,type:i}=e||{};return[t&&si(t)||null,r&&si(r)||null].slice(0,this.getNumberOfInputs(i))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){const r=t;return t==null||r<e?-1:r>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(r,i)=>{if(e[r]!=null)if(isNaN(e[r]))Te(`DateFilter ${r} is not a number`);else return e[r]==null?i:Number(e[r]);return i};this.minValidYear=t("minValidYear",kS),this.maxValidYear=t("maxValidYear",_S),this.minValidYear>this.maxValidYear&&Te("DateFilter minValidYear should be <= maxValidYear"),e.minValidDate?this.minValidDate=e.minValidDate instanceof Date?e.minValidDate:si(e.minValidDate):this.minValidDate=null,e.maxValidDate?this.maxValidDate=e.maxValidDate instanceof Date?e.maxValidDate:si(e.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&Te("DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new xF(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new SF(this.context,this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>t.destroy()),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return yF}createValueElement(){const t=this.gos.getDocument().createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t}createFromToElement(e,t,r,i){const n=this.gos.getDocument().createElement("div");n.classList.add(`ag-filter-${i}`),n.classList.add(`ag-filter-date-${i}`),t.push(n),e.appendChild(n),r.push(this.createDateCompWrapper(n))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,r){this.removeItems(e,t,r).forEach(s=>s.destroy())}isValidDateValue(e){if(e===null)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((r,i,s,n)=>{s!==e||!t||i>=n||(t=t&&this.isValidDateValue(r.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),r={},i=this.getValues(e);return i.length>0&&(r.dateFrom=ki(i[0])),i.length>1&&(r.dateTo=ki(i[1])),{dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t,...r}}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),r=e("ariaFilterValue","Filter Value");this.forEachInput(i=>{i.setInputPlaceholder(t),i.setInputAriaLabel(r)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,i,s,n)=>{i<n&&t.push(r.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}},hm=class extends xe{constructor(e,t,r,i){super(),this.columnOrGroup=e,this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=i,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?ft(this.colsSpanning):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=ke(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),r=e.getOldLeft(),i=this.modifyLeftForPrintLayout(e,r),s=this.modifyLeftForPrintLayout(e,t);this.setLeft(i),this.actualLeft=s,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===s&&this.setLeft(s)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!this.beans.gos.isDomLayout("print")||e.getPinned()==="left")return t;const i=this.beans.visibleColsService.getColsLeftWidth();if(e.getPinned()==="right"){const s=this.beans.visibleColsService.getBodyContainerWidth();return i+s+t}return i+t}setLeft(e){if(ke(e)&&(this.eCell.style.left=`${e}px`),Jt(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&XK(this.ariaEl,t.length)}}},Dq="ag-column-first",Mq="ag-column-last";function bF(e,t,r,i){return ut(e)?[]:_q(e.headerClass,e,t,r,i)}function RF(e,t,r){e.addOrRemoveCssClass(Dq,r.isColAtEdge(t,"first")),e.addOrRemoveCssClass(Mq,r.isColAtEdge(t,"last"))}function kq(e,t,r,i){return t.addGridCommonParams({colDef:e,column:r,columnGroup:i})}function _q(e,t,r,i,s){if(ut(e))return[];let n;if(typeof e=="function"){const o=kq(t,r,i,s);n=e(o)}else n=e;return typeof n=="string"?[n]:Array.isArray(n)?[...n]:[]}var Iq=0,EF=class FF extends xe{constructor(t,r,i){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=t,this.parentRowCtrl=i,this.beans=r,this.instanceId=t.getUniqueId()+"-"+Iq++}wireBeans(t){this.pinnedWidthService=t.pinnedWidthService,this.focusService=t.focusService,this.userComponentFactory=t.userComponentFactory,this.ctrlsService=t.ctrlsService,this.dragAndDropService=t.dragAndDropService,this.menuService=t.menuService}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(t){const{headerRowIndex:r,column:i}=this.focusService.getFocusedHeader();return yq(this.gos,t,r,i)}getWrapperHasFocus(){return this.gos.getActiveDomElement()===this.eGui}setGui(t){this.eGui=t,this.addDomData(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onGuiFocus(){const t={type:"headerFocused",column:this.column};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){!this.comp||!this.column||(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp:t,column:r,beans:i}=this;RF(t,r,i.visibleColsService)}refreshAriaColIndex(){const{beans:t,column:r}=this,i=t.visibleColsService.getAriaColIndex(r);OE(this.eGui,i)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&this.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){this.gos.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(t){var o;const r=this.gos.getActiveDomElement(),i=t.key===ve.LEFT||t.key===ve.RIGHT;if(this.isResizing&&(t.preventDefault(),t.stopImmediatePropagation()),r!==this.eGui||!t.shiftKey&&!t.altKey||((this.isResizing||i)&&(t.preventDefault(),t.stopImmediatePropagation()),!i))return;const s=t.key===ve.LEFT!==this.gos.get("enableRtl"),n=sF[s?"Left":"Right"];if(t.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const a=this.getViewportAdjustedResizeDiff(t);this.resizeHeader(a,t.shiftKey),(o=this.resizeFeature)==null||o.toggleColumnResizing(!0)}else this.moveHeader(n)}getViewportAdjustedResizeDiff(t){let r=this.getResizeDiff(t);if(this.column.getPinned()){const s=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),o=qc(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(s+n+r>o)if(o>s+n)r=o-s-n;else return 0}return r}getResizeDiff(t){let r=t.key===ve.LEFT!==this.gos.get("enableRtl");const i=this.column.getPinned(),s=this.gos.get("enableRtl");return i&&s!==(i==="right")&&(r=!r),(r?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{var t;(t=this.resizeFeature)==null||t.toggleColumnResizing(!1)},150))}handleKeyDown(t){const r=this.getWrapperHasFocus();switch(t.key){case ve.PAGE_DOWN:case ve.PAGE_UP:case ve.PAGE_HOME:case ve.PAGE_END:r&&t.preventDefault()}}addDomData(){const t=FF.DOM_DATA_KEY_HEADER_CTRL;this.gos.setDomData(this.eGui,t,this),this.addDestroyFunc(()=>this.gos.setDomData(this.eGui,t,null))}getGui(){return this.eGui}focus(t){return this.eGui?(this.lastFocusEvent=t||null,this.eGui.focus(),!0):!1}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(t,r,i){const s=t??r;this.gos.get("preventDefaultOnContextMenu")&&s.preventDefault();const n=Bn(i)?i:void 0;this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,t,r),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(t,r){const i={type:t,column:r};this.eventService.dispatchEvent(i)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}};EF.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";var Fh=EF,fm=class extends xe{wireBeans(e){this.columnHoverService=e.columnHoverService}constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListeners(this.element,{mouseout:this.onMouseOut.bind(this),mouseover:this.onMouseOver.bind(this)})}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}},Oq=class extends Fh{constructor(e,t,r){super(e,t,r),this.iconCreated=!1,this.column=e}setComp(e,t,r,i){this.comp=e,this.eButtonShowMainFilter=r,this.eFloatingFilterBody=i,this.setGui(t),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(),this.addManagedListeners(this.column,{colDefChanged:this.onColDefChanged.bind(this)})}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,r=!!e.floatingFilter;this.active=t&&r}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=vi("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(){this.createManagedBean(new jo(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();Oa(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gos.getActiveDomElement()===this.eGui)return;const i=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(i){this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleColsService;let r=this.column;do if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break;while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case ve.UP:case ve.DOWN:t||e.preventDefault();case ve.LEFT:case ve.RIGHT:if(t)return;e.stopPropagation();case ve.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case ve.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const r=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&Sa(e.relatedTarget,"ag-floating-filter");if(r&&i&&e.target===this.eGui){const n=this.lastFocusEvent,o=!!(n&&n.key===ve.TAB);if(n&&o){const a=n.shiftKey;this.focusService.focusInto(this.eGui,a)}}const s=this.getRowIndex();this.beans.focusService.setFocusedHeader(s,this.column)}setupHover(){this.createManagedBean(new fm([this.column],this.eGui));const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedEventListeners({columnHoverChanged:e}),e()}setupLeft(){const e=new hm(this.column,this.eGui,this.beans);this.createManagedBean(e)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){var t;if(!this.active)return;const e=(t=this.beans.filterManager)==null?void 0:t.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager:e}=this.beans,t=r=>{if((r==null?void 0:r.source)==="filterDestroyed"&&!this.isAlive())return;const i=this.comp.getFloatingFilterComp();i&&i.then(s=>{if(s){const n=e==null?void 0:e.getCurrentFloatingFilterParentModel(this.column),o=r?{...r,columns:r.columns??[],source:r.source==="api"?"api":"columnFilter"}:null;s.onParentModelChanged(n,o)}})};[this.destroySyncListener]=this.addManagedListeners(this.column,{filterChanged:t}),e!=null&&e.isFilterActive(this.column)&&t(null)}setupWidth(){const e=()=>{const t=`${this.column.getActualWidth()}px`;this.comp.setWidth(t)};this.addManagedListeners(this.column,{widthChanged:e}),e()}setupFilterChangedListener(){this.active&&([this.destroyFilterChangedListener]=this.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){var e;if(!this.suppressFilterButton&&this.comp){const t=!!((e=this.beans.filterManager)!=null&&e.isFilterAllowed(this.column));this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var s;const e=this.active;this.setupActive();const t=!e&&this.active;e&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const r=this.active?(s=this.beans.filterManager)==null?void 0:s.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,i=this.comp.getFloatingFilterComp();!i||!r?this.updateCompDetails(r,t):i.then(n=>{var o;!n||(o=this.beans.filterManager)!=null&&o.areFilterCompsDifferent(this.userCompDetails??null,r)?this.updateCompDetails(r,t):this.updateFloatingFilterParams(r)})}updateCompDetails(e,t){this.isAlive()&&(this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(e){var r;if(!e)return;const t=e.params;(r=this.comp.getFloatingFilterComp())==null||r.then(i=>{let s=!1;i!=null&&i.refresh&&typeof i.refresh=="function"&&i.refresh(t)!==null&&(s=!0),!s&&(i!=null&&i.onParamsUpdated)&&typeof i.onParamsUpdated=="function"&&i.onParamsUpdated(t)!==null&&Te("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},Ze="32.0.2";function Lq(e){var t,r;return!!((t=e.filterManager)!=null&&t.isColumnFilterPresent())||!!((r=e.filterManager)!=null&&r.isAggregateFilterPresent())}function Nq(e,t,r){var i;return(i=e.filterManager)==null?void 0:i.getFilterInstance(t,r)}function Bq(e,t){var r;return((r=e.filterManager)==null?void 0:r.getColumnFilterInstance(t))??Promise.resolve(void 0)}function Gq(e,t){var i;const r=e.columnModel.getColDefCol(t);if(r)return(i=e.filterManager)==null?void 0:i.destroyFilter(r,"api")}function Hq(e,t){e.frameworkOverrides.wrapIncoming(()=>{var r;return(r=e.filterManager)==null?void 0:r.setFilterModel(t)})}function Vq(e){var t;return((t=e.filterManager)==null?void 0:t.getFilterModel())??{}}function Wq(e,t){var r;return((r=e.filterManager)==null?void 0:r.getColumnFilterModel(t))??null}function zq(e,t,r){var i;return((i=e.filterManager)==null?void 0:i.setColumnFilterModel(t,r))??Promise.resolve()}function $q(e,t){const r=e.columnModel.getCol(t);if(!r){pt(`column '${t}' not found`);return}e.menuService.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"})}function Uq(e,t,r){if(t==null)return null;let i=null;const{compName:s,jsComp:n,fwComp:o}=rF.getCompKeys(e,t,am);return s?i={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[s]:n==null&&o==null&&t.filter===!0&&(i=r()),i}var Kq=class extends xe{constructor(){super(...arguments),this.beanName="columnFilterService",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.userComponentFactory=e.userComponentFactory,this.rowRenderer=e.rowRenderer,this.dataTypeService=e.dataTypeService,this.filterManager=e.filterManager}postConstruct(){var e,t;this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),rowDataUpdated:()=>this.onNewRowsLoaded("rowDataUpdated"),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...((t=(e=this.gos.get("initialState"))==null?void 0:e.filter)==null?void 0:t.filterModel)??{}}}setFilterModel(e,t="api"){var s;if((s=this.dataTypeService)!=null&&s.isPendingInference()){this.filterModelUpdateQueue.push({model:e,source:t});return}const r=[],i=this.getFilterModel();if(e){const n=new Set(Object.keys(e));this.allColumnFilters.forEach((o,a)=>{const l=e[a];r.push(this.setModelOnFilterWrapper(o.filterPromise,l)),n.delete(a)}),n.forEach(o=>{const a=this.columnModel.getColDefCol(o)||this.columnModel.getCol(o);if(!a){Te("setFilterModel() - no column found for colId: "+o);return}if(!a.isFilterAllowed()){Te("setFilterModel() - unable to fully apply model, filtering disabled for colId: "+o);return}const l=this.getOrCreateFilterWrapper(a);if(!l){Te("setFilterModel() - unable to fully apply model, unable to create filter for colId: "+o);return}r.push(this.setModelOnFilterWrapper(l.filterPromise,e[o]))})}else this.allColumnFilters.forEach(n=>{r.push(this.setModelOnFilterWrapper(n.filterPromise,null))});pi.all(r).then(()=>{var a;const n=this.getFilterModel(),o=[];this.allColumnFilters.forEach((l,c)=>{const u=i?i[c]:null,d=n?n[c]:null;_d(u,d)||o.push(l.column)}),o.length>0&&((a=this.filterManager)==null||a.onFilterChanged({columns:o,source:t}))})}setModelOnFilterWrapper(e,t){return new pi(r=>{e.then(i=>{typeof i.setModel!="function"&&(Te("filter missing setModel method, which is needed for setFilterModel"),r()),(i.setModel(t)||pi.resolve()).then(()=>r())})})}getFilterModel(){const e={};return this.allColumnFilters.forEach((t,r)=>{const i=this.getModelFromFilterWrapper(t);ke(i)&&(e[r]=i)}),e}getModelFromFilterWrapper(e){const{filter:t}=e;return t?typeof t.getModel!="function"?(Te("filter API missing getModel method, which is needed for getFilterModel"),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){return this.allColumnFilters.size?(this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"advancedFilterEnabled")),!0):!1}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=n=>n?n.isFilterActive?n.isFilterActive():(Te("Filter is missing isFilterActive() method"),!1):!1,t=!!this.gos.getGroupAggFiltering(),r=n=>{if(!n.isPrimary())return!0;const a=!this.columnModel.isPivotActive();return!n.isValueActive()||!a?!1:this.columnModel.isPivotMode()?!0:t},i=[],s=[];return this.forEachColumnFilter((n,o)=>{e(n)&&(r(o.column)?i.push(n):s.push(n))}).then(()=>{this.activeAggregateFilters=i,this.activeColumnFilters=s})}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter((r,i)=>i.column.setFilterActive(r.isFilterActive(),e,t))}forEachColumnFilter(e){return pi.all(Array.from(this.allColumnFilters.values()).map(t=>t.filterPromise.then(r=>e(r,t))))}doColumnFiltersPass(e,t,r){const{data:i,aggData:s}=e,n=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?s:i;for(let a=0;a<n.length;a++){const l=n[a];if(!(l==null||l===t)){if(typeof l.doesFilterPass!="function")throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const t=()=>{var r;return(r=this.filterManager)==null?void 0:r.onFilterChanged(e)};this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}updateBeforeFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:r}=e;return this.updateDependentFilters(),this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",r).then(()=>{this.allColumnFilters.forEach(i=>{i.filterPromise&&i.filterPromise.then(s=>{s&&s!==t&&s.onAnyFilterChanged&&s.onAnyFilterChanged()})}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter(t=>{t.onNewRowsLoaded&&t.onNewRowsLoaded()}).then(()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0})).then(()=>this.updateActiveFilters())}createValueGetter(e){return({node:t})=>this.valueService.getValue(e,t,!0)}createGetValue(e){return(t,r)=>{const i=r?this.columnModel.getCol(r):e;return i?this.valueService.getValue(i,t,!0):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():this.getModelFromInitialState(e)!=null}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){var r;let t;if(Ur.__isRegistered("@ag-grid-enterprise/set-filter",this.gridId))t="agSetColumnFilter";else{const i=(r=this.dataTypeService)==null?void 0:r.getBaseDataType(e);i==="number"?t="agNumberColumnFilter":i==="date"||i==="dateString"?t="agDateColumnFilter":t="agTextColumnFilter"}return t}getDefaultFloatingFilter(e){var r;let t;if(Ur.__isRegistered("@ag-grid-enterprise/set-filter",this.gridId))t="agSetColumnFloatingFilter";else{const i=(r=this.dataTypeService)==null?void 0:r.getBaseDataType(e);i==="number"?t="agNumberColumnFloatingFilter":i==="date"||i==="dateString"?t="agDateColumnFloatingFilter":t="agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const r=this.getDefaultFilter(e),i=e.getColDef();let s;const n={...this.createFilterParams(e,i),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(s,e)(),filterChangedCallback:a=>this.filterChangedCallbackFactory(s,e)(a),doesRowPassOtherFilter:a=>this.filterManager?this.filterManager.doesRowPassOtherFilters(s,a):!0},o=this.userComponentFactory.getFilterDetails(i,n,r);return o?{filterPromise:()=>{const a=o.newAgStackInstance();return a!=null&&a.then(l=>{s=l,t&&(t.filter=l)}),a},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:bE(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:i}=this.createFilterInstance(e,t);return t.filterPromise=(r==null?void 0:r())??null,t.compDetails=i,t}onColumnsChanged(){var t;const e=[];this.allColumnFilters.forEach((r,i)=>{let s;r.column.isPrimary()?s=this.columnModel.getColDefCol(i):s=this.columnModel.getCol(i),!(s&&s===r.column)&&(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(i))}),e.length>0?(t=this.filterManager)==null||t.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){const e=this.columnModel.getAutoCols();e==null||e.forEach(t=>{t.getColDef().filter==="agGroupColumnFilter"&&this.getOrCreateFilterWrapper(t)})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:r}=this.allColumnFilters.get(e.getColId())??{};return r&&typeof(r==null?void 0:r.isFilterAllowed)=="function"?r.isFilterAllowed():!0}getFloatingFilterCompDetails(e,t){const r=l=>{var u;const c=(u=this.getOrCreateFilterWrapper(e))==null?void 0:u.filterPromise;c!=null&&c.then(d=>{l(Kl(d))})},i=e.getColDef(),s={...this.createFilterParams(e,i),filterChangedCallback:()=>r(l=>this.filterChangedCallbackFactory(l,e)())},n=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(i,am,s);let o=Uq(this.frameworkOverrides,i,()=>this.getDefaultFloatingFilter(e));o==null&&(o="agReadOnlyFloatingFilter");const a={column:e,filterParams:n,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:r,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(i,a,o)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e,t="api"){var s;const r=e.getColId(),i=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialFilterModel[r],i&&(this.disposeFilterWrapper(i,t),(s=this.filterManager)==null||s.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then(r=>{this.destroyBean(r),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId());const i={type:"filterDestroyed",source:t,column:e.column};this.eventService.dispatchEvent(i)})}filterModifiedCallbackFactory(e,t){return()=>{const r={type:"filterModified",column:t,filterInstance:e};this.eventService.dispatchEvent(r)}}filterChangedCallbackFactory(e,t){return r=>{const i=(r==null?void 0:r.source)??"columnFilter",s={filter:e,additionalEventAttributes:r,columns:[t],source:i};this.callOnFilterChangedOutsideRenderCycle(s)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const r=t.column,{compDetails:i}=r.isFilterAllowed()?this.createFilterInstance(r):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i)){this.destroyFilter(r,"paramsUpdated");return}const s=r.getColDef().filterParams;if(!t.filterPromise){this.destroyFilter(r,"paramsUpdated");return}t.filterPromise.then(n=>{(n!=null&&n.refresh?n.refresh({...this.createFilterParams(r,r.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(n,r),filterChangedCallback:this.filterChangedCallbackFactory(n,r),doesRowPassOtherFilter:a=>this.filterManager?this.filterManager.doesRowPassOtherFilters(n,a):!0,...s}):!0)===!1&&this.destroyFilter(r,"paramsUpdated")})}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:i}=t;return!(r===i||(r==null?void 0:r.render)&&(i==null?void 0:i.render)&&r.render===i.render)}hasFloatingFilters(){return this.columnModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e,t){t&&this.getFilterInstanceImpl(e).then(r=>{const i=Kl(r);t(i)})}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstanceImpl(e).then(r=>{t(Kl(r))})})}getFilterInstanceImpl(e){var i;const t=this.columnModel.getColDefCol(e);return t?((i=this.getOrCreateFilterWrapper(t))==null?void 0:i.filterPromise)??pi.resolve(null):pi.resolve(void 0)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:r})=>{this.setColumnFilterModel(e,t).then(()=>r())}),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){var n;if((n=this.dataTypeService)!=null&&n.isPendingInference()){let o=()=>{};const a=new Promise(l=>{o=l});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:o}),a}const r=this.columnModel.getColDefCol(e),i=r?this.getOrCreateFilterWrapper(r):null;return i?(o=>new Promise(a=>{o.then(l=>a(l))}))(this.setModelOnFilterWrapper(i.filterPromise,t)):Promise.resolve()}getFilterWrapper(e){const t=this.columnModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};function jq(e){var t;return!!((t=e.filterManager)!=null&&t.isAnyFilterPresent())}function qq(e,t="api"){var r;(r=e.filterManager)==null||r.onFilterChanged({source:t})}var Yq=class extends wt{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>
            </div>`,[Eh]),this.eFloatingFilterText=He}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),r=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${r("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const r=t.getModelAsString(e);this.eFloatingFilterText.setValue(r)}})}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}},TF=class extends wt{wireBeans(e){this.columnNameService=e.columnNameService}getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e==null?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.getDefaultOption();return}const t=e.operator;let r;t?r=e.conditions[0]:r=e,this.lastType=r.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const r=e;return this.isTypeEditable(r.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){this.optionsFactory=new uF,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const r=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(r)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:r}=t||{};return r==null||r==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),r=this.localeService.getLocaleTextFunc();return`${t} ${r("ariaFilterInput","Filter Input")}`}},Xq=class extends TF{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field data-ref="eReadOnlyText"></ag-input-text-field>
                <div data-ref="eDateWrapper" style="display: flex;"></div>
            </div>`,[Eh]),this.eReadOnlyText=He,this.eDateWrapper=He}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}getDefaultFilterOptions(){return yF}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new xF(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const r=e;this.dateComp.setDate(si(r.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Wt(this.eDateWrapper,e),Wt(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=this.dateComp.getDate(),t=ki(e);this.params.parentFilterInstance(r=>{if(r){const i=si(t);r.onFloatingFilterChanged(this.getLastType()||null,i)}})}getDateComponentParams(){const e=lm(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:qr(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new SF(this.context,this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}},Qq=class extends wt{constructor(){super(`
            <div class="ag-filter-filter">
                <ag-input-text-field class="ag-date-filter" data-ref="eDateInput"></ag-input-text-field>
            </div>`,[Eh]),this.eDateInput=He}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()},input:r=>{r.target===this.gos.getActiveDomElement()&&(this.eDateInput.isDisabled()||this.params.onDateChanged())}})}setParams(e){const t=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=r&&Js(),t.type=r?"date":"text";const{minValidYear:i,maxValidYear:s,minValidDate:n,maxValidDate:o}=e.filterParams||{};if(n&&i&&Te("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&s&&Te("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),n&&o){const[a,l]=[n,o].map(c=>c instanceof Date?c:si(c));a&&l&&a.getTime()>l.getTime()&&Te("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}n?n instanceof Date?t.min=ql(n):t.min=n:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=ql(o):t.max=o:s&&(t.max=`${s}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return si(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(ki(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&e.filterParams.browserDatePicker!=null?e.filterParams.browserDatePicker:Z0()||NE()||Js()&&LE()>=14.1}},AF=class extends xe{constructor(e){super(),this.params=e,this.eFloatingFilterTextInput=He,this.valueChangedListener=()=>{}}setupGui(e){var i;this.eFloatingFilterTextInput=this.createManagedBean(new qo((i=this.params)==null?void 0:i.config));const t=this.eFloatingFilterTextInput.getGui();e.appendChild(t);const r=s=>this.valueChangedListener(s);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},PF=class extends TF{constructor(){super(...arguments),this.eFloatingFilterInputContainer=He}postConstruct(){this.setTemplate(`
            <div class="ag-floating-filter-input" role="presentation" data-ref="eFloatingFilterInputContainer"></div>
        `)}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Vd(this.params.filterParams),!this.isReadOnly()){const r=lm(this.params.filterParams,this.getDefaultDebounceMs()),i=qr(this.syncUpWithParentFilter.bind(this),r);this.floatingFilterInputService.setValueChangedListener(i)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();Or(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===ve.ENTER;if(this.applyActive&&!t)return;let r=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(r=CF(r),this.floatingFilterInputService.setValue(r,!0)),this.params.parentFilterInstance(i=>{i&&i.onFloatingFilterChanged(this.getLastType()||null,r||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}},Jq=class extends xe{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new um),this.eFloatingFilterTextInput=this.createManagedBean(new qo),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),r=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,i=>this.valueChangedListener(i)),this.setupListeners(r,i=>this.valueChangedListener(i))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Zq=class extends PF{init(e){var t;super.init(e),this.filterModelFormatter=new gF(this.localeService,this.optionsFactory,(t=e.filterParams)==null?void 0:t.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){sg(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return pF}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=sg(e.filterParams),this.allowedCharPattern?this.createManagedBean(new AF({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Jq)}},eY=class extends PF{init(e){super.init(e),this.filterModelFormatter=new vF(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return mF}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new AF)}};function tY(e){var t;return!!((t=e.filterManager)!=null&&t.isQuickFilterPresent())}function rY(e){return e.gos.get("quickFilterText")}function iY(e){var t;(t=e.filterManager)==null||t.resetQuickFilterCache()}var sY=class extends xe{constructor(){super(...arguments),this.beanName="quickFilterService",this.quickFilter=null,this.quickFilterParts=null}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.pivotResultColsService=e.pivotResultColsService}postConstruct(){const e=this.resetQuickFilterCache.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}}),this.addManagedPropertyListener("quickFilterText",t=>this.setQuickFilter(t.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}refreshQuickFilterCols(){var s;const e=this.columnModel.isPivotMode(),t=this.columnModel.getAutoCols(),r=this.columnModel.getColDefCols();let i=(e&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?(s=this.pivotResultColsService.getPivotResultCols())==null?void 0:s.list:r)??[];t&&(i=i.concat(t)),this.colsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?i:i.filter(n=>n.isVisible()||n.isRowGroupActive())}isQuickFilterPresent(){return this.quickFilter!==null}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every(r=>t?this.doesRowPassQuickFilterCache(e,r):this.doesRowPassQuickFilterNoCache(e,r))}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseQuickFilter(e){return ke(e)?this.gos.isRowModelType("clientSide")?e.toUpperCase():(Te("Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(e!=null&&typeof e!="string"){Te(`Grid option quickFilterText only supports string inputs, received: ${typeof e}`);return}const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),r=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,r&&(this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onQuickFilterColumnConfigChanged(){this.refreshQuickFilterCols(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassQuickFilterNoCache(e,t){return this.colsForQuickFilter.some(r=>{const i=this.getQuickFilterTextForColumn(r,e);return ke(i)&&i.indexOf(t)>=0})}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let r;e?(this.checkGenerateQuickFilterAggregateText(t),r=t.quickFilterAggregateText):r=this.getQuickFilterAggregateText(t);const{quickFilterParts:i,matcher:s}=this;return s(i,r)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let r=this.valueService.getValue(e,t,!0);const i=e.getColDef();if(i.getQuickFilterText){const s=this.gos.addGridCommonParams({value:r,node:t,data:t.data,column:e,colDef:i});r=i.getQuickFilterText(s)}return ke(r)?r.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.colsForQuickFilter.forEach(r=>{const i=this.getQuickFilterTextForColumn(r,e);ke(i)&&t.push(i)}),t.join(`
`)}},pm={version:Ze,moduleName:"@ag-grid-community/filter-core",beans:[oq]},nY={version:Ze,moduleName:"@ag-grid-community/filter-api",apiFunctions:{isAnyFilterPresent:jq,onFilterChanged:qq},dependantModules:[pm]},gm={version:Ze,moduleName:"@ag-grid-community/column-filter",beans:[Kq],dependantModules:[pm]},oY={version:Ze,moduleName:"@ag-grid-community/column-filter-api",apiFunctions:{isColumnFilterPresent:Lq,getFilterInstance:Nq,getColumnFilterInstance:Bq,destroyFilter:Gq,setFilterModel:Hq,getFilterModel:Vq,getColumnFilterModel:Wq,setColumnFilterModel:zq,showColumnFilter:$q},dependantModules:[gm,nY]},DF={version:Ze,moduleName:"@ag-grid-community/floating-filter-core",controllers:[{name:"headerFilterCell",classImp:Oq}],dependantModules:[gm]},aY={version:Ze,moduleName:"@ag-grid-community/read-only-floating-filter",userComponents:[{name:"agReadOnlyFloatingFilter",classImp:Yq}],dependantModules:[DF]},lY={version:Ze,moduleName:"@ag-grid-community/simple-filter",dependantModules:[gm],userComponents:[{name:"agTextColumnFilter",classImp:Fq},{name:"agNumberColumnFilter",classImp:Eq},{name:"agDateColumnFilter",classImp:Pq},{name:"agDateInput",classImp:Qq}]},cY={version:Ze,moduleName:"@ag-grid-community/simple-floating-filter",dependantModules:[lY,DF],userComponents:[{name:"agTextColumnFloatingFilter",classImp:eY},{name:"agNumberColumnFloatingFilter",classImp:Zq},{name:"agDateColumnFloatingFilter",classImp:Xq}]},MF={version:Ze,moduleName:"@ag-grid-community/quick-filter-core",beans:[sY],dependantModules:[pm]},uY={version:Ze,moduleName:"@ag-grid-community/quick-filter-api",apiFunctions:{isQuickFilterPresent:tY,getQuickFilter:rY,resetQuickFilter:iY},dependantModules:[MF]},dY={version:Ze,moduleName:"@ag-grid-community/quick-filter",dependantModules:[MF,uY]},hY={version:Ze,moduleName:"@ag-grid-community/filter",dependantModules:[cY,aY,dY,oY]},mm=class extends wt{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},fY=class extends mm{constructor(e){super(`<div class="ag-header-cell ag-floating-filter" role="gridcell">
            <div data-ref="eFloatingFilterBody" role="presentation"></div>
            <div class="ag-floating-filter-button ag-hidden" data-ref="eButtonWrapper" role="presentation">
                <button type="button" class="ag-button ag-floating-filter-button-button" data-ref="eButtonShowMainFilter" tabindex="-1"></button>
            </div>
        </div>`,e),this.eFloatingFilterBody=He,this.eButtonWrapper=He,this.eButtonShowMainFilter=He}postConstruct(){const e=this.getGui(),t={addOrRemoveCssClass:(r,i)=>this.addOrRemoveCssClass(r,i),addOrRemoveBodyCssClass:(r,i)=>this.eFloatingFilterBody.classList.toggle(r,i),setButtonWrapperDisplayed:r=>Wt(this.eButtonWrapper,r),setCompDetails:r=>this.setCompDetails(r),getFloatingFilterComp:()=>this.compPromise,setWidth:r=>e.style.width=r,setMenuIcon:r=>this.eButtonShowMainFilter.appendChild(r)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},pY=class extends mm{constructor(e){super(`<div class="ag-header-cell" role="columnheader">
            <div data-ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
            <div data-ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>
        </div>`,e),this.eResize=He,this.eHeaderCompWrapper=He,this.headerCompVersion=0,this.column=e.getColumnGroupChild(),this.pinned=e.getPinned()}postConstruct(){const e=this.getGui();((s,n)=>{n!=null&&n!=""?e.setAttribute(s,n):e.removeAttribute(s)})("col-id",this.column.getColId());const r={setWidth:s=>e.style.width=s,addOrRemoveCssClass:(s,n)=>this.addOrRemoveCssClass(s,n),setAriaSort:s=>s?QK(e,s):JK(e),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(r,this.getGui(),this.eResize,this.eHeaderCompWrapper);const i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(r=>this.afterCompCreated(t,r))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},gY=class extends mm{constructor(e){super(`<div class="ag-header-group-cell" role="columnheader">
            <div data-ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
        </div>`,e),this.eResize=He}postConstruct(){const e=this.getGui(),t=(i,s)=>s!=null?e.setAttribute(i,s):e.removeAttribute(i);e.setAttribute("col-id",this.ctrl.getColId());const r={addOrRemoveCssClass:(i,s)=>this.addOrRemoveCssClass(i,s),setResizableDisplayed:i=>Wt(this.eResize,i),setWidth:i=>e.style.width=i,setAriaExpanded:i=>t("aria-expanded",i),setUserCompDetails:i=>this.setUserCompDetails(i),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(r,e,this.eResize)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}const r=this.getGui(),i=e.getGui();r.appendChild(i),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(r)}},mY=class extends wt{constructor(e){super(),this.headerComps={},this.ctrl=e,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}postConstruct(){IE(this.getGui(),this.ctrl.getAriaRowIndex());const e={setHeight:t=>this.getGui().style.height=t,setTop:t=>this.getGui().style.top=t,setHeaderCtrls:(t,r)=>this.setHeaderCtrls(t,r),setWidth:t=>this.getGui().style.width=t};this.ctrl.setComp(e)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;const r=this.headerComps;if(this.headerComps={},e.forEach(i=>{const s=i.getInstanceId();let n=r[s];delete r[s],n==null&&(n=this.createHeaderComp(i),this.getGui().appendChild(n.getGui())),this.headerComps[s]=n}),Ei(r,(i,s)=>{this.getGui().removeChild(s.getGui()),this.destroyBean(s)}),t){const i=Nn(this.headerComps);i.sort((n,o)=>{const a=n.getCtrl().getColumnGroupChild().getLeft(),l=o.getCtrl().getColumnGroupChild().getLeft();return a-l});const s=i.map(n=>n.getGui());KE(this.getGui(),s)}}createHeaderComp(e){let t;switch(this.ctrl.getType()){case"group":t=new gY(e);break;case"filter":t=new fY(e);break;default:t=new pY(e);break}return this.createBean(t),t.setParentComponent(this),t}},vY=class extends xe{constructor(){super(...arguments),this.beanName="headerNavigationService",this.currentHeaderRowWithoutSpan=-1}wireBeans(e){this.focusService=e.focusService,this.headerPositionUtils=e.headerPositionUtils,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.visibleColService=e.visibleColsService}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCon=t.gridBodyCtrl});const e=this.gos.getDocument();this.addManagedElementListeners(e,{mousedown:()=>this.setCurrentHeaderRowWithoutSpan(-1)})}getHeaderRowCount(){const e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}getHeaderPositionForColumn(e,t){let r;if(typeof e=="string"?(r=this.columnModel.getCol(e),r||(r=this.visibleColService.getColumnGroup(e))):r=e,!r)return null;const s=this.ctrlsService.getHeaderRowContainerCtrl().getAllCtrls(),n=ft(s).getType()==="filter",o=this.getHeaderRowCount()-1;let a=-1,l=r;for(;l;)a++,l=l.getParent();let c=a;return t&&n&&c===o-1&&c++,c===-1?null:{headerRowIndex:c,column:r}}navigateVertically(e,t,r){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:i}=t,s=t.column,n=this.getHeaderRowCount(),o=e===0;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:c}=o?this.headerPositionUtils.getColumnVisibleParent(s,i):this.headerPositionUtils.getColumnVisibleChild(s,i),u=!1;return a<0&&(a=0,l=s,u=!0),a>=n?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):c!==void 0&&(this.currentHeaderRowWithoutSpan=c),!u&&!l?!1:this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:r})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e,t=!1,r){const i=this.focusService.getFocusedHeader(),s=e===2,n=this.gos.get("enableRtl");let o,a;if(this.currentHeaderRowWithoutSpan!==-1?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,s!==n?(a="Before",o=this.headerPositionUtils.findHeader(i,a)):(a="After",o=this.headerPositionUtils.findHeader(i,a)),o||!t)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r});if(t){const l=this.gos.getCallback("tabToNextHeader");if(l)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a})}return this.focusNextHeaderRow(i,a,r)}focusNextHeaderRow(e,t,r){const i=e.headerRowIndex;let s=null,n;if(t==="Before"?i>0&&(n=i-1,this.currentHeaderRowWithoutSpan-=1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=i+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),s=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),!s)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(s.column,s==null?void 0:s.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(Jt(e)){const i=e.getDisplayedLeafColumns();r=t==="Before"?ft(i):i[0]}else r=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(r)}},CY=class extends xe{wireBeans(e){this.headerNavigationService=e.headerNavigationService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.menuService=e.menuService}setComp(e,t,r){this.comp=e,this.eGui=t,this.createManagedBean(new jo(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.onPivotModeChanged(),this.setupHeaderHeight();const i=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:i}),this.mockContextMenuForIPad(i),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,gridStylesChanged:e,advancedFilterEnabledChanged:e})}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){var u;const{columnModel:e}=this;let t=0,r=e.getHeaderRowCount(),i;((u=this.filterManager)==null?void 0:u.hasFloatingFilters())&&(r++,t=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),a=1+t,l=r-a;if(i=t*e.getFloatingFiltersHeight(),i+=l*n,i+=o,this.headerHeight===i)return;this.headerHeight=i;const c=`${i+1}px`;this.comp.setHeightAndMinHeight(c),this.eventService.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const t=this.visibleColsService.getAllCols().some(r=>r.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey!==t?2:3;(this.headerNavigationService.navigateHorizontally(r,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case ve.LEFT:t=2;case ve.RIGHT:{ke(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e);break}case ve.UP:t=0;case ve.DOWN:{ke(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(this.gos.getActiveDomElement())||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,r){if(!e&&!r||!this.menuService.isHeaderContextMenuEnabled())return;const{target:i}=e??t;(i===this.eGui||i===this.ctrlsService.getHeaderRowContainerCtrl().getViewport())&&this.menuService.showHeaderContextMenu(void 0,e,r)}mockContextMenuForIPad(e){if(!$n())return;const t=new kn(this.eGui),r=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListeners(t,{longTap:r}),this.addDestroyFunc(()=>t.destroy())}},vm=class extends xe{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}wireBeans(e){this.visibleColsService=e.visibleColsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=this.gos.isDomLayout("print"),t=this.visibleColsService.getBodyContainerWidth(),r=this.visibleColsService.getColsLeftWidth(),i=this.visibleColsService.getDisplayedColumnsRightWidth();let s;e?s=t+r+i:(s=t,this.addSpacer&&(this.gos.get("enableRtl")?r:i)===0&&this.scrollVisibleService.isVerticalScrollShowing()&&(s+=this.gos.getScrollbarWidth())),this.callback(s)}},wY=class extends xe{constructor(e){super(),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}wireBeans(e){this.funcColsService=e.funcColsService}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(r=>{r.isPrimary()&&(r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.funcColsService.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.funcColsService.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.funcColsService.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}};function Cm(e){const{isFromHeader:t,hDirection:r,xPosition:i,fromEnter:s,fakeEvent:n,pinned:o,gos:a,columnModel:l,columnMoveService:c,presentedColsService:u}=e,d=r===0,h=r===1;let{allMovingColumns:p}=e;if(t){const R=[];p.forEach(y=>{var T;let b=null,x=y.getParent();for(;x!=null&&x.getDisplayedLeafColumns().length===1;)b=x,x=x.getParent();b!=null?(!!((T=b.getColGroupDef())!=null&&T.marryChildren)?b.getProvidedColumnGroup().getLeafColumns():b.getLeafColumns()).forEach(U=>{R.includes(U)||R.push(U)}):R.includes(y)||R.push(y)}),p=R}const g=p.slice();l.sortColsLikeCols(g);const f=bY({movingCols:g,draggingRight:h,xPosition:i,pinned:o,gos:a,columnModel:l,presentedColsService:u}),m=SY(g,l);if(f.length===0)return;const v=f[0];let w=m!==null&&!s;if(t&&(w=m!==null),w&&!n&&(d&&v>=m||h&&v<=m))return;const C=u.getAllCols(),F=[];let D=null;for(let R=0;R<f.length;R++){const y=f[R],b=c.getProposedColumnOrder(g,y);if(!c.doesOrderPassRules(b))continue;const x=b.filter(A=>C.includes(A));if(D===null)D=x;else if(!Uo(x,D))break;const T=yY(b);F.push({move:y,fragCount:T})}if(F.length!==0)return F.sort((R,y)=>R.fragCount-y.fragCount),kF(p,F[0].move,"uiColumnMoved",!1,c)}function kF(e,t,r,i,s){return s.moveColumns(e,t,r,i),i?null:{columns:e,toIndex:t}}function SY(e,t){const r=t.getCols(),i=tK(e.map(l=>r.indexOf(l))),s=i[0];return ft(i)-s!==i.length-1?null:s}function yY(e){function t(i){const s=[];let n=i.getOriginalParent();for(;n!=null;)s.push(n),n=n.getOriginalParent();return s}let r=0;for(let i=0;i<e.length-1;i++){let s=t(e[i]),n=t(e[i+1]);[s,n]=s.length>n.length?[s,n]:[n,s],s.forEach(o=>{n.indexOf(o)===-1&&r++})}return r}function xY(e,t){switch(t){case"left":return e.getLeftCols();case"right":return e.getRightCols();default:return e.getCenterCols()}}function bY(e){const{movingCols:t,draggingRight:r,xPosition:i,pinned:s,gos:n,columnModel:o,presentedColsService:a}=e;if(n.get("suppressMovableColumns")||t.some(C=>C.getColDef().suppressMovable))return[];const c=xY(a,s),u=o.getCols(),d=c.filter(C=>xo(t,C)),h=c.filter(C=>!xo(t,C)),p=u.filter(C=>!xo(t,C));let g=0,f=i;if(r){let C=0;d.forEach(F=>C+=F.getActualWidth()),f-=C}if(f>0){for(let C=0;C<h.length;C++){const F=h[C];if(f-=F.getActualWidth(),f<0)break;g++}r&&g++}let m;if(g>0){const C=h[g-1];m=p.indexOf(C)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);const v=[m],w=(C,F)=>C-F;if(r){let C=m+1;const F=u.length-1;for(;C<=F;)v.push(C),C++;v.sort(w)}else{let C=m;const F=u.length-1;let D=u[C];for(;C<=F&&c.indexOf(D)<0;)C++,v.push(C),D=u[C];C=m-1;const R=0;for(;C>=R;)v.push(C),C--;v.sort(w).reverse()}return v}function wm(e,t,r,i,s){const n=s.getHeaderRowContainerCtrl(t).getViewport();return r&&(e-=n.getBoundingClientRect().left),i.get("enableRtl")&&(e=n.clientWidth-e),t==null&&(e+=s.get("center").getCenterViewportScrollLeft()),e}var RY=class extends xe{constructor(e){super(),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!ke(e)}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnMoveService=e.columnMoveService,this.dragAndDropService=e.dragAndDropService,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){return this.pinned?"pinned":"move"}onDragEnter(e){const t=e.dragItem.columns;if(e.dragSource.type===0)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const i=e.dragItem.visibleState,s=(t||[]).filter(n=>i[n.getId()]);this.setColumnsVisible(s,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(e){const i=e.filter(s=>!s.getColDef().lockVisible);this.columnModel.setColsVisible(i,t,r)}}setColumnsPinned(e,t,r){if(e){const i=e.filter(s=>!s.getColDef().lockPinned);this.columnModel.setColsPinned(i,t,r)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(e){if(this.isCenterContainer){const t=this.ctrlsService.get("center"),r=t.getCenterViewportScrollLeft(),i=r+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<r+50,this.needToMoveLeft=e>i-50):(this.needToMoveLeft=e<r+50,this.needToMoveRight=e>i-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,i=!1){var c;if(i){if(this.lastMovedInfo){const{columns:u,toIndex:d}=this.lastMovedInfo;kF(u,d,"uiColumnMoved",!0,this.columnMoveService)}return}if(this.lastDraggingEvent=e,ut(e.hDirection))return;const s=wm(e.x,this.pinned,!1,this.gos,this.ctrlsService);t||this.checkCenterForScrolling(s);const n=this.normaliseDirection(e.hDirection),o=e.dragSource.type,a=((c=e.dragSource.getDragItem().columns)==null?void 0:c.filter(u=>u.getColDef().lockPinned?u.getPinned()==this.pinned:!0))||[],l=Cm({allMovingColumns:a,isFromHeader:o===1,hDirection:n,xPosition:s,pinned:this.pinned,fromEnter:t,fakeEvent:r,gos:this.gos,columnModel:this.columnModel,columnMoveService:this.columnMoveService,presentedColsService:this.visibleColsService});l&&(this.lastMovedInfo=l)}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0;default:pt(`Unknown direction ${e}`)}else return e}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.dragAndDropService.setGhostIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon("move"))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*5,e>100&&(e=100);let t=null;const r=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const s=this.lastDraggingEvent.dragItem.columns.filter(n=>!n.getColDef().lockPinned);if(s.length>0&&(this.dragAndDropService.setGhostIcon("pinned"),this.failedMoveAttempts>7)){const n=this.needToMoveLeft?"left":"right";this.setColumnsPinned(s,n,"uiColumnDragged"),this.dragAndDropService.nudge()}}}},EY=class extends xe{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]];break}}),this.moveColumnFeature=this.createManagedBean(new RY(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new wY(this.pinned)),this.dragAndDropService.addDropTarget(this)}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}},FY=class extends xe{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.pinnedWidthService=e.pinnedWidthService,this.ctrlsService=e.ctrlsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,r,i,s){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=i,this.ctrl=s}postConstruct(){const e=[];let t,r;const i=()=>{if(Wt(this.eResize,t),!t)return;const o=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(o),r){const a=this.gos.get("skipHeaderOnAutoSize"),l=()=>{this.columnAutosizeService.autoSizeColumn(this.column,"uiColumnResized",a)};this.eResize.addEventListener("dblclick",l);const c=new kn(this.eResize);c.addEventListener("doubleTap",l),e.push(()=>{this.eResize.removeEventListener("dblclick",l),c.removeEventListener("doubleTap",l),c.destroy()})}},s=()=>{e.forEach(o=>o()),e.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,s(),i())};n(),this.addDestroyFunc(s),this.ctrl.addRefreshFunction(n)}onResizing(e,t){const{column:r,lastResizeAmount:i,resizeStartWidth:s}=this,n=this.normaliseResizeAmount(t),o=s+n,a=[{key:r,newWidth:o}];if(this.column.getPinned()){const l=this.pinnedWidthService.getPinnedLeftWidth(),c=this.pinnedWidthService.getPinnedRightWidth(),u=qc(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(l+c+(n-i)>u)return}this.lastResizeAmount=n,this.columnSizeService.setColumnWidths(a,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r=this.pinned!=="left",i=this.pinned==="right";return this.gos.get("enableRtl")?r&&(t*=-1):i&&(t*=-1),t}},TY=class extends xe{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(this.gos.getActiveDomElement())&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new nm),this.cbSelectAll.addCssClass("ag-header-select-all"),li(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:this.onNewColumnsLoaded.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedListeners(this.cbSelectAll,{fieldValueChanged:this.onCbSelectAll.bind(this)}),Q0(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),r=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${i} (${r})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${i} (${r})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return this.gos.get("rowSelection")==="multiple"?!0:(Te(`${e} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(e){const t=this.rowModel.getType();return t==="clientSide"||t==="serverSide"?!0:(Te(`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),r=this.isCurrentPageOnly();let i="uiSelectAll";r?i="uiSelectAllCurrentPage":t&&(i="uiSelectAllFiltered");const s={source:i,justFiltered:t,justCurrentPage:r};e?this.selectionService.selectAllRowNodes(s):this.selectionService.deselectAllRowNodes(s)}isCheckboxSelection(){let e=this.column.getColDef().headerCheckboxSelection;if(typeof e=="function"){const t=e,r=this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()});e=t(r)}return e?this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"):!1}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},AY=class extends Fh{constructor(e,t,r){super(e,t,r),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,r,i){this.comp=e,this.setGui(t),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(i),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new FY(this.getPinned(),this.column,r,e,this)),this.createManagedBean(new fm([this.column],t)),this.createManagedBean(new hm(this.column,t,this.beans)),this.createManagedBean(new jo(t,{shouldStopEventPropagation:s=>this.shouldStopEventPropagation(s),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListeners(this.column,{colDefChanged:this.refresh.bind(this)}),this.addManagedEventListeners({columnValueChanged:this.onColumnValueChanged.bind(this),columnRowGroupChanged:this.onColumnRowGroupChanged.bind(this),columnPivotChanged:this.onColumnPivotChanged.bind(this),headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}resizeHeader(e,t){if(!this.column.isResizable())return;const r=this.column.getActualWidth(),i=this.column.getMinWidth(),s=this.column.getMaxWidth(),n=Math.min(Math.max(r+e,i),s);this.beans.columnSizeService.setColumnWidths([{key:this.column,newWidth:n}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,column:r,gos:i,ctrlsService:s}=this,n=this.getPinned(),o=t.getBoundingClientRect().left,a=r.getActualWidth(),l=i.get("enableRtl"),u=wm(e===0!==l?o-20:o+a+20,n,!0,i,s);Cm({allMovingColumns:[r],isFromHeader:!0,hDirection:e,xPosition:u,pinned:n,fromEnter:!1,fakeEvent:!1,gos:i,columnModel:this.beans.columnModel,columnMoveService:this.beans.columnMoveService,presentedColsService:this.beans.visibleColsService}),s.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto")}setupUserComp(){const e=this.lookupUserCompDetails();this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}createParams(){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:t=>{this.menuService.showColumnMenu({column:this.column,buttonElement:t,positionBy:"button"})},showColumnMenuAfterMouseClick:t=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:t,positionBy:"mouse"})},showFilter:t=>{this.menuService.showFilterMenu({column:this.column,buttonElement:t,containerType:"columnFilter",positionBy:"button"})},progressSort:t=>{this.beans.sortController.progressSort(this.column,!!t,"uiColumnSorted")},setSort:(t,r)=>{this.beans.sortController.setSortForColumn(this.column,t,!!r,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,r)=>{this.setupTooltip(t,r)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new TY(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===ve.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===ve.ENTER&&this.onEnterKeyDown(e),e.key===ve.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();!r||!(r instanceof tg)||r.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r=this.gos.get("tooltipShowMode")==="whenTruncated",i=this.eGui,s=this.column.getColDef();!t&&r&&!s.headerComponent&&(t=()=>{const a=i.querySelector(".ag-header-cell-text");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>i,getLocation:()=>"header",getTooltipValue:()=>e??this.column.getColDef().headerTooltip,shouldDisplayTooltip:t},o=this.createManagedBean(new Xa(n));this.refreshFunctions.push(()=>o.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),r=bF(t,this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(r),r.forEach(s=>{i.has(s)?i.delete(s):this.comp.addOrRemoveCssClass(s,!0)}),i.forEach(s=>this.comp.addOrRemoveCssClass(s,!1))};this.refreshFunctions.push(e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:r,displayName:i,dragAndDropService:s,gos:n}=this,{columnModel:o}=r;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),t.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>t.setMoving(!1,"uiColumnMoved"),onGridEnter:c=>{var u;if(a){const d=((u=c==null?void 0:c.columns)==null?void 0:u.filter(h=>!h.getColDef().lockVisible))||[];o.setColsVisible(d,!0,"uiColumnMoved")}},onGridExit:c=>{var u;if(a){const d=((u=c==null?void 0:c.columns)==null?void 0:u.filter(h=>!h.getColDef().lockVisible))||[];o.setColsVisible(d,!1,"uiColumnMoved")}}};s.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(e){this.refreshFunctions.push(e)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.columnNameService.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const e=()=>{const t=this.column.getActualWidth();this.comp.setWidth(`${t}px`)};this.addManagedListeners(this.column,{widthChanged:e}),e()}setupMovingCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListeners(this.column,{movingChanged:e}),e()}setupMenuClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListeners(this.column,{menuVisibleChanged:e}),e()}setupSortableClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};e(),this.addRefreshFunction(e),this.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(){const e=()=>{const t=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",t),this.refreshAria()};this.addManagedListeners(this.column,{filterActiveChanged:e}),e()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.addRefreshFunction(e)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:r,beans:i}=this;if(!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),r.addOrRemoveCssClass("ag-header-span-height",!1),r.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:s,isSpanningTotal:n}=this.column.getColumnGroupPaddingInfo();r.addOrRemoveCssClass("ag-header-span-height",s>0);const{columnModel:o}=i,a=o.getColumnHeaderRowHeight();if(s===0){r.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${a}px`);return}r.addOrRemoveCssClass("ag-header-span-total",n);const c=o.isPivotMode()?o.getPivotGroupHeaderHeight():o.getGroupHeaderHeight(),u=s*c;e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${a+u}px`)}setupAutoHeight(e){const{columnModel:t,resizeObserverService:r}=this.beans,i=c=>{if(!this.isAlive())return;const{paddingTop:u,paddingBottom:d,borderBottomWidth:h,borderTopWidth:p}=Ko(this.getGui()),g=u+d+h+p,m=e.offsetHeight+g;if(c<5){const v=this.beans.gos.getDocument(),w=!v||!v.contains(e),C=m==0;if(w||C){window.setTimeout(()=>i(c+1),0);return}}t.setColHeaderHeight(this.column,m)};let s=!1,n;const o=()=>{const c=this.column.isAutoHeaderHeight();c&&!s&&a(),!c&&s&&l()},a=()=>{s=!0,i(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),n=r.observeResize(e,()=>i(0))},l=()=>{s=!1,n&&n(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),n=void 0};o(),this.addDestroyFunc(()=>l()),this.addManagedListeners(this.column,{widthChanged:()=>s&&i(0)}),this.addManagedEventListeners({sortChanged:()=>{s&&window.setTimeout(()=>i(0))}}),this.addRefreshFunction(o)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(HK(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(this.beans.gos.getActiveDomElement()))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,r)=>t==="filter"?-1:r.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnouncementService.announceValue(e)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedEventListeners({columnHoverChanged:e}),e()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column),r=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);this.addManagedListeners(this.getGui(),{mouseenter:e,mouseleave:e,click:t,contextmenu:r})}handleMouseOverChange(e){this.setActiveHeader(e);const r={type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column};this.eventService.dispatchEvent(r)}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof tg?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},PY=class extends xe{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.autoWidthCalculator=e.autoWidthCalculator,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,r,i){super(),this.eResize=t,this.comp=e,this.pinned=r,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const t=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const r=[];this.columnGroup.getDisplayedLeafColumns().forEach(s=>{s.getColDef().suppressAutoSize||r.push(s.getColId())}),r.length>0&&this.columnAutosizeService.autoSizeCols({colKeys:r,skipHeader:t,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const i=this.normaliseDragChange(t),s=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(s,r,e)}getInitialValues(e){const t=this.getColumnsToResize(),r=this.getInitialSizeOfColumns(t),i=this.getSizeRatiosOfColumns(t,r),s={columnsToResize:t,resizeStartWidth:r,resizeRatios:i};let n=null;if(e&&(n=this.visibleColsService.getGroupAtDirection(this.columnGroup,"After")),n){const o=n.getDisplayedLeafColumns(),a=s.groupAfterColumns=o.filter(c=>c.isResizable()),l=s.groupAfterStartWidth=this.getInitialSizeOfColumns(a);s.groupAfterRatios=this.getSizeRatiosOfColumns(a,l)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:i,groupAfterColumns:s,groupAfterStartWidth:n,groupAfterRatios:o}=e;this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=i,this.resizeTakeFromCols=s,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){if(!this.resizeCols||!this.resizeRatios)return;const i={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols??void 0,groupAfterStartWidth:this.resizeTakeFromStartWidth??void 0,groupAfterRatios:this.resizeTakeFromRatios??void 0};this.resizeColumns(i,e,t,r)}resizeColumns(e,t,r,i=!0){const{columnsToResize:s,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:s,ratios:o,width:t}),a){const d=t-n;u.push({columns:a,ratios:c,width:l-d})}this.columnSizeService.resizeColumnSets({resizeSets:u,finished:i,source:r}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}getInitialSizeOfColumns(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}getSizeRatiosOfColumns(e,t){return e.map(r=>r.getActualWidth()/t)}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}},DY=class extends xe{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",e===0)}},MY=class extends Fh{constructor(e,t,r){super(e,t,r),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const i=this.getGui();this.setDragSource(i)}},this.column=e}setComp(e,t,r){this.comp=e,this.setGui(t),this.displayName=this.beans.columnNameService.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const i=this.getParentRowCtrl().getPinned(),s=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new fm(s,t)),this.createManagedBean(new hm(this.column,t,this.beans)),this.createManagedBean(new DY(e,this.column)),this.resizeFeature=this.createManagedBean(new PY(e,r,i,this.column)),this.createManagedBean(new jo(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(e,t){if(!this.resizeFeature)return;const r=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(r,r.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:r,column:i,gos:s,ctrlsService:n}=this,o=s.get("enableRtl"),a=e===0,l=this.getPinned(),c=r.getBoundingClientRect(),u=c.left,d=c.width,h=wm(a!==o?u-20:u+d+20,l,!0,s,n),p=i.getGroupId(),g=this.focusService.getFocusedHeader();Cm({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection:e,xPosition:h,pinned:l,fromEnter:!1,fakeEvent:!1,gos:s,columnModel:t.columnModel,columnMoveService:t.columnMoveService,presentedColsService:t.visibleColsService});const f=i.getDisplayedLeafColumns(),m=a?f[0]:ft(f);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(m,"auto"),!this.isAlive()&&g&&this.restoreFocus(p,i,g)}restoreFocus(e,t,r){const i=t.getLeafColumns();if(!i.length)return;const s=i[0].getParent();if(!s)return;const n=this.findGroupWidthId(s,e);n&&this.focusService.focusHeaderPosition({headerPosition:{...r,column:n}})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(){const e=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:r=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),r,"gridInitializing")},setTooltip:(r,i)=>{this.setupTooltip(r,i)}}),t=this.userComponentFactory.getHeaderGroupCompDetails(e);this.comp.setUserCompDetails(t)}addHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),r=i=>this.handleContextMenuMouseEvent(i,void 0,this.column.getProvidedColumnGroup());this.addManagedListeners(this.getGui(),{mouseenter:e,mouseleave:e,click:t,contextmenu:r})}handleMouseOverChange(e){const r={type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(r)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r=this.column.getColGroupDef(),i=this.gos.get("tooltipShowMode")==="whenTruncated",s=this.eGui;!t&&i&&!(r!=null&&r.headerGroupComponent)&&(t=()=>{const o=s.querySelector(".ag-header-group-text");return o?o.scrollWidth>o.clientWidth:!0});const n={getColumn:()=>this.column,getGui:()=>s,getLocation:()=>"headerGroup",getTooltipValue:()=>e??(r&&r.headerTooltip),shouldDisplayTooltip:t};r&&(n.getColDef=()=>r),this.createManagedBean(new Xa(n))}setupExpandable(){const e=this.column.getProvidedColumnGroup();this.refreshExpanded();const t=this.refreshExpanded.bind(this);this.addManagedListeners(e,{expandedChanged:t,expandableChanged:t})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=bF(e,this.gos,null,this.column);this.column.isPadding()?(t.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&t.push("ag-header-span-height")):t.push("ag-header-group-cell-with-group"),t.forEach(r=>this.comp.addOrRemoveCssClass(r,!0))}setupMovingCss(){const t=this.column.getProvidedColumnGroup().getLeafColumns(),r=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach(i=>{this.addManagedListeners(i,{movingChanged:r})}),r()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===ve.ENTER){const r=this.column,i=!r.isExpanded();this.beans.columnModel.setColumnGroupOpened(r.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!e))return;const{beans:t,column:r,displayName:i,gos:s,dragAndDropService:n}=this,{columnModel:o}=t,a=r.getProvidedColumnGroup().getLeafColumns();let l=!s.get("suppressDragLeaveHidesColumns");const c=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?"hide":"notAllowed",dragItemName:i,getDragItem:()=>this.getDragItemForGroup(r),onDragStarted:()=>{l=!s.get("suppressDragLeaveHidesColumns"),a.forEach(u=>u.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>a.forEach(u=>u.setMoving(!1,"uiColumnDragged")),onGridEnter:u=>{var d;if(l){const h=((d=u==null?void 0:u.columns)==null?void 0:d.filter(p=>!p.getColDef().lockVisible))||[];o.setColsVisible(h,!0,"uiColumnMoved")}},onGridExit:u=>{var d;if(l){const h=((d=u==null?void 0:u.columns)==null?void 0:d.filter(p=>!p.getColDef().lockVisible))||[];o.setColsVisible(h,!1,"uiColumnMoved")}}};n.addDragSource(c,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),r={};t.forEach(s=>r[s.getId()]=s.isVisible());const i=[];return this.beans.visibleColsService.getAllCols().forEach(s=>{t.indexOf(s)>=0&&(i.push(s),jr(t,s))}),t.forEach(s=>i.push(s)),{columns:i,visibleState:r}}isSuppressMoving(){let e=!1;return this.column.getLeafColumns().forEach(r=>{(r.getColDef().suppressMovable||r.getColDef().lockPosition)&&(e=!0)}),e||this.gos.get("suppressMovableColumns")}},kY=0,kf=class extends xe{constructor(e,t,r){super(),this.instanceId=kY++,this.rowIndex=e,this.pinned=t,this.type=r;const i=r=="group"?"ag-header-row-column-group":r=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}wireBeans(e){this.beans=e}postConstruct(){this.isPrintLayout=this.gos.isDomLayout("print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}getInstanceId(){return this.instanceId}areCellsRendered(){return this.comp?this.getHeaderCellCtrls().every(e=>e.getGui()!=null):!1}setComp(e,t=!0){this.comp=e,t&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){const e=this.onRowHeightChanged.bind(this);this.addManagedEventListeners({columnResized:this.onColumnResized.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:t=>this.onVirtualColumnsChanged(t.afterScroll),columnHeaderHeightChanged:e,gridStylesChanged:e,advancedFilterEnabledChanged:e}),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",t=>this.isEnsureDomOrder=t.currentValue),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e)}getHeaderCellCtrl(e){if(this.headerCellCtrls)return Yu(this.headerCellCtrls).find(t=>t.getColumnGroupChild()===e)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gos.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleColsService:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans;let r=e.getHeaderRowCount();const i=[];let s=0;t!=null&&t.hasFloatingFilters()&&(r++,s=1);const n=e.getColumnGroupHeaderRowHeight(),o=e.getColumnHeaderRowHeight(),a=1+s,l=r-a;for(let d=0;d<l;d++)i.push(n);i.push(o);for(let d=0;d<s;d++)i.push(e.getFloatingFiltersHeight());let c=0;for(let d=0;d<this.rowIndex;d++)c+=i[d];const u=i[this.rowIndex];return{topOffset:c,rowHeight:u}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(e=!1){const t=this.getHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const i of t)this.recycleAndCreateHeaderCtrls(i,e);const r=i=>{const{focusService:s,visibleColsService:n}=this.beans;return s.isHeaderWrapperFocused(i)?n.isVisible(i.getColumnGroupChild()):!1};if(e)for(const[i,s]of e)r(s)?this.headerCellCtrls.set(i,s):this.destroyBean(s);return this.getHeaderCellCtrls()}getHeaderCellCtrls(){var e;return Array.from(((e=this.headerCellCtrls)==null?void 0:e.values())??[])}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls||e.isEmptyGroup())return;const r=e.getUniqueId();let i;if(t&&(i=t.get(r),t.delete(r)),i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":{i=this.createBean(this.beans.ctrlsFactory.getInstance("headerFilterCell",e,this.beans,this));break}case"group":i=this.createBean(new MY(e,this.beans,this));break;default:i=this.createBean(new AY(e,this.beans,this));break}this.headerCellCtrls.set(r,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let e=[];const t=this.getActualDepth(),{columnViewportService:r}=this.beans;return["left",null,"right"].forEach(i=>{const s=r.getHeadersToRender(i,t);e=e.concat(s)}),e}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnViewportService.getHeadersToRender(this.pinned,this.getActualDepth())}findHeaderCellCtrl(e){return this.headerCellCtrls?this.getHeaderCellCtrls().find(i=>i.getColumnGroupChild()==e):void 0}focusHeader(e,t){const r=this.findHeaderCellCtrl(e);return r?r.focus(t):!1}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(e=>{this.destroyBean(e)}),this.headerCellCtrls=void 0,super.destroy()}},_Y=class extends xe{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}wireBeans(e){this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.focusService=e.focusService,this.filterManager=e.filterManager}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport);const r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:r,advancedFilterEnabledChanged:r}),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const t=new Na,r=this.focusService.getFocusHeaderToUseAfterRefresh(),i=()=>{const a=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let l=0;l<a;l++){const c=this.createBean(new kf(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(c)}},s=()=>{const a=t.next(),l=!this.hidden&&(this.columnsRowCtrl==null||!e||this.columnsRowCtrl.getRowIndex()!==a);(l||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),l&&(this.columnsRowCtrl=this.createBean(new kf(a,this.pinned,"column")))},n=()=>{var c;this.includeFloatingFilter=!!((c=this.filterManager)!=null&&c.hasFloatingFilters())&&!this.hidden;const a=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){a();return}const l=t.next();if(this.filtersRowCtrl){const u=this.filtersRowCtrl.getRowIndex()!==l;(!e||u)&&a()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new kf(l,this.pinned,"filter")))};i(),s(),n();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(r)}getHeaderCtrlForColumn(e){if(Bn(e))return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(e):void 0;if(this.groupsRowCtrls.length!==0)for(let t=0;t<this.groupsRowCtrls.length;t++){const r=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(r)return r}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const r=this.getAllCtrls()[e];return r?r.getType():void 0}focusHeader(e,t,r){const s=this.getAllCtrls()[e];return s?s.focusHeader(t,r):!1}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}setupDragAndDrop(e){const t=new EY(this.pinned,e);this.createManagedBean(t)}restoreFocusOnHeader(e){if(!e)return;const{column:t}=e;t.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){var t;const e=((t=this.filterManager)==null?void 0:t.hasFloatingFilters())&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new vm(e=>this.comp.setCenterWidth(`${e}px`),!0))}setupPinnedWidth(){if(this.pinned==null)return;const e=this.pinned==="left",t=this.pinned==="right";this.hidden=!0;const r=()=>{const i=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(i==null)return;const s=i==0,n=this.hidden!==s,o=this.gos.get("enableRtl"),a=this.gos.getScrollbarWidth(),c=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?i+a:i;this.comp.setPinnedContainerWidth(`${c}px`),this.comp.setDisplayed(!s),n&&(this.hidden=s,this.refresh())};this.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}},IY='<div class="ag-pinned-left-header" role="rowgroup"></div>',OY='<div class="ag-pinned-right-header" role="rowgroup"></div>',LY=`<div class="ag-header-viewport" role="presentation">
        <div class="ag-header-container" data-ref="eCenterContainer" role="rowgroup"></div>
    </div>`,_f=class extends wt{constructor(e){super(),this.eCenterContainer=He,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();const e={setDisplayed:r=>this.setDisplayed(r),setCtrls:r=>this.setCtrls(r),setCenterWidth:r=>this.eCenterContainer.style.width=r,setViewportScrollLeft:r=>this.getGui().scrollLeft=r,setPinnedContainerWidth:r=>{const i=this.getGui();i.style.width=r,i.style.maxWidth=r,i.style.minWidth=r}};this.createManagedBean(new _Y(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e=this.pinned=="left",t=this.pinned=="right",r=e?IY:t?OY:LY;this.setTemplate(r),this.eRowContainer=this.eCenterContainer!==He?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let r;const i=s=>{const n=s.getGui();n.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(n),r&&UE(this.eRowContainer,n,r),r=n};e.forEach(s=>{const n=s.getInstanceId(),o=t[n];delete t[n];const a=o||this.createBean(new mY(s));this.headerRowComps[n]=a,this.rowCompsList.push(a),i(a)}),Nn(t).forEach(s=>this.destroyRowComp(s))}},NY=class extends wt{constructor(){super('<div class="ag-header" role="presentation"/>')}postConstruct(){const e={addOrRemoveCssClass:(i,s)=>this.addOrRemoveCssClass(i,s),setHeightAndMinHeight:i=>{this.getGui().style.height=i,this.getGui().style.minHeight=i}};this.createManagedBean(new CY).setComp(e,this.getGui(),this.getFocusableElement());const r=i=>{this.createManagedBean(i),this.appendChild(i)};r(new _f("left")),r(new _f(null)),r(new _f("right"))}},BY={selector:"AG-HEADER-ROOT",component:NY},Sm=class extends xe{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},r=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(r,t)}getDomLayout(){const e=this.gos.get("domLayout")??"normal";return["normal","print","autoHeight"].indexOf(e)===-1?(Te(`${e} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):e}},GY=class extends wt{constructor(){super(`
            <div class="ag-overlay" role="presentation">
                <div class="ag-overlay-panel" role="presentation">
                    <div class="ag-overlay-wrapper" data-ref="eOverlayWrapper" role="presentation"></div>
                </div>
            </div>`),this.eOverlayWrapper=He,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeOverlayWrapperCssClass=null}wireBeans(e){this.overlayService=e.overlayService}updateLayoutClasses(e,t){const r=this.eOverlayWrapper.classList;r.toggle("ag-layout-auto-height",t.autoHeight),r.toggle("ag-layout-normal",t.normal),r.toggle("ag-layout-print",t.print)}postConstruct(){this.createManagedBean(new Sm(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&t.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r){this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.activePromise=e,e==null||e.then(i=>{if(this.activePromise!==e){this.activeOverlay!==i&&(this.destroyBean(i),i=null);return}if(this.activePromise=null,!!i&&this.activeOverlay!=i&&(this.eOverlayWrapper.appendChild(i.getGui()),this.activeOverlay=i,r)){const s=i;this.updateListenerDestroyFunc=this.addManagedPropertyListener(r,({currentValue:n})=>{var o;(o=s.refresh)==null||o.call(s,this.gos.addGridCommonParams({...n??{}}))})}}),this.setDisplayed(!0,{skipAriaHidden:!0})}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;this.activeOverlay=null;const t=this.updateListenerDestroyFunc;t&&(t(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Or(this.eOverlayWrapper)}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}},HY={selector:"AG-OVERLAY-WRAPPER",component:GY},_F=class extends wt{constructor(e,t){super(),this.direction=t,this.eViewport=He,this.eContainer=He,this.hideTimeout=null,this.setTemplate(e)}wireBeans(e){this.animationFrameService=e.animationFrameService}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",BE()||$n())}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=HE(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),r=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout!==null&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)}})}attemptSettingScrollPosition(e){const t=this.getViewport();mK(()=>ss(t),()=>this.setScrollPosition(e),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedElementListeners(this.getViewport(),{scroll:e})}},VY=class extends _F{constructor(){super(`<div class="ag-body-horizontal-scroll" aria-hidden="true">
            <div class="ag-horizontal-left-spacer" data-ref="eLeftSpacer"></div>
            <div class="ag-body-horizontal-scroll-viewport" data-ref="eViewport">
                <div class="ag-body-horizontal-scroll-container" data-ref="eContainer"></div>
            </div>
            <div class="ag-horizontal-right-spacer" data-ref="eRightSpacer"></div>
        </div>`,"horizontal"),this.eLeftSpacer=He,this.eRightSpacer=He}wireBeans(e){super.wireBeans(e),this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new vm(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.visibleColsService.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,i=this.gos.getScrollbarWidth();r&&(t+=i),es(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=i);let s=this.visibleColsService.getColsLeftWidth();this.enableRtl&&e&&(s+=i),es(this.eLeftSpacer,s),this.eLeftSpacer.classList.toggle("ag-scroller-corner",s<=i)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),i=e&&this.gos.getScrollbarWidth()||0,n=r?0:i===0&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),Ul(this.getGui(),n),Ul(this.eViewport,n),Ul(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return Bd(this.getViewport(),this.enableRtl)}setScrollPosition(e){ss(this.getViewport())||this.attemptSettingScrollPosition(e),Gd(this.getViewport(),e,this.enableRtl)}},WY={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:VY},IF=class extends xe{wireBeans(e){this.maxDivHeightScaler=e.rowContainerHeightService}constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this)})}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=e!=null?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}},zY=class extends _F{wireBeans(e){super.wireBeans(e),this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}constructor(){super(`<div class="ag-body-vertical-scroll" aria-hidden="true">
            <div class="ag-body-vertical-scroll-viewport" data-ref="eViewport">
                <div class="ag-body-vertical-scroll-container" data-ref="eContainer"></div>
            </div>
        </div>`,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new IF(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this)})}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,r=e&&this.gos.getScrollbarWidth()||0,i=r===0&&t?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),es(this.getGui(),i),es(this.eViewport,i),es(this.eContainer,i),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,r=e.getGridBodyCtrl().getBodyViewportElement(),i=this.getScrollPosition(),s=r.scrollTop;i!=s&&this.setScrollPosition(s,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(e,t){!t&&!ss(this.getViewport())&&this.attemptSettingScrollPosition(e),this.getViewport().scrollTop=e}},$Y={selector:"AG-FAKE-VERTICAL-SCROLL",component:zY},UY=class extends xe{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=qr(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=qr(()=>this.lastScrollSource[0]=null,500)}wireBeans(e){this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.rowModel=e.rowModel,this.heightScaler=e.rowContainerHeightService,this.rowRenderer=e.rowRenderer,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)}),this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const{fakeHScrollComp:e,fakeVScrollComp:t}=this.ctrlsService.getParams();this.addManagedElementListeners(this.centerRowsCtrl.getViewportElement(),{scroll:this.onHScroll.bind(this)}),e.onScrollCallback(this.onFakeHScroll.bind(this));const r=this.gos.get("debounceVerticalScrollbar"),i=r?qr(this.onVScroll.bind(this),100):this.onVScroll.bind(this),s=r?qr(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),t.onScrollCallback(s)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){if(this.centerRowsCtrl==null)return;e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft());const r=this.enableRtl?e:-e,{topCenter:i,stickyTopCenter:s,stickyBottomCenter:n,centerHeader:o,bottomCenter:a,fakeHScrollComp:l}=this.ctrlsService.getParams();o.setHorizontalScroll(-r),a.setContainerTranslateX(r),i.setContainerTranslateX(r),s.setContainerTranslateX(r),n.setContainerTranslateX(r);const c=this.centerRowsCtrl.getViewportElement(),u=this.lastScrollSource[1]===0;e=Math.abs(e),u?l.setScrollPosition(e):Gd(c,e,this.enableRtl)}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(e){const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;let i;e===0?i=Bd(t,this.enableRtl):i=this.ctrlsService.get("fakeHScrollComp").getScrollPosition(),this.doHorizontalScroll(Math.round(i)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(e){let t;e===0?t=this.eBodyViewport.scrollTop:t=this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),!this.shouldBlockScrollUpdate(0,t,!0)&&(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===0?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const r={...t,type:"bodyScrollEnd"};this.eventService.dispatchEvent(r)},100)}shouldBlockScrollUpdate(e,t,r=!1){return r&&!$n()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=tm(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&Nd()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl&&Nd()?e=e>0?0:i:e=Math.min(Math.max(e,0),i)),Gd(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const r=this.rowModel.getRowCount();let i=-1;for(let s=0;s<r;s++){const n=this.rowModel.getRow(s);if(typeof e=="function"){if(n&&e(n)){i=s;break}}else if(e===n||e===n.data){i=s;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(this.gos.isDomLayout("print"))return;const r=this.rowModel.getRowCount();if(typeof e!="number"||e<0||e>=r){Te("Invalid row index for ensureIndexVisible: "+e);return}const s=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{var u;s||(u=this.paginationService)==null||u.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),a=n.getStickyBottomHeight(),l=this.rowModel.getRow(e);let c;do{const d=l.rowTop,h=l.rowHeight,p=this.pageBoundsService.getPixelOffset(),g=l.rowTop-p,f=g+l.rowHeight,m=this.getVScrollPosition(),v=this.heightScaler.getDivStretchOffset(),w=m.top+v,C=m.bottom+v,F=C-w,D=this.heightScaler.getScrollPositionForPixel(g),R=this.heightScaler.getScrollPositionForPixel(f-F),y=Math.min((D+R)/2,g),b=w+o>g,x=C-a<f;let T=null;t==="top"?T=D:t==="bottom"?T=R:t==="middle"?T=y:b?T=D-o:x&&(T=R+a),T!==null&&(this.setVerticalScrollPosition(T),this.rowRenderer.redraw({afterScroll:!0})),c=d!==l.rowTop||h!==l.rowHeight}while(c);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const r=this.columnModel.getCol(e);if(!r||r.isPinned()||!this.visibleColsService.isColDisplayed(r))return;const i=this.getPositionedHorizontalScroll(r,t);this.getFrameworkOverrides().wrapIncoming(()=>{i!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:i}=this.isColumnOutsideViewport(e),s=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:i)||s,l=o?i:r;t!=="auto"&&(a=t==="start",l=t==="end");const c=t==="middle";if(a||l||c){const{colLeft:u,colMiddle:d,colRight:h}=this.getColumnBounds(e);return c?d-n/2:a?o?h:u:o?u-n:h-n}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:i,colRight:s}=this.getColumnBounds(e),n=this.enableRtl,o=n?t>s:r<s,a=n?r<i:t>i;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleColsService.getBodyContainerWidth(),i=e.getActualWidth(),s=e.getLeft(),n=t?-1:1,o=t?r-s:s,a=o+i*n,l=o+i/2*n;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),r=t,i=e+t;return{start:r,end:i,width:e}}},OF="ag-force-vertical-scroll",KY="ag-selectable",jY="ag-column-moving",qY=class extends xe{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.menuService=e.menuService,this.headerNavigationService=e.headerNavigationService,this.dragAndDropService=e.dragAndDropService,this.pinnedRowModel=e.pinnedRowModel,this.rowRenderer=e.rowRenderer,this.popupService=e.popupService,this.mouseEventService=e.mouseEventService,this.rowModel=e.rowModel,this.filterManager=e.filterManager,this.environment=e.environment}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,r,i,s,n,o){var a;this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=i,this.eBottom=s,this.eStickyTop=n,this.eStickyBottom=o,this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",l=>this.setCellTextSelection(l.currentValue)),this.createManagedBean(new Sm(this.comp)),this.bodyScrollFeature=this.createManagedBean(new UY(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,r,s,n,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),(a=this.filterManager)==null||a.setupAdvancedFilterHeaderComp(i),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),pinnedRowDataChanged:this.setFloatingHeights.bind(this),pinnedHeightChanged:this.setFloatingHeights.bind(this),headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}addFocusListeners(e){e.forEach(t=>{this.addManagedElementListeners(t,{focusin:r=>{const{target:i}=r,s=Sa(i,"ag-root",t);t.classList.toggle("ag-has-focus",!s)},focusout:r=>{const{target:i,relatedTarget:s}=r,n=t.contains(s),o=Sa(s,"ag-root",t);Sa(i,"ag-root",t)||(!n||o)&&t.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(jY,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(KY,e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=e&&this.gos.getScrollbarWidth()||0,r=HE()?16:0,i=`calc(100% + ${t+r}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(i))}onGridColumnsChanged(){const e=this.columnModel.getCols();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=r=>{const i=r.relatedTarget;if(eg(i)===null){this.rowRenderer.stopEditing();return}let s=t.some(n=>n.contains(i))&&this.mouseEventService.isElementInThisGrid(i);if(!s){const n=this.popupService;s=n.getActivePopups().some(o=>o.contains(i))||n.isElementWithinCustomPopup(i)}s||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach(r=>this.addManagedElementListeners(r,{focusout:e}))}updateRowCount(){var i;const e=this.headerNavigationService.getHeaderRowCount()+(((i=this.filterManager)==null?void 0:i.getHeaderRowCount())??0),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,r=t===-1?-1:e+t;this.comp.setRowCount(r)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?OF:null,r=this.gos.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&lj(this.eBodyViewport)}setupRowAnimationCssClass(){let e=this.environment.hasMeasuredSizes();const t=()=>{const r=e&&this.gos.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),i=r?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(i,r)};t(),this.addManagedEventListeners({heightScaleChanged:t}),this.addManagedPropertyListener("animateRows",t),this.addManagedEventListeners({gridStylesChanged:()=>{!e&&this.environment.hasMeasuredSizes()&&(e=!0,t())}})}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:e}),this.mockContextMenuForIPad(e),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const e=this.eBodyViewport.querySelector(".ag-full-width-container"),t=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&t&&this.addManagedElementListeners(e,{wheel:r=>this.onFullWidthContainerWheel(r,t)})}onFullWidthContainerWheel(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(e,t,r){if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsService.get("center").getViewportElement())&&this.menuService.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!$n())return;const t=new kn(this.eBodyViewport),r=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListeners(t,{longTap:r}),this.addDestroyFunc(()=>t.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new rq(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e.getPinnedTopTotalHeight(),r=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(r),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(r?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.gos.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){var s;const t=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+(((s=this.filterManager)==null?void 0:s.getHeaderHeight())??0),r=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;t>0&&(i+=t),r>0&&(i+=r),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight(),r=this.scrollVisibleService.isHorizontalScrollShowing()&&this.gos.getScrollbarWidth()||0,i=e+r;this.comp.setStickyBottomBottom(`${i}px`)}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.gos.getScrollbarWidth():0,n=qc(this.eGridBody)-i;if(n>0){this.columnSizeService.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):Te("tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}},YY=class extends wt{constructor(e,t,r,i,s){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode(),this.rowCtrl=t.getRowCtrl(),this.eRow=i,this.cellCtrl=t;const n=document.createElement("div");n.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(n);const o=this.getGui();this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const a=(u,d)=>{d!=null&&d!=""?o.setAttribute(u,d):o.removeAttribute(u)};li(o,t.getCellAriaRole()),a("col-id",t.getColumnIdSanitised());const l=t.getTabIndex();l!==void 0&&a("tabindex",l.toString());const c={addOrRemoveCssClass:(u,d)=>this.addOrRemoveCssClass(u,d),setUserStyles:u=>jE(o,u),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:u=>this.includeSelection=u,setIncludeRowDrag:u=>this.includeRowDrag=u,setIncludeDndSource:u=>this.includeDndSource=u,setRenderDetails:(u,d,h)=>this.setRenderDetails(u,d,h),setEditDetails:(u,d,h)=>this.setEditDetails(u,d,h),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};t.setComp(c,this.getGui(),this.eCellWrapper,r,s)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(e,t,r){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const s=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(r||s)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t))}setEditDetails(e,t,r){e?this.createCellEditorInstance(e,t,r):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,r=t||this.forceWrapper,i=r&&this.eCellWrapper==null;if(i){const c=document.createElement("div");c.setAttribute("role","presentation"),c.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=c,this.getGui().appendChild(this.eCellWrapper)}const s=!r&&this.eCellWrapper!=null;s&&(Cs(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!r);const n=!e&&r,o=n&&this.eCellValue==null;if(o){const c=document.createElement("span");c.setAttribute("role","presentation"),c.setAttribute("class","ag-cell-value"),this.eCellValue=c,this.eCellWrapper.appendChild(this.eCellValue)}const a=!n&&this.eCellValue!=null;a&&(Cs(this.eCellValue),this.eCellValue=void 0);const l=i||s||o||a;return l&&this.removeControls(),e||t&&this.addControls(),l}addControls(){this.includeRowDrag&&this.rowDraggingComp==null&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&this.dndSourceComp==null&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(e,t,r){const i=this.editorVersion,s=e.newAgStackInstance();if(s==null)return;const{params:n}=e;s.then(a=>this.afterCellEditorCreated(i,a,n,t,r)),ut(this.cellEditor)&&n.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Or(t);const r=e!=null?bs(e,!0):null;r!=null&&(t.textContent=r)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),Cs(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Cs(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer==null||this.cellRenderer.refresh==null||this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){const r=!this.beans.gos.get("suppressAnimationFrame"),i=this.rendererVersion,{componentClass:s}=e,n=()=>{if(this.rendererVersion!==i||!this.isAlive())return;const a=e.newAgStackInstance(),l=this.afterCellRendererCreated.bind(this,i,s);a&&a.then(l)};r&&this.firstRender?this.beans.animationFrameService.createTask(n,this.rowNode.rowIndex,"createTasksP2"):n()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(e,t,r){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(r);return}if(this.cellRenderer=r,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),this.cellRendererGui!=null){const s=this.getParentOfValue();Or(s),s.appendChild(this.cellRendererGui)}}afterCellEditorCreated(e,t,r,i,s){if(e!==this.editorVersion){this.beans.context.destroyBean(t);return}if(t.isCancelBeforeStart&&t.isCancelBeforeStart()){this.beans.context.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){Te(`cellEditor for column ${this.column.getId()} is missing getGui() method`),this.beans.context.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();const a=i||t.isPopup!==void 0&&t.isPopup();a?this.addPopupCellEditor(r,s):this.addInCellEditor(),this.refreshEditStyles(!0,a),t.afterGuiAttached&&t.afterGuiAttached()}refreshEditStyles(e,t){var r;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),(r=this.rowCtrl)==null||r.setInlineEditingCss(e)}addInCellEditor(){const e=this.getGui();e.contains(this.beans.gos.getActiveDomElement())&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){this.beans.gos.get("editType")==="fullRow"&&Te("popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const r=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(this.beans.editService.createPopupEditorWrapper(e));const i=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&i.appendChild(this.cellEditorGui);const s=this.beans.popupService,n=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),o=t??(r.getPopupPosition?r.getPopupPosition():"over"),a=this.beans.gos.get("enableRtl"),l={ePopup:i,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:o,alignSide:a?"right":"left",keepWithinBounds:!0},c=s.positionPopupByComponent.bind(s,l),u=this.beans.localeService.getLocaleTextFunc(),d=s.addPopup({modal:n,eChild:i,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:u("ariaLabelCellEditor","Cell Editor")});d&&(this.hideEditorPopup=d.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const e=this.getGui();e.contains(this.beans.gos.getActiveDomElement())&&Zp()&&e.focus({preventScroll:!0}),Or(this.getParentOfValue())}},XY=class extends wt{constructor(e,t,r){super(),this.cellComps={},this.beans=t,this.rowCtrl=e;const i=document.createElement("div");i.setAttribute("comp-id",`${this.getCompId()}`),i.setAttribute("style",this.getInitialStyle(r)),this.setTemplateFromElement(i);const s=this.getGui(),n=s.style;this.domOrder=this.rowCtrl.getDomOrder(),li(s,"row");const o=this.rowCtrl.getTabIndex();o!=null&&s.setAttribute("tabindex",o.toString());const a={setDomOrder:l=>this.domOrder=l,setCellCtrls:l=>this.setCellCtrls(l),showFullWidth:l=>this.showFullWidth(l),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(l,c)=>this.addOrRemoveCssClass(l,c),setUserStyles:l=>jE(s,l),setTop:l=>n.top=l,setTransform:l=>n.transform=l,setRowIndex:l=>s.setAttribute("row-index",l),setRowId:l=>s.setAttribute("row-id",l),setRowBusinessKey:l=>s.setAttribute("row-business-key",l),refreshFullWidth:l=>this.refreshFullWidth(l)};e.setComp(a,this.getGui(),r),this.addDestroyFunc(()=>{e.unsetComp(r)})}getInitialStyle(e){const t=this.rowCtrl.getInitialTransform(e);return t?`transform: ${t}`:`top: ${this.rowCtrl.getInitialRowTop(e)}`}showFullWidth(e){const t=i=>{if(this.isAlive()){const s=i.getGui();this.getGui().appendChild(s),this.rowCtrl.setupDetailRowAutoHeight(s),this.setFullWidthRowComp(i)}else this.beans.context.destroyBean(i)},r=e.newAgStackInstance();r&&r.then(t)}setCellCtrls(e){const t=Object.assign({},this.cellComps);e.forEach(i=>{const s=i.getInstanceId();this.cellComps[s]==null?this.newCellComp(i):t[s]=null});const r=Nn(t).filter(i=>i!=null);this.destroyCells(r),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const t=[];e.forEach(r=>{const i=this.cellComps[r.getInstanceId()];i&&t.push(i.getGui())}),KE(this.getGui(),t)}newCellComp(e){const t=new YY(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=t,this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const e=Nn(this.cellComps).filter(t=>t!=null);this.destroyCells(e)}setFullWidthRowComp(e){this.fullWidthCellRenderer&&pt("should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(e){e.forEach(t=>{if(!t)return;const r=t.getCtrl().getInstanceId();this.cellComps[r]===t&&(t.detach(),t.destroy(),this.cellComps[r]=null)})}refreshFullWidth(e){const{fullWidthCellRenderer:t}=this;if(!t||!t.refresh)return!1;const r=e();return t.refresh(r)}},QY=class extends xe{wireBeans(e){this.ctrlsService=e.ctrlsService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.columnViewportService=e.columnViewportService}constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnSizeService.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=qc(e);if(t<=50)return;let r=this.getPinnedColumnsOverflowingViewport(t-50);const i=this.gos.getCallback("processUnpinnedColumns");r.length&&(i&&(r=i({columns:r,viewportWidth:t})),this.columnModel.setColsPinned(r,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth(),r=this.pinnedWidthService.getPinnedLeftWidth(),i=t+r;if(i<e)return[];const s=[...this.visibleColsService.getLeftCols()],n=[...this.visibleColsService.getRightCols()];let o=0,a=0;const l=0,c=[];let u=i-l-e;for(;(a<s.length||o<n.length)&&u>0;){if(o<n.length){const d=n[o++];u-=d.getActualWidth(),c.push(d)}if(a<s.length&&u>0){const d=s[a++];u-=d.getActualWidth(),c.push(d)}}return c}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=tm(e);if(this.bodyHeight!==t){this.bodyHeight=t;const r={type:"bodyHeightChanged"};this.eventService.dispatchEvent(r)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnViewportService.setScrollPosition(e,t)}},JY=class extends xe{wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",t=>{if(t.currentValue){this.enableFeature();return}this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),this.gos.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},ZY=class extends wt{constructor(){super(`
            <div class="ag-selection-checkbox" role="presentation">
                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>
            </div>`,[om]),this.eCheckbox=He}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),r=J0(e,t),[i,s]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],n=e(i,s);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${r})`)}onClicked(e,t,r){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:r.shiftKey,groupSelectsFiltered:t,event:r,source:"checkboxSelected"})}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:i=>Ia(i),click:i=>{Ia(i);const s=this.gos.get("groupSelectsFiltered"),n=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(n,s)?this.onClicked(!0,s,i||{})===0&&this.onClicked(!1,s,i):n?this.onClicked(!1,s,i):this.onClicked(!0,s,i||{})}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.gos.get("isRowSelectable")||typeof this.getIsVisible()=="function"){const i=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i}),this.addManagedListeners(this.rowNode,{dataChanged:i,cellChanged:i}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(this.eCheckbox.getPreviousValue()===void 0||e===void 0)&&this.gos.isRowModelType("clientSide")}showOrHideSelect(){var i,s,n;let e=this.rowNode.selectable;const t=this.getIsVisible();if(e)if(typeof t=="function"){const o=(i=this.overrides)==null?void 0:i.callbackParams;if(!this.column)e=t({...o,node:this.rowNode,data:this.rowNode.data});else{const a=this.column.createColumnFunctionCallbackParams(this.rowNode);e=t({...o,...a})}}else e=t??!1;if((s=this.column)==null?void 0:s.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!e),this.setVisible(!0),this.setDisplayed(!0);return}if((n=this.overrides)!=null&&n.removeHidden){this.setDisplayed(e);return}this.setVisible(e)}getIsVisible(){var e,t;return this.overrides?this.overrides.isVisible:(t=(e=this.column)==null?void 0:e.getColDef())==null?void 0:t.checkboxSelection}},eX=class extends wt{constructor(e,t,r){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=r}postConstruct(){this.getGui().appendChild(vi("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const r=()=>{try{const i=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",i),e.dataTransfer.setData("text/plain",i)}catch{}};if(t){const i=this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e});t(i)}else r()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}},tX=class extends xe{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,r=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,r,i=>this.cellComp.addOrRemoveCssClass(i,!0),i=>this.cellComp.addOrRemoveCssClass(i,!1)),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if(typeof e.cellStyle=="function"){const r=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex}),i=e.cellStyle;t=i(r)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(r=>this.cellComp.addOrRemoveCssClass(r,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(r=>this.cellComp.addOrRemoveCssClass(r,!0))}destroy(){super.destroy()}},rX=class extends xe{constructor(e,t,r,i,s){super(),this.cellCtrl=e,this.beans=t,this.rowNode=i,this.rowCtrl=s}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case ve.ENTER:this.onEnterKeyDown(e);break;case ve.F2:this.onF2KeyDown(e);break;case ve.ESCAPE:this.onEscapeKeyDown(e);break;case ve.TAB:this.onTabKeyDown(e);break;case ve.BACKSPACE:case ve.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case ve.DOWN:case ve.UP:case ve.RIGHT:case ve.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:r,beans:i,rowNode:s}=this,{gos:n,rangeService:o,eventService:a}=i;if(!r.isEditing()){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),bq(e,n.get("enableCellEditingOnBackspace"))){if(o&&n.get("enableRangeSelection"))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const l=r.getColumn(),c=this.beans.valueService.parseValue(l,s,"",s.getValueFromValueService(l))??null;s.setDataValue(l,c,"cellClear")}}else r.startRowOrCellEdit(e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?ve.UP:ve.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(ve.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(ve.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const i=e.key;i===" "?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(i,e),e.preventDefault())}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&t.isRowSelection()){const r=this.rowNode.isSelected(),i=!r;if(i||!t.get("suppressRowDeselection")){const s=this.beans.gos.get("groupSelectsFiltered"),n=this.rowNode.setSelectedParams({newValue:i,rangeSelect:e.shiftKey,groupSelectsFiltered:s,event:e,source:"spaceKey"});r===void 0&&n===0&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:s,event:e,source:"spaceKey"})}}e.preventDefault()}destroy(){super.destroy()}},iX=class extends xe{constructor(e,t,r){super(),this.cellCtrl=e,this.beans=t,this.column=r}onMouseEvent(e,t){if(!Mn(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.isDoubleClickOnIPad()){this.onCellDoubleClicked(e),e.preventDefault();return}const{eventService:t,rangeService:r,gos:i}=this.beans,s=e.ctrlKey||e.metaKey;r&&s&&r.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&r.intersectLastRange(!0);const n=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(n);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{o.onCellClicked(n)})},0),(i.get("singleClickEdit")||o.singleClickEdit)&&!i.get("suppressClickEdit")&&!(e.shiftKey&&(r==null?void 0:r.getCellRanges().length)!=0)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!$n()||xE("dblclick"))return!1;const e=new Date().getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:i}=this,{eventService:s,frameworkOverrides:n,gos:o}=r,a=t.getColDef(),l=i.createEvent(e,"cellDoubleClicked");s.dispatchEvent(l),typeof a.onCellDoubleClicked=="function"&&window.setTimeout(()=>{n.wrapOutgoing(()=>{a.onCellDoubleClicked(l)})},0),!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&i.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:r,shiftKey:i}=e,s=e.target,{cellCtrl:n,beans:o}=this,{eventService:a,rangeService:l,focusService:c,gos:u}=o;if(this.isRightClickInExistingRange(e))return;const d=l&&l.getCellRanges().length!=0;if(!i||!d){const p=u.get("enableCellTextSelection")&&e.defaultPrevented,g=(Js()||p)&&!n.isEditing()&&!em(s);n.focusCell(g)}if(i&&d&&!c.isCellFocused(n.getCellPosition())){e.preventDefault();const h=c.getFocusedCell();if(h){const{column:p,rowIndex:g,rowPinned:f}=h,m=o.rowRenderer.getRowByPosition({rowIndex:g,rowPinned:f}),v=m==null?void 0:m.getCellCtrl(p);v!=null&&v.isEditing()&&v.stopEditing(),c.setFocusedCell({column:p,rowIndex:g,rowPinned:f,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(s)){if(l){const h=this.cellCtrl.getCellPosition();if(i)l.extendLatestRangeToCell(h);else{const p=t||r;l.setRangeToCell(h,p)}}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),i=e.button===2||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(r&&i)return!0}return!1}containsWidget(e){return Sa(e,"ag-selection-checkbox",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,"cellMouseOut");this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,"cellMouseOver");this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),r=t.contains(e.target),i=t.contains(e.relatedTarget);return r&&i}destroy(){super.destroy()}},sX=class extends xe{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Uo(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(e===1)t.push(this.column);else{let r=this.column;const i=this.column.getPinned();for(let s=0;r&&s<e&&(t.push(r),r=this.beans.visibleColsService.getColAfter(r),!(!r||ut(r)||i!==r.getPinned()));s++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=ft(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()==="left")return e;const t=this.beans.visibleColsService.getColsLeftWidth();if(this.column.getPinned()==="right"){const r=this.beans.visibleColsService.getBodyContainerWidth();return t+r+(e||0)}return t+(e||0)}applyRowSpan(e){if(this.rowSpan===1&&!e)return;const r=this.beans.gos.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${r}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},dl="ag-cell-range-selected",nX="ag-cell-range-chart",oX="ag-cell-range-single-cell",aX="ag-cell-range-chart-category",lX="ag-cell-range-handle",cX="ag-cell-range-top",uX="ag-cell-range-right",dX="ag-cell-range-bottom",hX="ag-cell-range-left",fX=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(dl,this.rangeCount!==0),this.cellComp.addOrRemoveCssClass(`${dl}-1`,this.rangeCount===1),this.cellComp.addOrRemoveCssClass(`${dl}-2`,this.rangeCount===2),this.cellComp.addOrRemoveCssClass(`${dl}-3`,this.rangeCount===3),this.cellComp.addOrRemoveCssClass(`${dl}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass(nX,this.hasChartRange),Od(this.eGui,this.rangeCount>0?!0:void 0),this.cellComp.addOrRemoveCssClass(oX,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),r=!t&&e.top,i=!t&&e.right,s=!t&&e.bottom,n=!t&&e.left;this.cellComp.addOrRemoveCssClass(cX,r),this.cellComp.addOrRemoveCssClass(uX,i),this.cellComp.addOrRemoveCssClass(dX,s),this.cellComp.addOrRemoveCssClass(hX,n)}isSingleCell(){const{rangeService:e}=this.beans;return this.rangeCount===1&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(r=>xo([1,0],r.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,r=!1,i=!1,s=!1;const n=this.cellCtrl.getCellPosition().column,o=this.beans.visibleColsService;let a,l;e?(a=o.getColAfter(n),l=o.getColBefore(n)):(a=o.getColBefore(n),l=o.getColAfter(n));const c=this.rangeService.getCellRanges().filter(u=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),u));a||(s=!0),l||(r=!0);for(let u=0;u<c.length&&!(t&&r&&i&&s);u++){const d=c[u],h=this.rangeService.getRangeStartRow(d),p=this.rangeService.getRangeEndRow(d);!t&&this.beans.rowPositionUtils.sameRow(h,this.cellCtrl.getCellPosition())&&(t=!0),!i&&this.beans.rowPositionUtils.sameRow(p,this.cellCtrl.getCellPosition())&&(i=!0),!s&&a&&d.columns.indexOf(a)<0&&(s=!0),!r&&l&&d.columns.indexOf(l)<0&&(r=!0)}return{top:t,right:r,bottom:i,left:s}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass(lX,!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),r=t.length;if(this.rangeCount<1||r<1)return!1;const i=ft(t),s=this.cellCtrl.getCellPosition(),n=e.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),o=e.get("enableRangeHandle");let a=r===1&&!this.cellCtrl.isEditing()&&(n||o);if(this.hasChartRange){const c=t[0].type===1&&this.rangeService.isCellInSpecificRange(s,t[0]);this.cellComp.addOrRemoveCssClass(aX,c),a=i.type===0}return a&&i.endRow!=null&&this.rangeService.isContiguousRange(i)&&this.rangeService.isBottomRightCell(i,s)}addSelectionHandle(){const e=this.beans.gos,t=ft(this.rangeService.getCellRanges()).type,i=e.get("enableFillHandle")&&ut(t)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==i&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(i)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},pX="ag-cell",gX="ag-cell-auto-height",mX="ag-cell-normal-height",vX="ag-cell-focus",CX="ag-cell-first-right-pinned",wX="ag-cell-last-left-pinned",SX="ag-cell-not-inline-editing",yX="ag-column-hover",xX="ag-cell-wrap-text",bX=0,LF=class ng extends xe{constructor(t,r,i,s){super(),this.column=t,this.rowNode=r,this.beans=i,this.rowCtrl=s,this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.instanceId=t.getId()+"-"+bX++,this.colIdSanitised=bs(this.column.getId()),i.gos.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new sX(this,this.beans),this.addDestroyFunc(()=>{var r;(r=this.cellPositionFeature)==null||r.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new tX(this,this.beans),this.addDestroyFunc(()=>{var r;(r=this.cellCustomStyleFeature)==null||r.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new iX(this,this.beans,this.column),this.addDestroyFunc(()=>{var r;(r=this.cellMouseListenerFeature)==null||r.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new rX(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var r;(r=this.cellKeyboardListenerFeature)==null||r.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()})),this.beans.rangeService&&this.beans.gos.get("enableRangeSelection")&&(this.cellRangeFeature=new fX(this.beans,this),this.addDestroyFunc(()=>{var r;(r=this.cellRangeFeature)==null||r.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(t,r){const i=()=>{const o=this.column.getColDef(),a=this.rowNode.data;if(o.tooltipField&&ke(a))return $l(a,o.tooltipField,this.column.isTooltipFieldContainsDots());const l=o.tooltipValueGetter;return l?l(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},s=this.beans.gos.get("tooltipShowMode")==="whenTruncated";!r&&s&&!this.isCellRenderer()&&(r=()=>{const o=this.getGui(),a=o.children.length===0?o:o.querySelector(".ag-cell-value");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:t!=null?()=>t:i,getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:r};this.tooltipFeature=new Xa(n,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(t,r,i,s,n){var o,a,l,c;this.cellComp=t,this.eGui=r,this.printLayout=s,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(o=this.cellPositionFeature)==null||o.setComp(r),(a=this.cellCustomStyleFeature)==null||a.setComp(t),(l=this.tooltipFeature)==null||l.refreshToolTip(),(c=this.cellKeyboardListenerFeature)==null||c.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,r),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(u=>u()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!t)return;const r=t.parentElement,i=this.beans.gos.getRowHeightForNode(this.rowNode).height,s=a=>{if(this.editing||!this.isAlive())return;const{paddingTop:l,paddingBottom:c,borderBottomWidth:u,borderTopWidth:d}=Ko(r),h=l+c+u+d,g=t.offsetHeight+h;if(a<5){const m=this.beans.gos.getDocument(),v=!m||!m.contains(t),w=g==0;if(v||w){window.setTimeout(()=>s(a+1),0);return}}const f=Math.max(g,i);this.rowNode.setRowAutoHeight(f,this.column)},n=()=>s(0);n();const o=this.beans.resizeObserverService.observeResize(t,n);this.addDestroyFunc(()=>{o(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}getInstanceId(){return this.instanceId}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const t=this.column.getColDef();return t.cellRenderer!=null||t.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}showValue(t=!1){var s;const r=this.getValueToDisplay();let i;if(this.rowNode.stub){const n=this.createCellRendererParams();i=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),n)}else if(this.isCellRenderer()){const n=this.createCellRendererParams();i=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n)}this.cellComp.setRenderDetails(i,r,t),(s=this.cellRangeFeature)==null||s.refreshHandle()}setupControlComps(){const t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(t){return this.rowNode.rowPinned!=null?!1:typeof t=="function"||t===!0}refreshShouldDestroy(){const t=this.column.getColDef(),r=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),s=this.includeDndSource!=this.isIncludeControl(t.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return r||i||s||n}startEditing(t=null,r=!1,i=null){const{editService:s}=this.beans;if(!(!this.isCellEditable()||this.editing||!s)){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startEditing(t,r,i)});return}s.startEditing(this,t,r,i)}}setEditing(t,r){var i;this.editCompDetails=r,this.editing!==t&&(this.editing=t,(i=this.cellRangeFeature)==null||i.refreshHandle())}stopRowOrCellEdit(t=!1){this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.stopEditing(t):this.stopEditing(t)}onPopupEditorClosed(){this.editing&&this.stopEditingAndFocus()}stopEditing(t=!1){const{editService:r}=this.beans;return!this.editing||!r?!1:r.stopEditing(this,t)}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:r=>this.beans.valueService.setValue(this.rowNode,this.column,r),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(r,i,s,n)=>this.registerRowDragger(r,i,n),setTooltip:(r,i)=>{var s;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(r,i),(s=this.tooltipFeature)==null||s.refreshToolTip()}})}setFocusOutOnEditor(){var t;this.editing&&((t=this.beans.editService)==null||t.setFocusOutOnEditor(this))}setFocusInOnEditor(){var t;this.editing&&((t=this.beans.editService)==null||t.setFocusInOnEditor(this))}onCellChanged(t){t.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(t){var r;this.refreshShouldDestroy()?(r=this.rowCtrl)==null||r.recreateCell(this):this.refreshCell(t)}refreshCell(t){var u,d,h,p,g;if(this.suppressRefreshCell||this.editing)return;const r=this.column.getColDef(),i=t!=null&&!!t.newData,s=t!=null&&!!t.suppressFlash||!!r.suppressCellFlash,n=r.field==null&&r.valueGetter==null&&r.showRowGroup==null,o=t&&t.forceRefresh||n||i,a=!!this.cellComp,l=this.updateAndFormatValue(a),c=o||l;if(a){if(c){this.showValue(i);const f=(u=this.beans.filterManager)==null?void 0:u.isSuppressFlashingCellsBecauseFiltering();!s&&!f&&(this.beans.gos.get("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),(d=this.cellCustomStyleFeature)==null||d.applyUserStyles(),(h=this.cellCustomStyleFeature)==null||h.applyClassesFromColDef()}(p=this.tooltipFeature)==null||p.refreshToolTip(),(g=this.cellCustomStyleFeature)==null||g.applyCellClassRules()}}stopEditingAndFocus(t=!1,r=!1){var i;(i=this.beans.editService)==null||i.stopEditingAndFocus(this,t,r)}flashCell(t){const r=(t==null?void 0:t.flashDuration)??(t==null?void 0:t.flashDelay),i=(t==null?void 0:t.fadeDuration)??(t==null?void 0:t.fadeDelay);this.animateCell("data-changed",r,i)}animateCell(t,r,i){if(!this.cellComp)return;const s=`ag-cell-${t}`,n=`ag-cell-${t}-animation`,{gos:o}=this.beans;r||(r=o.get("cellFlashDuration")),ke(i)||(i=o.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(s,!0),this.cellComp.addOrRemoveCssClass(n,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(s,!1),this.cellComp.addOrRemoveCssClass(n,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.eGui.style.transition="")},i))},r)})}onFlashCells(t){if(!this.cellComp)return;const r=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[r]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(t){return this.callValueFormatter(t)??t}callValueFormatter(t){return this.beans.valueService.formatValue(this.column,this.rowNode,t)}updateAndFormatValue(t){const r=this.value,i=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),t?!this.valuesAreEqual(r,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(t,r){const i=this.column.getColDef();return i.equals?i.equals(t,r):t===r}getComp(){return this.cellComp}getValue(){return this.value}addDomData(){const t=this.getGui();this.beans.gos.setDomData(t,ng.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gos.setDomData(t,ng.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(t,r){return this.beans.gos.addGridCommonParams({type:r,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex})}processCharacter(t){var r;(r=this.cellKeyboardListenerFeature)==null||r.processCharacter(t)}onKeyDown(t){var r;(r=this.cellKeyboardListenerFeature)==null||r.onKeyDown(t)}onMouseEvent(t,r){var i;(i=this.cellMouseListenerFeature)==null||i.onMouseEvent(t,r)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var t;this.cellComp&&((t=this.cellPositionFeature)==null||t.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:t,column:r,beans:i}=this;RF(t,r,i.visibleColsService)}refreshAriaColIndex(){const t=this.beans.visibleColsService.getAriaColIndex(this.column);OE(this.getGui(),t)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var t;return(t=this.cellPositionFeature)==null?void 0:t.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(t,r=null){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(t,r)});return}this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,r)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return this.cellRangeFeature!=null}focusCell(t=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass(CX,t)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass(wX,t)}onCellFocused(t){if(this.beans.gos.get("suppressCellFocus"))return;const r=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp){r&&(t!=null&&t.forceBrowserFocus)&&(this.focusEventToRestore=t);return}if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass(vX,r),r&&t&&t.forceBrowserFocus){let s=this.cellComp.getFocusableElement();if(this.editing){const n=this.beans.focusService.findFocusableElements(s,null,!0);n.length&&(s=n[0])}s.focus({preventScroll:!!t.preventScrollOnBrowserFocus})}const i=this.beans.gos.get("editType")==="fullRow";!r&&!i&&this.editing&&this.stopRowOrCellEdit(),r&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:bo(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass(pX,!0),this.cellComp.addOrRemoveCssClass(SX,!0);const t=this.column.isAutoHeight()==!0;this.cellComp.addOrRemoveCssClass(gX,t),this.cellComp.addOrRemoveCssClass(mX,!t)}onColumnHover(){if(!this.cellComp||!this.beans.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass(yX,t)}onColDefChanged(){var r;if(!this.cellComp)return;this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?(r=this.beans.editService)==null||r.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0})}setWrapText(){const t=this.column.getColDef().wrapText==!0;this.cellComp.addOrRemoveCssClass(xX,t)}dispatchCellContextMenuEvent(t){const r=this.column.getColDef(),i=this.createEvent(t,"cellContextMenu");this.beans.eventService.dispatchEvent(i),r.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{r.onCellContextMenu(i)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const t=new ZY;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t}createDndSource(){const t=new eX(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t}registerRowDragger(t,r,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(t,r);return}const s=this.createRowDragComp(t,r,i);s&&(this.customRowDragComp=s,this.addDestroyFunc(()=>{this.beans.context.destroyBean(s),this.customRowDragComp=null}))}createRowDragComp(t,r,i){const s=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=this.beans.gos.isRowModelType("clientSide");if(n){if(!o){Te("managed row dragging is only allowed in the Client Side Row Model");return}if(s){Te("managed row dragging is not possible when doing pagination");return}}const a=new rg(()=>this.value,this.rowNode,this.column,t,r,i);return this.beans.context.createBean(a),a}setSuppressRefreshCell(t){this.suppressRefreshCell=t}getEditCompDetails(){return this.editCompDetails}};LF.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var Eo=LF,RX=0,NF=class og extends xe{constructor(t,r,i,s,n){var o;super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=r,this.gos=r.gos,this.rowNode=t,this.paginationPage=((o=r.paginationService)==null?void 0:o.getCurrentPage())??0,this.useAnimationFrameForCreate=s,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=t.id+"-"+RX++,this.rowId=bs(t.id),this.initRowBusinessKey(),this.rowFocused=r.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=r.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gos.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=bs(t)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getInstanceId(){return this.instanceId}updateGui(t,r){t==="left"?this.leftGui=r:t==="right"?this.rightGui=r:t==="fullWidth"?this.fullWidthGui=r:this.centerGui=r}setComp(t,r,i){const s={rowComp:t,element:r,containerType:i};this.allRowGuis.push(s),this.updateGui(i,s),this.initialiseRowComp(s),this.rowType!=="FullWidthLoading"&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){this.allRowGuis=this.allRowGuis.filter(r=>r.containerType!==t),this.updateGui(t,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(t){const r=t?"none":"";this.allRowGuis.forEach(i=>i.element.style.display=r)}initialiseRowComp(t){const r=this.gos;this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),r.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=t.rowComp;this.getInitialRowClasses(t.containerType).forEach(n=>i.addOrRemoveCssClass(n,!0)),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&Id(t.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),r.setDomData(t.element,og.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>r.setDomData(t.element,og.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t.element),this.isFullWidth()&&this.setupFullWidth(t),r.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(t){this.businessKeySanitised!=null&&t.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(t){this.rowId=bs(this.rowNode.id),this.rowId!=null&&t.setRowId(this.rowId)}executeSlideAndFadeAnimations(t){const{containerType:r}=t;this.slideInAnimation[r]&&(RS(()=>{this.onTopChanged()}),this.slideInAnimation[r]=!1),this.fadeInAnimation[r]&&(RS(()=>{t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[r]=!1)}addRowDraggerToRow(t){if(this.gos.get("enableRangeSelection")){Te("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");return}const r=this.beans.localeService.getLocaleTextFunc(),i=new rg(()=>`1 ${r("rowDragRow","row")}`,this.rowNode,void 0,t.element,void 0,!0),s=this.createBean(i,this.beans.context);this.rowDragComps.push(s)}setupFullWidth(t){const r=this.getPinnedForContainer(t.containerType);if(this.rowType=="FullWidthDetail"&&!Ur.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const i=this.createFullWidthCompDetails(t.element,r);t.rowComp.showFullWidth(i)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var t,r;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(i=>{var s;return(s=i==null?void 0:i.rowComp)==null?void 0:s.getFullWidthCellRenderer()}):[(r=(t=this.fullWidthGui)==null?void 0:t.rowComp)==null?void 0:r.getFullWidthCellRenderer()]}getCellElement(t){const r=this.getCellCtrl(t);return r?r.getGui():null}executeProcessRowPostCreateFunc(){const t=this.gos.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;const r={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};t(r)}areAllContainersReady(){const t=!!this.leftGui||!this.beans.visibleColsService.isPinningLeft(),r=!!this.centerGui,i=!!this.rightGui||!this.beans.visibleColsService.isPinningRight();return t&&r&&i}setRowType(){const t=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow"),r=this.rowNode.isFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,s=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&this.gos.isGroupUseEntireRow(s);t?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":r?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(t=!1,r=!1){if(this.isFullWidth())return;if(t||this.gos.get("suppressAnimationFrame")||this.printLayout){this.updateColumnListsImpl(r);return}this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(t,r,i=null){const s={list:[],map:{}},n=(o,a)=>{s.list.push(a),s.map[o]=a};return r.forEach(o=>{const a=o.getInstanceId();let l=t.map[a];l||(l=new Eo(o,this.rowNode,this.beans,this)),n(a,l)}),t.list.forEach(o=>{if(s.map[o.getColumn().getInstanceId()]!=null)return;if(!this.isCellEligibleToBeRemoved(o,i)){n(o.getColumn().getInstanceId(),o);return}o.destroy()}),s}updateColumnListsImpl(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)}setCellCtrls(t){this.allRowGuis.forEach(r=>{const i=this.getCellCtrlsForContainer(r.containerType);r.rowComp.setCellCtrls(i,t)})}getCellCtrlsForContainer(t){switch(t){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const t=this.beans.columnViewportService,r=this.beans.visibleColsService;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r.getAllCols()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=t.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const s=r.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");const n=r.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,n,"right")}}isCellEligibleToBeRemoved(t,r){if(t.getColumn().getPinned()!=r)return!0;const o=t.isEditing(),a=this.beans.focusService.isCellFocused(t.getCellPosition());if(o||a){const c=t.getColumn();return!(this.beans.visibleColsService.getAllCols().indexOf(c)>=0)}return!0}getDomOrder(){return this.gos.get("ensureDomOrder")||this.gos.isDomLayout("print")}listenOnDomOrder(t){const r=()=>{t.rowComp.setDomOrder(this.getDomOrder())};this.addManagedPropertyListener("domLayout",r),this.addManagedPropertyListener("ensureDomOrder",r)}setAnimateFlags(t){if(this.isSticky()||!t)return;const r=ke(this.rowNode.oldRowTop),i=this.beans.visibleColsService.isPinningLeft(),s=this.beans.visibleColsService.isPinningRight();if(r){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.slideInAnimation.fullWidth=!0;return}this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=s}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.fadeInAnimation.fullWidth=!0;return}this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=s}}isEditing(){return this.editingRow}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const t=(a,l)=>a?a.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(a.element,l).params):!0,r=t(this.fullWidthGui,null),i=t(this.centerGui,null),s=t(this.leftGui,"left"),n=t(this.rightGui,"right");return r&&i&&s&&n}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),expandedChanged:this.updateExpandedCss.bind(this),hasChildrenChanged:this.updateExpandedCss.bind(this)}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventService,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(r=>{this.addRowDraggerToRow(r)});return}this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach(t=>t.onRowIndexChanged())},cellChanged:t=>{this.getAllCellCtrls().forEach(r=>r.onCellChanged(t))}})}onRowNodeDataChanged(t){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(i=>i.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(i=>{this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const t=this.rowNode.highlighted;this.allRowGuis.forEach(r=>{const i=t===0,s=t===1;r.rowComp.addOrRemoveCssClass("ag-row-highlight-above",i),r.rowComp.addOrRemoveCssClass("ag-row-highlight-below",s)})}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),r=this.rowNode.expanded==!0;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass("ag-row-group",t),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&r),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!r),Id(i.element,t&&r)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:bo(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){const r=this.allRowGuis.find(l=>l.element.contains(t.target));if(!((r?r.element:null)===t.target))return;const n=this.rowNode,o=this.beans.focusService.getFocusedCell(),a={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o&&o.column};this.beans.navigationService.navigateToNextCell(t,t.key,a,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||Mn(t))return;const r=this.allRowGuis.find(o=>o.element.contains(t.target)),i=r?r.element:null,s=i===t.target;let n=null;s||(n=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&s||!n)&&this.beans.navigationService.onTabKeyDown(this,t)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var r;const t=(r=this.allRowGuis.find(i=>ss(i.element)))==null?void 0:r.element;return t?t.getBoundingClientRect().top:0}onFullWidthRowFocused(t){var n;const r=this.rowNode,i=t?this.isFullWidth()&&t.rowIndex===r.rowIndex&&t.rowPinned==r.rowPinned:!1,s=this.fullWidthGui?this.fullWidthGui.element:(n=this.centerGui)==null?void 0:n.element;s&&(s.classList.toggle("ag-full-width-focus",i),i&&(t!=null&&t.forceBrowserFocus)&&s.focus({preventScroll:!0}))}recreateCell(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),t.destroy(),this.updateColumnLists()}removeCellCtrl(t,r){const i={list:[],map:{}};return t.list.forEach(s=>{s!==r&&(i.list.push(s),i.map[s.getColumn().getInstanceId()]=s)}),i}onMouseEvent(t,r){switch(t){case"dblclick":this.onRowDblClick(r);break;case"click":this.onRowClick(r);break;case"touchstart":case"mousedown":this.onRowMouseDown(r);break}}createRowEvent(t,r){return this.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:r})}createRowEventWithSource(t,r){const i=this.createRowEvent(t,r);return i.source=this,i}onRowDblClick(t){if(Mn(t))return;const r=this.createRowEventWithSource("rowDoubleClicked",t);this.beans.eventService.dispatchEvent(r)}onRowMouseDown(t){if(this.lastMouseDownOnDragger=Sa(t.target,"ag-row-drag",3),!this.isFullWidth())return;const r=this.rowNode,i=this.beans.visibleColsService;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges();const s=this.getFullWidthElement(),n=t.target;let o=!0;s&&s.contains(n)&&em(n)&&(o=!1),this.beans.focusService.setFocusedCell({rowIndex:r.rowIndex,column:i.getAllCols()[0],rowPinned:r.rowPinned,forceBrowserFocus:o})}onRowClick(t){if(Mn(t)||this.lastMouseDownOnDragger)return;const i=this.createRowEventWithSource("rowClicked",t);this.beans.eventService.dispatchEvent(i);const s=t.ctrlKey||t.metaKey,n=t.shiftKey;if(this.gos.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gos.get("suppressRowClickSelection"))return;const a=this.gos.get("rowMultiSelectWithClick"),l=!this.gos.get("suppressRowDeselection"),c="rowClicked";if(this.rowNode.isSelected())a?this.rowNode.setSelectedParams({newValue:!1,event:t,source:c}):s?l&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:c}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:t,source:c});else{const u=a?!1:!s;this.rowNode.setSelectedParams({newValue:!0,clearSelection:u,rangeSelect:n,event:t,source:c})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gos.isRowSelection()}setupDetailRowAutoHeight(t){if(this.rowType!=="FullWidthDetail"||!this.gos.get("detailRowAutoHeight"))return;const r=()=>{const s=t.clientHeight;if(s!=null&&s>0){const n=()=>{this.rowNode.setRowHeight(s),this.beans.rowModel.getType()==="clientSide"?this.beans.rowModel.onRowHeightChanged():this.beans.rowModel.getType()==="serverSide"&&this.beans.rowModel.onRowHeightChanged()};window.setTimeout(n,0)}},i=this.beans.resizeObserverService.observeResize(t,r);this.addDestroyFunc(i),r()}createFullWidthCompDetails(t,r){const{gos:i,rowNode:s}=this,n=i.addGridCommonParams({fullWidth:!0,data:s.data,node:s,value:s.key,valueFormatted:s.key,eGridCell:t,eParentOfValue:t,pinned:r,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(a,l,c,u)=>this.addFullWidthRowDragging(a,l,c,u),setTooltip:(a,l)=>this.refreshRowTooltip(a,l)}),o=this.beans.userComponentFactory;switch(this.rowType){case"FullWidthDetail":return o.getFullWidthDetailCellRendererDetails(n);case"FullWidthGroup":return o.getFullWidthGroupCellRendererDetails(n);case"FullWidthLoading":return o.getFullWidthLoadingCellRendererDetails(n);default:return o.getFullWidthCellRendererDetails(n)}}refreshRowTooltip(t,r){if(!this.fullWidthGui)return;const i={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>t,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:r};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new Xa(i,this.beans))}addFullWidthRowDragging(t,r,i="",s){if(!this.isFullWidth())return;const n=new rg(()=>i,this.rowNode,void 0,t,r,s);this.createBean(n,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(n,this.beans.context)})}onUiLevelChanged(){const t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){const r="ag-row-level-"+t,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(s=>{s.rowComp.addOrRemoveCssClass(r,!0),s.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=t}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getLastRow()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),r=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==r&&(this.lastRowOnPage=r,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-last",r)))}stopEditing(t=!1){var r;this.stoppingRowEdit||(r=this.beans.rowEditService)==null||r.stopEditing(this,t)}setInlineEditingCss(t){this.allRowGuis.forEach(r=>{r.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),r.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t}startRowEditing(t=null,r=null,i=null){var s;this.editingRow||(s=this.beans.rowEditService)==null||s.startEditing(this,t,r,i)}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!t||!t.length||t.forEach(r=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(r,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(t,r){t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(r,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(t){return t==="left"||t==="right"?t:null}getInitialRowClasses(t){const r=this.getPinnedForContainer(t),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:r};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const t=this.gos.get("rowStyle");if(t&&typeof t=="function"){Te("rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");return}const r=this.gos.getCallback("getRowStyle");let i;if(r){const s={data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex};i=r(s)}return i||t?Object.assign({},t,i):this.emptyStyle}onRowSelected(t){const r=!!this.rowNode.isSelected();this.forEachGui(t,i=>{i.rowComp.addOrRemoveCssClass("ag-row-selected",r),Od(i.element,r),i.element.contains(this.gos.getActiveDomElement())&&(i===this.centerGui||i===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const t=this.rowNode.isSelected();if(t&&this.gos.get("suppressRowDeselection"))return;const i=this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(i)}addHoverFunctionality(t){if(!this.active)return;const{rowNode:r,beans:i,gos:s}=this;this.addManagedListeners(t,{mouseenter:()=>r.onMouseEnter(),mouseleave:()=>r.onMouseLeave()}),this.addManagedListeners(r,{mouseEnter:()=>{!i.dragService.isDragging()&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),r.setHovered(!0))},mouseLeave:()=>{t.classList.remove("ag-row-hover"),r.setHovered(!1)}})}roundRowTopToBounds(t){const r=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(r.top,!0)-100,s=this.applyPaginationOffset(r.bottom,!0)+100;return Math.min(Math.max(i,t),s)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(t,r){t?r(t):this.allRowGuis.forEach(r)}onRowHeightChanged(t){if(this.rowNode.rowHeight==null)return;const r=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=this.gos.isGetRowHeightFunction()?this.gos.getRowHeightForNode(this.rowNode).height:void 0,o=n?`${Math.min(i,n)-2}px`:void 0;this.forEachGui(t,a=>{a.element.style.height=`${r}px`,o&&a.element.style.setProperty("--ag-line-height",o)})}addEventListener(t,r){super.addEventListener(t,r)}removeEventListener(t,r){super.removeEventListener(t,r)}destroyFirstPass(t=!1){if(this.active=!1,!t&&this.gos.isAnimateRows()&&!this.isSticky())if(this.rowNode.rowTop!=null){const s=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(s)}else this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventService.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const t=r=>(r.list.forEach(i=>i.destroy()),{list:[],map:{}});this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)}setFocusedClasses(t){this.forEachGui(t,r=>{r.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),r.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){var r;const t=((r=this.beans.paginationService)==null?void 0:r.getCurrentPage())??0;this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(t,r=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return t;const i=this.beans.pageBoundsService.getPixelOffset();return t+i*(r?1:-1)}setRowTop(t){if(!this.printLayout&&ke(t)){const r=this.applyPaginationOffset(t),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}px`;this.setRowTopStyle(n)}}getInitialRowTop(t){return this.suppressRowTransform?this.getInitialRowTopShared(t):void 0}getInitialTransform(t){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(t)})`}getInitialRowTopShared(t){if(this.printLayout)return"";const r=this.rowNode;let i;if(this.isSticky())i=r.stickyRowTop;else{const s=this.slideInAnimation[t]?this.roundRowTopToBounds(r.oldRowTop):r.rowTop,n=this.applyPaginationOffset(s);i=r.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n)}return i+"px"}setRowTopStyle(t){this.allRowGuis.forEach(r=>this.suppressRowTransform?r.rowComp.setTop(t):r.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let r=null;return this.getAllCellCtrls().forEach(i=>{i.getColumn()==t&&(r=i)}),r!=null||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(t)>=0&&(r=i)}),r}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(t){var o;const r=this.rowNode.getRowIndexString();if(r===null)return;const i=this.beans.headerNavigationService.getHeaderRowCount()+(((o=this.beans.filterManager)==null?void 0:o.getHeaderRowCount())??0),s=this.rowNode.rowIndex%2===0,n=i+this.rowNode.rowIndex+1;this.forEachGui(t,a=>{a.rowComp.setRowIndex(r),a.rowComp.addOrRemoveCssClass("ag-row-even",s),a.rowComp.addOrRemoveCssClass("ag-row-odd",!s),IE(a.element,n)})}setStoppingRowEdit(t){this.stoppingRowEdit=t}};NF.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Fo=NF,EX=class extends xe{wireBeans(e){this.mouseEventService=e.mouseEventService,this.valueService=e.valueService,this.menuService=e.menuService,this.ctrlsService=e.ctrlsService,this.navigationService=e.navigationService,this.focusService=e.focusService,this.undoRedoService=e.undoRedoService,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService,this.clipboardService=e.clipboardService}constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",xE("touchstart")?"touchstart":"mousedown"].forEach(r=>{const i=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:i})})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||Mn(t))return;const r=this.getRowForEvent(t),i=this.mouseEventService.getRenderedCellForEvent(t);e==="contextmenu"?this.handleContextMenuMouseEvent(t,void 0,r,i):(i&&i.onMouseEvent(e,t),r&&r.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!$n())return;const e=new kn(this.element),t=r=>{const i=this.getRowForEvent(r.touchEvent),s=this.mouseEventService.getRenderedCellForEvent(r.touchEvent);this.handleContextMenuMouseEvent(void 0,r.touchEvent,i,s)};this.addManagedListeners(e,{longTap:t}),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const r=this.gos.getDomData(t,Fo.DOM_DATA_KEY_ROW_CTRL);if(r)return r;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,r,i){const s=r?r.getRowNode():null,n=i?i.getColumn():null;let o=null;if(n){const c=e||t;i.dispatchCellContextMenuEvent(c??null),o=this.valueService.getValue(n,s)}const a=this.ctrlsService.getGridBodyCtrl(),l=i?i.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:s,column:n,value:o,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:$p(this.gos,e,Eo.DOM_DATA_KEY_CELL_CTRL),rowCtrl:$p(this.gos,e,Fo.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,r){const i=e.getRowNode(),s=e.getColumn(),n=e.isEditing();if(!ig(this.gos,r,i,s,n)&&t==="keydown"&&(!n&&this.navigationService.handlePageScrollingKey(r)||e.onKeyDown(r),this.doGridOperations(r,e.isEditing()),fF(r)&&e.processCharacter(r)),t==="keydown"){const a=e.createEvent(r,"cellKeyDown");this.eventService.dispatchEvent(a)}}processFullWidthRowKeyboardEvent(e,t,r){const i=e.getRowNode(),s=this.focusService.getFocusedCell(),n=s&&s.column;if(!ig(this.gos,r,i,n,!1)){const a=r.key;if(t==="keydown")switch(a){case ve.PAGE_HOME:case ve.PAGE_END:case ve.PAGE_UP:case ve.PAGE_DOWN:this.navigationService.handlePageScrollingKey(r,!0);break;case ve.UP:case ve.DOWN:e.onKeyboardNavigate(r);break;case ve.TAB:e.onTabKeyDown(r);break}}if(t==="keydown"){const a=e.createRowEvent("cellKeyDown",r);this.eventService.dispatchEvent(a)}}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!this.mouseEventService.isEventFromThisGrid(e))return;const r=xq(e);if(r===ve.A)return this.onCtrlAndA(e);if(r===ve.C)return this.onCtrlAndC(e);if(r===ve.D)return this.onCtrlAndD(e);if(r===ve.V)return this.onCtrlAndV(e);if(r===ve.X)return this.onCtrlAndX(e);if(r===ve.Y)return this.onCtrlAndY();if(r===ve.Z)return this.onCtrlAndZ(e)}onCtrlAndA(e){const{pinnedRowModel:t,rowModel:r,rangeService:i}=this;if(i&&r.isRowsToRender()){const[s,n]=[t.isEmpty("top"),t.isEmpty("bottom")],o=s?null:"top";let a,l;n?(a=null,l=r.getRowCount()-1):(a="bottom",l=t.getPinnedBottomRowNodes().length-1);const c=this.visibleColsService.getAllCols();if(hr(c))return;i.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:l,rowEndPinned:a,columnStart:c[0],columnEnd:ft(c)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||r!=null&&r.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||r!=null&&r.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||r!=null&&r.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){!this.gos.get("undoRedoCellEditing")||!this.undoRedoService||(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){var e;(e=this.undoRedoService)==null||e.redo("ui")}},FX=class extends xe{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({leftPinnedWidthChanged:this.onPinnedLeftWidthChanged.bind(this)})}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;Wt(this.element,t),es(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},TX=class extends xe{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({rightPinnedWidthChanged:this.onPinnedRightWidthChanged.bind(this)})}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;Wt(this.element,t),es(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},Au=e=>e.getTopRowCtrls(),Pu=e=>e.getStickyTopRowCtrls(),Du=e=>e.getStickyBottomRowCtrls(),Mu=e=>e.getBottomRowCtrls(),ku=e=>e.getCentreRowCtrls(),AX={center:{type:"center",container:"ag-center-cols-container",viewport:"ag-center-cols-viewport",getRowCtrls:ku},left:{type:"left",container:"ag-pinned-left-cols-container",pinnedType:"left",getRowCtrls:ku},right:{type:"right",container:"ag-pinned-right-cols-container",pinnedType:"right",getRowCtrls:ku},fullWidth:{type:"fullWidth",container:"ag-full-width-container",fullWidth:!0,getRowCtrls:ku},topCenter:{type:"center",container:"ag-floating-top-container",viewport:"ag-floating-top-viewport",getRowCtrls:Au},topLeft:{type:"left",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Au},topRight:{type:"right",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Au},topFullWidth:{type:"fullWidth",container:"ag-floating-top-full-width-container",fullWidth:!0,getRowCtrls:Au},stickyTopCenter:{type:"center",container:"ag-sticky-top-container",viewport:"ag-sticky-top-viewport",getRowCtrls:Pu},stickyTopLeft:{type:"left",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Pu},stickyTopRight:{type:"right",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Pu},stickyTopFullWidth:{type:"fullWidth",container:"ag-sticky-top-full-width-container",fullWidth:!0,getRowCtrls:Pu},stickyBottomCenter:{type:"center",container:"ag-sticky-bottom-container",viewport:"ag-sticky-bottom-viewport",getRowCtrls:Du},stickyBottomLeft:{type:"left",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Du},stickyBottomRight:{type:"right",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Du},stickyBottomFullWidth:{type:"fullWidth",container:"ag-sticky-bottom-full-width-container",fullWidth:!0,getRowCtrls:Du},bottomCenter:{type:"center",container:"ag-floating-bottom-container",viewport:"ag-floating-bottom-viewport",getRowCtrls:Mu},bottomLeft:{type:"left",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Mu},bottomRight:{type:"right",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Mu},bottomFullWidth:{type:"fullWidth",container:"ag-floating-bottom-full-width-container",fullWidth:!0,getRowCtrls:Mu}};function BF(e){return AX[e]}var PX=["topCenter","topLeft","topRight"],DX=["bottomCenter","bottomLeft","bottomRight"],MX=["center","left","right"],kX=["center","left","right","fullWidth"],_X=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],IX=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],OX=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],GF=["stickyTopCenter","stickyTopLeft","stickyTopRight"],HF=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],LX=[...GF,"stickyTopFullWidth",...HF,"stickyBottomFullWidth"],NX=[...PX,...DX,...MX,...GF,...HF],BX=class extends xe{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.options=BF(e)}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService,this.columnViewportService=e.columnViewportService,this.resizeObserverService=e.resizeObserverService,this.rowRenderer=e.rowRenderer}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new QY(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.ctrlsService.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,r){this.comp=e,this.eContainer=t,this.eViewport=r,this.createManagedBean(new EX(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows(),this.forContainers(IX,()=>{this.pinnedWidthFeature=this.createManagedBean(new FX(this.eContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:()=>this.onPinnedWidthChanged()})}),this.forContainers(OX,()=>{this.pinnedWidthFeature=this.createManagedBean(new TX(this.eContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:()=>this.onPinnedWidthChanged()})}),this.forContainers(kX,()=>this.createManagedBean(new IF(this.eContainer,this.name==="center"?r:void 0))),this.forContainers(NX,()=>this.createManagedBean(new JY(this.eContainer))),this.forContainers(_X,()=>this.createManagedBean(new vm(i=>this.comp.setContainerWidth(`${i}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(LX.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const r=this.gos.get("ensureDomOrder"),i=this.gos.isDomLayout("print");this.comp.setDomOrder(r||i)};this.addManagedPropertyListener("domLayout",t),t()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>{const e=()=>this.eViewport.scrollLeft=0;this.addManagedElementListeners(this.eViewport,{scroll:e})})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const e=t=>{this.dragService.isDragging()&&t.cancelable&&t.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.columnViewportService.setScrollPosition(t,r,e)}getCenterWidth(){return qc(this.eViewport)}getCenterViewportScrollLeft(){return Bd(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return $E(this.eViewport)}getViewportScrollLeft(){return Bd(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||aj(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(e){this.eContainer.style.transform=`translateX(${e}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Gd(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const r=this.gos.isDomLayout("print"),s=this.gos.get("embedFullWidthRows")||r,n=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!s&&a:s||!a});this.comp.setRowCtrls({rowCtrls:n,useFlushSync:e})}};function GX(e){let t;return e.type==="center"?t=`<div class="${e.viewport}" data-ref="eViewport" role="presentation">
                <div class="${e.container}" data-ref="eContainer"></div>
            </div>`:t=`<div class="${e.container}" data-ref="eContainer"></div>`,t}var HX=class extends wt{constructor(){super(),this.eViewport=He,this.eContainer=He,this.rowComps={},this.name=wt.elementGettingCreated.getAttribute("name"),this.options=BF(this.name),this.setTemplate(GX(this.options))}wireBeans(e){this.beans=e}postConstruct(){const e={setViewportHeight:r=>this.eViewport.style.height=r,setRowCtrls:({rowCtrls:r})=>this.setRowCtrls(r),setDomOrder:r=>{this.domOrder=r},setContainerWidth:r=>this.eContainer.style.width=r,setOffsetTop:r=>this.eContainer.style.transform=`translateY(${r})`};this.createManagedBean(new BX(this.name)).setComp(e,this.eContainer,this.eViewport)}destroy(){this.setRowCtrls([]),super.destroy()}setRowCtrls(e){const t={...this.rowComps};this.rowComps={},this.lastPlacedElement=null;const r=i=>{const s=i.getInstanceId(),n=t[s];if(n)this.rowComps[s]=n,delete t[s],this.ensureDomOrder(n.getGui());else{if(!i.getRowNode().displayed)return;const o=new XY(i,this.beans,this.options.type);this.rowComps[s]=o,this.appendRow(o.getGui())}};e.forEach(r),Nn(t).forEach(i=>{this.eContainer.removeChild(i.getGui()),i.destroy()}),li(this.eContainer,"rowgroup")}appendRow(e){this.domOrder?oj(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e}ensureDomOrder(e){this.domOrder&&(UE(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)}},VX={selector:"AG-ROW-CONTAINER",component:HX};function hl(e){return e.map(t=>`<ag-row-container name="${t}"></ag-row-container>`).join("")}var WX=`<div class="ag-root ag-unselectable" role="treegrid">
        <ag-header-root></ag-header-root>
        <div class="ag-floating-top" data-ref="eTop" role="presentation">
            ${hl(["topLeft","topCenter","topRight","topFullWidth"])}
        </div>
        <div class="ag-body" data-ref="eBody" role="presentation">
            <div class="ag-body-viewport" data-ref="eBodyViewport" role="presentation">
            ${hl(["left","center","right","fullWidth"])}
            </div>
            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>
        </div>
        <div class="ag-sticky-top" data-ref="eStickyTop" role="presentation">
            ${hl(["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])}
        </div>
        <div class="ag-sticky-bottom" data-ref="eStickyBottom" role="presentation">
            ${hl(["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])}
        </div>
        <div class="ag-floating-bottom" data-ref="eBottom" role="presentation">
            ${hl(["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])}
        </div>
        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>
        <ag-overlay-wrapper></ag-overlay-wrapper>
    </div>`,zX=class extends wt{constructor(){super(WX,[HY,WY,$Y,BY,VX]),this.eBodyViewport=He,this.eStickyTop=He,this.eStickyBottom=He,this.eTop=He,this.eBottom=He,this.eBody=He}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.rangeService=e.rangeService}postConstruct(){const e=(r,i)=>{const s=`${r}px`;i.style.minHeight=s,i.style.height=s},t={setRowAnimationCssOnBodyViewport:(r,i)=>this.setRowAnimationCssOnBodyViewport(r,i),setColumnCount:r=>YK(this.getGui(),r),setRowCount:r=>qK(this.getGui(),r),setTopHeight:r=>e(r,this.eTop),setBottomHeight:r=>e(r,this.eBottom),setTopDisplay:r=>this.eTop.style.display=r,setBottomDisplay:r=>this.eBottom.style.display=r,setStickyTopHeight:r=>this.eStickyTop.style.height=r,setStickyTopTop:r=>this.eStickyTop.style.top=r,setStickyTopWidth:r=>this.eStickyTop.style.width=r,setStickyBottomHeight:r=>this.eStickyBottom.style.height=r,setStickyBottomBottom:r=>this.eStickyBottom.style.bottom=r,setStickyBottomWidth:r=>this.eStickyBottom.style.width=r,setColumnMovingCss:(r,i)=>this.addOrRemoveCssClass(r,i),updateLayoutClasses:(r,i)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(n=>{n.toggle("ag-layout-auto-height",i.autoHeight),n.toggle("ag-layout-normal",i.normal),n.toggle("ag-layout-print",i.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",i.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",i.normal),this.addOrRemoveCssClass("ag-layout-print",i.print)},setAlwaysVerticalScrollClass:(r,i)=>this.eBodyViewport.classList.toggle(OF,i),registerBodyViewportResizeListener:r=>{const i=this.resizeObserverService.observeResize(this.eBodyViewport,r);this.addDestroyFunc(()=>i())},setPinnedTopBottomOverflowY:r=>this.eTop.style.overflowY=this.eBottom.style.overflowY=r,setCellSelectableCss:(r,i)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(s=>s.classList.toggle(r,i))},setBodyViewportWidth:r=>this.eBodyViewport.style.width=r};this.ctrl=this.createManagedBean(new qY),this.ctrl.setComp(t,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&this.gos.get("enableRangeSelection")||this.gos.get("rowSelection")==="multiple")&&jK(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const r=this.eBodyViewport.classList;r.toggle("ag-row-animation",t),r.toggle("ag-row-no-animation",!t)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}},$X={selector:"AG-GRID-BODY",component:zX},UX=class extends xe{constructor(){super(...arguments),this.beanName="scrollVisibleService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnAnimationService=e.columnAnimationService}postConstruct(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)})}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}setScrollsVisible(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;const r={type:"scrollVisibilityChanged"};this.eventService.dispatchEvent(r)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}},IS="__ag_grid_instance",VF=class WF extends xe{constructor(){super(...arguments),this.beanName="mouseEventService",this.gridInstanceId=WF.gridInstanceSequence.next()}wireBeans(t){this.ctrlsService=t.ctrlsService}stampTopLevelGridCompWithGridInstance(t){t[IS]=this.gridInstanceId}getRenderedCellForEvent(t){return $p(this.gos,t.target,Eo.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(t){return this.isElementInThisGrid(t.target)}isElementInThisGrid(t){let r=t;for(;r;){const i=r[IS];if(ke(i))return i===this.gridInstanceId;r=r.parentElement}return!1}getCellPositionForEvent(t){const r=this.getRenderedCellForEvent(t);return r?r.getCellPosition():null}getNormalisedPosition(t){const r=this.gos.isDomLayout("normal"),i=t;let s,n;if(i.clientX!=null||i.clientY!=null?(s=i.clientX,n=i.clientY):(s=i.x,n=i.y),r){const o=this.ctrlsService.getGridBodyCtrl(),a=o.getScrollFeature().getVScrollPosition(),l=o.getScrollFeature().getHScrollPosition();s+=l.left,n+=a.top}return{x:s,y:n}}};VF.gridInstanceSequence=new Na;var KX=VF,jX=class extends xe{constructor(){super(),this.beanName="navigationService",this.onPageDown=ES(this.onPageDown,100),this.onPageUp=ES(this.onPageUp,100)}wireBeans(e){this.mouseEventService=e.mouseEventService,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.ctrlsService=e.ctrlsService,this.rowRenderer=e.rowRenderer,this.headerNavigationService=e.headerNavigationService,this.rowPositionUtils=e.rowPositionUtils,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,i=e.altKey,s=e.ctrlKey||e.metaKey,n=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(r){case ve.PAGE_HOME:case ve.PAGE_END:!s&&!i&&(this.onHomeOrEndKey(r),a=!0);break;case ve.LEFT:case ve.RIGHT:case ve.UP:case ve.DOWN:if(!o)return!1;s&&!i&&!n&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case ve.PAGE_DOWN:case ve.PAGE_UP:!s&&!i&&(a=this.handlePageUpDown(r,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.focusService.getFocusedCell()),t?(e===ve.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo(e){var o;const{scrollIndex:t,scrollType:r,scrollColumn:i,focusIndex:s,focusColumn:n}=e;ke(i)&&!i.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(i),ke(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,r),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(s),this.focusService.setFocusedCell({rowIndex:s,column:n,rowPinned:null,forceBrowserFocus:!0}),(o=this.rangeService)==null||o.setRangeToCell({rowIndex:s,rowPinned:null,column:n})}onPageDown(e){const r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),s=this.pageBoundsService.getPixelOffset(),n=r.top+i,o=this.rowModel.getRowIndexAtPixel(n+s);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.pageBoundsService.getPixelOffset(),s=r.top,n=this.rowModel.getRowIndexAtPixel(s+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,n,!0):this.navigateToNextPage(e,n,!0)}navigateToNextPage(e,t,r=!1){const i=this.getViewportHeight(),s=this.pageBoundsService.getFirstRow(),n=this.pageBoundsService.getLastRow(),o=this.pageBoundsService.getPixelOffset(),a=this.rowModel.getRow(e.rowIndex),l=r?(a==null?void 0:a.rowHeight)-i-o:i-o,c=(a==null?void 0:a.rowTop)+l;let u=this.rowModel.getRowIndexAtPixel(c+o);if(u===e.rowIndex){const h=r?-1:1;t=u=e.rowIndex+h}let d;r?(d="bottom",u<s&&(u=s),t<s&&(t=s)):(d="top",u>n&&(u=n),t>n&&(t=n)),this.isRowTallerThanView(u)&&(t=u,d="top"),this.navigateTo({scrollIndex:t,scrollType:d,scrollColumn:null,focusIndex:u,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const r=t?-1:1,i=this.getViewportHeight(),s=this.pageBoundsService.getLastRow();let n=0,o=e.rowIndex;for(;o>=0&&o<=s;){const a=this.rowModel.getRow(o);if(a){const l=a.rowHeight??0;if(n+l>i)break;n+=l}o+=r}return Math.max(0,Math.min(o,s))}getViewportHeight(){const{gridBodyCtrl:e,center:t}=this.ctrlsService.getParams(),r=e.getScrollFeature().getVScrollPosition(),i=this.gos.getScrollbarWidth();let s=r.bottom-r.top;return t.isHorizontalScrollShowing()&&(s-=i),s}isRowTallerThanView(e){const t=this.rowModel.getRow(e);if(!t)return!1;const r=t.rowHeight;return typeof r!="number"?!1:r>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:i}=r,s=r.column;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:s,focusIndex:i,focusColumn:s})}onHomeOrEndKey(e){const t=e===ve.PAGE_HOME,r=this.visibleColsService.getAllCols(),i=t?r[0]:ft(r),s=t?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow();this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:i,focusIndex:s,focusColumn:i})}onTabKeyDown(e,t){const r=t.shiftKey,i=this.tabToNextCellCommon(e,r,t);if(i!==!1){i&&t.preventDefault();return}if(r){const{rowIndex:s,rowPinned:n}=e.getRowPosition();(n?s===0:s===this.pageBoundsService.getFirstRow())&&(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof Eo&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(r)&&t.preventDefault()}tabToNextCell(e,t){const r=this.focusService.getFocusedCell();if(!r)return!1;let i=this.getCellByPosition(r);return!i&&(i=this.rowRenderer.getRowByPosition(r),!i||!i.isFullWidth())?!1:!!this.tabToNextCellCommon(i,e,t)}tabToNextCellCommon(e,t,r){let i=e.isEditing();if(!i&&e instanceof Eo){const o=e.getRowCtrl();o&&(i=o.isEditing())}let s;return i?this.gos.get("editType")==="fullRow"?s=this.moveToNextEditingRow(e,t,r):s=this.moveToNextEditingCell(e,t,r):s=this.moveToNextCellNotEditing(e,t),s===null?s:s||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,r=null){const i=e.getCellPosition();e.getGui().focus(),e.stopEditing();const s=this.findNextCellToFocusOn(i,t,!0);return s===!1?null:s==null?!1:(s.startEditing(null,!0,r),s.focusCell(!1),!0)}moveToNextEditingRow(e,t,r=null){const i=e.getCellPosition(),s=this.findNextCellToFocusOn(i,t,!0);if(s===!1)return null;if(s==null)return!1;const n=s.getCellPosition(),o=this.isCellEditable(i),a=this.isCellEditable(n),l=n&&i.rowIndex===n.rowIndex&&i.rowPinned===n.rowPinned;return o&&e.setFocusOutOnEditor(),l||(e.getRowCtrl().stopEditing(),s.getRowCtrl().startRowEditing(void 0,void 0,r)),a?(s.setFocusInOnEditor(),s.focusCell()):s.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const r=this.visibleColsService.getAllCols();let i;e instanceof Fo?i={...e.getRowPosition(),column:t?r[0]:ft(r)}:i=e.getCellPosition();const s=this.findNextCellToFocusOn(i,t,!1);if(s===!1)return null;if(s instanceof Eo)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s.getRowPosition(),t);return ke(s)}findNextCellToFocusOn(e,t,r){var s;let i=e;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=this.cellNavigationService.getNextTabbedCell(i,t);const n=this.gos.getCallback("tabToNextCell");if(ke(n)){const c=n({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:i||null});if(c===!0||c===null)c===null&&Te("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),i=e;else{if(c===!1)return!1;i={rowIndex:c.rowIndex,column:c.column,rowPinned:c.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const l=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l+i.rowIndex,column:i.column},fromCell:!0}),null}const o=this.gos.get("editType")==="fullRow";if(r&&!o&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const a=this.getCellByPosition(i);if(!a){const l=this.rowRenderer.getRowByPosition(i);if(!l||!l.isFullWidth()||r)continue;return l}if(!a.isSuppressNavigable())return(s=this.rangeService)==null||s.setRangeToCell(i),a}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return e.rowPinned==="top"?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):e.rowPinned==="bottom"?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.rowModel.getRow(e.rowIndex)}navigateToNextCell(e,t,r,i){let s=r,n=!1;for(;s&&(s===r||!this.isValidNavigateCell(s));)this.gos.get("enableRtl")?t===ve.LEFT&&(s=this.getLastCellOfColSpan(s)):t===ve.RIGHT&&(s=this.getLastCellOfColSpan(s)),s=this.cellNavigationService.getNextCellToFocus(t,s),n=ut(s);if(n&&e&&e.key===ve.UP&&(s={rowIndex:-1,rowPinned:null,column:r.column}),i){const a=this.gos.getCallback("navigateToNextCell");if(ke(a)){const c=a({key:t,previousCellPosition:r,nextCellPosition:s||null,event:e});ke(c)?s={rowPinned:c.rowPinned,rowIndex:c.rowIndex,column:c.column}:s=null}}if(!s)return;if(s.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+s.rowIndex,column:r.column},event:e||void 0,fromCell:!0});return}const o=this.getNormalisedPosition(s);o?this.focusPosition(o):this.tryToFocusFullWidthRow(s)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t=!1){const r=this.visibleColsService.getAllCols(),i=this.rowRenderer.getRowByPosition(e);if(!i||!i.isFullWidth())return!1;const s=this.focusService.getFocusedCell(),n={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?ft(r):r[0])};this.focusPosition(n);const o=s!=null?this.rowPositionUtils.before(n,s):!1,a={type:"fullWidthRowFocused",rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:n.column,isFullWidthCell:!0,fromBelow:o};return this.eventService.dispatchEvent(a),!0}focusPosition(e){var t;this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),(t=this.rangeService)==null||t.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const r=t.getColSpanningList();return r.length===1?e:{rowIndex:e.rowIndex,column:ft(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=this.gos.isGroupRowsSticky(),r=this.rowModel.getRow(e.rowIndex);!(t&&(r==null?void 0:r.sticky))&&ut(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}},qX=class extends xe{constructor(){super(...arguments),this.beanName="horizontalResizeService"}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(t),()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(r)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},YX=class extends xe{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.menuService=e.menuService}hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,r){this.showPopup(e,i=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:r,mouseEvent:t,ePopup:i})},r,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,r){let i=-1,s="left";const n=this.menuService.isLegacyMenuEnabled();!n&&this.gos.get("enableRtl")&&(i=1,s="right");const o=n?void 0:4*i,a=n?void 0:4;this.showPopup(e,l=>{this.popupService.positionPopupByComponent({type:r,eventSource:t,ePopup:l,nudgeX:o,nudgeY:a,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},r,t,n)}showPopup(e,t,r,i,s){const n=e?this.createBean(new aq(e,"COLUMN_MENU")):void 0;if(this.activeMenu=n,!(n!=null&&n.hasFilter())||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");li(o,"presentation"),o.classList.add("ag-menu"),s||o.classList.add("ag-filter-menu"),[this.tabListener]=this.addManagedElementListeners(o,{keydown:g=>this.trapFocusWithin(g,o)}),o.appendChild(n==null?void 0:n.getGui());let a;const l=()=>n==null?void 0:n.afterGuiDetached(),c=this.menuService.isColumnMenuAnchoringEnabled()?i??this.ctrlsService.getGridBodyCtrl().getGui():void 0,u=g=>{e.setMenuVisible(!1,"contextMenu");const f=g instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),f&&i&&ss(i)){const m=this.focusService.findTabbableParent(i);m&&m.focus()}l(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e)},d=this.localeService.getLocaleTextFunc(),h=s&&r!=="columnFilter"?d("ariaLabelColumnMenu","Column Menu"):d("ariaLabelColumnFilter","Column Filter"),p=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:u,positionCallback:()=>t(o),anchorToElement:c,ariaLabel:h});p&&(this.hidePopup=a=p.hideFunc),n.afterInit().then(()=>{t(o),n.afterGuiAttached({container:r,hidePopup:a})}),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==ve.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){const i={type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null};this.eventService.dispatchEvent(i)}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},XX=50,QX=class extends xe{constructor(){super(...arguments),this.beanName="resizeObserverService",this.polyfillFunctions=[]}observeResize(e,t){const r=this.gos.getWindow(),i=()=>{const a=new r.ResizeObserver(t);return a.observe(e),()=>a.disconnect()},s=()=>{let a=(e==null?void 0:e.clientWidth)??0,l=(e==null?void 0:e.clientHeight)??0,c=!0;const u=()=>{if(c){const d=(e==null?void 0:e.clientWidth)??0,h=(e==null?void 0:e.clientHeight)??0;(d!==a||h!==l)&&(a=d,l=h,t()),this.doNextPolyfillTurn(u)}};return u(),()=>c=!1},n=this.gos.get("suppressBrowserResizeObserver");return!!r.ResizeObserver&&!n?i():this.getFrameworkOverrides().wrapIncoming(()=>s(),"resize-observer")}doNextPolyfillTurn(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;const e=()=>{const t=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],t.forEach(r=>r())};this.polyfillScheduled=!0,window.setTimeout(e,XX)}},JX=class extends xe{constructor(){super(...arguments),this.beanName="animationFrameService",this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}setScrollTop(e){var r;const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&e===0){const i=((r=this.paginationService)==null?void 0:r.getCurrentPage())??0;i!==this.lastPage&&(this.lastPage=i,this.scrollGoingDown=!0)}this.lastScrollTop=e}postConstruct(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){this.useAnimationFrame===!1&&Te(`AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,r){this.verifyAnimationFrameOn(r);const i={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[r],i),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,i)=>r.index!==i.index?t*(i.index-r.index):i.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,r=t.list,i=this.createTasksP2,s=i.list,n=this.destroyTasks,o=new Date().getTime();let a=new Date().getTime()-o;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let d;if(r.length)this.sortTaskList(t),d=r.pop().task;else if(s.length)this.sortTaskList(i),d=s.pop().task;else if(n.length)d=n.pop();else{this.cancelledTasks.clear();break}this.cancelledTasks.has(d)||d()}a=new Date().getTime()-o}r.length||s.length||n.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=this.gos.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{if(!this.isOn()){window.setTimeout(e,0);return}t||(t=!0,this.addDestroyTask(()=>{t=!1,e()}))}}},ZX=class extends xe{constructor(){super(...arguments),this.beanName="expansionService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide"}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode(r=>{r.id&&t.has(r.id)&&(r.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode(({expanded:t,id:r})=>{t&&r&&e.push(r)}),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,r,i){e&&(r&&e.parent&&e.parent.level!==-1&&this.setRowNodeExpanded(e.parent,t,r,i),e.setExpanded(t,void 0,i))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},eQ=class extends xe{constructor(){super(...arguments),this.beanName="menuService"}wireBeans(e){this.filterMenuFactory=e.filterMenuFactory,this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.filterManager=e.filterManager,this.rowRenderer=e.rowRenderer,this.columnChooserFactory=e.columnChooserFactory,this.contextMenuFactory=e.contextMenuFactory,this.enterpriseMenuFactory=e.enterpriseMenuFactory}postConstruct(){this.activeMenuFactory=this.enterpriseMenuFactory??this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,r){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,r)}getContextMenuPosition(e,t){const r=this.getRowCtrl(e),i=this.getCellGui(r,t);if(!i)return r?{x:0,y:r.getRowYPosition()}:{x:0,y:0};const s=i.getBoundingClientRect();return{x:s.x+s.width/2,y:s.y+s.height/2}}showContextMenu(e){var n;const{rowNode:t}=e,r=e.column;let{anchorToElement:i,value:s}=e;t&&r&&s==null&&(s=t.getValueFromValueService(r)),i==null&&(i=this.getContextMenuAnchorElement(t,r)),(n=this.contextMenuFactory)==null||n.onContextMenu(e.mouseEvent??null,e.touchEvent??null,t??null,r??null,s,i)}showColumnChooser(e){var t;(t=this.columnChooserFactory)==null||t.showColumnChooser(e)}hidePopupMenu(){var e;(e=this.contextMenuFactory)==null||e.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var e;(e=this.columnChooserFactory)==null||e.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:r}=e.getColDef();return!(r??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){var t;return!e.getColDef().suppressHeaderFilterButton&&!!((t=this.filterManager)!=null&&t.isFilterAllowed(e))}isHeaderContextMenuEnabled(e){return!(e!=null&&e.getColDef().suppressHeaderContextMenu)&&this.getColumnMenuType()==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!($n()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){var t;return!!((t=this.filterManager)!=null&&t.isFilterAllowed(e))&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return this.getColumnMenuType()==="new"}isLegacyMenuEnabled(){return this.getColumnMenuType()==="legacy"}isFloatingFilterButtonEnabled(e){var i;const t=e.getColDef(),r=(i=t.floatingFilterComponentParams)==null?void 0:i.suppressFilterButton;return r!=null&&Te("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),t.suppressFloatingFilterButton==null?!r:!t.suppressFloatingFilterButton}getColumnMenuType(){return this.gos.get("columnMenu")}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?this.gos.exists("suppressMenuHide")?e:!1:e}showColumnMenuCommon(e,t,r,i){const{positionBy:s}=t,n=t.column;if(s==="button"){const{buttonElement:o}=t;e.showMenuAfterButtonClick(n,o,r,i)}else if(s==="mouse"){const{mouseEvent:o}=t;e.showMenuAfterMouseEvent(n,o,r,i)}else n&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(n,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const o=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned()).getHeaderCtrlForColumn(n);e.showMenuAfterButtonClick(n,o.getAnchorElementForMenu(i),r,!0)}))}getRowCtrl(e){const{rowIndex:t,rowPinned:r}=e||{};if(t!=null)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r})||void 0}getCellGui(e,t){if(!e||!t)return;const r=e.getCellCtrl(t);return(r==null?void 0:r.getGui())||void 0}getContextMenuAnchorElement(e,t){const r=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),i=this.getRowCtrl(e);if(!i)return r;const s=this.getCellGui(i,t);return s||(i.isFullWidth()?i.getFullWidthElement():r)}},tQ=class extends po{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const r=super.setValue(e,t);return this.eInput.value=e,r}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},rQ={selector:"AG-INPUT-TEXT-AREA",component:tQ},iQ=class extends Qa{constructor(){super(`<div class="ag-large-text">
        <ag-input-text-area data-ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>
        </div>`,[rQ]),this.eTextArea=He}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),ke(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===ve.LEFT||t===ve.UP||t===ve.RIGHT||t===ve.DOWN||e.shiftKey&&t===ve.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return!ke(e)&&!ke(this.params.value)?this.params.value:this.params.parseValue(e)}},sQ=class extends Qa{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){this.gos.setDomData(this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,r=i=>{ig(this.gos,i,t.node,t.column,!0)||t.onKeyDown(i)};this.addManagedElementListeners(e,{keydown:r})}},nQ=class extends Qa{constructor(){super(`<div class="ag-cell-edit-wrapper">
                <ag-select class="ag-cell-editor" data-ref="eSelect"></ag-select>
            </div>`,[pq]),this.eSelect=He,this.startedByEnter=!1}wireBeans(e){this.valueService=e.valueService}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:r,gos:i}=this,{values:s,value:n,eventKey:o}=e;if(ut(s)){Te("no values found for select cellEditor");return}this.startedByEnter=o!=null?o===ve.ENTER:!1;let a=!1;s.forEach(d=>{const h={value:d},p=r.formatValue(e.column,null,d),g=p!=null;h.text=g?p:d,t.addOption(h),a=a||n===d}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;l!=null&&t.setPickerGap(l),u!=null&&t.setPickerMaxHeight(u),c!=null&&t.setPickerMaxWidth(c),i.get("editType")!=="fullRow"&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}},Th=class extends Qa{constructor(e){super(`
            <div class="ag-cell-edit-wrapper">
                ${e.getTemplate()}
            </div>`,e.getAgComponents()),this.cellEditorInput=e,this.eInput=He}init(e){this.params=e;const t=this.eInput;this.cellEditorInput.init(t,e);let r;if(e.cellStartedEdit){this.focusAfterAttached=!0;const i=e.eventKey;i===ve.BACKSPACE||e.eventKey===ve.DELETE?r="":i&&i.length===1?r=i:(r=this.cellEditorInput.getStartValue(),i!==ve.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,r=this.cellEditorInput.getStartValue();r!=null&&t.setStartValue(r),this.addManagedElementListeners(t.getGui(),{keydown:i=>{const{key:s}=i;(s===ve.PAGE_UP||s===ve.PAGE_DOWN)&&i.preventDefault()}})}afterGuiAttached(){var i,s;const e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Js()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():(s=(i=this.cellEditorInput).setCaret)==null||s.call(i)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},oQ=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" data-ref="eInput"></ag-input-text-field>'}getAgComponents(){return[Eh]}init(e,t){this.eInput=e,this.params=t,t.maxLength!=null&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return!ke(e)&&!ke(this.params.value)?this.params.value:this.params.parseValue(e)}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=ke(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},zF=class extends Th{constructor(){super(new oQ)}},aQ=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" data-ref="eInput"></ag-input-number-field>'}getAgComponents(){return[Rq]}init(e,t){this.eInput=e,this.params=t,t.max!=null&&e.setMax(t.max),t.min!=null&&e.setMin(t.min),t.precision!=null&&e.setPrecision(t.precision),t.step!=null&&e.setStep(t.step);const r=e.getInputElement();t.preventStepping?e.addManagedElementListeners(r,{keydown:this.preventStepping}):t.showStepperButtons&&r.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===ve.UP||e.key===ve.DOWN)&&e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!ke(e)&&!ke(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(t==null)return t;if(typeof t=="string"){if(t==="")return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}},lQ=class extends Th{constructor(){super(new aQ)}},cQ=class extends qo{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=Js();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?ki(e??null,!1)??void 0:e;return this.min===t?this:(this.min=t,Us(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?ki(e??null,!1)??void 0:e;return this.max===t?this:(this.max=t,Us(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,Us(this.eInput,"step",e),this)}getDate(){if(this.eInput.validity.valid)return si(this.getValue())??void 0}setDate(e,t){this.setValue(ki(e??null,!1),t)}},$F={selector:"AG-INPUT-DATE-FIELD",component:cQ},uQ=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[$F]}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return!ke(e)&&!ke(this.params.value)?this.params.value:e??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return ki(e,!1)}},dQ=class extends Th{constructor(){super(new uQ)}},hQ=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[$F]}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return!ke(e)&&!ke(this.params.value)?this.params.value:this.params.parseValue(e??"")}getStartValue(){return ki(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):si(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):ki(e??null,!1)??void 0}},fQ=class extends Th{wireBeans(e){this.dataTypeService=e.dataTypeService}constructor(){super(new hQ(()=>this.dataTypeService))}},pQ=class extends Qa{constructor(){super(`
            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">
                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>
            </div>`,[om]),this.eCheckbox=He}init(e){this.params=e;const t=e.value??void 0;this.eCheckbox.setValue(t),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(this.eCheckbox,{fieldValueChanged:i=>this.setAriaLabel(i.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),r=J0(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${r})`)}},bl=class{constructor(e){this.cellValueChanges=e}},If=class extends bl{constructor(e,t,r,i){super(e),this.initialRange=t,this.finalRange=r,this.ranges=i}},gQ=10,OS=class{constructor(e){this.actionStack=[],this.maxStackSize=e||gQ,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},mQ=class extends xe{constructor(){super(...arguments),this.beanName="undoRedoService",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=this.activeCellEdit!==null&&this.cellPositionUtils.equals(this.activeCellEdit,t),i=this.activeRowEdit!==null&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(r||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:c}=e,u={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(u)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}wireBeans(e){this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.columnModel=e.columnModel,this.rangeService=e.rangeService}postConstruct(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");if(e<=0)return;this.undoStack=new OS(e),this.redoStack=new OS(e),this.addListeners();const t=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:t,newColumnsLoaded:t,columnGroupOpened:t,columnRowGroupChanged:t,columnMoved:t,columnPinned:t,columnVisible:t,rowDragEnd:t}),this.ctrlsService.whenReady(r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){const t={type:"undoStarted",source:e};this.eventService.dispatchEvent(t);const r=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),i={type:"undoEnded",source:e,operationPerformed:r};this.eventService.dispatchEvent(i)}redo(e){const t={type:"redoStarted",source:e};this.eventService.dispatchEvent(t);const r=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),i={type:"redoEnded",source:e,operationPerformed:r};this.eventService.dispatchEvent(i)}undoRedo(e,t,r,i,s){if(!e)return!1;const n=e.pop();return!n||!n.cellValueChanges?!1:(this.processAction(n,o=>o[i],s),n instanceof If?this.processRange(this.rangeService,n.ranges||[n[r]]):this.processCell(n.cellValueChanges),t.push(n),!0)}processAction(e,t,r){e.cellValueChanges.forEach(i=>{const{rowIndex:s,rowPinned:n,columnId:o}=i,a={rowIndex:s,rowPinned:n},l=this.rowPositionUtils.getRowNode(a);l.displayed&&l.setDataValue(o,t(i),r)})}processRange(e,t){let r;e.removeAllCellRanges(!0),t.forEach((i,s)=>{if(!i)return;const n=i.startRow,o=i.endRow;s===t.length-1&&(r={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(r));const a={rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};e.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:r,rowPinned:i}=t,s={rowIndex:r,rowPinned:i},n=this.rowPositionUtils.getRowNode(s),o={rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:r,columnId:i,rowPinned:s}=e,n=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getCol(i);if(!o)return;n.ensureIndexVisible(r),n.ensureColumnVisible(o);const a={rowIndex:r,column:o,rowPinned:s};this.focusService.setFocusedCell({...a,forceBrowserFocus:!0}),t==null||t.setRangeToCell(a)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new bl(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const r=new bl(this.cellValueChanges);this.pushActionsToUndoStack(r)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new bl(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new If(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;this.rangeService&&this.gos.get("enableRangeSelection")?e=new If(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):e=new bl(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}};function vQ(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition()}function CQ(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getHScrollPosition()}function UF(e,t,r="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(t,r),"ensureVisible")}function KF(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureIndexVisible(t,r),"ensureVisible")}function wQ(e,t,r=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureNodeVisible(t,r),"ensureVisible")}function SQ(e){var t;(t=e.undoRedoService)==null||t.undo("api")}function yQ(e){var t;(t=e.undoRedoService)==null||t.redo("api")}function xQ(e,t={}){return e.rowRenderer.getCellEditorInstances(t).map(Kl)}function bQ(e){return e.rowRenderer.getEditingCells()}function RQ(e,t=!1){e.rowRenderer.stopEditing(t)}function EQ(e,t){const r=e.columnModel.getCol(t.colKey);if(!r){Te(`no column found for ${t.colKey}`);return}const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:r};t.rowPinned==null&&KF(e,t.rowIndex),UF(e,t.colKey);const n=e.navigationService.getCellByPosition(i);n&&(e.focusService.isCellFocused(i)||e.focusService.setFocusedCell(i),n.startRowOrCellEdit(t.key))}function FQ(e){var t;return((t=e.undoRedoService)==null?void 0:t.getCurrentUndoStackSize())??0}function TQ(e){var t;return((t=e.undoRedoService)==null?void 0:t.getCurrentRedoStackSize())??0}var AQ=class extends xe{constructor(){super(...arguments),this.beanName="editService"}wireBeans(e){this.navigationService=e.navigationService,this.userComponentFactory=e.userComponentFactory,this.valueService=e.valueService}startEditing(e,t=null,r=!1,i=null){const s=this.createCellEditorParams(e,t,r),n=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(n,s),a=(o==null?void 0:o.popupFromSelector)!=null?o.popupFromSelector:!!n.cellEditorPopup,l=(o==null?void 0:o.popupPositionFromSelector)!=null?o.popupPositionFromSelector:n.cellEditorPopupPosition;e.setEditing(!0,o),e.getComp().setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents"));const c=e.createEvent(i,"cellEditingStarted");this.eventService.dispatchEvent(c)}stopEditing(e,t){const r=e.getComp(),{newValue:i,newValueExists:s}=this.takeValueFromCellEditor(t,r),n=e.getRowNode(),o=e.getColumn(),a=n.getValueFromValueService(o);let l=!1;s&&(l=this.saveNewValue(e,a,i,n,o)),e.setEditing(!1,void 0),r.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0});const c={...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:i,valueChanged:l};return this.eventService.dispatchEvent(c),l}handleColDefChanged(e){const t=e.getCellEditor();if(t!=null&&t.refresh){const{eventKey:r,cellStartedEdit:i}=e.getEditCompDetails().params,s=this.createCellEditorParams(e,r,i),n=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(n,s);t.refresh(o.params)}}setFocusOutOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusIn?t.focusIn():e.focusCell(!0)}stopEditingAndFocus(e,t=!1,r=!1){e.stopRowOrCellEdit(),e.focusCell(!0),t||this.navigateAfterEdit(r,e.getCellPosition())}createPopupEditorWrapper(e){return new sQ(e)}takeValueFromCellEditor(e,t){const r={newValueExists:!1};if(e)return r;const i=t.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?r:{newValue:i.getValue(),newValueExists:!0}}saveNewValue(e,t,r,i,s){if(r===t)return!1;e.setSuppressRefreshCell(!0);const n=i.setDataValue(s,r,"edit");return e.setSuppressRefreshCell(!1),n}createCellEditorParams(e,t,r){const i=e.getColumn(),s=e.getRowNode();return this.gos.addGridCommonParams({value:s.getValueFromValueService(i),eventKey:t,column:i,colDef:i.getColDef(),rowIndex:e.getCellPosition().rowIndex,node:s,data:s.data,cellStartedEdit:r,onKeyDown:e.onKeyDown.bind(e),stopEditing:e.stopEditingAndFocus.bind(e),eGridCell:e.getGui(),parseValue:n=>this.valueService.parseValue(i,s,n,e.getValue()),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const i=e?ve.UP:ve.DOWN;this.navigationService.navigateToNextCell(null,i,t,!1)}}},PQ=class extends xe{constructor(){super(...arguments),this.beanName="rowEditService"}startEditing(e,t=null,r=null,i=null){e.getAllCellCtrls().reduce((n,o)=>{const a=o===r;return a?o.startEditing(t,a,i):o.startEditing(null,a,i),n?!0:o.isEditing()},!1)&&this.setEditing(e,!0)}stopEditing(e,t=!1){const r=e.getAllCellCtrls(),i=e.isEditing();e.setStoppingRowEdit(!0);let s=!1;for(const n of r){const o=n.stopEditing(t);i&&!t&&!s&&o&&(s=!0)}if(s){const n=e.createRowEvent("rowValueChanged");this.eventService.dispatchEvent(n)}i&&this.setEditing(e,!1),e.setStoppingRowEdit(!1)}setEditing(e,t){e.setEditingRow(t),e.forEachGui(void 0,i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const r=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventService.dispatchEvent(r)}},Yo={version:Ze,moduleName:"@ag-grid-community/edit-core",beans:[AQ]},DQ={version:Ze,moduleName:"@ag-grid-community/edit-api",apiFunctions:{undoCellEditing:SQ,redoCellEditing:yQ,getCellEditorInstances:xQ,getEditingCells:bQ,stopEditing:RQ,startEditingCell:EQ,getCurrentUndoSize:FQ,getCurrentRedoSize:TQ},dependantModules:[Yo]},MQ={version:Ze,moduleName:"@ag-grid-community/undo-redo-edit",beans:[mQ],dependantModules:[Yo]},kQ={version:Ze,moduleName:"@ag-grid-community/full-row-edit",beans:[PQ],dependantModules:[Yo]},jF={version:Ze,moduleName:"@ag-grid-community/default-editor",userComponents:[{name:"agCellEditor",classImp:zF}],dependantModules:[Yo]},_Q={version:Ze,moduleName:"@ag-grid-community/data-type-editors",userComponents:[{name:"agTextCellEditor",classImp:zF},{name:"agNumberCellEditor",classImp:lQ},{name:"agDateCellEditor",classImp:dQ},{name:"agDateStringCellEditor",classImp:fQ},{name:"agCheckboxCellEditor",classImp:pQ}],dependantModules:[jF]},IQ={version:Ze,moduleName:"@ag-grid-community/select-editor",userComponents:[{name:"agSelectCellEditor",classImp:nQ}],dependantModules:[Yo]},OQ={version:Ze,moduleName:"@ag-grid-community/large-text-editor",userComponents:[{name:"agLargeTextCellEditor",classImp:iQ}],dependantModules:[Yo]},LQ={version:Ze,moduleName:"@ag-grid-community/all-editors",dependantModules:[jF,_Q,IQ,OQ]},NQ={version:Ze,moduleName:"@ag-grid-community/editing",dependantModules:[Yo,MQ,kQ,LQ,DQ]},BQ=class extends xe{constructor(){super(...arguments),this.beanName="autoWidthCalculator"}wireBeans(e){this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const i=this.rowRenderer.getAllCellsForColumn(e);return t||i.push(r),this.addElementsToContainerAndGetWidth(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const r=this.centerRowContainerCtrl.getContainerElement();e.forEach(n=>this.cloneItemIntoDummy(n,t)),r.appendChild(t);const i=t.offsetWidth;r.removeChild(t);const s=this.getAutoSizePadding();return i+s}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(r=>{const i=r.getHtmlElementForColumnHeader(e);i!=null&&(t=i)}),t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const i=document.createElement("div"),s=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(s.add("ag-header","ag-header-row"),i.style.position="static"):s.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const c=o.classList[l];c!="ag-row-position-absolute"&&s.add(c)}break}o=o.parentElement}i.appendChild(r),t.appendChild(i)}},GQ=class extends xe{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.topContainerHeight=0,this.bottomContainerHeight=0,this.extraTopHeight=0,this.extraBottomHeight=0}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.isClientSide=this.rowModel.getType()==="clientSide",this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}setOffsetTop(e){if(this.extraTopHeight===e)return;this.extraTopHeight=e;const t={type:"stickyTopOffsetChanged",offset:e};this.eventService.dispatchEvent(t)}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getExtraTopHeight(){return this.extraTopHeight}getExtraBottomHeight(){return this.extraBottomHeight}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){var t,r;if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let s=(t=e.childStore)==null?void 0:t.getStoreBounds();return e.footer&&(s=(r=e.sibling.childStore)==null?void 0:r.getStoreBounds()),((s==null?void 0:s.heightPx)??0)+((s==null?void 0:s.topPx)??0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){if(e.footer&&e.rowIndex===0)return Number.MAX_SAFE_INTEGER;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let i=e.footer?e.sibling:e;for(;i.isExpandable()&&i.expanded;)if(i.master)i=i.detailNode;else if(i.childrenAfterSort){if(i.childrenAfterSort.length===0)break;i=ft(i.childrenAfterSort)}return i.rowTop+i.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t=e==="top";let r=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,r);const i=t?this.rowRenderer.getFirstVisibleVerticalPixel()-this.extraTopHeight:this.rowRenderer.getLastVisibleVerticalPixel()-this.extraTopHeight,s=new Set,n=c=>{if(s.add(c),t){const u=this.getLastPixelOfGroup(c),d=i+r+c.rowHeight;u<d?c.stickyRowTop=r+(u-d):c.stickyRowTop=r}else{const u=this.getFirstPixelOfGroup(c),d=i-(r+c.rowHeight);u>d?c.stickyRowTop=r-(u-d):c.stickyRowTop=r}r=0,s.forEach(u=>{const d=u.stickyRowTop+u.rowHeight;r<d&&(r=d)})},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=c=>c.displayed?c.footer?o===!0||o==="grand"&&c.level===-1||o==="group"&&c.level>-1?!1:!s.has(c):c.isExpandable()?a===!0?!1:!s.has(c)&&c.expanded:!1:!1;for(let c=0;c<100;c++){let u=i+r;t||(u=i-r);const d=this.rowModel.getRowIndexAtPixel(u),h=this.rowModel.getRow(d);if(h==null)break;const g=this.getStickyAncestors(h).find(m=>(t?m.rowIndex<d:m.rowIndex>d)&&l(m));if(g){n(g);continue}if((t?h.rowTop<u:h.rowTop+h.rowHeight>u)&&l(h)){n(h);continue}break}return t||s.forEach(c=>{c.stickyRowTop=r-(c.stickyRowTop+c.rowHeight)}),this.refreshNodesAndContainerHeight(e,s,r)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(e===!0)return!0;const t=!!this.gos.get("groupIncludeFooter")||e==="group",r=!!this.gos.get("groupIncludeTotalFooter")||e==="grand";return t&&r?!0:r?"grand":t?"group":!1}canRowsBeSticky(){const e=this.gos.isGroupRowsSticky(),t=this.areFooterRowsStickySuppressed(),r=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!r)}getStickyAncestors(e){const t=[];let r=e.footer?e.sibling:e.parent;for(;r;)r.sibling&&t.push(r.sibling),t.push(r),r=r.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(r=>r.getRowNode()===e)){for(let r=0;r<this.stickyTopRowCtrls.length;r++){const i=this.stickyTopRowCtrls[r].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows();return}for(let r=0;r<this.stickyBottomRowCtrls.length;r++){const i=this.stickyBottomRowCtrls[r].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(e,t,r){const i=e==="top",s=i?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,n={},o=[];for(let h=0;h<s.length;h++){const p=s[h].getRowNode();if(!t.has(p)){n[p.id]=s[h],p.sticky=!1;continue}o.push(s[h])}const a=new Set;for(let h=0;h<o.length;h++)a.add(o[h].getRowNode());const l=[];t.forEach(h=>{a.has(h)||(h.sticky=!0,l.push(this.createRowCon(h,!1,!1)))});let c=!!l.length||o.length!==s.length;i?this.topContainerHeight!==r&&(this.topContainerHeight=r,this.gridBodyCtrl.setStickyTopHeight(r),c=!0):this.bottomContainerHeight!==r&&(this.bottomContainerHeight=r,this.gridBodyCtrl.setStickyBottomHeight(r),c=!0),this.destroyRowCtrls(n,!1);const u=[...o,...l];u.sort((h,p)=>p.getRowNode().rowIndex-h.getRowNode().rowIndex),i||u.reverse(),u.forEach(h=>h.setRowTop(h.getRowNode().stickyRowTop));let d=0;return i?(t.forEach(h=>{h.rowIndex<this.pageBoundsService.getFirstRow()&&(d+=h.rowHeight)}),d>this.topContainerHeight&&(d=this.topContainerHeight),this.setOffsetTop(d)):(t.forEach(h=>{h.rowIndex>this.pageBoundsService.getLastRow()&&(d+=h.rowHeight)}),d>this.bottomContainerHeight&&(d=this.bottomContainerHeight),this.setOffsetBottom(d)),c?(i?this.stickyTopRowCtrls=u:this.stickyBottomRowCtrls=u,!0):!1}ensureRowHeightsValid(){let e=!1;const t=r=>{const i=r.getRowNode();if(i.rowHeightEstimated){const s=this.gos.getRowHeightForNode(i);i.setRowHeight(s.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}},HQ=class extends xe{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(n=>n.onRangeSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(n=>n.updateRangeBordersIfRangeCount())},r=()=>{this.eventService.addEventListener("rangeSelectionChanged",e),this.eventService.addEventListener("columnMoved",t),this.eventService.addEventListener("columnPinned",t),this.eventService.addEventListener("columnVisible",t)},i=()=>{this.eventService.removeEventListener("rangeSelectionChanged",e),this.eventService.removeEventListener("columnMoved",t),this.eventService.removeEventListener("columnPinned",t),this.eventService.removeEventListener("columnVisible",t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListener("enableRangeSelection",n=>{n.currentValue?r():i()}),this.gos.get("enableRangeSelection")&&r()}}wireBeans(e){this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusService=e.focusService,this.beans=e,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){if(this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this)}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gos.isGroupRowsSticky()){const e=this.rowModel.getType();(e==="clientSide"||e==="serverSide")&&(this.stickyRowFeature=this.createManagedBean(new GQ(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gos.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new VQ(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=Nn(this.rowCtrlsByRowIndex),t=Nn(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>{this.onCellFocusChanged(e)},cellFocusCleared:()=>this.onCellFocusChanged(),flashCells:e=>{this.getAllCellCtrls().forEach(t=>t.onFlashCells(e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getCols().forEach(t=>{const r=l=>{this.getAllCellCtrls().forEach(c=>{c.getColumn()===t&&l(c)})},i=()=>{r(l=>l.onLeftChanged())},s=()=>{r(l=>l.onWidthChanged())},n=()=>{r(l=>l.onFirstRightPinnedChanged())},o=()=>{r(l=>l.onLastLeftPinnedChanged())},a=()=>{r(l=>l.onColDefChanged())};t.addEventListener("leftChanged",i),t.addEventListener("widthChanged",s),t.addEventListener("firstRightPinnedChanged",n),t.addEventListener("lastLeftPinnedChanged",o),t.addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.removeEventListener("leftChanged",i),t.removeEventListener("widthChanged",s),t.removeEventListener("firstRightPinnedChanged",n),t.removeEventListener("lastLeftPinnedChanged",o),t.removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=this.gos.isDomLayout("print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach(r=>{const i=r.getCellElement(e);i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowNodes()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowNodes())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){const r=Object.fromEntries(t.map(s=>[s.id,s])),i=Object.fromEntries(e.map(s=>[s.getRowNode().id,s]));for(let s=0;s<t.length;s++){const n=t[s],o=e[s];o&&r[o.getRowNode().id]===void 0&&(o.destroyFirstPass(),o.destroySecondPass()),n.id in i?(e[s]=i[n.id],delete i[n.id]):e[s]=new Fo(n,this.beans,!1,!1,this.printLayout)}e.length=t.length}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}redrawRow(e,t=!1){var r;if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else if((r=this.cachedRowCtrls)!=null&&r.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const i=s=>{const n=s[e.rowIndex];n&&n.getRowNode()===e&&(n.destroyFirstPass(),n.destroySecondPass(),s[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(e!=null){e==null||e.forEach(r=>this.redrawRow(r,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e!=null&&e.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(t==null)return null;const r=this.gos.getActiveDomElement(),i=this.gos.getDomData(r,Eo.DOM_DATA_KEY_CELL_CTRL),s=this.gos.getDomData(r,Fo.DOM_DATA_KEY_ROW_CTRL);return i||s?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&this.gos.isAnimateRows(),s=r?this.getRowsToRecycle():null;if(r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature){this.stickyRowFeature.checkStickyRows();const n=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();n&&this.updateContainerHeights(n)}this.recycleRows(s,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){var i;const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.getScrollFeature().scrollToTop(),(i=this.stickyRowFeature)==null||i.resetOffsets())}updateContainerHeights(e=0){if(this.printLayout){this.rowContainerHeightService.setModelHeight(null);return}let t=this.pageBoundsService.getCurrentPageHeight();t===0&&(t=1),this.rowContainerHeightService.setModelHeight(t+e)}getLockOnRefresh(){var e,t,r,i;if(this.refreshInProgress){const s=((t=(e=this.frameworkOverrides).getLockOnRefreshError)==null?void 0:t.call(e))??"";throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace."+s)}this.refreshInProgress=!0,(i=(r=this.frameworkOverrides).getLockOnRefresh)==null||i.call(r)}releaseLockOnRefresh(){var e,t;this.refreshInProgress=!1,(t=(e=this.frameworkOverrides).releaseLockOnRefresh)==null||t.call(e)}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&setTimeout(()=>{this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged(this.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))})}stopEditing(e=!1){this.getAllRowCtrls().forEach(t=>{t.stopEditing(e)})}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let i=0;i<r;i++){const s=t[i].getAllCellCtrls(),n=s.length;for(let o=0;o<n;o++)e.push(s[o])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],r=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const i in this.rowCtrlsByRowIndex)r.push(this.rowCtrlsByRowIndex[i]);return r}addRenderedRowListener(e,t,r){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,r)}flashCells(e={}){this.getCellCtrls(e.rowNodes,e.columns).forEach(t=>t.flashCell(e))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const r of this.getCellCtrls(e.rowNodes,e.columns))r.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=null;this.stickyRowFeature&&Zp()&&(t=this.getCellToRestoreFocusToAfterRefresh()||null);for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||this.redrawRow(r.getRowNode(),!0)}this.dispatchDisplayedRowsChanged(!1),t&&this.restoreFocusedCell(t)}getCellRendererInstances(e){var s;const t=this.getCellCtrls(e.rowNodes,e.columns).map(n=>n.getCellRenderer()).filter(n=>n!=null);if((s=e.columns)!=null&&s.length)return t;const r=[],i=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(n=>{if(i&&!this.isRowInMap(n.getRowNode(),i)||!n.isFullWidth())return;const o=n.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&r.push(l)}}),[...r,...t]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(r=>{const i=r.getCellEditor();i&&t.push(i)}),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const r=t.getCellPosition();e.push(r)}}),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(r=>{const i=r.id;switch(r.rowPinned){case"top":t.top[i]=r;break;case"bottom":t.bottom[i]=r;break;default:t.normal[i]=r;break}}),t}isRowInMap(e,t){const r=e.id;switch(e.rowPinned){case"top":return t.top[r]!=null;case"bottom":return t.bottom[r]!=null;default:return t.normal[r]!=null}}getRowCtrls(e){const t=this.mapRowNodes(e),r=this.getAllRowCtrls();return!e||!t?r:r.filter(i=>{const s=i.getRowNode();return this.isRowInMap(s,t)})}getCellCtrls(e,t){let r;ke(t)&&(r={},t.forEach(s=>{const n=this.columnModel.getCol(s);ke(n)&&(r[n.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(s=>{s.getAllCellCtrls().forEach(n=>{const o=n.getColumn().getId();r&&!r[o]||i.push(n)})}),i}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];Ei(this.rowCtrlsByRowIndex,(r,i)=>{i.getRowNode().id==null&&e.push(r)}),this.removeRowCtrls(e);const t={};return Ei(this.rowCtrlsByRowIndex,(r,i)=>{const s=i.getRowNode();t[s.id]=i}),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(r=>{const i=this.rowCtrlsByRowIndex[r];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{afterScroll:t}=e;let r;this.stickyRowFeature&&Zp()&&(r=this.getCellToRestoreFocusToAfterRefresh()||void 0);const i=this.firstRenderedRow,s=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let n=!1;if(this.stickyRowFeature){n=this.stickyRowFeature.checkStickyRows();const a=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();a&&this.updateContainerHeights(a)}const o=this.firstRenderedRow!==i||this.lastRenderedRow!==s;if(!(t&&!n&&!o)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!n),r!=null)){const a=this.getCellToRestoreFocusToAfterRefresh();r!=null&&a==null&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(e,t){const r={};e.forEach(n=>r[n]=!0);const s=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!r[n]);this.removeRowCtrls(s,t)}calculateIndexesToDraw(e){const t=Tq(this.firstRenderedRow,this.lastRenderedRow),r=(s,n)=>{const o=n.getRowNode().rowIndex;o!=null&&(o<this.firstRenderedRow||o>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(o)};Ei(this.rowCtrlsByRowIndex,r),Ei(e,r),t.sort((s,n)=>s-n);const i=[];for(let s=0;s<t.length;s++){const n=t[s],o=this.rowModel.getRow(n);o&&!o.sticky&&i.push(n)}return i}recycleRows(e,t=!1,r=!1){const i=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(i,!t),i.forEach(s=>{this.createOrUpdateRowCtrl(s,e,t,r)}),e&&(r&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){const t={type:"displayedRowsChanged",afterScroll:e};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){const e=this.visibleColsService.isPinningLeft(),t=this.visibleColsService.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const r=t.getRowNode().rowIndex;e.push(r.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const i=r.getRowNode();return!(t!=null&&!this.isRowInMap(i,t))})}createOrUpdateRowCtrl(e,t,r,i){let s,n=this.rowCtrlsByRowIndex[e];if(n||(s=this.rowModel.getRow(e),ke(s)&&ke(t)&&t[s.id]&&s.alreadyRendered&&(n=t[s.id],t[s.id]=null)),!n)if(s||(s=this.rowModel.getRow(e)),ke(s))n=this.createRowCon(s,r,i);else return;return s&&(s.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=n,n}destroyRowCtrls(e,t){const r=[];Ei(e,(i,s)=>{if(s){if(this.cachedRowCtrls&&s.isCacheable()){this.cachedRowCtrls.addRow(s);return}s.destroyFirstPass(!t),t?(this.zombieRowCtrls[s.getInstanceId()]=s,r.push(()=>{s.destroySecondPass(),delete this.zombieRowCtrls[s.getInstanceId()]})):s.destroySecondPass()}}),t&&(r.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),pK(r))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=this.gos.getRowHeightAsNumber();return e*t}workOutFirstAndLastRowsToRender(){this.rowContainerHeightService.updateOffset();let e,t;if(!this.rowModel.isRowsToRender())e=0,t=-1;else if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.pageBoundsService.getFirstRow(),t=this.pageBoundsService.getLastRow();else{const a=this.getRowBufferInPixels(),l=this.ctrlsService.getGridBodyCtrl(),c=this.gos.get("suppressRowVirtualisation");let u=!1,d,h;do{const v=this.pageBoundsService.getPixelOffset(),{pageFirstPixel:w,pageLastPixel:C}=this.pageBoundsService.getCurrentPagePixelRange(),F=this.rowContainerHeightService.getDivStretchOffset(),D=l.getScrollFeature().getVScrollPosition(),R=D.top,y=D.bottom;c?(d=w+F,h=C+F):(d=Math.max(R+v-a,w)+F,h=Math.min(y+v+a,C)+F),this.firstVisibleVPixel=Math.max(R+v,w)+F,this.lastVisibleVPixel=Math.min(y+v,C)+F,u=this.ensureAllRowsInRangeHaveHeightsCalculated(d,h)}while(u);let p=this.rowModel.getRowIndexAtPixel(d),g=this.rowModel.getRowIndexAtPixel(h);const f=this.pageBoundsService.getFirstRow(),m=this.pageBoundsService.getLastRow();p<f&&(p=f),g>m&&(g=m),e=p,t=g}const r=this.gos.isDomLayout("normal"),i=this.gos.get("suppressMaxRenderedRowRestriction"),s=Math.max(this.getRowBuffer(),500);r&&!i&&t-e>s&&(t=e+s);const n=e!==this.firstRenderedRow,o=t!==this.lastRenderedRow;if(n||o){this.firstRenderedRow=e,this.lastRenderedRow=t;const a={type:"viewportChanged",firstRow:e,lastRow:t};this.eventService.dispatchEvent(a)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const e={type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(e)})}ensureAllRowsInRangeHaveHeightsCalculated(e,t){var n,o;const r=(n=this.pinnedRowModel)==null?void 0:n.ensureRowHeightsValid(),i=(o=this.stickyRowFeature)==null?void 0:o.ensureRowHeightsValid(),s=this.rowModel.ensureRowHeightsValid(e,t,this.pageBoundsService.getFirstRow(),this.pageBoundsService.getLastRow());return(s||i)&&this.eventService.dispatchEvent({type:"recalculateRowBounds"}),i||s||r?(this.updateContainerHeights(),!0):!1}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const i=e.getRowNode(),s=this.focusService.isRowNodeFocused(i),n=e.isEditing(),o=i.detail;return s||n||o?!!this.isRowPresent(i):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.paginationService?this.paginationService.isRowPresent(e):!0:!1}createRowCon(e,t,r){const i=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(i)return i;const s=this.gos.get("suppressAnimationFrame"),n=r&&!s&&!this.printLayout;return new Fo(e,this.beans,t,n,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map(t=>t.getRowNode())}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(i=>i.getRowNode().rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.getRowNode().rowIndex===r)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}},VQ=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],jr(this.entriesList,r)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],jr(this.entriesList,e)}getEntries(){return this.entriesList}},WQ=class extends xe{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0}wireBeans(e){this.beans=e}postConstruct(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData()),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){const t=e==="top"?this.pinnedTopRows:this.pinnedBottomRows;return hr(t)}isRowsToRender(e){return!this.isEmpty(e)}getRowAtPixel(e,t){const r=t==="top"?this.pinnedTopRows:this.pinnedBottomRows;if(hr(r))return 0;for(let i=0;i<r.length;i++){const s=r[i];if(s.rowTop+s.rowHeight-1>=e)return i}return r.length-1}onGridStylesChanges(e){if(e.rowHeightChanged){const t=r=>{r.setRowHeight(r.rowHeight,!0)};this.pinnedBottomRows.forEach(t),this.pinnedTopRows.forEach(t)}}ensureRowHeightsValid(){var s,n;let e=!1,t=0;const r=o=>{if(o.rowHeightEstimated){const a=this.gos.getRowHeightForNode(o);o.setRowTop(t),o.setRowHeight(a.height),t+=a.height,e=!0}};(s=this.pinnedBottomRows)==null||s.forEach(r),t=0,(n=this.pinnedTopRows)==null||n.forEach(r);const i={type:"pinnedHeightChanged"};return this.eventService.dispatchEvent(i),e}setPinnedTopRowData(){const e=this.gos.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(e,!0);const t={type:"pinnedRowDataChanged"};this.eventService.dispatchEvent(t)}setPinnedBottomRowData(){const e=this.gos.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(e,!1);const t={type:"pinnedRowDataChanged"};this.eventService.dispatchEvent(t)}createNodesFromData(e,t){const r=[];if(e){const i=this.gos.getRowIdCallback(),s=t?Ks.ID_PREFIX_TOP_PINNED:Ks.ID_PREFIX_BOTTOM_PINNED;let n=0;const o=t?"top":"bottom";e.forEach((a,l)=>{const c=new Ks(this.beans);c.data=a,c.id=(i==null?void 0:i({data:a,level:0,rowPinned:o}))??s+this.nextId++,c.rowPinned=o,c.setRowTop(n),c.setRowHeight(this.gos.getRowHeightForNode(c).height),c.setRowIndex(l),n+=c.rowHeight,r.push(c)})}return r}getPinnedTopRowNodes(){return this.pinnedTopRows}getPinnedBottomRowNodes(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(e){return this.pinnedTopRows[e]}getPinnedBottomRow(e){return this.pinnedBottomRows[e]}forEachPinnedTopRow(e){hr(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}forEachPinnedBottomRow(e){hr(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(e){if(!e||e.length===0)return 0;const t=ft(e);return t.rowTop+t.rowHeight}},zQ=class extends xe{constructor(e){super(),this.state="needsLoading",this.version=0,this.id=e}getId(){return this.id}load(){this.state="loading",this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed",this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,r){this.successCommon(e,{rowData:t,rowCount:r})}isRequestMostRecentAndLive(e){const t=e===this.version,r=this.isAlive();return t&&r}successCommon(e,t){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}dispatchLoadCompleted(e=!0){const t={type:"loadComplete",success:e,block:this};this.dispatchLocalEvent(t)}},$Q=class extends xe{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=qr(this.performCheckBlocksToLoad.bind(this),e))}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");if(e==null)return 2;if(!(e<=0))return e}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){jr(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchLocalEvent({type:"blockLoaded"}),this.activeBlockLoadsCount==0&&this.dispatchLocalEvent({type:"blockLoaderFinished"})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){this.gos.get("debug")&&Ti("RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.getAvailableLoadingCount(),t=this.blocks.filter(r=>r.getState()==="needsLoading").slice(0,e);this.registerLoads(t.length),t.forEach(r=>r.load()),this.printCacheStatus()}getBlockState(){if(this.gos.isRowModelType("serverSide"))return this.rowModel.getBlockStates();const e={};return this.blocks.forEach(t=>{const{id:r,state:i}=t.getBlockStateJson();e[r]=i}),e}printCacheStatus(){this.gos.get("debug")&&Ti(`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return this.maxConcurrentRequests!==void 0?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}},UQ={version:Ze,moduleName:"@ag-grid-community/row-node-block",beans:[$Q]},KQ=class{constructor(){this.root=null,this.end=null,this.cachedRange=[]}init(e){this.rowModel=e}reset(){this.root=null,this.end=null,this.cachedRange.length=0}setRoot(e){this.root=e,this.end=null,this.cachedRange.length=0}setEndRange(e){this.end=e,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)}return this.cachedRange}isInRange(e){return this.root===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(){var e;return this.root&&((e=this.root)==null?void 0:e.key)===null&&(this.root=this.rowModel.getRowNode(this.root.id)??null),this.root}getEnd(){var e;return this.end&&((e=this.end)==null?void 0:e.key)===null&&(this.end=this.rowModel.getRowNode(this.end.id)??null),this.end}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const r=t[0].id===this.root.id,i=t.findIndex(s=>s.id===e.id);if(i>-1){const s=t.slice(0,i),n=t.slice(i+1);return this.setEndRange(e),r?{keep:s,discard:n}:{keep:n,discard:s}}else return{keep:t,discard:[]}}extend(e,t=!1){const r=this.getRoot();if(r==null){const s=this.getRange().slice();return t&&e.depthFirstSearch(n=>!n.group&&s.push(n)),s.push(e),this.setRoot(e),{keep:s,discard:[]}}if(this.rowModel.getNodesInRangeForSelection(r,e).find(s=>{var n;return s.id===((n=this.end)==null?void 0:n.id)}))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const s=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:s}}}},jQ=class extends xe{constructor(){super(...arguments),this.beanName="stylingService"}wireBeans(e){this.expressionService=e.expressionService}processAllCellClasses(e,t,r,i){this.processClassRules(void 0,e.cellClassRules,t,r,i),this.processStaticCellClasses(e,t,r)}processClassRules(e,t,r,i,s){if(t==null&&e==null)return;const n={},o={},a=(l,c)=>{l.split(" ").forEach(u=>{u.trim()!=""&&c(u)})};if(t){const l=Object.keys(t);for(let c=0;c<l.length;c++){const u=l[c],d=t[u];let h;typeof d=="string"?h=this.expressionService.evaluate(d,r):typeof d=="function"&&(h=d(r)),a(u,p=>{h?n[p]=!0:o[p]=!0})}}e&&s&&Object.keys(e).forEach(l=>a(l,c=>{n[c]||(o[c]=!0)})),s&&Object.keys(o).forEach(s),Object.keys(n).forEach(i)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let i;return typeof r=="function"?i=r(t):i=r,typeof i=="string"&&(i=[i]),i||[]}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach(s=>{r(s)})}},qQ=class extends xe{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:r,eBottomGuard:i,focusTrapActive:s,forceFocusOutWhenTabGuardsAreEmpty:n,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:d,handleKeyDown:h,eFocusableElement:p}=e;this.comp=t,this.eTopGuard=r,this.eBottomGuard=i,this.providedFocusInnerElement=a,this.eFocusableElement=p,this.focusTrapActive=!!s,this.forceFocusOutWhenTabGuardsAreEmpty=!!n,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.createManagedBean(new jo(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length===0){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=this.gos.getDocument(),r=this.focusService.findFocusableElements(t.body,null,!0),i=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(i===-1)return;let s,n;e?(s=0,n=i):(s=i+1,n=r.length);const o=r.slice(s,n),a=this.gos.get("tabIndex");o.sort((l,c)=>{const u=parseInt(l.getAttribute("tabindex")||"0"),d=parseInt(c.getAttribute("tabindex")||"0");return d===a?1:u===a?-1:u===0?1:d===0?-1:u-d}),o[e?o.length-1:0].focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},YQ=class extends xe{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:i}=this,s=[t,r],n={setTabIndex:f=>{s.forEach(m=>f!=null?m.setAttribute("tabindex",f):m.removeAttribute("tabindex"))}};this.addTabGuards(t,r);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}=e;this.tabGuardCtrl=this.createManagedBean(new qQ({comp:n,focusTrapActive:o,eTopGuard:t,eBottomGuard:r,eFocusableElement:i,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=this.gos.getDocument().createElement("div"),r=e==="top"?"ag-tab-guard-top":"ag-tab-guard-bottom";return t.classList.add("ag-tab-guard",r),li(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Or(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){im(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):e(t,r)}},qF=class extends wt{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new YQ(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},XQ=0,QQ=200,JQ=class extends xe{constructor(){super(...arguments),this.beanName="popupService",this.popupList=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.resizeObserverService=e.resizeObserverService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:r}=e,i=this.getPopupIndex(r);if(i!==-1){const p=this.popupList[i];p.alignedToElement=t}const s=t.getBoundingClientRect(),n=this.getParentRect(),o=this.keepXYWithinBounds(r,s.top-n.top,0),a=r.clientWidth>0?r.clientWidth:200;r.style.minWidth=`${a}px`;const c=n.right-n.left-a;let u;this.gos.get("enableRtl")?(u=h(),u<0&&(u=d(),this.setAlignedStyles(r,"left")),u>c&&(u=0,this.setAlignedStyles(r,"right"))):(u=d(),u>c&&(u=h(),this.setAlignedStyles(r,"right")),u<0&&(u=0,this.setAlignedStyles(r,"left"))),r.style.left=`${u}px`,r.style.top=`${o}px`;function d(){return s.right-n.left-2}function h(){return s.left-n.left-a}}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:i,skipObserver:s}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:!0,skipObserver:s,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:s,eventSource:n,alignSide:o="left",position:a="over",column:l,rowNode:c,type:u}=e,d=n.getBoundingClientRect(),h=this.getParentRect(),p=this.getPopupIndex(t);if(p!==-1){const f=this.popupList[p];f.alignedToElement=n}const g=()=>{let f=d.left-h.left;o==="right"&&(f-=t.offsetWidth-d.width);let m;return a==="over"?(m=d.top-h.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)==="under"?m=d.top-h.top+d.height:m=d.top-t.offsetHeight-(i||0)*2-h.top),{x:f,y:m}};this.positionPopup({ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:s,updatePosition:g,postProcessCallback:()=>this.callPostProcessPopup(u,t,n,null,l,c)})}shouldRenderUnderOrAbove(e,t,r,i){const s=r.bottom-t.bottom,n=t.top-r.top,o=e.offsetHeight+i;return s>o?"under":n>o||n>s?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const i=this.popupList[r],{alignedToElement:s}=i;!s||(["right","left","over","above","under"].forEach(o=>{s.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(s.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,r,i,s,n){const o=this.gos.getCallback("postProcessPopup");o&&o({column:s,rowNode:n,ePopup:t,type:e,eventSource:r,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:r,nudgeX:i,nudgeY:s,skipObserver:n,updatePosition:o}=e,a={width:0,height:0},l=(c=!1)=>{let{x:u,y:d}=o();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(u+=i),s&&(d+=s),r&&(u=this.keepXYWithinBounds(t,u,1),d=this.keepXYWithinBounds(t,d,0)),t.style.left=`${u}px`,t.style.top=`${d}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!n){const c=this.resizeObserverService.observeResize(t,()=>l(!0));setTimeout(()=>c(),QQ)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=this.gos.getDocument();let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),zE(t)}keepXYWithinBounds(e,t,r){const i=r===0,s=i?"clientHeight":"clientWidth",n=i?"top":"left",o=i?"height":"width",a=i?"scrollTop":"scrollLeft",l=this.gos.getDocument(),c=l.documentElement,u=this.getPopupParent(),d=e.getBoundingClientRect(),h=u.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=u===l.body,f=Math.ceil(d[o]);let v=g?(i?WE:Ld)(c)+c[a]:u[s];g&&(v-=Math.abs(p[n]-h[n]));const w=v-f;return Math.min(Math.max(t,0),Math.abs(w))}addPopup(e){const t=this.gos.getDocument(),{eChild:r,ariaLabel:i,alwaysOnTop:s,positionCallback:n,anchorToElement:o}=e;if(!t)return Te("could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(r);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(r);const l=this.createPopupWrapper(r,i,!!s),c=this.addEventListenersToPopup({...e,wrapperEl:l});return n&&n(),this.addPopupToPopupList(r,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const r=this.getPopupParent().getBoundingClientRect();ke(e.style.top)||(e.style.top=`${r.top*-1}px`),ke(e.style.left)||(e.style.left=`${r.left*-1}px`)}createPopupWrapper(e,t,r){const i=this.getPopupParent(),s=document.createElement("div");return this.environment.applyThemeClasses(s),s.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||li(e,"dialog"),Oa(e,t),s.appendChild(e),i.appendChild(s),r?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),s}handleThemeChange(e){if(e.themeChanged)for(const t of this.popupList)this.environment.applyThemeClasses(t.wrapper)}addEventListenersToPopup(e){const t=this.gos.getDocument(),r=this.getPopupParent(),{wrapperEl:i,eChild:s,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l}=e;let c=!1;const u=g=>{if(!i.contains(this.gos.getActiveDomElement()))return;g.key===ve.ESCAPE&&!Mn(g)&&p({keyboardEvent:g})},d=g=>p({mouseEvent:g}),h=g=>p({touchEvent:g}),p=(g={})=>{const{mouseEvent:f,touchEvent:m,keyboardEvent:v,forceHide:w}=g;!w&&(this.isEventFromCurrentPopup({mouseEvent:f,touchEvent:m},s)||c)||(c=!0,r.removeChild(i),t.removeEventListener("keydown",u),t.removeEventListener("mousedown",d),t.removeEventListener("touchstart",h),t.removeEventListener("contextmenu",d),this.eventService.removeEventListener("dragStarted",d),n&&n(f||m||v),this.removePopupFromPopupList(s))};return o&&o({hidePopup:p}),window.setTimeout(()=>{a&&t.addEventListener("keydown",u),l&&(t.addEventListener("mousedown",d),this.eventService.addEventListener("dragStarted",d),t.addEventListener("touchstart",h),t.addEventListener("contextmenu",d))},0),p}addPopupToPopupList(e,t,r,i){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:XQ++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const i=this.popupList[r];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(n=>n&&n()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const s=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=s,i.isAnchored=!0,s}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:i,ePopup:s}=e,n=i.getBoundingClientRect(),o=r.top-n.top,a=r.left-n.left;let l=o,c=a;const u=s.style.top,d=parseInt(u.substring(0,u.length-1),10),h=s.style.left,p=parseInt(h.substring(0,h.length-1),10),g=this.getFrameworkOverrides();return new pi(f=>{g.wrapIncoming(()=>{g.setInterval(()=>{const m=t.getBoundingClientRect(),v=i.getBoundingClientRect();if(v.top==0&&v.left==0&&v.height==0&&v.width==0){e.hidePopup();return}const C=m.top-v.top;if(C!=l){const D=this.keepXYWithinBounds(s,d+o-C,0);s.style.top=`${D}px`}l=C;const F=m.left-v.left;if(F!=c){const D=this.keepXYWithinBounds(s,p+a-F,1);s.style.left=`${D}px`}c=F},200).then(m=>{f(()=>{m!=null&&window.clearInterval(m)})})},"popupPositioning")})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:i}=e,s=r||i;if(!s)return!1;const n=this.getPopupIndex(t);if(n===-1)return!1;for(let o=n;o<this.popupList.length;o++){const a=this.popupList[o];if(oK(a.element,s))return!0}return this.isElementWithinCustomPopup(s.target)}isElementWithinCustomPopup(e){const t=this.gos.getDocument();for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=r.length,s=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),n=s.length,o=this.getWrapper(e);if(!o||i<=1||!t.contains(e))return!1;const a=r.indexOf(o),l=o.querySelectorAll("div"),c=[];l.forEach(d=>{d.scrollTop!==0&&c.push([d,d.scrollTop])});let u=!1;for(n?o.classList.contains("ag-always-on-top")?a!==i-1&&(ft(s).insertAdjacentElement("afterend",o),u=!0):a!==i-n-1&&(s[0].insertAdjacentElement("beforebegin",o),u=!0):a!==i-1&&(ft(r).insertAdjacentElement("afterend",o),u=!0);c.length;){const d=c.pop();d[0].scrollTop=d[1]}return u}},ZQ=["touchstart","touchend","touchmove","touchcancel"],YF=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t()}setInterval(e,t){return new pi(r=>{r(window.setInterval(e,t))})}addEventListener(e,t,r,i){const s=xo(ZQ,t);e.addEventListener(t,r,{capture:!!i,passive:s})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${this.frameworkName==="solid"?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},eJ=class extends xe{constructor(){super(...arguments),this.beanName="cellNavigationService"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.pinnedRowModel=e.pinnedRowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===ve.UP,i=e===ve.DOWN,s=e===ve.LEFT;let n,o;if(r||i)o=r?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow(),n=t.column;else{const a=this.visibleColsService.getAllCols(),l=this.gos.get("enableRtl");o=t.rowIndex,n=s!==l?a[0]:ft(a)}return{rowIndex:o,rowPinned:null,column:n}}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,i=!1;for(;!i;){switch(e){case ve.UP:r=this.getCellAbove(r);break;case ve.DOWN:r=this.getCellBelow(r);break;case ve.RIGHT:this.gos.get("enableRtl")?r=this.getCellToLeft(r):r=this.getCellToRight(r);break;case ve.LEFT:this.gos.get("enableRtl")?r=this.getCellToRight(r):r=this.getCellToLeft(r);break;default:r=null,Te("unknown key for navigation ",e);break}r?i=this.isCellGoodToFocusOn(r):i=!0}return r}isCellGoodToFocusOn(e){const t=e.column;let r;switch(e.rowPinned){case"top":r=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":r=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:r=this.rowModel.getRow(e.rowIndex);break}return r?!t.isSuppressNavigable(r):!1}getCellToLeft(e){if(!e)return null;const t=this.visibleColsService.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.visibleColsService.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,r=e.rowPinned;if(this.isLastRowInContainer(e))switch(r){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.pageBoundsService.getFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const i=this.rowModel.getRow(e.rowIndex),s=this.getNextStickyPosition(i);return s||{rowIndex:t+1,rowPinned:r}}getNextStickyPosition(e,t){if(!this.gos.isGroupRowsSticky()||!e||!e.sticky)return;const r=this.rowRenderer.getStickyTopRowCtrls().some(a=>a.getRowNode().rowIndex===e.rowIndex);let i=[];r?i=[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,l)=>a.getRowNode().rowIndex-l.getRowNode().rowIndex):i=[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,l)=>l.getRowNode().rowIndex-a.getRowNode().rowIndex);const s=t?-1:1,n=i.findIndex(a=>a.getRowNode().rowIndex===e.rowIndex),o=i[n+s];if(o)return{rowIndex:o.getRowNode().rowIndex,rowPinned:null}}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,r=e.rowIndex;return t==="top"?this.pinnedRowModel.getPinnedTopRowNodes().length-1<=r:t==="bottom"?this.pinnedRowModel.getPinnedBottomRowNodes().length-1<=r:this.pageBoundsService.getLastRow()<=r}getRowAbove(e){const t=e.rowIndex,r=e.rowPinned;if(r?t===0:t===this.pageBoundsService.getFirstRow())return r==="top"?null:r?this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null:this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const s=this.rowModel.getRow(e.rowIndex),n=this.getNextStickyPosition(s,!0);return n||{rowIndex:t-1,rowPinned:r}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.pageBoundsService.getLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowNodes().length-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){var n;const t=this.visibleColsService.getAllCols();let r=e.rowIndex,i=e.rowPinned,s=this.visibleColsService.getColAfter(e.column);if(!s){s=t[0];const o=this.getRowBelow(e);if(ut(o)||!o.rowPinned&&!(((n=this.paginationService)==null?void 0:n.isRowInPage(o))??!0))return null;r=o?o.rowIndex:null,i=o?o.rowPinned:null}return{rowIndex:r,column:s,rowPinned:i}}getNextTabbedCellBackwards(e){var n;const t=this.visibleColsService.getAllCols();let r=e.rowIndex,i=e.rowPinned,s=this.visibleColsService.getColBefore(e.column);if(!s){s=ft(t);const o=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(ut(o)||!o.rowPinned&&!(((n=this.paginationService)==null?void 0:n.isRowInPage(o))??!0))return null;r=o?o.rowIndex:null,i=o?o.rowPinned:null}return{rowIndex:r,column:s,rowPinned:i}}};function tJ(e,t){e.eventService.dispatchEvent(t)}var rJ=class extends xe{constructor(){super(...arguments),this.beanName="apiFunctionService",this.functions={dispatchEvent:tJ},this.isDestroyed=!1}wireBeans(e){this.beans=e}postConstruct(){this.preDestroyLink=this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}callFunction(e,t){var i;const r=this.functions[e];if(r)return r.apply(r,[this.beans,...t]);if(this.isDestroyed)return this.destroyedHandler(e);this.isFrameworkMethod(e)||(i=this.beans.validationService)==null||i.warnMissingApiFunction(e)}addFunction(e,t){const{validationService:r}=this.beans;r&&(t=r.validateApiFunction(e,t)),this.functions[e]=t}destroy(){this.functions={},this.isDestroyed=!0,super.destroy()}destroyedHandler(e){if(e==="isDestroyed")return!0;e!=="destroy"&&Te(`Grid API function ${e}() cannot be called as the grid has been destroyed.
Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${this.preDestroyLink}`)}isFrameworkMethod(e){return["preWireBeans","wireBeans","preConstruct","postConstruct"].includes(e)}};function iJ(e){const t=e.getBean("apiFunctionService");return new Proxy(t,{get(r,i){if(i!=="then")return(...s)=>r.callFunction(i,s)}})}function sJ(e){return{beanName:"gridApi",bean:iJ(e)}}var nJ=class extends xe{constructor(){super(...arguments),this.beanName="columnDefFactory"}buildColumnDefs(e,t,r){const i=[],s={};return e.forEach(n=>{const o=this.createDefFromColumn(n,t,r);let a=!0,l=o,c=n.getOriginalParent(),u=null;for(;c;){let d=null;if(c.isPadding()){c=c.getOriginalParent();continue}const h=s[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(d=this.createDefFromGroup(c),d&&(d.children=[l],s[d.groupId]=d,l=d,c=c.getOriginalParent()),c!=null&&u===c){a=!1;break}u=c}a&&i.push(l)}),i}createDefFromGroup(e){const t=qp(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,r){const i=qp(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?r.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=e.isVisible()?void 0:!0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,i}},oJ=class extends xe{constructor(){super(...arguments),this.beanName="columnEventDispatcher"}visibleCols(){const e={type:"displayedColumnsChanged"};this.eventService.dispatchEvent(e)}gridColumns(){const e={type:"gridColumnsChanged"};this.eventService.dispatchEvent(e)}headerHeight(e){const t={type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(t)}groupOpened(e){const t={type:"columnGroupOpened",columnGroup:e.length===1?e[0]:void 0,columnGroups:e};this.eventService.dispatchEvent(t)}rowGroupChanged(e,t){const r={type:"columnRowGroupChanged",columns:e,column:e.length===1?e[0]:null,source:t};this.eventService.dispatchEvent(r)}genericColumnEvent(e,t,r){const i={type:e,columns:t,column:t.length===1?t[0]:null,source:r};this.eventService.dispatchEvent(i)}pivotModeChanged(){const e={type:"columnPivotModeChanged"};this.eventService.dispatchEvent(e)}virtualColumnsChanged(e){const t={type:"virtualColumnsChanged",afterScroll:e};this.eventService.dispatchEvent(t)}newColumnsLoaded(e){const t={type:"newColumnsLoaded",source:e};this.eventService.dispatchEvent(t)}everythingChanged(e){const t={type:"columnEverythingChanged",source:e};this.eventService.dispatchEvent(t)}columnMoved(e){const{movedColumns:t,source:r,toIndex:i,finished:s}=e,n={type:"columnMoved",columns:t,column:t&&t.length===1?t[0]:null,toIndex:i,finished:s,source:r};this.eventService.dispatchEvent(n)}columnPinned(e,t){if(!e.length)return;const r=e.length===1?e[0]:null,i=this.getCommonValue(e,n=>n.getPinned()),s={type:"columnPinned",pinned:i??null,columns:e,column:r,source:t};this.eventService.dispatchEvent(s)}columnVisible(e,t){if(!e.length)return;const r=e.length===1?e[0]:null,s={type:"columnVisible",visible:this.getCommonValue(e,n=>n.isVisible()),columns:e,column:r,source:t};this.eventService.dispatchEvent(s)}getCommonValue(e,t){if(!e||e.length==0)return;const r=t(e[0]);for(let i=1;i<e.length;i++)if(r!==t(e[i]))return;return r}columnChanged(e,t,r){const i={type:e,columns:t,column:t&&t.length==1?t[0]:null,source:r};this.eventService.dispatchEvent(i)}columnResized(e,t,r,i=null){if(e&&e.length){const s={type:"columnResized",columns:e,column:e.length===1?e[0]:null,flexColumns:i,finished:t,source:r};this.eventService.dispatchEvent(s)}}},aJ=class extends xe{constructor(){super(...arguments),this.beanName="columnGetStateService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}getColumnState(){const e=this.columnModel.getColDefCols();if(ut(e)||!this.columnModel.isAlive())return[];const r=this.columnModel.getAllCols().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(r),r}createStateItemFromColumn(e){const t=this.funcColsService.getRowGroupColumns(),r=this.funcColsService.getPivotColumns(),i=e.isRowGroupActive()?t.indexOf(e):null,s=e.isPivotActive()?r.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,o=e.getSort()!=null?e.getSort():null,a=e.getSortIndex()!=null?e.getSortIndex():null,l=e.getFlex()!=null&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:o,sortIndex:a,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:i,pivot:e.isPivotActive(),pivotIndex:s,flex:l}}orderColumnStateList(e){const t=this.columnModel.getCols(),r=new Map(t.map((i,s)=>[i.getColId(),s]));e.sort((i,s)=>{const n=r.has(i.colId)?r.get(i.colId):-1,o=r.has(s.colId)?r.get(s.colId):-1;return n-o})}},lJ=class extends xe{constructor(){super(...arguments),this.beanName="columnGroupStateService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService}getColumnGroupState(){const e=[],t=this.columnModel.getColTree();return Qs(null,t,r=>{$r(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.columnModel.getColDefColTree();if(!t)return;const r=[];Qs(null,t,i=>{if($r(i)){const s=i.getColGroupDef(),n={groupId:i.getGroupId(),open:s?s.openByDefault:void 0};r.push(n)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){if(!this.columnModel.getColTree())return;this.columnAnimationService.start();const i=[];e.forEach(s=>{const n=s.groupId,o=s.open,a=this.columnModel.getProvidedColGroup(n);a&&a.isExpanded()!==o&&(a.setExpanded(o),i.push(a))}),this.visibleColsService.refresh(t,!0),i.length&&this.eventDispatcher.groupOpened(i),this.columnAnimationService.finish()}},cJ=class extends xe{constructor(){super(...arguments),this.beanName="columnViewportService",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const i=this.visibleColsService.isBodyWidthDirty();if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,this.visibleColsService.setBodyWidthDirty(),this.gos.get("enableRtl")){const n=this.visibleColsService.getBodyContainerWidth();this.viewportLeft=n-this.scrollPosition-this.scrollWidth,this.viewportRight=n-this.scrollPosition}else this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition;this.columnModel.isReady()&&this.checkViewportColumns(r)}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t];break}return r||[]}extractViewportColumns(){const e=this.visibleColsService.getCenterCols();this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),i=this.viewportLeft-200,s=this.viewportRight+200,n=t<i&&r<i,o=t>s&&r>s;return!n&&!o}getViewportColumns(){const e=this.visibleColsService.getLeftCols(),t=this.visibleColsService.getRightCols();return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.columnModel.isColSpanActive())return this.colsWithinViewport;const t=s=>{const n=s.getLeft();return ke(n)&&n>this.viewportLeft},r=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this),i=this.visibleColsService.getColsCenter();return this.visibleColsService.getColsForRow(e,i,r,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventDispatcher.virtualColumnsChanged(e)}calculateHeaderRows(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={};const e={},t=this.visibleColsService.getLeftCols(),r=this.visibleColsService.getRightCols();this.headerColsWithinViewport.concat(t).concat(r).forEach(n=>e[n.getId()]=!0);const s=(n,o,a)=>{let l=!1;for(let c=0;c<n.length;c++){const u=n[c];let d=!1;if(Bn(u))d=e[u.getId()]===!0;else{const p=u.getDisplayedChildren();p&&(d=s(p,o,a+1))}d&&(l=!0,o[a]||(o[a]=[]),o[a].push(u))}return l};s(this.visibleColsService.getTreeLeft(),this.rowsOfHeadersToRenderLeft,0),s(this.visibleColsService.getTreeRight(),this.rowsOfHeadersToRenderRight,0),s(this.visibleColsService.getTreeCenter(),this.rowsOfHeadersToRenderCenter,0)}extractViewport(){const e=i=>`${i.getId()}-${i.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}},uJ=class extends xe{constructor(){super(...arguments),this.beanName="agComponentUtils"}wireBeans(e){this.componentMetadataProvider=e.componentMetadataProvider}adaptFunction(e,t){const r=this.componentMetadataProvider.retrieve(e);return r&&r.functionAdapter?r.functionAdapter(t):null}adaptCellRendererFunction(e){class t{refresh(){return!1}getGui(){return this.eGui}init(i){const s=e(i),n=typeof s;if(n==="string"||n==="number"||n==="boolean"){this.eGui=La("<span>"+s+"</span>");return}if(s==null){this.eGui=La("<span></span>");return}this.eGui=s}}return t}doesImplementIComponent(e){return e?e.prototype&&"getGui"in e.prototype:!1}},dJ=class extends xe{constructor(){super(...arguments),this.beanName="componentMetadataProvider"}wireBeans(e){this.agComponentUtils=e.agComponentUtils}postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}},hJ=["rowPositionUtils","cellPositionUtils","headerPositionUtils","paginationAutoPageSizeService","apiFunctionService","gridApi","userComponentRegistry","agComponentUtils","componentMetadataProvider","resizeObserverService","userComponentFactory","rowContainerHeightService","horizontalResizeService","localeService","validationService","pinnedRowModel","dragService","visibleColsService","eventService","gos","popupService","selectionService","columnFilterService","quickFilterService","filterManager","columnModel","headerNavigationService","pageBoundsService","paginationService","pageBoundsListener","rowRenderer","expressionService","columnFactory","alignedGridsService","navigationService","valueCache","valueService","loggerFactory","autoWidthCalculator","filterMenuFactory","dragAndDropService","focusService","mouseEventService","environment","cellNavigationService","stylingService","scrollVisibleService","sortController","columnHoverService","columnAnimationService","selectableService","autoColService","changeDetectionService","animationFrameService","undoRedoService","columnDefFactory","rowCssClassCalculator","rowNodeBlockLoader","rowNodeSorter","ctrlsService","pinnedWidthService","rowNodeEventThrottle","ctrlsFactory","dataTypeService","syncService","overlayService","stateService","expansionService","apiEventService","ariaAnnouncementService","menuService","columnApplyStateService","columnEventDispatcher","columnMoveService","columnAutosizeService","columnGetStateService","columnGroupStateService","columnSizeService","funcColsService","columnNameService","columnViewportService","pivotResultColsService","showRowGroupColsService"],LS=Object.fromEntries(hJ.map((e,t)=>[e,t]));function fJ(e,t){const r=(e.beanName?LS[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,i=(t.beanName?LS[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return r-i}function pJ(e,t){return(e==null?void 0:e.beanName)==="gridDestroyService"?-1:0}var gJ=class extends xe{constructor(){super(...arguments),this.beanName="ctrlsFactory",this.registry={}}register(e){this.registry[e.name]=e.classImp}getInstance(e,...t){const r=this.registry[e];if(r!=null)return new r(...t)}},mJ=class extends xe{constructor(){super(...arguments),this.beanName="ctrlsService",this.params={},this.ready=!1,this.readyCallbacks=[]}checkReady(){const e=this.params;this.ready=e.gridCtrl!=null&&e.gridBodyCtrl!=null&&e.center!=null&&e.left!=null&&e.right!=null&&e.bottomCenter!=null&&e.bottomLeft!=null&&e.bottomRight!=null&&e.topCenter!=null&&e.topLeft!=null&&e.topRight!=null&&e.stickyTopCenter!=null&&e.stickyTopLeft!=null&&e.stickyTopRight!=null&&e.stickyBottomCenter!=null&&e.stickyBottomLeft!=null&&e.stickyBottomRight!=null&&e.centerHeader!=null&&e.leftHeader!=null&&e.rightHeader!=null&&e.fakeHScrollComp!=null&&e.fakeVScrollComp!=null&&e.gridHeaderCtrl!=null,this.ready&&(this.readyCallbacks.forEach(t=>t(e)),this.readyCallbacks.length=0)}whenReady(e){this.ready?e(this.params):this.readyCallbacks.push(e)}register(e,t){this.params[e]=t,this.checkReady()}registerHeaderContainer(e,t){const r=this.params;switch(t){case"left":r.leftHeader=e;break;case"right":r.rightHeader=e;break;default:r.centerHeader=e;break}this.checkReady()}get(e){return this.params[e]}getParams(){return this.params}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}},vJ=class extends xe{constructor(){super(...arguments),this.beanName="cellPositionUtils"}createId(e){const{rowIndex:t,rowPinned:r,column:i}=e;return this.createIdFromValues({rowIndex:t,column:i,rowPinned:r})}createIdFromValues(e){const{rowIndex:t,rowPinned:r,column:i}=e;return`${t}.${r??"null"}.${i.getId()}`}equals(e,t){const r=e.column===t.column,i=e.rowPinned===t.rowPinned,s=e.rowIndex===t.rowIndex;return r&&i&&s}},CJ=class extends xe{constructor(){super(...arguments),this.beanName="rowNodeEventThrottle",this.events=[]}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowModel=e.rowModel}postConstruct(){this.rowModel.getType()=="clientSide"&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(this.clientSideRowModel==null){this.eventService.dispatchEvent(e);return}this.events.push(e);const r=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(i=>this.eventService.dispatchEvent(i)),this.events=[]};t?r():(this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(r)),this.dispatchExpandedDebounced())}},wJ=class extends xe{constructor(){super(...arguments),this.beanName="rowPositionUtils"}wireBeans(e){this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.pageBoundsService=e.pageBoundsService}getFirstRow(){let e=0,t;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),t===void 0?null:{rowIndex:e,rowPinned:t}}getLastRow(){let e,t=null;const r=this.pinnedRowModel.getPinnedBottomRowCount(),i=this.pinnedRowModel.getPinnedTopRowCount();return r?(t="bottom",e=r-1):this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getLastRow()):i&&(t="top",e=i-1),e===void 0?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowNodes()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowNodes()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}before(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(ke(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}},NS={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},BS={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},GS={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},SJ=class extends xe{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.themeClasses=[],this.eThemeAncestor=null,this.eMeasurementContainer=null,this.sizesMeasured=!1}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.eGridDiv=e.eGridDiv}postConstruct(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.themeClasses=this.getAncestorThemeClasses(),this.setUpThemeClassObservers(),this.getSizeEl(NS),this.getSizeEl(BS),this.getSizeEl(GS)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(NS)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(BS)}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(GS)}hasMeasuredSizes(){return this.sizesMeasured}getThemeClasses(){return this.themeClasses}applyThemeClasses(e){for(const t of Array.from(e.classList))t.startsWith("ag-theme-")&&!this.themeClasses.includes(t)&&e.classList.remove(t);for(const t of this.themeClasses)e.classList.contains(t)||e.classList.add(t)}getThemeAncestorElement(){return this.eThemeAncestor}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(t==null||isNaN(t)||!isFinite(t))return e!==null&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const r=`${t}px`;return e!=r?(this.eGridDiv.style.setProperty("--ag-line-height",r),t):e!=""?parseFloat(e):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const r=this.measureSizeEl(e);return r==="detached"||r==="no-styles"?e.defaultValue:(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const r=t.offsetWidth;return r===HS?"no-styles":(this.sizesMeasured=!0,r)}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let r=this.eMeasurementContainer;r||(r=this.eMeasurementContainer=document.createElement("div"),r.className="ag-measurement-container",this.eGridDiv.appendChild(r)),t=document.createElement("div"),t.style.width=`var(${e.cssName}, ${HS}px)`,r.appendChild(t),this.sizeEls.set(e,t);let i=this.measureSizeEl(e);i==="no-styles"&&Te(`no value for ${e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e.defaultValue} will be used and updated when styles load.`);const s=this.resizeObserverService.observeResize(t,()=>{const n=this.measureSizeEl(e);n==="detached"||n==="no-styles"||(this.lastKnownValues.set(e,n),n!==i&&(i=n,this.fireGridStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>s()),t}fireGridStylesChangedEvent(e){const t={type:"gridStylesChanged",[e]:!0};this.eventService.dispatchEvent(t)}setUpThemeClassObservers(){const e=new MutationObserver(()=>{const r=this.getAncestorThemeClasses();yJ(r,this.themeClasses)||(this.themeClasses=r,this.fireGridStylesChangedEvent("themeChanged"))});let t=this.eGridDiv;for(;t;)e.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}getAncestorThemeClasses(){let e=this.eGridDiv;const t=[];for(this.eThemeAncestor=null;e;){const r=Array.from(e.classList).filter(i=>i.startsWith("ag-theme-"));for(const i of r)this.eThemeAncestor=e,t.includes(i)||t.unshift(i);e=e.parentElement}return Object.freeze(t)}},yJ=(e,t)=>e.length===t.length&&e.findIndex((r,i)=>e[i]!==t[i])===-1,HS=15538,xJ=class extends xe{constructor(){super(...arguments),this.beanName="eventService",this.globalEventService=new Ya}wireBeans(e){this.globalEventListener=e.globalEventListener,this.globalSyncEventListener=e.globalSyncEventListener}postConstruct(){if(this.globalEventListener){const e=this.gos.useAsyncEvents();this.addGlobalListener(this.globalEventListener,e)}this.globalSyncEventListener&&this.addGlobalListener(this.globalSyncEventListener,!1)}addEventListener(e,t,r){this.globalEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.globalEventService.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(this.gos.addGridCommonParams(e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(this.gos.addGridCommonParams(e))}},ym=class di extends xe{constructor(){super(...arguments),this.beanName="focusService"}wireBeans(t){this.eGridDiv=t.eGridDiv,this.columnModel=t.columnModel,this.visibleColsService=t.visibleColsService,this.headerNavigationService=t.headerNavigationService,this.headerPositionUtils=t.headerPositionUtils,this.rowRenderer=t.rowRenderer,this.rowPositionUtils=t.rowPositionUtils,this.cellPositionUtils=t.cellPositionUtils,this.navigationService=t.navigationService,this.ctrlsService=t.ctrlsService,this.filterManager=t.filterManager,this.rangeService=t.rangeService,this.advancedFilterService=t.advancedFilterService}static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",di.toggleKeyboardMode),t.addEventListener("mousedown",di.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",di.toggleKeyboardMode),t.addEventListener("mousedown",di.toggleKeyboardMode))}static toggleKeyboardMode(t){const r=di.keyboardModeActive,i=t.type==="keydown";i&&(t.ctrlKey||t.metaKey||t.altKey)||r!==i&&(di.keyboardModeActive=i)}static unregisterGridCompController(t){di.removeKeyboardModeEvents(t)}postConstruct(){const t=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:t,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:t,columnRowGroupChanged:t}),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(r=>{this.gridCtrl=r.gridCtrl})}registerKeyboardFocusEvents(){const t=this.gos.getDocument();di.addKeyboardModeEvents(t),di.instanceCount++,this.addDestroyFunc(()=>{di.instanceCount--,di.unregisterGridCompController(t)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const t=this.focusedCellPosition.column,r=this.columnModel.getCol(t.getId());t!==r&&this.clearFocusedCell()}isKeyboardMode(){return di.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),Fo.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),Fh.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(t,r){let i=t;for(;i;){if(this.gos.getDomData(i,r))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(t){return this.isCellRestoreFocused(t)?(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0):!1}isCellRestoreFocused(t){return this.restoredFocusedCellPosition==null?!1:this.cellPositionUtils.equals(t,this.restoredFocusedCellPosition)}setRestoreFocusedCell(t){this.getFrameworkOverrides().renderingEngine==="react"&&(this.restoredFocusedCellPosition=t)}getFocusEventParams(){const{rowIndex:t,rowPinned:r,column:i}=this.focusedCellPosition,s={rowIndex:t,rowPinned:r,column:i,isFullWidthCell:!1},n=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return n&&(s.isFullWidthCell=n.isFullWidth()),s}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,this.focusedCellPosition==null)return;const t={type:"cellFocusCleared",...this.getFocusEventParams()};this.focusedCellPosition=null,this.eventService.dispatchEvent(t)}setFocusedCell(t){const{column:r,rowIndex:i,rowPinned:s,forceBrowserFocus:n=!1,preventScrollOnBrowserFocus:o=!1}=t,a=this.columnModel.getCol(r);if(!a){this.focusedCellPosition=null;return}this.focusedCellPosition=a?{rowIndex:i,rowPinned:bo(s),column:a}:null;const l={type:"cellFocused",...this.getFocusEventParams(),forceBrowserFocus:n,preventScrollOnBrowserFocus:o};this.eventService.dispatchEvent(l)}isCellFocused(t){return this.focusedCellPosition==null?!1:this.cellPositionUtils.equals(t,this.focusedCellPosition)}isRowNodeFocused(t){return this.isRowFocused(t.rowIndex,t.rowPinned)}isHeaderWrapperFocused(t){if(this.focusedHeaderPosition==null)return!1;const r=t.getColumnGroupChild(),i=t.getRowIndex(),s=t.getPinned(),{column:n,headerRowIndex:o}=this.focusedHeaderPosition;return r===n&&i===o&&s==n.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(t,r){this.focusedHeaderPosition={headerRowIndex:t,column:r}}focusHeaderPosition(t){var c;if(this.gos.get("suppressHeaderFocus"))return!1;const{direction:r,fromTab:i,allowUserOverride:s,event:n,fromCell:o,rowWithoutSpanValue:a}=t;let{headerPosition:l}=t;if(o&&((c=this.filterManager)!=null&&c.isAdvancedFilterHeaderActive()))return this.focusAdvancedFilter(l);if(s){const u=this.getFocusedHeader(),d=this.headerNavigationService.getHeaderRowCount();if(i){const h=this.gos.getCallback("tabToNextHeader");h&&(l=this.getHeaderPositionFromUserFunc({userFunc:h,direction:r,currentPosition:u,headerPosition:l,headerRowCount:d}))}else{const h=this.gos.getCallback("navigateToNextHeader");if(h&&n){const p={key:n.key,previousHeaderPosition:u,nextHeaderPosition:l,headerRowCount:d,event:n};l=h(p)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:r,event:n,fromCell:o,rowWithoutSpanValue:a}):!1}focusHeaderPositionFromUserFunc(t){if(this.gos.get("suppressHeaderFocus"))return!1;const{userFunc:r,headerPosition:i,direction:s,event:n}=t,o=this.getFocusedHeader(),a=this.headerNavigationService.getHeaderRowCount(),l=this.getHeaderPositionFromUserFunc({userFunc:r,direction:s,currentPosition:o,headerPosition:i,headerRowCount:a});return!!l&&this.focusProvidedHeaderPosition({headerPosition:l,direction:s,event:n})}getHeaderPositionFromUserFunc(t){const{userFunc:r,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o}=t,l=r({backwards:i==="Before",previousHeaderPosition:s,nextHeaderPosition:n,headerRowCount:o});return l===!0||l===null?(l===null&&Te("Since v31.3 Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),s):l===!1?null:l}focusProvidedHeaderPosition(t){var d;const{headerPosition:r,direction:i,fromCell:s,rowWithoutSpanValue:n,event:o}=t,{column:a,headerRowIndex:l}=r;if(l===-1)return(d=this.filterManager)!=null&&d.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(r):this.focusGridView(a);this.headerNavigationService.scrollToColumn(a,i);const u=this.ctrlsService.getHeaderRowContainerCtrl(a.getPinned()).focusHeader(r.headerRowIndex,a,o);return u&&(n!=null||s)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(n??-1),u}focusFirstHeader(){let t=this.visibleColsService.getAllCols()[0];if(!t)return!1;t.getParent()&&(t=this.visibleColsService.getColGroupAtLevel(t,0));const r=this.headerPositionUtils.getHeaderIndexToFocus(t,0);return this.focusHeaderPosition({headerPosition:r,rowWithoutSpanValue:0})}focusLastHeader(t){const r=this.headerNavigationService.getHeaderRowCount()-1,i=ft(this.visibleColsService.getAllCols());return this.focusHeaderPosition({headerPosition:{headerRowIndex:r,column:i},rowWithoutSpanValue:-1,event:t})}focusPreviousFromFirstCell(t){var r;return(r=this.filterManager)!=null&&r.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(t,r){return this.focusedCellPosition==null?!1:this.focusedCellPosition.rowIndex===t&&this.focusedCellPosition.rowPinned===bo(r)}findFocusableElements(t,r,i=!1){const s=sj;let n=VE;r&&(n+=", "+r),i&&(n+=', [tabindex="-1"]');const o=Array.prototype.slice.apply(t.querySelectorAll(s)).filter(c=>ss(c)),a=Array.prototype.slice.apply(t.querySelectorAll(n));return a.length?((c,u)=>c.filter(d=>u.indexOf(d)===-1))(o,a):o}focusInto(t,r=!1,i=!1){const s=this.findFocusableElements(t,null,i),n=r?ft(s):s[0];return n?(n.focus({preventScroll:!0}),!0):!1}findFocusableElementBeforeTabGuard(t,r){if(!r)return null;const i=this.findFocusableElements(t),s=i.indexOf(r);if(s===-1)return null;let n=-1;for(let o=s-1;o>=0;o--)if(i[o].classList.contains("ag-tab-guard-top")){n=o;break}return n<=0?null:i[n-1]}findNextFocusableElement(t=this.eGridDiv,r,i){const s=this.findFocusableElements(t,r?':not([tabindex="-1"])':null),n=this.gos.getActiveDomElement();let o;r?o=s.findIndex(l=>l.contains(n)):o=s.indexOf(n);const a=o+(i?-1:1);return a<0||a>=s.length?null:s[a]}isTargetUnderManagedComponent(t,r){if(!r)return!1;const i=t.querySelectorAll(`.${jo.FOCUS_MANAGED_CLASS}`);if(!i.length)return!1;for(let s=0;s<i.length;s++)if(i[s].contains(r))return!0;return!1}findTabbableParent(t,r=5){let i=0;for(;t&&eg(t)===null&&++i<=r;)t=t.parentElement;return eg(t)===null?null:t}focusGridView(t,r){var a;if(this.gos.get("suppressCellFocus"))return r?this.gos.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const i=r?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!i)return!1;const{rowIndex:s,rowPinned:n}=i,o=this.getFocusedHeader();return!t&&o&&(t=o.column),s==null||!t?!1:(this.navigationService.ensureCellVisible({rowIndex:s,column:t,rowPinned:n}),this.setFocusedCell({rowIndex:s,column:t,rowPinned:bo(n),forceBrowserFocus:!0}),(a=this.rangeService)==null||a.setRangeToCell({rowIndex:s,rowPinned:n,column:t}),!0)}focusNextGridCoreContainer(t,r=!1){return!r&&this.gridCtrl.focusNextInnerContainer(t)?!0:((r||!t&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(t),!1)}focusAdvancedFilter(t){var r;return this.advancedFilterFocusColumn=t==null?void 0:t.column,((r=this.advancedFilterService)==null?void 0:r.getCtrl().focusHeaderComp())??!1}focusNextFromAdvancedFilter(t,r){var s;const i=(r?void 0:this.advancedFilterFocusColumn)??((s=this.visibleColsService.getAllCols())==null?void 0:s[0]);return t?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(i)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}addFocusableContainer(t){this.gridCtrl.addFocusableContainer(t)}removeFocusableContainer(t){this.gridCtrl.removeFocusableContainer(t)}focusGridInnerElement(t){return this.gridCtrl.focusInnerElement(t)}};ym.keyboardModeActive=!1;ym.instanceCount=0;var bJ=ym,RJ=class extends xe{constructor(){super(...arguments),this.beanName="pinnedWidthService"}wireBeans(e){this.visibleColsService=e.visibleColsService}postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=this.gos.isDomLayout("print"),t=e?0:this.visibleColsService.getColsLeftWidth(),r=e?0:this.visibleColsService.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:"leftPinnedWidthChanged"})),r!=this.rightWidth&&(this.rightWidth=r,this.eventService.dispatchEvent({type:"rightPinnedWidthChanged"}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},EJ=class extends xe{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}wireBeans(e){this.beans=e,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.gridId);const{dragAndDropService:i,mouseEventService:s,ctrlsService:n,resizeObserverService:o}=this.beans;i.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:l=>l===1||l===0,getIconName:()=>"notAllowed"}),s.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new Sm(this.view)),this.addRtlSupport();const a=o.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>a()),n.register("gridCtrl",this)}isDetailGrid(){var t;const e=this.focusService.findTabbableParent(this.getGui());return((t=e==null?void 0:e.getAttribute("row-id"))==null?void 0:t.startsWith("detail"))||!1}getOptionalSelectors(){var t,r,i,s,n;const e=this.beans;return{paginationSelector:(t=e.paginationService)==null?void 0:t.getPaginationSelector(),gridHeaderDropZonesSelector:(r=e.columnDropZonesService)==null?void 0:r.getDropZoneSelector(),sideBarSelector:(i=e.sideBarService)==null?void 0:i.getSideBarSelector(),statusBarSelector:(s=e.statusBarService)==null?void 0:s.getStatusPanelSelector(),watermarkSelector:(n=e.licenseManager)==null?void 0:n.getWatermarkSelector()}}onGridSizeChanged(){const e={type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}addRtlSupport(){const e=this.gos.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),r=this.gos.getActiveDomElement(),i=t.findIndex(n=>n.getGui().contains(r)),s=i+(e?-1:1);if(s<0||s>=t.length)return!1;if(s===0){if(i>0){const n=this.visibleColsService.getAllCols(),o=ft(n);if(this.focusService.focusGridView(o,!0))return!0}return!1}return this.focusContainer(t[s],e)}focusInnerElement(e){const t=this.getFocusableContainers(),r=this.visibleColsService.getAllCols(),i=this.gos.getCallback("focusGridInnerElement");if(i&&i({fromBottom:!!e}))return!0;if(e){if(t.length>1)return this.focusContainer(ft(t),!0);const s=ft(r);if(this.focusService.focusGridView(s,!0))return!0}if(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")){if(this.focusService.focusGridView(r[0]))return!0;for(let s=1;s<t.length;s++)if(this.focusService.focusInto(t[s].getGui()))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}focusContainer(e,t){var i,s;(i=e==null?void 0:e.setAllowFocus)==null||i.call(e,!0);const r=this.focusService.focusInto(e.getGui(),t);return(s=e==null?void 0:e.setAllowFocus)==null||s.call(e,!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers.values()]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},FJ=class extends qF{constructor(e){super(),this.gridBody=He,this.sideBar=He,this.pagination=He,this.rootWrapperBody=He,this.eGridDiv=e}postConstruct(){const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:n=>this.addCssClass(n),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:n=>{this.getGui().style.userSelect=n??"",this.getGui().style.webkitUserSelect=n??""},setCursor:n=>{this.getGui().style.cursor=n??""}},t=this.createManagedBean(new EJ),r=t.getOptionalSelectors(),i=this.createTemplate(r),s=[$X,...Object.values(r).filter(n=>!!n)];this.setTemplate(i,s),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:n=>t.focusInnerElement(n),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),this.gos.get("debug")&&Ti("Grid removed from DOM")})}updateLayoutClasses(e,t){const r=this.rootWrapperBody.classList;r.toggle("ag-layout-auto-height",t.autoHeight),r.toggle("ag-layout-normal",t.normal),r.toggle("ag-layout-print",t.print),this.addOrRemoveCssClass("ag-layout-auto-height",t.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",t.normal),this.addOrRemoveCssClass("ag-layout-print",t.print)}createTemplate(e){const t=e.gridHeaderDropZonesSelector?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",r=e.sideBarSelector?'<ag-side-bar data-ref="sideBar"></ag-side-bar>':"",i=e.statusBarSelector?"<ag-status-bar></ag-status-bar>":"",s=e.watermarkSelector?"<ag-watermark></ag-watermark>":"",n=e.paginationSelector?'<ag-pagination data-ref="pagination"></ag-pagination>':"";return`<div class="ag-root-wrapper" role="presentation">
                ${t}
                <div class="ag-root-wrapper-body" data-ref="rootWrapperBody" role="presentation">
                    <ag-grid-body data-ref="gridBody"></ag-grid-body>
                    ${r}
                </div>
                ${i}
                ${n}
                ${s}
            </div>`}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){var t;if(!e&&((t=this.pagination)!=null&&t.isDisplayed())){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){const e=[this.gridBody];return[this.sideBar,this.pagination].forEach(t=>{t&&e.push(t)}),e.filter(t=>ss(t.getGui()))}},TJ=class extends xe{constructor(){super(...arguments),this.beanName="alignedGridsService",this.consuming=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.ctrlsService=e.ctrlsService,this.columnApplyStateService=e.columnApplyStateService}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";typeof e=="function"&&(e=e());const r=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return e.map(s=>{var o;if(!s){pt("alignedGrids contains an undefined option."),t||pt(`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`),pt(r());return}if(this.isGridApi(s))return s;const n=s;return"current"in n?(o=n.current)==null?void 0:o.api:(n.api||pt(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${r()}`),n.api)}).filter(s=>!!s&&!s.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){const t={type:"alignedGridColumn",event:e};this.fireEvent(t)}fireScrollEvent(e){if(e.direction!=="horizontal")return;const t={type:"alignedGridScroll",event:e};this.fireEvent(t)}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}getMasterColumns(e){const t=[];return e.columns?e.columns.forEach(r=>{t.push(r)}):e.column&&t.push(e.column),t}getColumnIds(e){const t=[];return e.columns?e.columns.forEach(r=>{t.push(r.getColId())}):e.column&&t.push(e.column.getColId()),t}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{const t=e;this.processColumnEvent(t);break}case"columnGroupOpened":{const t=e;this.processGroupOpenedEvent(t);break}case"columnPivotChanged":Te("pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");break}})}processGroupOpenedEvent(e){e.columnGroups.forEach(t=>{let r=null;if(t){const i=t.getGroupId();r=this.columnModel.getProvidedColGroup(i)}t&&!r||this.columnModel.setColumnGroupOpened(r,t.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){var o;const t=e.column;let r=null;if(t&&(r=this.columnModel.getColDefCol(t.getColId())),t&&!r)return;const i=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const l=e.api.getColumnState().map(c=>({colId:c.colId}));this.columnApplyStateService.applyColumnState({state:l,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const l=e.api.getColumnState().map(c=>({colId:c.colId,hide:c.hide}));this.columnApplyStateService.applyColumnState({state:l},"alignedGridChanged")}break;case"columnPinned":{const l=e.api.getColumnState().map(c=>({colId:c.colId,pinned:c.pinned}));this.columnApplyStateService.applyColumnState({state:l},"alignedGridChanged")}break;case"columnResized":{const a=e,l={};i.forEach(c=>{l[c.getId()]={key:c.getColId(),newWidth:c.getActualWidth()}}),(o=a.flexColumns)==null||o.forEach(c=>{l[c.getId()]&&delete l[c.getId()]}),this.columnSizeService.setColumnWidths(Object.values(l),!1,a.finished,"alignedGridChanged");break}}const n=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(a=>{a.setGridOption("alwaysShowVerticalScroll",n)})}},AJ={version:Ze,moduleName:"@ag-grid-community/aligned-grid",beans:[TJ]};function PJ(e,t){const r=e.columnModel.getColDefCol(t);return r?r.getColDef():null}function DJ(e){return e.columnModel.getColumnDefs()}function MJ(e,t){typeof t=="number"?e.columnSizeService.sizeColumnsToFit(t,"api"):e.ctrlsService.getGridBodyCtrl().sizeColumnsToFit(t)}function kJ(e,t,r){e.columnModel.setColumnGroupOpened(t,r,"api")}function _J(e,t,r){return e.visibleColsService.getColumnGroup(t,r)}function IJ(e,t){return e.columnModel.getProvidedColGroup(t)}function OJ(e,t,r){return e.columnNameService.getDisplayNameForColumn(t,r)||""}function LJ(e,t,r){return e.columnNameService.getDisplayNameForColumnGroup(t,r)||""}function NJ(e,t){return e.columnModel.getColDefCol(t)}function BJ(e){return e.columnModel.getColDefCols()}function GJ(e,t){return e.columnApplyStateService.applyColumnState(t,"api")}function HJ(e){return e.columnGetStateService.getColumnState()}function VJ(e){e.columnApplyStateService.resetColumnState("api")}function WJ(e){return e.columnGroupStateService.getColumnGroupState()}function zJ(e,t){e.columnGroupStateService.setColumnGroupState(t,"api")}function $J(e){e.columnGroupStateService.resetColumnGroupState("api")}function UJ(e){return e.visibleColsService.isPinningLeft()||e.visibleColsService.isPinningRight()}function KJ(e){return e.visibleColsService.isPinningLeft()}function jJ(e){return e.visibleColsService.isPinningRight()}function qJ(e,t){return e.visibleColsService.getColAfter(t)}function YJ(e,t){return e.visibleColsService.getColBefore(t)}function XJ(e,t,r){e.columnModel.setColsVisible([t],r,"api")}function QJ(e,t,r){e.columnModel.setColsVisible(t,r,"api")}function JJ(e,t,r){e.columnModel.setColsPinned([t],r,"api")}function ZJ(e,t,r){e.columnModel.setColsPinned(t,r,"api")}function eZ(e){return e.columnModel.getCols()}function tZ(e){return e.visibleColsService.getLeftCols()}function rZ(e){return e.visibleColsService.getCenterCols()}function iZ(e){return e.visibleColsService.getRightCols()}function sZ(e){return e.visibleColsService.getAllCols()}function nZ(e){return e.columnViewportService.getViewportColumns()}function oZ(e,t,r){e.columnMoveService.moveColumns([t],r,"api")}function aZ(e,t,r){e.columnMoveService.moveColumnByIndex(t,r,"api")}function lZ(e,t,r){e.columnMoveService.moveColumns(t,r,"api")}function cZ(e,t,r,i=!0,s="api"){e.columnSizeService.setColumnWidths([{key:t,newWidth:r}],!1,i,s)}function uZ(e,t,r=!0,i="api"){e.columnSizeService.setColumnWidths(t,!1,r,i)}function dZ(e){return e.visibleColsService.getTreeLeft()}function hZ(e){return e.visibleColsService.getTreeCenter()}function fZ(e){return e.visibleColsService.getTreeRight()}function pZ(e){return e.visibleColsService.getAllTrees()}function gZ(e,t,r){return e.columnAutosizeService.autoSizeCols({colKeys:[t],skipHeader:r,source:"api"})}function mZ(e,t,r){e.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:r,source:"api"})}function vZ(e,t){e.columnAutosizeService.autoSizeAllColumns("api",t)}var VS={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},WS=["january","february","march","april","may","june","july","august","september","october","november","december"],CZ=class extends xe{constructor(){super(...arguments),this.beanName="dataTypeService",this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.columnApplyStateService=e.columnApplyStateService}postConstruct(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(da(e.source))})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes();this.dataTypeDefinitions={},this.formatValueFuncs={};const t=i=>s=>{const{column:n,node:o,value:a}=s;let l=n.getColDef().valueFormatter;return l===i.groupSafeValueFormatter&&(l=i.valueFormatter),this.valueService.formatValue(n,o,a,l)};Object.entries(e).forEach(([i,s])=>{const n={...s,groupSafeValueFormatter:this.createGroupSafeValueFormatter(s)};this.dataTypeDefinitions[i]=n,this.formatValueFuncs[i]=t(n)});const r=this.gos.get("dataTypeDefinitions")??{};this.dataTypeMatchers={},Object.entries(r).forEach(([i,s])=>{const n=this.processDataTypeDefinition(s,r,[i],e);n&&(this.dataTypeDefinitions[i]=n,s.dataTypeMatcher&&(this.dataTypeMatchers[i]=s.dataTypeMatcher),this.formatValueFuncs[i]=t(n))}),this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(i=>{const s=this.dataTypeMatchers[i];s&&delete this.dataTypeMatchers[i],this.dataTypeMatchers[i]=s??e[i].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...Qu(e.columnTypes),...Qu(t.columnTypes)]),r}processDataTypeDefinition(e,t,r,i){let s;const n=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[n];const a=t[n];if(o&&a&&(o=a),!this.validateDataTypeDefinition(e,o,n))return;s=this.mergeDataTypeDefinitions(o,e)}else{if(r.includes(n)){Te('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');return}const o=t[n];if(!this.validateDataTypeDefinition(e,o,n))return;const a=this.processDataTypeDefinition(o,t,[...r,n],i);if(!a)return;s=this.mergeDataTypeDefinitions(a,e)}return{...s,groupSafeValueFormatter:this.createGroupSafeValueFormatter(s)}}validateDataTypeDefinition(e,t,r){return t?t.baseDataType!==e.baseDataType?(Te('The "baseDataType" property of a data type definition must match that of its parent.'),!1):!0:(Te(`The data type definition ${r} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{var r,i;if((r=t.node)!=null&&r.group){const s=t.column.getAggFunc();if(s){if(s==="first"||s==="last")return e.valueFormatter(t);if(e.baseDataType==="number"&&s!=="count"){if(typeof t.value=="number")return e.valueFormatter(t);if(typeof t.value=="object"){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter({...t,value:t.value.toNumber()});if("value"in t.value)return e.valueFormatter({...t,value:t.value.value})}}}if(!this.gos.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()){if(typeof t.value!="string"||(i=e.dataTypeMatcher)!=null&&i.call(e,t.value))return e.valueFormatter(t);if(!this.gos.get("suppressGroupMaintainValueType"))return}return e.valueFormatter(t)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:i}=t;const{field:s}=t;if(i===void 0&&(i=e.cellDataType),(i==null||i===!0)&&(i=this.canInferCellDataType(e,t)?this.inferCellDataType(s,r):!1),!i){e.cellDataType=!1;return}const n=this.dataTypeDefinitions[i];if(!n){Te(`Missing data type definition - "${i}"`);return}return e.cellDataType=i,n.groupSafeValueFormatter&&(e.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(e.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,i,n,r),n.columnTypes}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=i=>{t.add(i.key)};e.addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){if(this.rowModel.getType()!=="clientSide")return!1;const r={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,r))return!1;const i=t.type===null?e.type:t.type;if(i){const s=this.gos.get("columnTypes")??{};if(Qu(i).some(o=>{const a=s[o.trim()];return a&&this.doColDefPropsPreventInference(a,r)}))return!1}return!this.doColDefPropsPreventInference(e,r)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,i])=>this.doesColDefPropPreventInference(e,t,r,i))}doesColDefPropPreventInference(e,t,r,i){if(!t[r])return!1;const s=e[r];return s===null?(t[r]=!1,!1):i===void 0?!!s:s===i}inferCellDataType(e,t){if(!e)return;let r;const i=this.getInitialData();if(i){const n=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");r=$l(i,e,n)}else this.initWaitForRowData(t);if(r==null)return;const[s]=Object.entries(this.dataTypeMatchers).find(([n,o])=>o(r))??["object"];return s}getInitialData(){const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const t=this.rowModel.getRootNode().allLeafChildren;if(t!=null&&t.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const[r]=this.addManagedEventListeners({rowDataUpdateStarted:i=>{const{firstRowData:s}=i;if(!s)return;r==null||r(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(s,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations();const n={type:"dataTypesInferred"};this.eventService.dispatchEvent(n)}})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const i={},s={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([n,o])=>{const a=this.columnModel.getCol(n);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const u=this.getUpdatedColumnState(a,o);u.rowGroup&&u.rowGroupIndex==null&&(i[n]=u),u.pivot&&u.pivotIndex==null&&(s[n]=u),r.push(u)}}),t&&r.push(...this.funcColsService.generateColumnStateForRowGroupAndPivotIndexes(i,s)),r.length&&this.columnApplyStateService.applyColumnState({state:r},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const r=this.columnApplyStateService.getColumnStateFromColDef(e);return t.forEach(i=>{delete r[i],i==="rowGroup"?delete r.rowGroupIndex:i==="pivot"&&delete r.pivotIndex}),r}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,r=e.object;this.hasObjectValueParser=t.valueParser!==r.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==r.valueFormatter}getDateStringTypeDefinition(e){return e?this.getDataTypeDefinition(e)??this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var i;if(t==null)return!0;const r=(i=this.getDataTypeDefinition(e))==null?void 0:i.dataTypeMatcher;return r?r(t):!0}validateColDef(e){e.cellDataType==="object"&&(e.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&Te('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&Te('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}getFormatValue(e){return this.formatValueFuncs[e]}setColDefPropertiesForBaseDataType(e,t,r,i){const s=this.formatValueFuncs[t],n=Ur.__isRegistered("@ag-grid-enterprise/set-filter",this.gridId),o=this.localeService.getLocaleTextFunc(),a=l=>{const{filterParams:c}=e;e.filterParams=typeof c=="object"?{...c,...l}:l};switch(r.baseDataType){case"number":{e.cellEditor="agNumberCellEditor",n&&a({comparator:(l,c)=>{const u=l==null?0:parseInt(l),d=c==null?0:parseInt(c);return u===d?0:u>d?1:-1}});break}case"boolean":{e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=l=>!!l.colDef.editable&&l.event.key===ve.SPACE,a(n?{valueFormatter:l=>ke(l.value)?o(String(l.value),l.value?"True":"False"):o("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(l,c)=>c,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(l,c)=>c===!1,numberOfInputs:0}]});break}case"date":{e.cellEditor="agDateCellEditor",e.keyCreator=s,n&&a({valueFormatter:l=>{const c=s(l);return ke(c)?c:o("blanks","(Blanks)")},treeList:!0,treeListFormatter:(l,c)=>{if(c===1&&l!=null){const u=WS[Number(l)-1];return o(u,VS[u])}return l??o("blanks","(Blanks)")}});break}case"dateString":{e.cellEditor="agDateStringCellEditor",e.keyCreator=s;const l=r.dateParser;a(n?{valueFormatter:c=>{const u=s(c);return ke(u)?u:o("blanks","(Blanks)")},treeList:!0,treeListPathGetter:c=>{const u=l(c??void 0);return u?[String(u.getFullYear()),String(u.getMonth()+1),String(u.getDate())]:null},treeListFormatter:(c,u)=>{if(u===1&&c!=null){const d=WS[Number(c)-1];return o(d,VS[d])}return c??o("blanks","(Blanks)")}}:{comparator:(c,u)=>{const d=l(u);return u==null||d<c?-1:d>c?1:0}});break}case"object":{e.cellEditorParams={useFormatter:!0},e.comparator=(l,c)=>{const u=this.columnModel.getColDefCol(i),d=u==null?void 0:u.getColDef();if(!u||!d)return 0;const h=l==null?"":s({column:u,node:null,value:l}),p=c==null?"":s({column:u,node:null,value:c});return h===p?0:h>p?1:-1},e.keyCreator=s,n?a({valueFormatter:l=>{const c=s(l);return ke(c)?c:o("blanks","(Blanks)")}}):e.filterValueGetter=l=>s({column:l.column,node:l.node,value:this.valueService.getValue(l.column,l.node)});break}}}getDefaultDataTypes(){const e=r=>!!r.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:r=>{var i,s;return((s=(i=r.newValue)==null?void 0:i.trim)==null?void 0:s.call(i))===""?null:Number(r.newValue)},valueFormatter:r=>r.value==null?"":typeof r.value!="number"||isNaN(r.value)?t("invalidNumber","Invalid Number"):String(r.value),dataTypeMatcher:r=>typeof r=="number"},text:{baseDataType:"text",valueParser:r=>r.newValue===""?null:Up(r.newValue),dataTypeMatcher:r=>typeof r=="string"},boolean:{baseDataType:"boolean",valueParser:r=>{var i,s;return r.newValue==null?r.newValue:((s=(i=r.newValue)==null?void 0:i.trim)==null?void 0:s.call(i))===""?null:String(r.newValue).toLowerCase()==="true"},valueFormatter:r=>r.value==null?"":String(r.value),dataTypeMatcher:r=>typeof r=="boolean"},date:{baseDataType:"date",valueParser:r=>si(r.newValue==null?null:String(r.newValue)),valueFormatter:r=>r.value==null?"":!(r.value instanceof Date)||isNaN(r.value.getTime())?t("invalidDate","Invalid Date"):ki(r.value,!1)??"",dataTypeMatcher:r=>r instanceof Date},dateString:{baseDataType:"dateString",dateParser:r=>si(r)??void 0,dateFormatter:r=>ki(r??null,!1)??void 0,valueParser:r=>e(String(r.newValue))?r.newValue:null,valueFormatter:r=>e(String(r.value))?r.value:"",dataTypeMatcher:r=>typeof r=="string"&&e(r)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:r=>Up(r.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}},wZ={version:Ze,moduleName:"@ag-grid-community/data-type",beans:[CZ]},SZ={version:Ze,moduleName:"@ag-grid-community/column-api",apiFunctions:{getColumnDef:PJ,getColumnDefs:DJ,sizeColumnsToFit:MJ,setColumnGroupOpened:kJ,getColumnGroup:_J,getProvidedColumnGroup:IJ,getDisplayNameForColumn:OJ,getDisplayNameForColumnGroup:LJ,getColumn:NJ,getColumns:BJ,applyColumnState:GJ,getColumnState:HJ,resetColumnState:VJ,getColumnGroupState:WJ,setColumnGroupState:zJ,resetColumnGroupState:$J,isPinning:UJ,isPinningLeft:KJ,isPinningRight:jJ,getDisplayedColAfter:qJ,getDisplayedColBefore:YJ,setColumnVisible:XJ,setColumnsVisible:QJ,setColumnPinned:JJ,setColumnsPinned:ZJ,getAllGridColumns:eZ,getDisplayedLeftColumns:tZ,getDisplayedCenterColumns:rZ,getDisplayedRightColumns:iZ,getAllDisplayedColumns:sZ,getAllDisplayedVirtualColumns:nZ,moveColumn:oZ,moveColumnByIndex:aZ,moveColumns:lZ,setColumnWidth:cZ,setColumnWidths:uZ,getLeftDisplayedColumnGroups:dZ,getCenterDisplayedColumnGroups:hZ,getRightDisplayedColumnGroups:fZ,getAllDisplayedColumnGroups:pZ,autoSizeColumn:gZ,autoSizeColumns:mZ,autoSizeAllColumns:vZ}};function yZ(e,t){e.ctrlsService.getGridBodyCtrl().getRowDragFeature().addRowDropZone(t)}function xZ(e,t){const r=e.dragAndDropService.findExternalZone(t);r&&e.dragAndDropService.removeDropTarget(r)}function bZ(e,t){return e.ctrlsService.getGridBodyCtrl().getRowDragFeature().getRowDropZone(t)}var RZ={version:Ze,moduleName:"@ag-grid-community/drag-api",apiFunctions:{addRowDropZone:yZ,removeRowDropZone:xZ,getRowDropZoneParams:bZ}};function EZ(e){return e.pinnedRowModel.getPinnedTopRowCount()}function FZ(e){return e.pinnedRowModel.getPinnedBottomRowCount()}function TZ(e,t){return e.pinnedRowModel.getPinnedTopRow(t)}function AZ(e,t){return e.pinnedRowModel.getPinnedBottomRow(t)}var PZ={version:Ze,moduleName:"@ag-grid-community/pinned-row-api",apiFunctions:{getPinnedTopRowCount:EZ,getPinnedBottomRowCount:FZ,getPinnedTopRow:TZ,getPinnedBottomRow:AZ}};function DZ(e){e.overlayService.showLoadingOverlay()}function MZ(e){e.overlayService.showNoRowsOverlay()}function kZ(e){e.overlayService.hideOverlay()}var _Z={version:Ze,moduleName:"@ag-grid-community/overlay-api",apiFunctions:{showLoadingOverlay:DZ,showNoRowsOverlay:MZ,hideOverlay:kZ}};function IZ(e,t,r){if(!t)return;const i=e.ctrlsService.getGridBodyCtrl().getGui(),s=`aria-${t}`;r===null?i.removeAttribute(s):i.setAttribute(s,r)}function OZ(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function LZ(e,t={}){const r=i=>Te(`Since v31.1 api.flashCells parameter '${i}Delay' is deprecated. Please use '${i}Duration' instead.`);ke(t.fadeDelay)&&r("fade"),ke(t.flashDelay)&&r("flash"),e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.flashCells(t))}function NZ(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}function BZ(e){return e.animationFrameService.isQueueEmpty()}function GZ(e){e.animationFrameService.flushAllFrames()}function HZ(e){return{rowHeight:e.gos.getRowHeightAsNumber(),headerHeight:e.columnModel.getHeaderHeight()}}function VZ(e,t={}){return e.rowRenderer.getCellRendererInstances(t).map(Kl)}var WZ={version:Ze,moduleName:"@ag-grid-community/render-api",apiFunctions:{setGridAriaProperty:IZ,refreshCells:OZ,flashCells:LZ,refreshHeader:NZ,isAnimationFrameQueueEmpty:BZ,flushAllAnimationFrames:GZ,getSizesForCurrentTheme:HZ,getCellRendererInstances:VZ}};function zZ(e){e.valueCache.expire()}function $Z(e,t,r){return XF(e,{colKey:t,rowNode:r})}function XF(e,t){const{colKey:r,rowNode:i,useFormatter:s}=t,n=e.columnModel.getColDefCol(r)??e.columnModel.getCol(r);if(ut(n))return null;const o=e.valueService.getValue(n,i);return s?e.valueService.formatValue(n,i,o)??bs(o,!0):o}function UZ(e){return e.context.getGridId()}function KZ(e){e.gridDestroyService.destroy()}function jZ(e){return e.gridDestroyService.isDestroyCalled()}function qZ(e,t){return e.gos.get(t)}function YZ(e,t,r){QF(e,{[t]:r})}function QF(e,t){e.gos.updateGridOptions({options:t})}function XZ(e,t,r){e.apiEventService.addEventListener(t,r)}function QZ(e,t,r){e.apiEventService.removeEventListener(t,r)}function JZ(e,t){e.apiEventService.addGlobalListener(t)}function ZZ(e,t){e.apiEventService.removeGlobalListener(t)}function eee(e){return e.focusService.getFocusedCell()}function tee(e){return e.focusService.clearFocusedCell()}function ree(e,t,r,i){e.focusService.setFocusedCell({rowIndex:t,column:r,rowPinned:i,forceBrowserFocus:!0})}function iee(e,t){return e.navigationService.tabToNextCell(!1,t)}function see(e,t){return e.navigationService.tabToNextCell(!0,t)}function nee(e,t,r=!1){const i=e.headerNavigationService.getHeaderPositionForColumn(t,r);i&&e.focusService.focusHeaderPosition({headerPosition:i})}function oee(e,t,r){const i=e.columnModel.getCol(t);e.menuService.showColumnMenu({column:i,buttonElement:r,positionBy:"button"})}function aee(e,t,r){let i=e.columnModel.getCol(t);if(i||(i=e.columnModel.getColDefCol(t)),!i){pt(`column '${t}' not found`);return}e.menuService.showColumnMenu({column:i,mouseEvent:r,positionBy:"mouse"})}function lee(e,t){const r=e.columnModel.getCol(t);if(!r){pt(`column '${t}' not found`);return}e.menuService.showColumnMenu({column:r,positionBy:"auto"})}function cee(e){e.menuService.hidePopupMenu()}function uee(e,t={}){const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(r))}function dee(e,t,r,i,s){e.expansionService.setRowNodeExpanded(t,r,i,s)}function hee(e,t){return e.rowModel.getRowNode(t)}function fee(e,t,r,i){e.rowRenderer.addRenderedRowListener(t,r,i)}function pee(e){return e.rowRenderer.getRenderedNodes()}function gee(e,t,r){e.rowModel.forEachNode(t,r)}function mee(e){return JF(e)}function JF(e){return e.rowRenderer.getFirstVirtualRenderedRow()}function vee(e){return ZF(e)}function ZF(e){return e.rowRenderer.getLastVirtualRenderedRow()}function Cee(e,t){return e.rowModel.getRow(t)}function wee(e){return e.rowModel.getRowCount()}function See(e){return e.rowModel}function yee(e,t){if(!t.nodes.every(a=>a.rowPinned?(Te("cannot select pinned rows"),!1):a.id===void 0?(Te("cannot select node until id for node is known"),!1):!0))return;const{nodes:i,source:s,newValue:n}=t,o=i;e.selectionService.setNodesSelected({nodes:o,source:s??"api",newValue:n})}function xee(e,t="apiSelectAll"){e.selectionService.selectAllRowNodes({source:t})}function bee(e,t="apiSelectAll"){e.selectionService.deselectAllRowNodes({source:t})}function Ree(e,t="apiSelectAllFiltered"){e.selectionService.selectAllRowNodes({source:t,justFiltered:!0})}function Eee(e,t="apiSelectAllFiltered"){e.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})}function Fee(e,t="apiSelectAllCurrentPage"){e.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})}function Tee(e,t="apiSelectAllCurrentPage"){e.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})}function Aee(e){return e.selectionService.getSelectedNodes()}function Pee(e){return e.selectionService.getSelectedRows()}function Dee(e){e.sortController.onSortChanged("api")}var Mee={version:Ze,moduleName:"@ag-grid-community/core-api",apiFunctions:{getGridId:UZ,destroy:KZ,isDestroyed:jZ,getGridOption:qZ,setGridOption:YZ,updateGridOptions:QF}},kee={version:Ze,moduleName:"@ag-grid-community/row-selection-api",apiFunctions:{setNodesSelected:yee,selectAll:xee,deselectAll:bee,selectAllFiltered:Ree,deselectAllFiltered:Eee,selectAllOnCurrentPage:Fee,deselectAllOnCurrentPage:Tee,getSelectedNodes:Aee,getSelectedRows:Pee}},_ee={version:Ze,moduleName:"@ag-grid-community/row-api",apiFunctions:{redrawRows:uee,setRowNodeExpanded:dee,getRowNode:hee,addRenderedRowListener:fee,getRenderedNodes:pee,forEachNode:gee,getFirstDisplayedRow:mee,getFirstDisplayedRowIndex:JF,getLastDisplayedRow:vee,getLastDisplayedRowIndex:ZF,getDisplayedRowAtIndex:Cee,getDisplayedRowCount:wee,getModel:See}},Iee={version:Ze,moduleName:"@ag-grid-community/scroll-api",apiFunctions:{getVerticalPixelRange:vQ,getHorizontalPixelRange:CQ,ensureColumnVisible:UF,ensureIndexVisible:KF,ensureNodeVisible:wQ}},Oee={version:Ze,moduleName:"@ag-grid-community/keyboard-navigation-api",apiFunctions:{getFocusedCell:eee,clearFocusedCell:tee,setFocusedCell:ree,setFocusedHeader:nee,tabToNextCell:iee,tabToPreviousCell:see}},Lee={version:Ze,moduleName:"@ag-grid-community/event-api",apiFunctions:{addEventListener:XZ,addGlobalListener:JZ,removeEventListener:QZ,removeGlobalListener:ZZ}},Nee={version:Ze,moduleName:"@ag-grid-community/cell-api",apiFunctions:{expireValueCache:zZ,getValue:$Z,getCellValue:XF}},Bee={version:Ze,moduleName:"@ag-grid-community/menu-api",apiFunctions:{showColumnMenuAfterButtonClick:oee,showColumnMenuAfterMouseClick:aee,showColumnMenu:lee,hidePopupMenu:cee}},Gee={version:Ze,moduleName:"@ag-grid-community/sort-api",apiFunctions:{onSortChanged:Dee}},Hee={version:Ze,moduleName:"@ag-grid-community/api",dependantModules:[Mee,PZ,kee,SZ,_ee,RZ,Iee,_Z,Oee,Lee,WZ,Nee,Bee,Gee]};function Vee(e){var t;return((t=e.stateService)==null?void 0:t.getState())??{}}var Wee=class extends xe{constructor(){super(...arguments),this.beanName="stateService",this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=qr(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=qr(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=qr(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}wireBeans(e){this.filterManager=e.filterManager,this.ctrlsService=e.ctrlsService,this.pivotResultColsService=e.pivotResultColsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnGroupStateService=e.columnGroupStateService,this.columnGetStateService=e.columnGetStateService,this.paginationService=e.paginationService,this.rowModel=e.rowModel,this.selectionService=e.selectionService,this.expansionService=e.expansionService,this.columnAnimationService=e.columnAnimationService,this.columnApplyStateService=e.columnApplyStateService,this.sideBarService=e.sideBarService,this.rangeService=e.rangeService}postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide",this.cachedState=this.gos.get("initialState")??{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const[e,t,r]=this.addManagedEventListeners({newColumnsLoaded:({source:i})=>{i==="gridInitializing"&&(e(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))},rowCountReady:()=>{t==null||t(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())},firstDataRendered:()=>{r==null||r(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())}})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState());const e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.gos.get("initialState")??{};this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedEventListeners({columnValueChanged:()=>this.updateColumnState(["aggregation"]),columnMoved:()=>this.updateColumnState(["columnOrder"]),columnPinned:()=>this.updateColumnState(["columnPinning"]),columnResized:()=>this.updateColumnState(["columnSizing"]),columnVisible:()=>this.updateColumnState(["columnVisibility"]),columnPivotChanged:()=>this.updateColumnState(["pivot"]),columnPivotModeChanged:()=>this.updateColumnState(["pivot"]),columnRowGroupChanged:()=>this.updateColumnState(["rowGroup"]),sortChanged:()=>this.updateColumnState(["sort"]),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:r,pagination:i}=this.gos.get("initialState")??{},s=this.gos.get("advancedFilterModel");(e||s)&&this.setFilterState(e,s),t&&this.setRowGroupExpansionState(t),r&&this.setRowSelectionState(r),i&&this.setPaginationState(i),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedEventListeners({filterChanged:()=>this.updateCachedState("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:n=>{(n.newPage||n.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,rangeSelection:t,focusedCell:r,columnOrder:i}=this.gos.get("initialState")??{};r&&this.setFocusedCellState(r),t&&this.setRangeSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!(i!=null&&i.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>this.updateCachedState("focusedCell",this.getFocusedCellState()),rangeSelectionChanged:s=>{s.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())},bodyScrollEnd:()=>this.updateCachedState("scroll",this.getScrollState())})}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],r=[],i=[],s=[],n=[],o=[],a=[],l=[],c=[],u=this.columnGetStateService.getColumnState();for(let d=0;d<u.length;d++){const{colId:h,sort:p,sortIndex:g,rowGroup:f,rowGroupIndex:m,aggFunc:v,pivot:w,pivotIndex:C,pinned:F,hide:D,width:R,flex:y}=u[d];c.push(h),p&&(t[g??0]={colId:h,sort:p}),f&&(r[m??0]=h),typeof v=="string"&&i.push({colId:h,aggFunc:v}),w&&(s[C??0]=h),F&&(F==="right"?o:n).push(h),D&&a.push(h),(y||R)&&l.push({colId:h,flex:y??void 0,width:R})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:r.length?{groupColIds:r}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:s.length||e?{pivotMode:e,pivotColIds:s}:void 0,columnPinning:n.length||o.length?{leftColIds:n,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:r,aggregation:i,pivot:s,columnPinning:n,columnVisibility:o,columnSizing:a,columnOrder:l}=e,c={},u=g=>{let f=c[g];return f||(f={colId:g},c[g]=f,f)};t&&t.sortModel.forEach(({colId:g,sort:f},m)=>{const v=u(g);v.sort=f,v.sortIndex=m}),r&&r.groupColIds.forEach((g,f)=>{const m=u(g);m.rowGroup=!0,m.rowGroupIndex=f}),i&&i.aggregationModel.forEach(({colId:g,aggFunc:f})=>{u(g).aggFunc=f}),s&&(s.pivotColIds.forEach((g,f)=>{const m=u(g);m.pivot=!0,m.pivotIndex=f}),this.gos.updateGridOptions({options:{pivotMode:s.pivotMode},source:"gridInitializing"})),n&&(n.leftColIds.forEach(g=>{u(g).pinned="left"}),n.rightColIds.forEach(g=>{u(g).pinned="right"})),o&&o.hiddenColIds.forEach(g=>{u(g).hide=!0}),a&&a.columnSizingModel.forEach(({colId:g,flex:f,width:m})=>{const v=u(g);v.flex=f??null,v.width=m});const d=l==null?void 0:l.orderedColIds,h=!!(d!=null&&d.length),p=h?d.map(g=>u(g)):Object.values(c);if(p.length){this.columnStates=p;const g={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnApplyStateService.applyColumnState({state:p,applyOrder:h,defaultState:g},"gridInitializing")}}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const r=this.columnGroupStates;if(this.columnGroupStates=void 0,!!this.pivotResultColsService.isPivotResultColsPresent()){if(t){const i=[];for(const s of t)this.pivotResultColsService.getPivotResultCol(s.colId)&&i.push(s);this.columnApplyStateService.applyColumnState({state:i,applyOrder:e},"gridInitializing")}r&&this.columnGroupStateService.setColumnGroupState(r,"gridInitializing")}}getColumnGroupState(){const e=this.columnGroupStateService.getColumnGroupState(),t=[];return e.forEach(({groupId:r,open:i})=>{i&&t.push(r)}),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){var s;if(!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const t=new Set((s=e.columnGroup)==null?void 0:s.openColumnGroupIds),i=this.columnGroupStateService.getColumnGroupState().map(({groupId:n})=>{const o=t.has(n);return o&&t.delete(n),{groupId:n,open:o}});t.forEach(n=>{i.push({groupId:n,open:!0})}),i.length&&(this.columnGroupStates=i),this.columnGroupStateService.setColumnGroupState(i,"gridInitializing")}getFilterState(){var r,i;let e=(r=this.filterManager)==null?void 0:r.getFilterModel();e&&Object.keys(e).length===0&&(e=void 0);const t=((i=this.filterManager)==null?void 0:i.getAdvancedFilterModel())??void 0;return e||t?{filterModel:e,advancedFilterModel:t}:void 0}setFilterState(e,t){var s,n;const{filterModel:r,advancedFilterModel:i}=e??{advancedFilterModel:t};r&&((s=this.filterManager)==null||s.setFilterModel(r,"columnFilter")),i&&((n=this.filterManager)==null||n.setAdvancedFilterModel(i))}getRangeSelectionState(){var t;const e=(t=this.rangeService)==null?void 0:t.getCellRanges().map(r=>{const{id:i,type:s,startRow:n,endRow:o,columns:a,startColumn:l}=r;return{id:i,type:s,startRow:n,endRow:o,colIds:a.map(c=>c.getColId()),startColId:l.getColId()}});return e!=null&&e.length?{cellRanges:e}:void 0}setRangeSelectionState(e){if(!this.gos.get("enableRangeSelection")||!this.rangeService)return;const t=[];e.cellRanges.forEach(r=>{const i=[];if(r.colIds.forEach(n=>{const o=this.columnModel.getCol(n);o&&i.push(o)}),!i.length)return;let s=this.columnModel.getCol(r.startColId);if(!s){const n=this.visibleColsService.getAllCols(),o=new Set(i);s=n.find(a=>o.has(a))}t.push({...r,columns:i,startColumn:s})}),this.rangeService.setCellRanges(t)}getScrollState(){var i;if(!this.isClientSideRowModel)return;const e=(i=this.ctrlsService.getGridBodyCtrl())==null?void 0:i.getScrollFeature(),{left:t}=(e==null?void 0:e.getHScrollPosition())??{left:0},{top:r}=(e==null?void 0:e.getVScrollPosition())??{top:0};return r||t?{top:r,left:t}:void 0}setScrollState(e){var i;if(!this.isClientSideRowModel)return;const{top:t,left:r}=e;(i=this.ctrlsService.getGridBodyCtrl())==null||i.getScrollFeature().setScrollPosition(t,r)}getSideBarState(){var e,t;return(t=(e=this.sideBarService)==null?void 0:e.getSideBarComp())==null?void 0:t.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:r,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:r,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:r,rowPinned:i}=e;this.focusService.setFocusedCell({column:this.columnModel.getCol(t),rowIndex:r,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){if(!this.paginationService)return;const e=this.paginationService.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationService.getPageSize();if(!(!e&&!t))return{page:e,pageSize:t}}setPaginationState(e){this.paginationService&&(e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationService.setPageSize(e.pageSize,"initialState"),typeof e.page=="number"&&this.paginationService.setPage(e.page))}getRowSelectionState(){var r;const e=this.selectionService.getSelectionState();return!e||!Array.isArray(e)&&(e.selectAll===!1||e.selectAllChildren===!1)&&!((r=e==null?void 0:e.toggledNodes)!=null&&r.length)?void 0:e}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let r=!1;Object.entries(t).forEach(([i,s])=>{_d(s,this.cachedState[i])||(r=!0)}),this.cachedState={...this.cachedState,...t},r&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const r=this.cachedState[e];this.setCachedStateValue(e,t),_d(t,r)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){this.staleStateKeys.forEach(e=>{switch(e){case"rowSelection":this.setCachedStateValue(e,this.getRowSelectionState());break}}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const t={type:"stateUpdated",sources:e,state:this.cachedState};this.eventService.dispatchEvent(t)}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}},eT={version:Ze,moduleName:"@ag-grid-community/state-core",beans:[Wee]},zee={version:Ze,moduleName:"@ag-grid-community/state-api",apiFunctions:{getState:Vee},dependantModules:[eT]},$ee={version:Ze,moduleName:"@ag-grid-community/state",dependantModules:[eT,zee]};function Uee(e){return e.rowModel.isLastRowIndexKnown()}function Kee(e){var t;return((t=e.paginationService)==null?void 0:t.getPageSize())??100}function jee(e){var t;return((t=e.paginationService)==null?void 0:t.getCurrentPage())??0}function qee(e){var t;return((t=e.paginationService)==null?void 0:t.getTotalPages())??1}function Yee(e){return e.paginationService?e.paginationService.getMasterRowCount():e.rowModel.getRowCount()}function Xee(e){var t;(t=e.paginationService)==null||t.goToNextPage()}function Qee(e){var t;(t=e.paginationService)==null||t.goToPreviousPage()}function Jee(e){var t;(t=e.paginationService)==null||t.goToFirstPage()}function Zee(e){var t;(t=e.paginationService)==null||t.goToLastPage()}function ete(e,t){var r;(r=e.paginationService)==null||r.goToPage(t)}var tte=class extends xe{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.paginationService.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const r=Math.max(this.gos.getRowHeightAsNumber(),1),i=Math.floor(e/r);this.paginationService.setPageSize(i,"autoCalculated")};this.isBodyRendered?qr(()=>t(),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};function rte(e,t,r){e.addManagedElementListeners(t,{keydown:i=>{if(!i.defaultPrevented&&i.key===ve.TAB){const s=i.shiftKey;r.findNextFocusableElement(t,!1,s)||r.focusNextGridCoreContainer(s)&&i.preventDefault()}}})}var ite=class extends wt{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationService.getPageSize()||(this.paginationService.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.paginationService=e.paginationService}postConstruct(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!(e!=null&&e.newPageSize))return;const t=this.paginationService.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){Or(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get("paginationPageSizeSelector")!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationService.getPageSize(),r=!t||!e.includes(t);r&&(e.unshift(""),Te(`The paginationPageSize grid option is set to a value that is not in the list of page size options.
                Please make sure that the paginationPageSize grid option is set to one of the values in the 
                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.`)),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp));const i=this.localeService.getLocaleTextFunc(),s=i("pageSizeSelectorLabel","Page Size:"),n=e.map(a=>({value:String(a),text:String(a)})),o=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new cm).addOptions(n).setValue(String(r?"":t)).setAriaLabel(o).setLabel(s).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=r}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get("paginationPageSizeSelector");return!Array.isArray(t)||!this.validateValues(t)?e:[...t].sort((r,i)=>r-i)}validateValues(e){if(!e.length)return Te(`The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.
                If you want to hide the page size selector, please set the paginationPageSizeSelector to false.`),!1;for(let t=0;t<e.length;t++){const r=e[t],i=typeof r=="number",s=r>0;if(!i)return Te(`The paginationPageSizeSelector grid option contains a non-numeric value.
                    Please make sure that all values in the paginationPageSizeSelector array are numbers.`),!1;if(!s)return Te(`The paginationPageSizeSelector grid option contains a negative number or zero.
                    Please make sure that all values in the paginationPageSizeSelector array are positive.`),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},ste={selector:"AG-PAGE-SIZE-SELECTOR",component:ite},nte=class extends qF{constructor(){super(),this.btFirst=He,this.btPrevious=He,this.btNext=He,this.btLast=He,this.lbRecordCount=He,this.lbFirstRowOnPage=He,this.lbLastRowOnPage=He,this.lbCurrent=He,this.lbTotal=He,this.pageSizeComp=He,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1}wireBeans(e){this.rowNodeBlockLoader=e.rowNodeBlockLoader,this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.focusService=e.focusService}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[ste]);const{btFirst:t,btPrevious:r,btNext:i,btLast:s}=this;this.activateTabIndex([t,r,i,s]),t.insertAdjacentElement("afterbegin",vi(e?"last":"first",this.gos)),r.insertAdjacentElement("afterbegin",vi(e?"next":"previous",this.gos)),i.insertAdjacentElement("afterbegin",vi(e?"previous":"next",this.gos)),s.insertAdjacentElement("afterbegin",vi(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:n=>{this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(n):this.focusService.focusGridInnerElement(n)},forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:i=>{(i.key===ve.ENTER||i.key===ve.SPACE)&&(i.preventDefault(),r())}})}),rte(this,this.getGui(),this.focusService),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationService.goToFirstPage()}setCurrentPageLabel(){const e=this.paginationService.getTotalPages()>0,t=this.paginationService.getCurrentPage(),r=e?t+1:0;this.lbCurrent.textContent=this.formatNumber(r)}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t)return t({value:e});const r=this.localeService.getLocaleTextFunc(),i=r("thousandSeparator",","),s=r("decimalSeparator",".");return Aq(e,i,s)}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),r=e("to","to"),i=e("of","of"),s=e("firstPage","First Page"),n=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">
                <ag-page-size-selector data-ref="pageSizeComp"></ag-page-size-selector>
                <span class="ag-paging-row-summary-panel" role="status">
                    <span id="ag-${l}-first-row" data-ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-to">${r}</span>
                    <span id="ag-${l}-last-row" data-ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-of">${i}</span>
                    <span id="ag-${l}-row-count" data-ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>
                </span>
                <span class="ag-paging-page-summary-panel" role="presentation">
                    <div data-ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>
                    <div data-ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${n}"></div>
                    <span class="ag-paging-description" role="status">
                        <span id="ag-${l}-start-page">${t}</span>
                        <span id="ag-${l}-start-page-number" data-ref="lbCurrent" class="ag-paging-number"></span>
                        <span id="ag-${l}-of-page">${i}</span>
                        <span id="ag-${l}-of-page-number" data-ref="lbTotal" class="ag-paging-number"></span>
                    </span>
                    <div data-ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>
                    <div data-ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>
                </span>
            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationService.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationService.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationService.goToLastPage()}enableOrDisableButtons(){const e=this.paginationService.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.paginationService.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),s=e===r-1;this.nextButtonDisabled=s||i,this.lastButtonDisabled=!t||i||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){$K(e,t),e.classList.toggle("ag-disabled",t)}updateRowLabels(){var o;const e=this.paginationService.getCurrentPage(),t=this.paginationService.getPageSize(),r=this.rowModel.isLastRowIndexKnown(),i=this.rowModel.isLastRowIndexKnown()?this.paginationService.getMasterRowCount():null;let s,n;if(this.isZeroPagesToDisplay()?s=n=0:(s=t*e+1,n=s+t-1,r&&n>i&&(n=i)),this.lbFirstRowOnPage.textContent=this.formatNumber(s),(o=this.rowNodeBlockLoader)!=null&&o.isLoading()){const a=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=a("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(n)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages();return e&&t===0}setTotalLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages(),r=e?this.paginationService.getMasterRowCount():null;if(r===1){const i=this.rowModel.getRow(0);if(i&&i.group&&!(i.groupData||i.aggData)){this.setTotalLabelsToZero();return}}if(e)this.lbTotal.textContent=this.formatNumber(t),this.lbRecordCount.textContent=this.formatNumber(r);else{const i=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=i,this.lbRecordCount.innerHTML=i}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}},ote={selector:"AG-PAGINATION",component:nte},ate=class extends xe{constructor(){super(...arguments),this.beanName="paginationService",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return ote}isPaginateChildRows(){return this.gos.get("groupRemoveSingleChildren")||this.gos.get("groupRemoveLowestSingleChildren")?!0:this.gos.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){!this.active||this.currentPage===e||typeof this.currentPage!="number"||(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}isRowPresent(e){return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){return this.active?this.getPageForIndex(e.rowIndex)===this.currentPage:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return ke(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:ke(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:ke(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:ke(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.pageBoundsService.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let r=this.pageSize*(this.currentPage+1)-1;if(r>e&&(r=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),r===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const i=this.rowModel.getTopLevelRowDisplayedIndex(r+1);this.bottomDisplayedRowIndex=i-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),this.masterRowCount===0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:i=!1}=e,s={type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:i,keepRenderedRows:t};this.eventService.dispatchEvent(s)}},tT={version:Ze,moduleName:"@ag-grid-community/pagination-core",beans:[ate,tte]},lte={version:Ze,moduleName:"@ag-grid-community/pagination-api",dependantModules:[tT],apiFunctions:{paginationIsLastPageFound:Uee,paginationGetPageSize:Kee,paginationGetCurrentPage:jee,paginationGetTotalPages:qee,paginationGetRowCount:Yee,paginationGoToNextPage:Xee,paginationGoToPreviousPage:Qee,paginationGoToFirstPage:Jee,paginationGoToLastPage:Zee,paginationGoToPage:ete}},cte={version:Ze,moduleName:"@ag-grid-community/pagination",dependantModules:[tT,lte]},me="@ag-grid-community/core",fs="@ag-grid-community/client-side-row-model",zS="@ag-grid-community/csv-export",_u="@ag-grid-community/infinite-row-model",Iu="@ag-grid-enterprise/advanced-filter",Vi="@ag-grid-enterprise/charts",ta="@ag-grid-enterprise/clipboard",fl="@ag-grid-enterprise/excel-export",Ou="@ag-grid-enterprise/master-detail",Of="@ag-grid-enterprise/menu",Lf="@ag-grid-enterprise/range-selection",Mt="@ag-grid-enterprise/row-grouping",_s="@ag-grid-enterprise/server-side-row-model",ps="@ag-grid-enterprise/side-bar",ute="@ag-grid-enterprise/status-bar",dte={dispatchEvent:me,getState:me,getGridId:me,destroy:me,isDestroyed:me,getGridOption:me,setGridOption:me,updateGridOptions:me,setNodesSelected:me,selectAll:me,deselectAll:me,selectAllFiltered:me,deselectAllFiltered:me,selectAllOnCurrentPage:me,deselectAllOnCurrentPage:me,getSelectedNodes:me,getSelectedRows:me,redrawRows:me,setRowNodeExpanded:me,getRowNode:me,addRenderedRowListener:me,getRenderedNodes:me,forEachNode:me,getFirstDisplayedRow:me,getFirstDisplayedRowIndex:me,getLastDisplayedRow:me,getLastDisplayedRowIndex:me,getDisplayedRowAtIndex:me,getDisplayedRowCount:me,getModel:me,getVerticalPixelRange:me,getHorizontalPixelRange:me,ensureColumnVisible:me,ensureIndexVisible:me,ensureNodeVisible:me,getFocusedCell:me,clearFocusedCell:me,setFocusedCell:me,tabToNextCell:me,tabToPreviousCell:me,setFocusedHeader:me,addEventListener:me,addGlobalListener:me,removeEventListener:me,removeGlobalListener:me,expireValueCache:me,getValue:me,getCellValue:me,showColumnMenuAfterButtonClick:me,showColumnMenuAfterMouseClick:me,showColumnMenu:me,hidePopupMenu:me,onSortChanged:me,getPinnedTopRowCount:me,getPinnedBottomRowCount:me,getPinnedTopRow:me,getPinnedBottomRow:me,showLoadingOverlay:me,showNoRowsOverlay:me,hideOverlay:me,setGridAriaProperty:me,refreshCells:me,flashCells:me,refreshHeader:me,isAnimationFrameQueueEmpty:me,flushAllAnimationFrames:me,getSizesForCurrentTheme:me,getCellRendererInstances:me,addRowDropZone:me,removeRowDropZone:me,getRowDropZoneParams:me,getColumnDef:me,getColumnDefs:me,sizeColumnsToFit:me,setColumnGroupOpened:me,getColumnGroup:me,getProvidedColumnGroup:me,getDisplayNameForColumn:me,getDisplayNameForColumnGroup:me,getColumn:me,getColumns:me,applyColumnState:me,getColumnState:me,resetColumnState:me,getColumnGroupState:me,setColumnGroupState:me,resetColumnGroupState:me,isPinning:me,isPinningLeft:me,isPinningRight:me,getDisplayedColAfter:me,getDisplayedColBefore:me,setColumnVisible:me,setColumnsVisible:me,setColumnPinned:me,setColumnsPinned:me,getAllGridColumns:me,getDisplayedLeftColumns:me,getDisplayedCenterColumns:me,getDisplayedRightColumns:me,getAllDisplayedColumns:me,getAllDisplayedVirtualColumns:me,moveColumn:me,moveColumnByIndex:me,moveColumns:me,setColumnWidth:me,setColumnWidths:me,getLeftDisplayedColumnGroups:me,getCenterDisplayedColumnGroups:me,getRightDisplayedColumnGroups:me,getAllDisplayedColumnGroups:me,autoSizeColumn:me,autoSizeColumns:me,autoSizeAllColumns:me,undoCellEditing:me,redoCellEditing:me,getCellEditorInstances:me,getEditingCells:me,stopEditing:me,startEditingCell:me,getCurrentUndoSize:me,getCurrentRedoSize:me,isAnyFilterPresent:me,onFilterChanged:me,isColumnFilterPresent:me,getFilterInstance:me,getColumnFilterInstance:me,destroyFilter:me,setFilterModel:me,getFilterModel:me,getColumnFilterModel:me,setColumnFilterModel:me,showColumnFilter:me,isQuickFilterPresent:me,getQuickFilter:me,resetQuickFilter:me,paginationIsLastPageFound:me,paginationGetPageSize:me,paginationGetCurrentPage:me,paginationGetTotalPages:me,paginationGetRowCount:me,paginationGoToNextPage:me,paginationGoToPreviousPage:me,paginationGoToFirstPage:me,paginationGoToLastPage:me,paginationGoToPage:me,expandAll:me,collapseAll:me,onRowHeightChanged:me,setRowCount:me,getCacheBlockState:me,onGroupExpandedOrCollapsed:fs,refreshClientSideRowModel:fs,forEachLeafNode:fs,forEachNodeAfterFilter:fs,forEachNodeAfterFilterAndSort:fs,resetRowHeights:fs,applyTransaction:fs,applyTransactionAsync:fs,flushAsyncTransactions:fs,getBestCostNodeSelection:fs,getDataAsCsv:zS,exportDataAsCsv:zS,refreshInfiniteCache:_u,purgeInfiniteCache:_u,getInfiniteRowCount:_u,isLastRowIndexKnown:_u,getAdvancedFilterModel:Iu,setAdvancedFilterModel:Iu,showAdvancedFilterBuilder:Iu,hideAdvancedFilterBuilder:Iu,getChartModels:Vi,getChartRef:Vi,getChartImageDataURL:Vi,downloadChart:Vi,openChartToolPanel:Vi,closeChartToolPanel:Vi,createRangeChart:Vi,createPivotChart:Vi,createCrossFilterChart:Vi,updateChart:Vi,restoreChart:Vi,copyToClipboard:ta,cutToClipboard:ta,copySelectedRowsToClipboard:ta,copySelectedRangeToClipboard:ta,copySelectedRangeDown:ta,pasteFromClipboard:ta,getDataAsExcel:fl,exportDataAsExcel:fl,getSheetDataForExcel:fl,getMultipleSheetsAsExcel:fl,exportMultipleSheetsAsExcel:fl,addDetailGridInfo:Ou,removeDetailGridInfo:Ou,getDetailGridInfo:Ou,forEachDetailGridInfo:Ou,showContextMenu:Of,showColumnChooser:Of,hideColumnChooser:Of,getCellRanges:Lf,addCellRange:Lf,clearRangeSelection:Lf,addAggFunc:Mt,addAggFuncs:Mt,clearAggFuncs:Mt,setColumnAggFunc:Mt,isPivotMode:Mt,getPivotResultColumn:Mt,setValueColumns:Mt,getValueColumns:Mt,removeValueColumn:Mt,removeValueColumns:Mt,addValueColumn:Mt,addValueColumns:Mt,setRowGroupColumns:Mt,removeRowGroupColumn:Mt,removeRowGroupColumns:Mt,addRowGroupColumn:Mt,addRowGroupColumns:Mt,getRowGroupColumns:Mt,moveRowGroupColumn:Mt,setPivotColumns:Mt,removePivotColumn:Mt,removePivotColumns:Mt,addPivotColumn:Mt,addPivotColumns:Mt,getPivotColumns:Mt,setPivotResultColumns:Mt,getPivotResultColumns:Mt,getServerSideSelectionState:_s,setServerSideSelectionState:_s,applyServerSideTransaction:_s,applyServerSideTransactionAsync:_s,applyServerSideRowData:_s,retryServerSideLoads:_s,flushServerSideAsyncTransactions:_s,refreshServerSide:_s,getServerSideGroupLevelState:_s,isSideBarVisible:ps,setSideBarVisible:ps,setSideBarPosition:ps,openToolPanel:ps,closeToolPanel:ps,getOpenedToolPanel:ps,refreshToolPanel:ps,isToolPanelShowing:ps,getToolPanelInstance:ps,getSideBar:ps,getStatusPanel:ute},ci="clientSide",Jr="serverSide",ra="infinite",hte={onGroupExpandedOrCollapsed:[ci],refreshClientSideRowModel:[ci],forEachLeafNode:[ci],forEachNodeAfterFilter:[ci],forEachNodeAfterFilterAndSort:[ci],resetRowHeights:[ci],applyTransaction:[ci],applyTransactionAsync:[ci],flushAsyncTransactions:[ci],getBestCostNodeSelection:[ci],getServerSideSelectionState:[Jr],setServerSideSelectionState:[Jr],applyServerSideTransaction:[Jr],applyServerSideTransactionAsync:[Jr],applyServerSideRowData:[Jr],retryServerSideLoads:[Jr],flushServerSideAsyncTransactions:[Jr],refreshServerSide:[Jr],getServerSideGroupLevelState:[Jr],refreshInfiniteCache:[ra],purgeInfiniteCache:[ra],getInfiniteRowCount:[ra],isLastRowIndexKnown:[ra],expandAll:[ci,Jr],collapseAll:[ci,Jr],onRowHeightChanged:[ci,Jr],setRowCount:[ra,Jr],getCacheBlockState:[ra,Jr]},fte={getValue:{version:"v31.3",new:"getCellValue"},getFirstDisplayedRow:{version:"v31.1",new:"getFirstDisplayedRowIndex"},getLastDisplayedRow:{version:"v31.1",new:"getLastDisplayedRowIndex"},getModel:{version:"v31.1",message:"Please use the appropriate grid API methods instead."},setColumnVisible:{version:"v31.1",old:"setColumnVisible(key,visible)",new:"setColumnsVisible([key],visible)"},setColumnPinned:{version:"v31.1",old:"setColumnPinned(key,pinned)",new:"setColumnsPinned([key],pinned)"},moveColumn:{version:"v31.1",old:"moveColumn(key, toIndex)",new:"moveColumns([key], toIndex)"},setColumnWidth:{version:"v31.1",old:"setColumnWidth(col, width)",new:"setColumnWidths([{key: col, newWidth: width}])"},autoSizeColumn:{version:"v31.1",old:"autoSizeColumn(key, skipHeader)",new:"autoSizeColumns([key], skipHeader)"},addAggFunc:{version:"v31.1",old:"addAggFunc(key, func)",new:"addAggFuncs({ key: func })"},removeValueColumn:{version:"v31.1",old:"removeValueColumn(colKey)",new:"removeValueColumns([colKey])"},addValueColumn:{version:"v31.1",old:"addValueColumn(colKey)",new:"addValueColumns([colKey])"},removeRowGroupColumn:{version:"v31.1",old:"removeRowGroupColumn(colKey)",new:"removeRowGroupColumns([colKey])"},addRowGroupColumn:{version:"v31.1",old:"addRowGroupColumn(colKey)",new:"addRowGroupColumns([colKey])"},removePivotColumn:{version:"v31.1",old:"removePivotColumn(colKey)",new:"removePivotColumns([colKey])"},addPivotColumn:{version:"v31.1",old:"addPivotColumn(colKey)",new:"addPivotColumns([colKey])"},showColumnMenuAfterButtonClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere."},showColumnMenuAfterMouseClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere."},getFilterInstance:{version:"v31.1",message:"'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."},showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'}};function pte(e,t){const r=dte[e];r?Ur.__assertRegistered(r,`api.${e}`,t)&&Te(`API function '${e}' not registered to module '${r}'`):pt(`Unknown API function: '${e}' on GridApi.`)}function gte(e,t,r){const i=fte[e];if(i){const{version:n,new:o,old:a,message:l}=i,c=a??e;return(...u)=>{const d=o?`Please use ${o} instead. `:"";return Te(`Since ${n} api.${c} is deprecated. ${d}${l??""}`),t.apply(t,u)}}const s=hte[e];return s?(...n)=>{const o=r.rowModel.getType();if(!s.includes(o)){pt(`api.${e} can only be called when gridOptions.rowModelType is ${s.join(" or ")}`);return}return t.apply(t,n)}:t}var mte={columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"}},dn=(e,t)=>(t.rowModelType??"clientSide")==="clientSide"?{module:"@ag-grid-enterprise/row-grouping"}:null,vte={enableRowGroup:dn,rowGroup:dn,rowGroupIndex:dn,enablePivot:dn,enableValue:dn,pivot:dn,pivotIndex:dn,aggFunc:dn,cellEditor:e=>e.cellEditor==="agRichSelect"||e.cellEditor==="agRichSelectCellEditor"?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{var r;const t=["columnsMenuTab","generalMenuTab"];return(r=e.menuTabs)!=null&&r.some(i=>t.includes(i))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>ha},Cte={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0},wte=Object.keys(Cte),ha={objectName:"colDef",allProperties:wte,docsUrl:"column-properties/",deprecations:mte,validations:vte},Ste=()=>({advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."},suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."}}),yte={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0},xte=()=>({sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:e=>{const t=e.rowModelType??"clientSide";switch(t){case"clientSide":{const r=`treeData requires 'getDataPath' in the ${t} row model.`;return e.getDataPath?null:r}case"serverSide":{const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${t} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:r}}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:e=>{switch(e.rowModelType??"clientSide"){case"clientSide":return null;case"serverSide":return e.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupHideOpenParents:{supportedRowModels:["clientSide"],dependencies:{groupTotalRow:[void 0,"bottom"]}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>ha,defaultColDef:()=>ha,defaultColGroupDef:()=>ha,autoGroupColumnDef:()=>ha}),bte=()=>({objectName:"gridOptions",allProperties:[...xc.ALL_PROPERTIES,...ji.EVENT_CALLBACKS],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:Ste(),validations:xte()}),Rte=class extends xe{constructor(){super(...arguments),this.beanName="validationService"}wireBeans(e){this.beans=e,this.gridOptions=e.gridOptions}postConstruct(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,bte())}processColumnDefs(e){this.processOptions(e,ha)}warnMissingApiFunction(e){pte(e,this.gridId)}validateApiFunction(e,t){return gte(e,t,this.beans)}processOptions(e,t){const{validations:r,deprecations:i,allProperties:s,propertyExceptions:n,objectName:o,docsUrl:a}=t;s&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...n??[],...Object.keys(i)],s,o,a);const l=new Set;Object.keys(e).forEach(u=>{const d=i[u];if(d)if("renamed"in d){const{renamed:w,version:C}=d;l.add(`As of v${C}, ${String(u)} is deprecated. Please use ${String(w)} instead.`),e[w]=e[u]}else{const{message:w,version:C}=d;l.add(`As of v${C}, ${String(u)} is deprecated. ${w??""}`)}const h=e[u];if(h==null||h===!1)return;const p=r[u];let g;if(p)if(typeof p=="function"){const w=p(e,this.gridOptions);if(!w)return;if("objectName"in w){const C=e[u];if(Array.isArray(C)){C.forEach(F=>{this.processOptions(F,w)});return}this.processOptions(e[u],w);return}g=w}else g=p;else return;const{module:f,dependencies:m,supportedRowModels:v}=g;if(v){const w=this.gridOptions.rowModelType??"clientSide";if(!v.includes(w)){l.add(`${String(u)} is not supported with the '${w}' row model.`);return}}if(f){const w=Array.isArray(f)?f:[f];let C=!0;if(w.forEach(F=>{Ur.__assertRegistered(F,String(u),this.gridId)||(C=!1,l.add(`${String(u)} is only available when ${F} is loaded.`))}),!C)return}if(m){const w=this.checkForWarning(u,m,e);if(w){l.add(w);return}}}),l.size>0&&l.forEach(u=>{Te(u)})}checkForWarning(e,t,r){if(typeof t=="function")return t(r,this.gridOptions);const s=Object.entries(t).find(([a,l])=>{const c=r[a];return!l.includes(c)});if(!s)return null;const[n,o]=s;return o.length>1?`'${String(e)}' requires '${n}' to be one of [${o.join(", ")}].`:`'${String(e)}' requires '${n}' to be ${o[0]}.`}checkProperties(e,t,r,i,s){const n=["__ob__","__v_skip","__metadata__"],o=Mj(Object.getOwnPropertyNames(e),[...n,...t,...r],r);if(Ei(o,(a,l)=>{let c=`invalid ${i} property '${a}' did you mean any of these: ${l.slice(0,8).join(", ")}.`;r.includes("context")&&(c+=`
If you are trying to annotate ${i} with application data, use the '${i}.context' property instead.`),Te(c)}),Object.keys(o).length>0&&s){const a=this.getFrameworkOverrides().getDocLink(s);Te(`to see all the valid ${i} properties please check: ${a}`)}}},Ete={version:Ze,moduleName:"@ag-grid-community/core"},Fte={version:Ze,moduleName:"@ag-grid-community/core-validations",beans:[Rte]},rT={version:Ze,moduleName:"@ag-grid-community/core-community-features",dependantModules:[Ete,Fte,NQ,hY,$ee,wZ,AJ,cte,Hee]},Tte=class extends xe{constructor(){super(...arguments),this.beanName="gridDestroyService",this.destroyCalled=!1}wireBeans(e){this.beans=e}destroy(){var t,r;if(this.destroyCalled)return;const e={type:"gridPreDestroyed",state:((t=this.beans.stateService)==null?void 0:t.getState())??{}};this.eventService.dispatchEvent(e),this.destroyCalled=!0,(r=this.beans.ctrlsService.get("gridCtrl"))==null||r.destroyGridUi(),this.beans.context.destroy(),super.destroy()}isDestroyCalled(){return this.destroyCalled}},Yl=new Set(["gridPreDestroyed","fillStart","pasteStart"]),Ate=e=>e==="checkboxSelected"||e==="rowClicked"||e==="spaceKey"||e==="uiSelectAll"||e==="uiSelectAllCurrentPage"||e==="uiSelectAllFiltered",Pte=new Map([...xc.BOOLEAN_PROPERTIES.map(e=>[e,jp]),...xc.NUMBER_PROPERTIES.map(e=>[e,wF]),["groupAggFiltering",e=>typeof e=="function"?e:jp(e)],["pageSize",hs(1)],["autoSizePadding",hs(0)],["keepDetailRowsCount",hs(1)],["rowBuffer",hs(0)],["infiniteInitialRowCount",hs(1)],["cacheOverflowSize",hs(1)],["cacheBlockSize",hs(1)],["serverSideInitialRowCount",hs(1)],["viewportRowModelPageSize",hs(1)],["viewportRowModelBufferSize",hs(0)]]);function iT(e,t){const r=Pte.get(e);return r?r(t):t}function Dte(e){const t={};return Object.entries(e).forEach(([r,i])=>{const s=iT(r,i);t[r]=s}),t}var sT=class nT extends xe{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new Ya,this.globalEventHandlerFactory=t=>(r,i)=>{if(!this.isAlive())return;const s=Yl.has(r);if(s&&!t||!s&&t)return;const n=ji.getCallbackForEvent(r),o=this.gridOptions[n];typeof o=="function"&&this.frameworkOverrides.wrapOutgoing(()=>{o(i)})}}wireBeans(t){this.gridOptions=t.gridOptions,this.eGridDiv=t.eGridDiv,this.validationService=t.validationService,this.environment=t.environment,this.api=t.gridApi}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){const t=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),t),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth(),this.addManagedEventListeners({gridOptionsChanged:({options:r})=>{this.updateGridOptions({options:r,force:!0,source:"gridOptionsUpdated"})}})}get(t){return this.gridOptions[t]??yte[t]}getCallback(t){return this.mergeGridCommonParams(this.gridOptions[t])}exists(t){return ke(this.gridOptions[t])}mergeGridCommonParams(t){return t&&(i=>{const s=i;return s.api=this.api,s.context=this.gridOptionsContext,t(s)})}updateGridOptions({options:t,force:r,source:i="api"}){var o;const s={id:nT.changeSetId++,properties:[]},n=[];Object.entries(t).forEach(([a,l])=>{i==="api"&&NK[a]&&Te(`${a} is an initial property and cannot be updated.`);const c=iT(a,l),u=r||typeof c=="object"&&i==="api",d=this.gridOptions[a];if(u||d!==c){this.gridOptions[a]=c;const h={type:a,currentValue:c,previousValue:d,changeSet:s,source:i};n.push(h)}}),(o=this.validationService)==null||o.processGridOptions(this.gridOptions),s.properties=n.map(a=>a.type),n.forEach(a=>{this.gridOptions.debug&&Ti(`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propertyEventService.dispatchEvent(a)})}addPropertyEventListener(t,r){this.propertyEventService.addEventListener(t,r)}removePropertyEventListener(t,r){this.propertyEventService.removeEventListener(t,r)}getScrollbarWidth(){if(this.scrollbarWidth==null){const r=typeof this.gridOptions.scrollbarWidth=="number"&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:ij();r!=null&&(this.scrollbarWidth=r,this.eventService.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}isRowModelType(t){return this.gridOptions.rowModelType===t||t==="clientSide"&&ut(this.gridOptions.rowModelType)}isDomLayout(t){return(this.gridOptions.domLayout??"normal")===t}isRowSelection(){return this.gridOptions.rowSelection==="single"||this.gridOptions.rowSelection==="multiple"}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return typeof this.gridOptions.getRowHeight=="function"}getRowHeightForNode(t,r=!1,i){if(i==null&&(i=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(r)return{height:i,estimated:!0};const n={node:t,data:t.data},o=this.getCallback("getRowHeight")(n);if(this.isNumeric(o))return o===0&&Te("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,o),estimated:!1}}return t.detail&&this.get("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:i,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||ut(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const t=this.environment.refreshRowHeightVariable();return t!==-1?t:(Te("row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(t){return!isNaN(t)&&typeof t=="number"&&isFinite(t)}getDomDataKey(){return this.domDataKey}getDomData(t,r){const i=t[this.getDomDataKey()];return i?i[r]:void 0}setDomData(t,r,i){const s=this.getDomDataKey();let n=t[s];ut(n)&&(n={},t[s]=n),n[r]=i}getDocument(){let t=null;return this.gridOptions.getDocument&&ke(this.gridOptions.getDocument)?t=this.gridOptions.getDocument():this.eGridDiv&&(t=this.eGridDiv.ownerDocument),t&&ke(t)?t:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getActiveDomElement(){return this.getRootNode().activeElement}getAsyncTransactionWaitMillis(){return ke(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return this.get("ensureDomOrder")?!1:this.get("animateRows")}isGroupRowsSticky(){return!(this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const t=this.gridOptions.autoGroupColumnDef;return!(t!=null&&t.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const t=this.gridOptions.groupAggFiltering;if(typeof t=="function")return this.getCallback("groupAggFiltering");if(t===!0)return()=>!0}getGrandTotalRow(){const t=this.gridOptions.grandTotalRow;if(t)return t;if(this.gridOptions.groupIncludeTotalFooter)return"bottom"}getGroupTotalRowCallback(){const t=this.get("groupTotalRow");if(typeof t=="function")return this.getCallback("groupTotalRow");if(t)return()=>t;const r=this.get("groupIncludeFooter");if(typeof r=="function"){const i=this.getCallback("groupIncludeFooter");return s=>i(s)?"bottom":void 0}return()=>r?"bottom":void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?this.gridOptions.groupDisplayType==="multipleColumns":this.get("groupHideOpenParents")}isGroupUseEntireRow(t){return t?!1:this.gridOptions.groupDisplayType==="groupRows"}getGridCommonParams(){return{api:this.api,context:this.gridOptionsContext}}addGridCommonParams(t){const r=t;return r.api=this.api,r.context=this.gridOptionsContext,r}getRowIdCallback(){const t=this.getCallback("getRowId");return t===void 0?t:r=>{let i=t(r);return typeof i!="string"&&(Te("The getRowId callback must return a string. The ID ",i," is being cast to a string."),i=String(i)),i}}};sT.changeSetId=0;var Mte=sT,kte=class extends xe{constructor(){super(...arguments),this.beanName="headerPositionUtils"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}findHeader(e,t){let r,i;if(Jt(e.column)?r=this.visibleColsService.getGroupAtDirection(e.column,t):(i=`getCol${t}`,r=this.visibleColsService[i](e.column)),!r)return;const{headerRowIndex:s}=e;if(this.getHeaderRowType(s)!=="filter"){const a=[r];for(;r.getParent();)r=r.getParent(),a.push(r);r=a[a.length-1-s]}const{column:n,headerRowIndex:o}=this.getHeaderIndexToFocus(r,s);return{column:n,headerRowIndex:o}}getHeaderIndexToFocus(e,t){let r;if(Jt(e)&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const i=e;r=i.getLeafColumns()[0];let s=r;for(;s!==i;)t++,s=s.getParent()}return{column:r||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return e?e.getLeafColumns().some(t=>t.isSpanHeaderHeight()):!1}getColumnVisibleParent(e,t){const r=this.getHeaderRowType(t),i=r==="filter",s=r==="column";let n=i?e:e.getParent(),o=t-1,a=o;if(s&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;a=o,o<0&&(n=e,o=t,a=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:a}}getColumnVisibleChild(e,t,r="After"){const i=this.getHeaderRowType(t);let s=e,n=t+1;const o=n;if(i==="group"){const a=e.getDisplayedLeafColumns(),l=r==="After"?a[0]:ft(a),c=[];let u=l;for(;u.getParent()!==e;)u=u.getParent(),c.push(u);if(s=l,l.isSpanHeaderHeight())for(let d=c.length-1;d>=0;d--){const h=c[d];if(!h.isPadding()){s=h;break}n++}else s=ft(c),s||(s=l)}return{column:s,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const r=this.visibleColsService.getAllCols(),i=r[t==="start"?0:r.length-1];if(!i)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(i.getPinned()).getRowType(e);if(n=="group"){const o=this.visibleColsService.getColGroupAtLevel(i,e);return{headerRowIndex:e,column:o}}return{headerRowIndex:n==null?-1:e,column:i}}},_te=class extends xe{constructor(){super(...arguments),this.beanName="localeService"}getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(r,i,s)=>e({key:r,defaultValue:i,variableValues:s});const t=this.gos.get("localeText");return(r,i,s)=>{let n=t&&t[r];if(n&&s&&s.length){let o=0;for(;!(o>=s.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",s[o++])}return n??i}}},Ite=class extends xe{constructor(){super(...arguments),this.beanName="apiEventService",this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new K0(this.getFrameworkOverrides())}addEventListener(e,t){const r=this.frameworkEventWrappingService.wrap(t),i=this.gos.useAsyncEvents()&&!Yl.has(e),s=i?this.asyncEventListeners:this.syncEventListeners;s.has(e)||s.set(e,new Set),s.get(e).add(r),this.eventService.addEventListener(e,r,i)}removeEventListener(e,t){var n;const r=this.frameworkEventWrappingService.unwrap(t),i=this.asyncEventListeners.get(e),s=!!(i!=null&&i.delete(r));s||(n=this.syncEventListeners.get(e))==null||n.delete(r),this.eventService.removeEventListener(e,r,s)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(this.gos.useAsyncEvents()){const i=(n,o)=>{Yl.has(n)&&t(n,o)},s=(n,o)=>{Yl.has(n)||t(n,o)};this.globalEventListenerPairs.set(e,{syncListener:i,asyncListener:s}),this.eventService.addGlobalListener(i,!1),this.eventService.addGlobalListener(s,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:i,asyncListener:s}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(i,!1),this.eventService.removeGlobalListener(s,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach((r,i)=>{r.forEach(s=>this.eventService.removeEventListener(i,s,t)),r.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(r=>this.eventService.removeGlobalListener(r,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener:e,asyncListener:t})=>{this.eventService.removeGlobalListener(e,!1),this.eventService.removeGlobalListener(t,!0)}),this.globalEventListenerPairs.clear()}},Ote=class extends xe{constructor(){super(...arguments),this.beanName="pageBoundsListener"}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages();const t={type:"paginationChanged",animate:e?e.animate:!1,newData:e?e.newData:!1,newPage:e?e.newPage:!1,newPageSize:e?e.newPageSize:!1,keepRenderedRows:e?e.keepRenderedRows:!1};this.eventService.dispatchEvent(t)}calculatePages(){this.paginationService?this.paginationService.calculatePages():this.pageBoundsService.calculateBounds(0,this.rowModel.getRowCount()-1)}},Lte=class extends xe{constructor(){super(...arguments),this.beanName="pageBoundsService",this.pixelOffset=0}wireBeans(e){this.rowModel=e.rowModel}getFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getCurrentPageHeight(){return ut(this.topRowBounds)||ut(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){const e=this.topRowBounds?this.topRowBounds.rowTop:0,t=this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0;return{pageFirstPixel:e,pageLastPixel:t}}calculateBounds(e,t){this.topRowBounds=this.rowModel.getRowBounds(e),this.topRowBounds&&(this.topRowBounds.rowIndex=e),this.bottomRowBounds=this.rowModel.getRowBounds(t),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=t),this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=ke(this.topRowBounds)?this.topRowBounds.rowTop:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},Nte=class extends xe{constructor(){super(),this.beanName="ariaAnnouncementService",this.descriptionContainer=null,this.announceValue=qr(this.announceValue.bind(this),200)}wireBeans(e){this.eGridDiv=e.eGridDiv}postConstruct(){const e=this.gos.getDocument(),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),_E(t,"polite"),zK(t,"additions text"),WK(t,!0),this.eGridDiv.appendChild(t)}announceValue(e){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)},50))}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Or(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null}},Bte=class extends xe{constructor(){super(...arguments),this.beanName="columnAnimationService",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(e){this.active?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(e){if(this.executeNextFuncs.length===0&&this.executeLaterFuncs.length===0){e();return}const t=r=>{for(;r.length;){const i=r.pop();i&&i()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>t(this.executeNextFuncs),0),window.setTimeout(()=>{e(),t(this.executeLaterFuncs)},200)})}},Gte=class extends xe{constructor(){super(...arguments),this.beanName="columnHoverService"}setMouseOver(e){this.selectedColumns=e;const t={type:"columnHoverChanged"};this.eventService.dispatchEvent(t)}clearMouseOver(){this.selectedColumns=null;const e={type:"columnHoverChanged"};this.eventService.dispatchEvent(e)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}},Hte=class extends xe{constructor(){super(...arguments),this.beanName="overlayService",this.state=0,this.showInitialOverlay=!0}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.rowModel=e.rowModel,this.columnModel=e.columnModel}postConstruct(){const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e}),this.addManagedPropertyListener("loading",e)}registerOverlayWrapperComp(e){this.overlayWrapperComp=e,this.updateOverlayVisibility()}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos.get("loading");!e&&(e!==void 0||this.gos.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1,!(this.gos.get("loading")||this.gos.get("suppressNoRowsOverlay"))&&this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,!this.gos.get("loading")&&this.doHideOverlay()}updateOverlayVisibility(){let e=this.gos.get("loading");this.showInitialOverlay&&e===void 0&&!this.gos.get("suppressLoadingOverlay")&&(e=!this.gos.get("columnDefs")||!this.columnModel.isReady()||!this.gos.get("rowData")&&this.gos.isRowModelType("clientSide")),e?this.state!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,this.rowModel.isEmpty()&&!this.gos.get("suppressNoRowsOverlay")&&this.gos.isRowModelType("clientSide")?this.state!==2&&this.doShowNoRowsOverlay():this.state!==0&&this.doHideOverlay())}doShowLoadingOverlay(){this.state=1,this.showOverlay(this.userComponentFactory.getLoadingOverlayCompDetails({}),"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}doShowNoRowsOverlay(){this.state=2,this.showOverlay(this.userComponentFactory.getNoRowsOverlayCompDetails({}),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}doHideOverlay(){this.state=0,this.overlayWrapperComp.hideOverlay()}showOverlay(e,t,r){const i=e.newAgStackInstance();this.overlayWrapperComp.showOverlay(i,t,r)}},Vte=class extends xe{constructor(){super(...arguments),this.beanName="rowCssClassCalculator"}wireBeans(e){this.stylingService=e.stylingService}getInitialRowClasses(e){const t=[];return ke(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),xS(t,this.processClassesFromGridOptions(e.rowNode)),xS(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&(e.pinned==="left"&&t.push("ag-cell-last-left-pinned"),e.pinned==="right"&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],r=n=>{typeof n=="string"?t.push(n):Array.isArray(n)&&n.forEach(o=>t.push(o))},i=this.gos.get("rowClass");if(i){if(typeof i=="function")return Te("rowClass should not be a function, please use getRowClass instead"),[];r(i)}const s=this.gos.getCallback("getRowClass");if(s){const n={data:e.data,node:e,rowIndex:e.rowIndex},o=s(n);r(o)}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,r=>{t.push(r)},()=>{}),t}processRowClassRules(e,t,r){const i=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),i,t,r)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}},Wte=class extends xe{constructor(){super(...arguments),this.beanName="rowContainerHeightService",this.scrollY=0,this.uiBodyHeight=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=ej(),this.gos.get("debug")&&Ti("RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,r=this.getUiBodyHeight();(t!==this.scrollY||r!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=r,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.gos.get("debug")&&Ti(`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),r=e/t;return this.maxScrollY*r}},zte=class extends xe{constructor(){super(...arguments),this.beanName="rowNodeSorter"}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.showRowGroupColsService=e.showRowGroupColsService}postConstruct(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup())}doFullSort(e,t){const r=(s,n)=>({currentPos:n,rowNode:s}),i=e.map(r);return i.sort(this.compareRowNodes.bind(this,t)),i.map(s=>s.rowNode)}compareRowNodes(e,t,r){const i=t.rowNode,s=r.rowNode;for(let n=0,o=e.length;n<o;n++){const a=e[n],l=a.sort==="desc",c=this.getValue(i,a.column),u=this.getValue(s,a.column);let d;const h=this.getComparator(a,i);if(h?d=h(c,u,i,s,l):d=uK(c,u,this.isAccentedSort),!isNaN(d)&&d!==0)return a.sort==="asc"?d:d*-1}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column,i=r.getColDef().comparator;if(i!=null)return i;if(!r.getColDef().showRowGroup)return;const s=!t.group&&r.getColDef().field;if(!s)return;const n=this.columnModel.getColDefCol(s);if(n)return n.getColDef().comparator}getValue(e,t){var i,s,n;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(this.gos.isGroupUseEntireRow(this.columnModel.isPivotActive())){const l=(i=e.allLeafChildren)==null?void 0:i[0];return l?this.valueService.getValue(t,l,!1,!1):void 0}const a=(s=this.showRowGroupColsService)==null?void 0:s.getShowRowGroupCol(t.getId());return a?(n=e.groupData)==null?void 0:n[a.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return this.valueService.getValue(t,e,!1,!1)}},Ah=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let r=0;r<e.children.length;r++)this.depthFirstSearchChangedPath(e.children[r],t);t(e.rowNode)}depthFirstSearchEverything(e,t,r){if(e.childrenAfterGroup)for(let i=0;i<e.childrenAfterGroup.length;i++){const s=e.childrenAfterGroup[i];s.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[i],t,r):r&&t(s)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const i={rowNode:t,children:null};this.mapToItems[t.id]=i,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;)this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={}),t.forEach(i=>this.nodeIdsToColumns[r.id][i.getId()]=!0),r=r.parent}linkPathItems(e,t){let r=e;for(let i=0;i<t;i++){const s=this.mapToItems[r.id],n=this.mapToItems[r.parent.id];n.children||(n.children=[]),n.children.push(s),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>r[s.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>!r[s.getId()])}},oT=class extends xe{constructor(){super(...arguments),this.beanName="selectionService",this.selectedNodes=new Map,this.selectionCtx=new KQ}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.selectionCtx.init(this.rowModel),this.rowSelection=this.gos.get("rowSelection"),this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.rowSelection=this.gos.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes(),this.selectionCtx.reset()}isMultiselect(){return this.rowSelection==="multiple"}overrideSelectionValue(e,t){if(!Ate(t))return e;const r=this.selectionCtx.getRoot();return r?r.isSelected()??!1:!0}setNodesSelected(e){var d;const{newValue:t,clearSelection:r,suppressFinishActions:i,rangeSelect:s,nodes:n,event:o,source:a}=e;if(n.length===0)return 0;if(n.length>1&&!this.isMultiselect())return Te("cannot multi select while rowSelection='single'"),0;const l=this.groupSelectsChildren&&e.groupSelectsFiltered===!0,c=n.map(h=>h.footer?h.sibling:h);if(s){if(c.length>1)return Te("cannot range select while selecting multiple rows"),0;const h=c[0],p=this.overrideSelectionValue(t,a);if(this.isMultiselect()){if(this.selectionCtx.isInRange(h)){const g=this.selectionCtx.truncate(h);return p&&this.selectRange(g.discard,!1,a),this.selectRange(g.keep,p,a)}else if(this.selectionCtx.getRoot()!==h){const m=this.selectionCtx.extend(h,this.groupSelectsChildren);return p&&this.selectRange(m.discard,!1,a),this.selectRange(m.keep,p,a)}}}i||this.selectionCtx.setRoot(c[0]);let u=0;for(let h=0;h<c.length;h++){const p=c[h];l&&p.group||p.selectThisNode(t,o,a)&&u++,this.groupSelectsChildren&&((d=p.childrenAfterGroup)!=null&&d.length)&&(u+=this.selectChildren(p,t,l,a))}return i||(t&&(r||!this.isMultiselect())&&(u+=this.clearOtherNodes(c[0],a)),u>0&&(this.updateGroupsFromChildrenSelections(a),this.dispatchSelectionChanged(a))),u}selectRange(e,t,r){let i=0;return e.forEach(s=>{if(s.group&&this.groupSelectsChildren)return;s.selectThisNode(t,void 0,r)&&i++}),i>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)),i}selectChildren(e,t,r,i){const s=r?e.childrenAfterAggFilter:e.childrenAfterGroup;return ut(s)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:r,source:i,nodes:s})}getSelectedNodes(){const e=[];return this.selectedNodes.forEach(t=>{t&&e.push(t)}),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>{t&&t.data&&e.push(t.data)}),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((r,i)=>{r&&e(r)&&t.set(i,r)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren||this.rowModel.getType()!=="clientSide")return!1;const i=this.rowModel.getRootNode();t||(t=new Ah(!0,i),t.setInactive());let s=!1;return t.forEachChangedNodeDepthFirst(n=>{if(n!==i){const o=n.calculateSelectedFromChildren();s=n.selectThisNode(o===null?!1:o,void 0,e)||s}}),s}clearOtherNodes(e,t){const r=new Map;let i=0;return this.selectedNodes.forEach(s=>{if(s&&s.id!==e.id){const n=this.selectedNodes.get(s.id);i+=n.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&s.parent&&r.set(s.parent.id,s.parent)}}),r.forEach(s=>{const n=s.calculateSelectedFromChildren();s.selectThisNode(n===null?!1:n,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if(ke(t)&&e.id!==t.id&&t){const i=t.id;this.selectedNodes.get(i)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){var e;(e=this.selectedNodes)==null||e.clear()}getBestCostNodeSelection(){if(this.rowModel.getType()!=="clientSide")return;const t=this.rowModel.getTopLevelNodes();if(t===null)return;const r=[];function i(s){for(let n=0,o=s.length;n<o;n++){const a=s[n];if(a.isSelected())r.push(a);else{const l=a;l.group&&l.children&&i(l.children)}}}return i(t),r}isEmpty(){let e=0;return this.selectedNodes.forEach(t=>{t&&e++}),e===0}deselectAllRowNodes(e){const t=o=>o.selectThisNode(!1,void 0,i),r=this.rowModel.getType()==="clientSide",{source:i,justFiltered:s,justCurrentPage:n}=e;if(n||s){if(!r){pt("selecting just filtered only works when gridOptions.rowModelType='clientSide'");return}this.getNodesToSelect(s,n).forEach(t)}else this.selectedNodes.forEach(o=>{o&&t(o)}),this.reset(i);this.selectionCtx.reset(),r&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)}getSelectedCounts(e,t){let r=0,i=0;const s=n=>{this.groupSelectsChildren&&n.group||(n.isSelected()?r++:n.selectable&&i++)};return this.getNodesToSelect(e,t).forEach(s),{selectedCount:r,notSelectedCount:i}}getSelectAllState(e,t){const{selectedCount:r,notSelectedCount:i}=this.getSelectedCounts(e,t);return r===0&&i===0?!1:r>0&&i>0?null:r>0}hasNodesToSelect(e=!1,t=!1){return this.getNodesToSelect(e,t).filter(r=>r.selectable).length>0}getNodesToSelect(e=!1,t=!1){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const r=[];if(t)return this.forEachNodeOnPage(s=>{if(!s.group){r.push(s);return}if(!s.expanded){const n=o=>{var a;r.push(o),(a=o.childrenAfterFilter)!=null&&a.length&&o.childrenAfterFilter.forEach(n)};n(s);return}this.groupSelectsChildren||r.push(s)}),r;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(s=>{r.push(s)}),r):(i.forEachNode(s=>{r.push(s)}),r)}forEachNodeOnPage(e){const t=this.pageBoundsService.getFirstRow(),r=this.pageBoundsService.getLastRow();for(let i=t;i<=r;i++){const s=this.rowModel.getRow(i);s&&e(s)}}selectAllRowNodes(e){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source:t,justFiltered:r,justCurrentPage:i}=e,s=this.getNodesToSelect(r,i);s.forEach(n=>n.selectThisNode(!0,void 0,t)),this.selectionCtx.setRoot(s[0]??null),this.selectionCtx.setEndRange(ft(s)??null),this.rowModel.getType()==="clientSide"&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t),this.dispatchSelectionChanged(t)}getSelectionState(){const e=[];return this.selectedNodes.forEach(t=>{t!=null&&t.id&&e.push(t.id)}),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return;const r=new Set(e),i=[];this.rowModel.forEachNode(s=>{r.has(s.id)&&i.push(s)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}dispatchSelectionChanged(e){const t={type:"selectionChanged",source:e};this.eventService.dispatchEvent(t)}},$te=class extends xe{constructor(){super(...arguments),this.beanName="selectableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(e=!1){const t=!!this.gos.get("rowSelection"),r=this.gos.get("isRowSelectable");if(!t||!r)return;const i=this.gos.get("groupSelectsChildren"),s=this.rowModel.getType()==="clientSide"&&i,n=[],o=a=>{if(e&&!a.group)return;if(s&&a.group){const c=a.childrenAfterGroup.some(u=>u.selectable===!0);a.setRowSelectable(c,!0);return}const l=r?r(a):!0;a.setRowSelectable(l,!0),!l&&a.isSelected()&&n.push(a)};if(s){const a=this.rowModel;new Ah(!1,a.getRootNode()).forEachChangedNodeDepthFirst(o,!0,!0)}else this.rowModel.forEachNode(o);n.length&&this.selectionService.setNodesSelected({nodes:n,newValue:!1,source:"selectableChanged"}),s&&this.selectionService instanceof oT&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},$S=["asc","desc",null],Ute=class extends xe{constructor(){super(...arguments),this.beanName="sortController"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.showRowGroupColsService=e.showRowGroupColsService}progressSort(e,t,r){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,r)}setSortForColumn(e,t,r,i){t!=="asc"&&t!=="desc"&&(t=null);const s=this.gos.isColumnsSortingCoupledToGroup();let n=[e];if(s&&e.getColDef().showRowGroup){const l=this.funcColsService.getSourceColumnsForGroupColumn(e),c=l==null?void 0:l.filter(u=>u.isSortable());c&&(n=[e,...c])}n.forEach(l=>l.setSort(t,i));const o=(r||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"),a=[];if(!o){const l=this.clearSortBarTheseColumns(n,i);a.push(...l)}this.updateSortIndex(e),a.push(...n),this.dispatchSortChangedEvents(i,a)}updateSortIndex(e){var a;const t=this.gos.isColumnsSortingCoupledToGroup(),r=(a=this.showRowGroupColsService)==null?void 0:a.getShowRowGroupCol(e.getId()),i=t&&r||e,s=this.getColumnsWithSortingOrdered();this.columnModel.getAllCols().forEach(l=>l.setSortIndex(null));const n=s.filter(l=>t&&l.getColDef().showRowGroup?!1:l!==i);(i.getSort()?[...n,i]:n).forEach((l,c)=>{l.setSortIndex(c)})}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const t=this.columnModel.getAllCols().filter(r=>!!r.getSort());return t&&t.length>0}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventService.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.columnModel.getAllCols().forEach(i=>{e.includes(i)||(i.getSort()&&r.push(i),i.setSort(void 0,t))}),r}getNextSortDirection(e){let t;if(e.getColDef().sortingOrder?t=e.getColDef().sortingOrder:this.gos.get("sortingOrder")?t=this.gos.get("sortingOrder"):t=$S,!Array.isArray(t)||t.length<=0)return Te(`sortingOrder must be an array with at least one element, currently it's ${t}`),null;const r=t.indexOf(e.getSort()),i=r<0,s=r==t.length-1;let n;return i||s?n=t[0]:n=t[r+1],$S.indexOf(n)<0?(Te("invalid sort type ",n),null):n}getIndexedSortMap(){let e=this.columnModel.getAllCols().filter(n=>!!n.getSort());if(this.columnModel.isPivotMode()){const n=this.gos.isColumnsSortingCoupledToGroup();e=e.filter(o=>{var u;const a=!!o.getAggFunc(),l=!o.isPrimary(),c=n?(u=this.showRowGroupColsService)==null?void 0:u.getShowRowGroupCol(o.getId()):o.getColDef().showRowGroup;return a||l||c})}const t=this.funcColsService.getRowGroupColumns().filter(n=>!!n.getSort()),r={};e.forEach((n,o)=>r[n.getId()]=o),e.sort((n,o)=>{const a=n.getSortIndex(),l=o.getSortIndex();if(a!=null&&l!=null)return a-l;if(a==null&&l==null){const c=r[n.getId()],u=r[o.getId()];return c>u?1:-1}else return l==null?-1:1});const i=this.gos.isColumnsSortingCoupledToGroup()&&!!t.length;i&&(e=[...new Set(e.map(n=>{var o;return((o=this.showRowGroupColsService)==null?void 0:o.getShowRowGroupCol(n.getId()))??n}))]);const s=new Map;return e.forEach((n,o)=>s.set(n,o)),i&&t.forEach(n=>{const o=this.showRowGroupColsService.getShowRowGroupCol(n.getId());s.set(n,s.get(o))}),s}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[r,i])=>t-i).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=this.gos.isColumnsSortingCoupledToGroup(),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){const t=this.funcColsService.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSort();const i=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,s=i[0].getSort();return i.every(o=>o.getSort()==s)?s:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}},Kte=class extends xe{constructor(){super(...arguments),this.beanName="syncService",this.waitingForColumns=!1}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.rowModel=e.rowModel}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.ctrlsService.whenReady(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const e=Ur.__isRegistered("@ag-grid-enterprise/core",this.gridId);this.gos.get("debug")&&Ti(`initialised successfully, enterprise = ${e}`)}dispatchGridReadyEvent(){const e={type:"gridReady"};this.eventService.dispatchEvent(e)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.columnModel.setColumnDefs(t,da(e.source))}}},jte="paste",qte=class extends xe{constructor(){super(...arguments),this.beanName="changeDetectionService"}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer}postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){e.source!==jte&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const r=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const i=this.gos.get("aggregateOnlyChangedColumns"),s=new Ah(i,this.clientSideRowModel.getRootNode());s.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(s),s.forEachChangedNodeDepthFirst(n=>{r.push(n)})}this.rowRenderer.refreshCells({rowNodes:r})}},Yte=class extends xe{constructor(){super(...arguments),this.beanName="expressionService",this.expressionToFunctionCache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);pt("value should be either a string or a function",e)}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return Ti("Processing of the expression failed"),Ti("Expression = ",e),Ti("Params = ",t),Ti("Exception = ",r),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),r=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=r,r}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},Xte=class extends xe{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,r){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=r)}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},Qte=class extends xe{constructor(){super(...arguments),this.beanName="valueService",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionService=e.expressionService,this.columnModel=e.columnModel,this.valueCache=e.valueCache,this.dataTypeService=e.dataTypeService}postConstruct(){this.initialised||this.init()}init(){this.isSsrm=this.gos.isRowModelType("serverSide"),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=r=>this.callColumnCellValueChangedHandler(r),t=this.gos.useAsyncEvents();this.eventService.addEventListener("cellValueChanged",e,t),this.addDestroyFunc(()=>this.eventService.removeEventListener("cellValueChanged",e,t)),this.addManagedPropertyListener("treeData",r=>this.isTreeData=r.currentValue)}getValue(e,t,r=!1,i=!1){if(this.initialised||this.init(),!t)return;const s=e.getColDef(),n=s.field,o=e.getColId(),a=t.data;let l;const c=t.groupData&&t.groupData[o]!==void 0,u=!i&&t.aggData&&t.aggData[o]!==void 0,d=this.isSsrm&&i&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(e.getColDef().showRowGroup===!0||e.getColDef().showRowGroup===t.field);if(r&&s.filterValueGetter?l=this.executeFilterValueGetter(s.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[o]:this.isTreeData&&s.valueGetter?l=this.executeValueGetter(s.valueGetter,a,e,t):this.isTreeData&&n&&a?l=$l(a,n,e.isFieldContainsDots()):c?l=t.groupData[o]:u?l=t.aggData[o]:s.valueGetter?l=this.executeValueGetter(s.valueGetter,a,e,t):h?l=$l(a,t.field,e.isFieldContainsDots()):n&&a&&!d&&(l=$l(a,n,e.isFieldContainsDots())),this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const p=l.substring(1);l=this.executeValueGetter(p,a,e,t)}if(l==null){const p=this.getOpenedGroup(t,e);if(p!=null)return p}return l}parseValue(e,t,r,i){const s=e.getColDef(),n=this.gos.addGridCommonParams({node:t,data:t==null?void 0:t.data,oldValue:i,newValue:r,colDef:s,column:e}),o=s.valueParser;return ke(o)?typeof o=="function"?o(n):this.expressionService.evaluate(o,n):r}formatValue(e,t,r,i,s=!0){let n=null,o;const a=e.getColDef();if(i?o=i:s&&(o=a.valueFormatter),o){const l=this.gos.addGridCommonParams({value:r,node:t,data:t?t.data:null,colDef:a,column:e});typeof o=="function"?n=o(l):n=this.expressionService.evaluate(o,l)}else if(a.refData)return a.refData[r]||"";return n==null&&Array.isArray(r)&&(n=r.join(", ")),n}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup")||!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let s=e.parent;for(;s!=null;){if(s.rowGroupColumn&&(i===!0||i===s.rowGroupColumn.getColId()))return s.key;s=s.parent}}setValue(e,t,r,i){const s=this.columnModel.getColDefCol(t);if(!e||!s)return!1;ut(e.data)&&(e.data={});const{field:n,valueSetter:o}=s.getColDef();if(ut(n)&&ut(o))return Te("you need either field or valueSetter set on colDef for editing to work"),!1;if(this.dataTypeService&&!this.dataTypeService.checkType(s,r))return Te("Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(s,e),newValue:r,colDef:s.getColDef(),column:s});a.newValue=r;let l;if(ke(o)?typeof o=="function"?l=o(a):l=this.expressionService.evaluate(o,a):l=this.setValueUsingField(e.data,n,r,s.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(s,e);const c={type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,api:a.api,colDef:a.colDef,context:a.context,data:e.data,node:e,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:i};return this.eventService.dispatchEvent(c),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.getFrameworkOverrides().wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,i){if(!t)return!1;let s=!1;if(!i)s=e[t]===r,s||(e[t]=r);else{const n=t.split(".");let o=e;for(;n.length>0&&o;){const a=n.shift();n.length===0?(s=o[a]===r,s||(o[a]=r)):o=o[a]}}return!s}executeFilterValueGetter(e,t,r,i){const s=this.gos.addGridCommonParams({data:t,node:i,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,i)});return typeof e=="function"?e(s):this.expressionService.evaluate(e,s)}executeValueGetter(e,t,r,i){const s=r.getColId(),n=this.valueCache.getValue(i,s);if(n!==void 0)return n;const o=this.gos.addGridCommonParams({data:t,node:i,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,i)});let a;return typeof e=="function"?a=e(o):a=this.expressionService.evaluate(e,o),this.valueCache.setValue(i,s,a),a}getValueCallback(e,t){const r=this.columnModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),i=e.getColDef().keyCreator;let s=r;if(i){const n=this.gos.addGridCommonParams({value:r,colDef:e.getColDef(),column:e,node:t,data:t.data});s=i(n)}return typeof s=="string"||s==null||(s=String(s),s==="[object Object]"&&Te("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),s}},ag=class{};ag.gridOptions=void 0;function Jte(e,t,r){if(!t)return pt("No gridOptions provided to createGrid"),{};const i=new ere().create(e,t,s=>{const n=new FJ(e);s.createBean(n)},void 0,r);if(!Object.isFrozen(t)&&!(r!=null&&r.frameworkOverrides)){const s="https://ag-grid.com/javascript-data-grid/grid-interface/#grid-api";Object.defineProperty(t,"api",{get:()=>{pt(`gridOptions.api is no longer supported. See ${s}.`)},configurable:!0})}return i}var Zte=1,ere=class{create(e,t,r,i,s){let n={};ag.gridOptions?(Fi(n,ag.gridOptions,!0,!0),n={...n,...t}):n=t;const o=Dte(n),a=o.gridId??String(Zte++),l=this.getRegisteredModules(s,a),c=this.createBeansList(o.rowModelType,l,a),u=this.createProvidedBeans(e,o,s);if(!c){pt("Failed to create grid.");return}const d={providedBeanInstances:u,beanClasses:c,gridId:a,beanInitComparator:fJ,beanDestroyComparator:pJ,derivedBeans:[sJ]},h=new Jj(d);return this.registerModuleUserComponents(h,l),this.registerControllers(h,l),this.registerModuleApiFunctions(h,l),r(h),h.getBean("syncService").start(),i&&i(h),h.getBean("gridApi")}registerControllers(e,t){const r=e.getBean("ctrlsFactory");t.forEach(i=>{i.controllers&&i.controllers.forEach(s=>r.register(s))})}getRegisteredModules(e,t){const r=e?e.modules:null,i=Ur.__getRegisteredModules(t),s=[],n={},o=(a,l,c)=>{(d=>{n[d.moduleName]||(n[d.moduleName]=!0,s.push(d),Ur.__register(d,a,c))})(l),l.dependantModules&&l.dependantModules.forEach(d=>o(a,d,c))};return o(!!(r!=null&&r.length)||!Ur.__isPackageBased(),rT,void 0),r&&r.forEach(a=>o(!0,a,t)),i&&i.forEach(a=>o(!Ur.__isPackageBased(),a,void 0)),s}registerModuleUserComponents(e,t){const r=this.extractModuleEntity(t,s=>s.userComponents?s.userComponents:[]),i=e.getBean("userComponentRegistry");r.forEach(s=>{i.registerDefaultComponent(s.name,s.classImp)})}registerModuleApiFunctions(e,t){const r=e.getBean("apiFunctionService");t.forEach(i=>{const s=i.apiFunctions??{};Object.keys(s).forEach(o=>{r==null||r.addFunction(o,s[o])})})}createProvidedBeans(e,t,r){let i=r?r.frameworkOverrides:null;ut(i)&&(i=new YF);const s={gridOptions:t,eGridDiv:e,globalEventListener:r?r.globalEventListener:null,globalSyncEventListener:r?r.globalSyncEventListener:null,frameworkOverrides:i};return r&&r.providedBeanInstances&&Object.assign(s,r.providedBeanInstances),s}createBeansList(e="clientSide",t,r){const i=t.filter(l=>!l.rowModel||l.rowModel===e),s={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!s[e]){pt("Could not find row model for rowModelType = ",e);return}if(!Ur.__assertRegistered(s[e],`rowModelType = '${e}'`,r))return;const n=[wJ,vJ,kte,Tte,rJ,_j,uJ,dJ,QX,rF,Wte,qX,_te,WQ,iq,IK,xJ,Mte,JQ,oT,SK,vY,Lte,Ote,HQ,Yte,wK,jX,Xte,Qte,BQ,YX,eq,bJ,KX,SJ,eJ,jQ,UX,Ute,Gte,Bte,$te,qte,JX,nJ,Vte,zte,mJ,RJ,CJ,gJ,Kte,Hte,ZX,Ite,Nte,eQ,EK,oJ,FK,bK,aJ,lJ,_K,RK,MK,cJ,kK],o=this.extractModuleEntity(i,l=>l.beans?l.beans:[]);n.push(...o);const a=[];return n.forEach(l=>{a.indexOf(l)<0&&a.push(l)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}},aT=class extends xe{constructor(){super(...arguments),this.beanName="rowModelHelperService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){const e=this.rowModel;switch(e.getType()){case"clientSide":this.clientSideRowModel=e;break;case"infinite":this.infiniteRowModel=e;break;case"serverSide":this.serverSideRowModel=e;break}}getClientSideRowModel(){return this.clientSideRowModel}getInfiniteRowModel(){return this.infiniteRowModel}getServerSideRowModel(){return this.serverSideRowModel}};function tre(e){e.expansionService.expandAll(!0)}function rre(e){e.expansionService.expandAll(!1)}function ire(e){var i,s;const t=(i=e.rowModelHelperService)==null?void 0:i.getClientSideRowModel(),r=(s=e.rowModelHelperService)==null?void 0:s.getServerSideRowModel();t?t.onRowHeightChanged():r&&r.onRowHeightChanged()}function sre(e,t,r){var n,o;const i=(n=e.rowModelHelperService)==null?void 0:n.getServerSideRowModel();if(i){if(e.funcColsService.isRowGroupEmpty()){i.setRowCount(t,r);return}pt("setRowCount cannot be used while using row grouping.");return}const s=(o=e.rowModelHelperService)==null?void 0:o.getInfiniteRowModel();if(s){s.setRowCount(t,r);return}}function nre(e){var t;return((t=e.rowNodeBlockLoader)==null?void 0:t.getBlockState())??{}}var ore={version:Ze,moduleName:"@ag-grid-community/csrm-ssrm-shared-api",apiFunctions:{expandAll:tre,collapseAll:rre,onRowHeightChanged:ire}},are={version:Ze,moduleName:"@ag-grid-community/ssrm-infinite-shared-api",apiFunctions:{setRowCount:sre,getCacheBlockState:nre}},lre=class{wrap(e,t,r=[],i){const s=this.createWrapper(e,i);return t.forEach(n=>{this.createMethod(s,n,!0)}),r.forEach(n=>{this.createMethod(s,n,!1)}),s}unwrap(e){return e}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&Te("Framework component is missing the method "+t+"()"),null)}}};function cre(e,t){if(!e)return!1;const r=(o,a)=>{const l=t[o.id],c=t[a.id],u=l!==void 0,d=c!==void 0,h=u&&d,p=!u&&!d;return h?l-c:p?o.__objectId-a.__objectId:u?1:-1};let i,s,n=!1;for(let o=0;o<e.length-1;o++)if(i=e[o],s=e[o+1],r(i,s)>0){n=!0;break}return n?(e.sort(r),!0):!1}var Ja=typeof global>"u"?{}:global;Ja.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement;Ja.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement;Ja.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement;Ja.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement;Ja.Node=typeof Node>"u"?{}:Node;Ja.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var ure="ROOT_NODE_ID",Nf=0,dre=class{constructor(e,t,r,i,s,n){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=r,this.funcColsService=i,this.beans=n,this.selectionService=s,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=ure,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return bE(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if(typeof e=="string"){Te("rowData must be an array.");return}this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,r=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map(i=>this.createNode(i,this.rootNode,Nf)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),r&&(r.childrenAfterFilter=t.childrenAfterFilter,r.childrenAfterGroup=t.childrenAfterGroup,r.childrenAfterAggFilter=t.childrenAfterAggFilter,r.childrenAfterSort=t.childrenAfterSort,r.childrenMapped=t.childrenMapped,r.allLeafChildren=t.allLeafChildren)}updateRowData(e,t){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const r={remove:[],update:[],add:[]},i=[];return this.executeRemove(e,r,i),this.executeUpdate(e,r,i),this.executeAdd(e,r),this.updateSelection(i,"rowDataChanged"),t&&cre(this.rootNode.allLeafChildren,t),r}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){const t={type:"rowDataUpdateStarted",firstRowData:e!=null&&e.length?e[0]:null};this.eventService.dispatchEvent(t)}updateSelection(e,t){const r=e.length>0;if(r&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),r){const i={type:"selectionChanged",source:t};this.eventService.dispatchEvent(i)}}executeAdd(e,t){var o;const{add:r,addIndex:i}=e;if(hr(r))return;const s=r.map(a=>this.createNode(a,this.rootNode,Nf)),n=this.rootNode.allLeafChildren;if(typeof i=="number"&&i>=0){const a=n.length;let l=i;if(this.gos.get("treeData")&&i>0&&a>0){for(let h=0;h<a;h++)if(((o=n[h])==null?void 0:o.rowIndex)==i-1){l=h+1;break}}const u=n.slice(0,l),d=n.slice(l,n.length);this.rootNode.allLeafChildren=[...u,...s,...d]}else this.rootNode.allLeafChildren=[...n,...s];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=n),t.add=s}executeRemove(e,t,r){var n;const{remove:i}=e;if(hr(i))return;const s={};i.forEach(o=>{const a=this.lookupRowNode(o);a&&(a.isSelected()&&r.push(a),a.clearRowTopAndRowIndex(),s[a.id]=!0,delete this.allNodesMap[a.id],t.remove.push(a))}),this.rootNode.allLeafChildren=((n=this.rootNode.allLeafChildren)==null?void 0:n.filter(o=>!s[o.id]))??null,this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,t,r){const{update:i}=e;hr(i)||i.forEach(s=>{const n=this.lookupRowNode(s);n&&(n.updateData(s),!n.selectable&&n.isSelected()&&r.push(n),this.setMasterForRow(n,s,Nf,!1),t.update.push(n))})}lookupRowNode(e){var i;const t=this.gos.getRowIdCallback();let r;if(t){const s=t({data:e,level:0});if(r=this.allNodesMap[s],!r)return pt(`could not find row id=${s}, data item was not found for this id`),null}else if(r=(i=this.rootNode.allLeafChildren)==null?void 0:i.find(s=>s.data===e),!r)return pt("could not find data item as object was not found",e),pt("Consider using getRowId to help the Grid find matching row data"),null;return r||null}createNode(e,t,r){const i=new Ks(this.beans);return i.group=!1,this.setMasterForRow(i,e,r,!0),t&&(i.parent=t),i.level=r,i.setDataAndId(e,this.nextId.toString()),this.allNodesMap[i.id]&&Te(`duplicate node id '${i.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[i.id]=i,this.nextId++,i}setMasterForRow(e,t,r,i){if(this.gos.get("treeData"))e.setMaster(!1),i&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const o=this.gos.get("isRowMaster");o?e.setMaster(o(t)):e.setMaster(!0)}else e.setMaster(!1);if(i){const o=this.funcColsService.getRowGroupColumns(),a=o?o.length:0,l=r+a;e.expanded=e.master?this.isExpanded(l):!1}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return t===-1?!0:e<t}},hre=class extends xe{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=qr(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),r=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:r,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Ks(this.beans),this.nodeManager=new dre(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),r=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),s=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),n=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...r,...i,...i,...s,...n,...o,...a];this.addManagedPropertyListeners(l,c=>{var h;const u=(h=c.changeSet)==null?void 0:h.properties;if(!u)return;const d=p=>u.some(g=>p.has(g));if(d(e)){this.setRowData(this.rootNode.allLeafChildren.map(p=>p.data));return}if(d(t)){this.refreshModel({step:"group"});return}if(d(r)){this.refreshModel({step:"filter"});return}if(d(i)){this.refreshModel({step:"pivot"});return}if(d(s)){this.refreshModel({step:"aggregate"});return}if(d(n)){this.refreshModel({step:"sort"});return}if(d(o)){this.refreshModel({step:"filter_aggregates"});return}d(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,r,i){let s,n=!1;do{s=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,r),c=Math.min(a,i);for(let u=l;u<=c;u++){const d=this.getRow(u);if(d.rowHeightEstimated){const h=this.gos.getRowHeightForNode(d);d.setRowHeight(h.height),s=!0,n=!0}}s&&this.setRowTopAndRowIndex()}while(s);return n}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const r=new Set,i=this.gos.isDomLayout("normal");for(let s=0;s<this.rowsToDisplay.length;s++){const n=this.rowsToDisplay[s];if(n.id!=null&&r.add(n.id),n.rowHeight==null){const o=this.gos.getRowHeightForNode(n,i,e);n.setRowHeight(o.height,o.estimated)}n.setRowTop(t),n.setRowIndex(s),t+=n.rowHeight}return r}clearRowTopAndRowIndex(e,t){const r=e.isActive(),i=n=>{n&&n.id!=null&&!t.has(n.id)&&n.clearRowTopAndRowIndex()},s=n=>{if(i(n),i(n.detailNode),i(n.sibling),n.hasChildren()&&n.childrenAfterGroup){const o=n.level==-1;r&&!o&&!n.expanded||n.childrenAfterGroup.forEach(s)}};s(this.rootNode)}ensureRowsAtPixel(e,t,r=0){const i=this.getRowIndexAtPixel(t),s=this.getRow(i),n=!this.gos.get("suppressAnimationFrame");return s===e[0]?!1:(e.forEach(o=>{jr(this.rootNode.allLeafChildren,o)}),e.forEach((o,a)=>{kd(this.rootNode.allLeafChildren,o,Math.max(i+r,0)+a)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:n}),!0)}highlightRowAtPixel(e,t){const r=t!=null?this.getRowIndexAtPixel(t):null,i=r!=null?this.getRow(r):null;if(!i||!e||i===e||t==null){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null);return}const s=this.getHighlightPosition(t,i);this.lastHighlightedRow&&this.lastHighlightedRow!==i&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),i.setHighlighted(s),this.lastHighlightedRow=i}getHighlightPosition(e,t){if(!t){const s=this.getRowIndexAtPixel(e);if(t=this.getRow(s||0),!t)return 1}const{rowTop:r,rowHeight:i}=t;return e-r<i/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const t=this.rootNode.sibling?1:0,r=this.rootNode.childrenAfterAggFilter;return(r?r.length:0)+t}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let r=e;if(this.rowsToDisplay[0].footer){if(e===0)return 0;r-=1}let i=this.rootNode.childrenAfterSort[r];if(this.gos.get("groupHideOpenParents"))for(;i.expanded&&i.childrenAfterSort&&i.childrenAfterSort.length>0;)i=i.childrenAfterSort[0];return i.rowIndex}getRowBounds(e){if(ut(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=this.gos.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=this.gos.isAnimateRows(),i=e.columns.length===0||e.columns.some(s=>s.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=this.gos.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=hr(e),r=new Ah(!1,this.rootNode);return(t||this.gos.get("treeData"))&&r.setInactive(),r}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||e.rowNodeTransactions==null)return!1;const t=e.rowNodeTransactions.filter(i=>i.add!=null&&i.add.length>0||i.remove!=null&&i.remove.length>0);return t==null||t.length==0}buildRefreshModelParams(e){let t="group";const r={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(ke(e)&&(t=r[e]),ut(t)){pt(`invalid step ${e}, available steps are ${Object.keys(r).join(", ")}`);return}const i=!this.gos.get("suppressAnimationFrame");return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t=typeof e=="object"&&"step"in e?e:this.buildRefreshModelParams(e);if(!t||this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const r=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,t.rowNodeOrder,r,!!t.afterColumnsChanged);case"filter":this.doFilter(r);case"pivot":this.doPivot(r);case"aggregate":this.doAggregate(r);case"filter_aggregates":this.doFilterAggregates(r);case"sort":this.doSort(t.rowNodeTransactions,r);case"map":this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(r,i),this.isRefreshingModel=!1;const s={type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(s)}isEmpty(){const e=ut(this.rootNode.allLeafChildren)||this.rootNode.allLeafChildren.length===0;return ut(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return ke(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let r=!1,i=!1;const s=[],n=this.gos.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(o=>{if(i)return;if(r&&(o===t||o===e)&&(i=!0,o.group&&n)){s.push(...o.allLeafChildren);return}if(!r){if(o!==t&&o!==e)return;r=!0}if(!o.group||!n){s.push(o);return}}),s}setDatasource(e){pt("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||this.rowsToDisplay.length===0)return-1;let t=0,r=this.rowsToDisplay.length-1;if(e<=0)return 0;if(ft(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let s=-1,n=-1;for(;;){const o=Math.floor((t+r)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,e)||(a.rowTop<e?t=o+1:a.rowTop>e&&(r=o-1),s===t&&n===r))return o;s=t,n=r}}isRowInPixel(e,t){const r=e.rowTop,i=e.rowTop+e.rowHeight;return r<=t&&i>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,r)=>e(t,r))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:r,recursionType:i,includeFooterNodes:s}=e;let{index:n}=e;const o=a=>{var p;const l=(p=t[0])==null?void 0:p.parent;if(!l)return;const c=s&&this.gos.getGrandTotalRow(),u=this.gos.getGroupTotalRowCallback(),d=s&&u({node:l});if(l===this.rootNode){c===a&&(l.createFooter(),r(l.sibling,n++));return}d===a&&(l.createFooter(),r(l.sibling,n++))};o("top");for(let a=0;a<t.length;a++){const l=t[a];if(r(l,n++),l.hasChildren()&&!l.footer){let c=null;switch(i){case 0:c=l.childrenAfterGroup;break;case 1:c=l.childrenAfterAggFilter;break;case 2:c=l.childrenAfterSort;break;case 3:c=l.leafGroup?null:l.childrenAfterSort;break}c&&(n=this.recursivelyWalkNodesAndCallback({nodes:[...c],callback:r,recursionType:i,index:n,includeFooterNodes:s}))}}return o("bottom"),n}doAggregate(e){var t;(t=this.aggregationStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),r=this.columnModel.isPivotActive(),i=o=>{o&&o.forEach(a=>{const l=()=>{a.expanded=e,i(a.childrenAfterGroup)};if(t){ke(a.childrenAfterGroup)&&l();return}if(r){!a.leafGroup&&l();return}a.group&&l()})};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const n={type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"};this.eventService.dispatchEvent(n)}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,r,i){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodeOrder:t,changedPath:r}):this.groupStage.execute({rowNode:this.rootNode,changedPath:r,afterColumnsChanged:i}),this.gos.get("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",r)){const n={type:"selectionChanged",source:"rowGroupChanged"};this.eventService.dispatchEvent(n)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){var t;(t=this.pivotStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(e){if(typeof e=="string"&&e.indexOf(Ks.ID_PREFIX_ROW_GROUP)==0){let r;return this.forEachNode(i=>{i.id===e&&(r=i)}),r}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const e={type:"rowDataUpdated"};this.eventService.dispatchEvent(e),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const r=this.gos.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},r)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let r=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(i=>{const s=this.nodeManager.updateRowData(i.rowDataTransaction,void 0);t.push(s),i.callback&&e.push(i.callback.bind(null,s)),typeof i.rowDataTransaction.addIndex=="number"&&(r=!0)}),this.commonUpdateRowData(t,void 0,r),e.length>0&&window.setTimeout(()=>{e.forEach(i=>i())},0),t.length>0){const i={type:"asyncTransactionsFlushed",results:t};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e,t){this.valueCache.onDataChanged();const r=this.nodeManager.updateRowData(e,t),i=typeof e.addIndex=="number";return this.commonUpdateRowData([r],t,i),r}createRowNodeOrder(){if(this.gos.get("suppressMaintainUnsortedOrder"))return;const t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let r=0;r<this.rootNode.allLeafChildren.length;r++){const i=this.rootNode.allLeafChildren[r];t[i.id]=r}return t}commonUpdateRowData(e,t,r){if(!this.hasStarted)return;const i=!this.gos.get("suppressAnimationFrame");r&&(t=this.createRowNodeOrder());const s={type:"rowDataUpdated"};this.eventService.dispatchEvent(s),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r&&r.setRowHeight(r.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}};function fre(e){e.expansionService.onGroupExpandedOrCollapsed()}function pre(e,t){var r,i;(i=(r=e.rowModelHelperService)==null?void 0:r.getClientSideRowModel())==null||i.refreshModel(t)}function gre(e,t){var r,i;(i=(r=e.rowModelHelperService)==null?void 0:r.getClientSideRowModel())==null||i.forEachLeafNode(t)}function mre(e,t){var r,i;(i=(r=e.rowModelHelperService)==null?void 0:r.getClientSideRowModel())==null||i.forEachNodeAfterFilter(t)}function vre(e,t){var r,i;(i=(r=e.rowModelHelperService)==null?void 0:r.getClientSideRowModel())==null||i.forEachNodeAfterFilterAndSort(t)}function Cre(e){var t,r;if(e.columnModel.isAutoRowHeightActive()){Te("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");return}(r=(t=e.rowModelHelperService)==null?void 0:t.getClientSideRowModel())==null||r.resetRowHeights()}function wre(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var r,i;return(i=(r=e.rowModelHelperService)==null?void 0:r.getClientSideRowModel())==null?void 0:i.updateRowData(t)})}function Sre(e,t,r){e.frameworkOverrides.wrapIncoming(()=>{var i,s;return(s=(i=e.rowModelHelperService)==null?void 0:i.getClientSideRowModel())==null?void 0:s.batchUpdateRowData(t,r)})}function yre(e){e.frameworkOverrides.wrapIncoming(()=>{var t,r;return(r=(t=e.rowModelHelperService)==null?void 0:t.getClientSideRowModel())==null?void 0:r.flushAsyncTransactions()})}function xre(e){return e.selectionService.getBestCostNodeSelection()}var bre=class extends xe{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){var r;const t=!!((r=this.filterManager)!=null&&r.isChildFilterPresent());this.filterNodes(t,e)}filterNodes(e,t){const r=(i,s)=>{i.hasChildren()&&e&&!s?i.childrenAfterFilter=i.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):i.childrenAfterFilter=i.childrenAfterGroup,i.sibling&&(i.sibling.childrenAfterFilter=i.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const i=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],c=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(n.childrenAfterGroup[a],c):r(l,c)}r(n,o)},s=n=>i(n,!1);t.executeFromRootNode(s)}else{const i=s=>r(s,!1);t.forEachChangedNodeDepthFirst(i,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},Rre=class extends xe{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,r=[],i=this.columnModel.isPivotMode(),s=i&&t.leafGroup,n=s?[t]:t.childrenAfterSort,o=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(o,n,r,i,0);const a=r.length>0;if(!s&&a&&o.grandTotalRow){t.createFooter();const c=o.grandTotalRow==="top";this.addRowNodeToRowsToDisplay(o,t.sibling,r,0,c)}return r}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:this.gos.isGroupMultiAutoColumn(),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:this.gos.getGrandTotalRow(),groupTotalRow:this.gos.getGroupTotalRowCallback()}}recursivelyAddToRowsToDisplay(e,t,r,i,s){if(!hr(t))for(let n=0;n<t.length;n++){const o=t[n],a=o.hasChildren(),l=i&&!a,c=e.groupRemoveSingleChildren&&a&&o.childrenAfterGroup.length===1,u=e.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&o.childrenAfterGroup.length===1,d=i&&o.leafGroup,h=e.hideOpenParents&&o.expanded&&!o.master&&!d;if(!l&&!h&&!c&&!u&&this.addRowNodeToRowsToDisplay(e,o,r,s),!(i&&o.leafGroup)){if(a){const g=c||u;if(o.expanded||g){const f=e.groupTotalRow({node:o});f||o.destroyFooter();const m=g?s:s+1;f==="top"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,r,m)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,r,i,m),f==="bottom"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,r,m))}}else if(o.master&&o.expanded){const g=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(e,g,r,s)}}}}addRowNodeToRowsToDisplay(e,t,r,i,s){s?r.unshift(t):r.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if(ke(e.detailNode))return e.detailNode;const t=new Ks(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,ke(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},Ere=class extends xe{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return this.gos.get("resetRowDataOnUpdate")?!1:e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const[r,i]=t;this.clientSideRowModel.updateRowData(r,i)}createTransactionForRowData(e){if(ut(this.clientSideRowModel)){pt("ImmutableService only works with ClientSideRowModel");return}const t=this.gos.getRowIdCallback();if(t==null){pt("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");return}const r={remove:[],update:[],add:[]},i=this.clientSideRowModel.getCopyOfNodesMap(),n=this.gos.get("suppressMaintainUnsortedOrder")?void 0:{};return ke(e)&&e.forEach((o,a)=>{const l=t({data:o,level:0}),c=i[l];n&&(n[l]=a),c?(c.data!==o&&r.update.push(o),i[l]=void 0):r.add.push(o)}),Ei(i,(o,a)=>{a&&r.remove.push(a.data)}),[r,n]}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}},Fre=class extends xe{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,r,i,s,n){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some(h=>h.isRowGroupActive());let l={};r&&i&&(l=this.calculateDirtyNodes(i));const c=this.columnModel.isPivotMode(),u=this.gos.getCallback("postSortRows"),d=h=>{var f;this.pullDownGroupDataForHideOpenParents(h.childrenAfterAggFilter,!0);const p=c&&h.leafGroup;if(o&&a&&!h.leafGroup&&!n){const m=(f=this.funcColsService.getRowGroupColumns())==null?void 0:f[h.level+1],v=(m==null?void 0:m.getSort())===null,w=h.childrenAfterAggFilter.slice(0);if(h.childrenAfterSort&&!v){const C={};h.childrenAfterSort.forEach((F,D)=>{C[F.id]=D}),w.sort((F,D)=>(C[F.id]??0)-(C[D.id]??0))}h.childrenAfterSort=w}else!t||p?h.childrenAfterSort=h.childrenAfterAggFilter.slice(0):r?h.childrenAfterSort=this.doDeltaSort(h,l,s,e):h.childrenAfterSort=this.rowNodeSorter.doFullSort(h.childrenAfterAggFilter,e);if(h.sibling&&(h.sibling.childrenAfterSort=h.childrenAfterSort),this.updateChildIndexes(h),u){const m={nodes:h.childrenAfterSort};u(m)}};s&&s.forEachChangedNodeDepthFirst(d),this.updateGroupDataForHideOpenParents(s)}calculateDirtyNodes(e){const t={},r=i=>{i&&i.forEach(s=>t[s.id]=!0)};return e&&e.forEach(i=>{r(i.add),r(i.update),r(i.remove)}),t}doDeltaSort(e,t,r,i){const s=e.childrenAfterAggFilter,n=e.childrenAfterSort;if(!n)return this.rowNodeSorter.doFullSort(s,i);const o={},a=[];s.forEach(d=>{t[d.id]||!r.canSkip(d)?a.push(d):o[d.id]=!0});const l=n.filter(d=>o[d.id]),c=(d,h)=>({currentPos:h,rowNode:d}),u=a.map(c).sort((d,h)=>this.rowNodeSorter.compareRowNodes(i,d,h));return this.mergeSortedArrays(i,u,l.map(c)).map(({rowNode:d})=>d)}mergeSortedArrays(e,t,r){const i=[];let s=0,n=0;for(;s<t.length&&n<r.length;)this.rowNodeSorter.compareRowNodes(e,t[s],r[n])<0?i.push(t[s++]):i.push(r[n++]);for(;s<t.length;)i.push(t[s++]);for(;n<r.length;)i.push(r[n++]);return i}updateChildIndexes(e){if(ut(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let r=0;r<t.length;r++){const i=t[r],s=r===0,n=r===e.childrenAfterSort.length-1;i.setFirstChild(s),i.setLastChild(n),i.setChildIndex(r)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return Te("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=r=>{this.pullDownGroupDataForHideOpenParents(r.childrenAfterSort,!1),r.childrenAfterSort.forEach(i=>{i.hasChildren()&&t(i)})};e&&e.executeFromRootNode(r=>t(r))}pullDownGroupDataForHideOpenParents(e,t){!this.gos.get("groupHideOpenParents")||ut(e)||e.forEach(r=>{var s;(((s=this.showRowGroupColsService)==null?void 0:s.getShowRowGroupCols())??[]).forEach(n=>{const o=n.getColDef().showRowGroup;if(typeof o!="string"){pt("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");return}const a=o,l=this.columnModel.getColDefCol(a);if(l!==r.rowGroupColumn)if(t)r.setGroupValue(n.getId(),void 0);else{const u=r.getFirstChildOfFirstChild(l);u&&r.setGroupValue(n.getId(),u.key)}})})}},Tre=class extends xe{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),r=ke(t)&&t.length>0,i=r&&ke(e.rowNodeTransactions)&&this.gos.get("deltaSort"),s=t.some(n=>this.gos.isColumnsSortingCoupledToGroup()?n.column.isPrimary()&&n.column.isRowGroupActive():!!n.column.getColDef().showRowGroup);this.sortService.sort(t,r,i,e.rowNodeTransactions,e.changedPath,s)}},xm="32.0.2",lT={version:xm,moduleName:"@ag-grid-community/client-side-row-model-core",rowModel:"clientSide",beans:[hre,bre,Tre,Rre,Fre,Ere]},Are={version:xm,moduleName:"@ag-grid-community/client-side-row-model-api",beans:[aT],apiFunctions:{onGroupExpandedOrCollapsed:fre,refreshClientSideRowModel:pre,forEachLeafNode:gre,forEachNodeAfterFilter:mre,forEachNodeAfterFilterAndSort:vre,resetRowHeights:Cre,applyTransaction:wre,applyTransactionAsync:Sre,flushAsyncTransactions:yre,getBestCostNodeSelection:xre},dependantModules:[lT,ore]},Pre={version:xm,moduleName:"@ag-grid-community/client-side-row-model",dependantModules:[lT,Are]},Dre=class extends xe{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},Mre=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:r,columnNameService:i,valueService:s,gos:n,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.funcColsService=r,this.columnNameService=i,this.valueService=s,this.gos=n,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,r,i,s){const o=(!this.gos.get("groupHideOpenParents")||s.footer)&&this.shouldRenderGroupSummaryCell(s,e,t)?this.createValueForGroupNode(e,s):this.valueService.getValue(e,s);return this.processCell({accumulatedRowIndex:r,rowNode:s,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,r){var o;if(!(e&&e.group))return!1;if(this.groupColumns.indexOf(t)!==-1){if(((o=e.groupData)==null?void 0:o[t.getId()])!=null||this.gos.isRowModelType("serverSide")&&e.group)return!0;if(e.footer&&e.level===-1){const a=t.getColDef();return a==null||a.showRowGroup===!0||a.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const n=this.gos.isGroupUseEntireRow(this.columnModel.isPivotMode());return r===0&&n}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const r=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),s=l=>{var u;if(r||i)return l.key;const c=(u=l.groupData)==null?void 0:u[e.getId()];return!c||!l.rowGroupColumn||l.rowGroupColumn.getColDef().useValueFormatterForExport===!1?c:this.valueService.formatValue(l.rowGroupColumn,l,c)??c},n=t.footer,o=[s(t)];if(!this.gos.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,o.push(s(t));const a=o.reverse().join(" -> ");return n?`Total ${a}`:a}processCell(e){const{accumulatedRowIndex:t,rowNode:r,column:i,value:s,processCellCallback:n,type:o}=e;return n?{value:n(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:i,node:r,value:s,type:o,parseValue:a=>this.valueService.parseValue(i,r,a,this.valueService.getValue(i,r)),formatValue:a=>this.valueService.formatValue(i,r,a)??a}))??""}:i.getColDef().useValueFormatterForExport!==!1?{value:s??"",valueFormatted:this.valueService.formatValue(i,r,s)}:{value:s??""}}},kre=class{static download(e,t){const r=document.defaultView||window;if(!r){Te("There is no `window` associated with the current `document`");return}const i=document.createElement("a"),s=r.URL.createObjectURL(t);i.setAttribute("href",s),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),document.body.removeChild(i),r.setTimeout(()=>{r.URL.revokeObjectURL(s)},0)}},US=`\r
`,_re=class extends Mre{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:r}=e;this.suppressQuotes=t,this.columnSeparator=r}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,US),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((r,i)=>{i!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r.data.value||""),r.mergeAcross&&this.appendEmptyCells(r.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,r,i){r!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,r){t!=0&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",r);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(Te("unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=US),this.isFirstLine=!1}},Ire=class extends Dre{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){Te("Export cancelled. Export is not allowed as per your configuration.");return}const t=this.getMergedParams(e),r=this.getData(t),i=new Blob(["\uFEFF",r],{type:"text/plain"}),s=typeof t.fileName=="function"?t.fileName(this.gos.getGridCommonParams()):t.fileName;kre.download(this.getFileName(s),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const r=t?Object.assign({},e):this.getMergedParams(e);return this.getData(r)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:r,funcColsService:i,valueService:s,gos:n}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new _re({columnModel:t,columnNameService:r,funcColsService:i,valueService:s,gos:n,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function Ore(e,t){var r;return(r=e.csvCreator)==null?void 0:r.getDataAsCsv(t)}function Lre(e,t){var r;(r=e.csvCreator)==null||r.exportDataAsCsv(t)}var Nre=class extends xe{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e,t={}){const{allColumns:r,columnKeys:i,skipRowGroups:s}=t,n=this.getColumnsToExport(r,s,i);return vK(this.prepareSession(n),this.prependContent(t),this.exportColumnGroups(t,n),this.exportHeaders(t,n),this.processPinnedTopRows(t,n),this.processRows(t,n),this.processPinnedBottomRows(t,n),this.appendContent(t))(e).parse()}processRow(e,t,r,i){var v;const s=t.shouldRowBeSkipped||(()=>!1),n=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),l=t.rowPositions!=null||!!t.onlySelected,c=this.gos.get("groupHideOpenParents")&&!l,u=this.columnModel.isPivotMode()?i.leafGroup:!i.group,d=!!i.footer,h=o&&i.leafGroup,p=i.allChildrenCount===1&&((v=i.childrenAfterGroup)==null?void 0:v.length)===1&&(n||h);if(!u&&!d&&(t.skipRowGroups||p||c)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&i.rowPinned==="top"||t.skipPinnedBottom&&i.rowPinned==="bottom"||i.level===-1&&!u&&!d||s(this.gos.addGridCommonParams({node:i})))return;const m=e.onNewBodyRow(i);if(r.forEach((w,C)=>{m.onColumn(w,C,i)}),t.getCustomContentBelowRow){const w=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));w&&e.addCustomContent(w)}}appendContent(e){return t=>{const r=e.appendContent;return r&&t.addCustomContent(r),t}}prependContent(e){return t=>{const r=e.prependContent;return r&&t.addCustomContent(r),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return r=>{if(!e.skipColumnGroupHeaders){const i=new PE,s=this.visibleColsService.createGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(s,r,e.processGroupHeaderCallback)}return r}}exportHeaders(e,t){return r=>{if(!e.skipColumnHeaders){const i=r.onNewHeaderRow();t.forEach((s,n)=>{i.onColumn(s,n,void 0)})}return r}}processPinnedTopRows(e,t){return r=>{const i=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(s=>s.rowPinned==="top").sort((s,n)=>s.rowIndex-n.rowIndex).map(s=>this.pinnedRowModel.getPinnedTopRow(s.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedTopRow(i),r}}processRows(e,t){return r=>{const i=this.rowModel,s=i.getType(),n=s==="clientSide",o=s==="serverSide",a=!n&&e.onlySelected,l=this.processRow.bind(this,r,e,t),{exportedRows:c="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(u=>u.rowPinned==null).sort((u,d)=>u.rowIndex-d.rowIndex).map(u=>i.getRow(u.rowIndex)).forEach(l);else if(this.columnModel.isPivotMode())n?i.forEachPivotNode(l,!0):o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);else if(e.onlySelectedAllPages||a){const u=this.selectionService.getSelectedNodes();this.replicateSortedOrder(u),u.forEach(l)}else c==="all"?i.forEachNode(l):n||o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);return r}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),r=(i,s)=>{var n,o;return i.rowIndex!=null&&s.rowIndex!=null?i.rowIndex-s.rowIndex:i.level===s.level?((n=i.parent)==null?void 0:n.id)===((o=s.parent)==null?void 0:o.id)?this.rowNodeSorter.compareRowNodes(t,{rowNode:i,currentPos:i.rowIndex??-1},{rowNode:s,currentPos:s.rowIndex??-1}):r(i.parent,s.parent):i.level>s.level?r(i.parent,s):r(i,s.parent)};e.sort(r)}processPinnedBottomRows(e,t){return r=>{const i=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(s=>s.rowPinned==="bottom").sort((s,n)=>s.rowIndex-n.rowIndex).map(s=>this.pinnedRowModel.getPinnedBottomRow(s.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedBottomRow(i),r}}getColumnsToExport(e=!1,t=!1,r){const i=this.columnModel.isPivotMode();if(r&&r.length)return this.columnModel.getColsForKeys(r);const s=this.gos.get("treeData");let n=[];return e&&!i?n=this.columnModel.getCols():n=this.visibleColsService.getAllCols(),t&&!s&&(n=n.filter(o=>o.getColId()!==jc)),n}recursivelyAddHeaderGroups(e,t,r){const i=[];e.forEach(s=>{const n=s;n.getChildren&&n.getChildren().forEach(o=>i.push(o))}),e.length>0&&Jt(e[0])&&this.doAddHeaderHeader(t,e,r),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,r)}doAddHeaderHeader(e,t,r){const i=e.onNewHeaderGroupingRow();let s=0;t.forEach(n=>{const o=n;let a;r?a=r(this.gos.addGridCommonParams({columnGroup:o})):a=this.columnNameService.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((c,u,d,h)=>{let p=ft(c);return u.getColumnGroupShow()==="open"?(!p||p[1]!=null)&&(p=[d],c.push(p)):p&&p[1]==null&&(p[1]=d-1),d===h.length-1&&p&&p[1]==null&&(p[1]=d),c},[]);i.onColumn(o,a||"",s++,o.getLeafColumns().length-1,l)})}},bm="32.0.2",cT={version:bm,moduleName:"@ag-grid-community/csv-export-core",beans:[Ire,Nre]},Bre={version:bm,moduleName:"@ag-grid-community/csv-export-api",apiFunctions:{getDataAsCsv:Ore,exportDataAsCsv:Lre},dependantModules:[cT]},Gre={version:bm,moduleName:"@ag-grid-community/csv-export",dependantModules:[cT,Bre]},Hre=class extends zQ{wireBeans(e){this.beans=e}constructor(e,t,r){super(e),this.parentCache=t,this.params=r,this.startRow=e*r.blockSize,this.endRow=this.startRow+r.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,r){ke(t)?e.setDataAndId(t,r.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(ut(this.params.datasource.getRows)){Te("datasource is missing getRows method");return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,r){this.rowNodes.forEach((i,s)=>{this.startRow+s<r&&e(i,t.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.next());const r=e-this.startRow;return this.rowNodes[r]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,r=new Ks(this.beans);r.setRowHeight(this.params.rowHeight),r.uiLevel=0,r.setRowIndex(t),r.setRowTop(this.params.rowHeight*t),this.rowNodes.push(r)}}processServerResult(e){this.rowNodes.forEach((r,i)=>{const s=e.rowData?e.rowData[i]:void 0;!r.id&&r.alreadyRendered&&s&&(this.rowNodes[i]=new Ks(this.beans),this.rowNodes[i].setRowIndex(r.rowIndex),this.rowNodes[i].setRowTop(r.rowTop),this.rowNodes[i].setRowHeight(r.rowHeight),r.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[i],s,this.startRow+i)});const t=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},Vre=2,Wre=class extends xe{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}wireBeans(e){this.rowRenderer=e.rowRenderer,this.focusService=e.focusService}getRow(e,t=!1){const r=Math.floor(e/this.params.blockSize);let i=this.blocks[r];if(!i){if(t)return;i=this.createBlock(r)}return i.getRow(e)}createBlock(e){const t=this.createBean(new Hre(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(t=>t.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.gos.get("debug")&&Ti(`InfiniteCache - onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),r=(o,a)=>a.getLastAccessed()-o.getLastAccessed();t.sort(r);const i=this.params.maxBlocksInCache>0,s=i?this.params.maxBlocksInCache-1:null,n=Vre-1;t.forEach((o,a)=>{const l=o.getState()==="needsLoading"&&a>=n,c=i?a>=s:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const r=e.getStartRow(),i=e.getEndRow();return t.rowIndex>=r&&t.rowIndex<i}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),r=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,r)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const i=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<i&&(this.rowCount=i)}}setRowCount(e,t){this.rowCount=e,ke(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t=new Na;this.getBlocksInOrder().forEach(r=>r.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){const e=(r,i)=>r.getId()-i.getId();return Nn(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const e={type:"storeUpdated"};this.eventService.dispatchEvent(e)}}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(t=>{t.getId()*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(t=>this.destroyBlock(t))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const r=[];let i=-1,s=!1;const n=new Na;let o=!1;return this.getBlocksInOrder().forEach(l=>{if(!o){if(s&&i+1!==l.getId()){o=!0;return}i=l.getId(),l.forEachNode(c=>{const u=c===e||c===t;(s||u)&&r.push(c),u&&(s=!s)},n,this.rowCount)}}),o||s?[]:r}},zre=class extends xe{constructor(){super(...arguments),this.beanName="rowModel"}wireBeans(e){this.filterManager=e.filterManager,this.sortController=e.sortController,this.selectionService=e.selectionService,this.rowRenderer=e.rowRenderer,this.rowNodeBlockLoader=e.rowNodeBlockLoader}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){this.gos.isRowModelType("infinite")&&(this.rowHeight=this.gos.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&Te("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onCacheUpdated.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gos.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;this.cacheParams?e=this.isSortModelDifferent():e=!0,e&&this.reset()}isSortModelDifferent(){return!_d(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;this.gos.getRowIdCallback()!=null||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){var t;this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:((t=this.filterManager)==null?void 0:t.getFilterModel())??{},sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:this.gos.getRowHeightAsNumber(),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new Na},this.infiniteCache=this.createBean(new Wre(this.cacheParams)),this.eventService.dispatchEventOnce({type:"rowCountReady"});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}updateRowHeights(){this.forEachNode(t=>{t.setRowHeight(this.rowHeight),t.setRowTop(this.rowHeight*t.rowIndex)});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode(r=>{r.id===e&&(t=r)}),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),r=this.getRowCount()-1;return t>r?r:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?this.infiniteCache.isLastRowIndexKnown():!1}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}};function $re(e){var t,r;(r=(t=e.rowModelHelperService)==null?void 0:t.getInfiniteRowModel())==null||r.refreshCache()}function Ure(e){var t,r;(r=(t=e.rowModelHelperService)==null?void 0:t.getInfiniteRowModel())==null||r.purgeCache()}function Kre(e){var t,r;return(r=(t=e.rowModelHelperService)==null?void 0:t.getInfiniteRowModel())==null?void 0:r.getRowCount()}function jre(e){var t,r;return(r=(t=e.rowModelHelperService)==null?void 0:t.getInfiniteRowModel())==null?void 0:r.isLastRowIndexKnown()}var Rm="32.0.2",uT={version:Rm,moduleName:"@ag-grid-community/infinite-row-model-core",rowModel:"infinite",beans:[zre],dependantModules:[UQ]},qre={version:Rm,moduleName:"@ag-grid-community/infinite-row-model-api",beans:[aT],apiFunctions:{refreshInfiniteCache:$re,purgeInfiniteCache:Ure,getInfiniteRowCount:Kre,isLastRowIndexKnown:jre},dependantModules:[uT,are]},Yre={version:Rm,moduleName:"@ag-grid-community/infinite-row-model",dependantModules:[uT,qre]};Ur.__registerModules([rT,Pre,Yre,Gre],!1,void 0);var Xre=e=>typeof e=="symbol",Qre=(e,t,r,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:r})};new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Xre));function lg(e){const t=e&&e.__v_raw;return t?lg(t):e}function Bf(e){return Object.isExtensible(e)&&Qre(e,"__v_skip",!0),e}var Jre=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Zre=e=>`on${e.charAt(0).toUpperCase()}${e.substring(1,e.length)}`,dT=e=>e&&(Object.isFrozen(e)?e:Kd(gt(e))),eie=()=>{const e={};ji.PUBLIC_EVENTS.map(s=>Zre(Jre(s))).forEach(s=>e[s]=void 0);const r={},i={modelValue:{handler(s,n){!this.gridCreated||!this.api||s!==n&&(s&&n&&s.length===n.length&&s.every((o,a)=>o===n[a])||Xp({rowData:s},this.api))},deep:!0}};return ji.ALL_PROPERTIES.filter(s=>s!="gridOptions").forEach(s=>{e[s]={default:ji.VUE_OMITTED_PROPERTY},i[s]={handler(n,o){let a=n;s==="rowData"&&n!=ji.VUE_OMITTED_PROPERTY&&(a=dT(n)),this.batchChanges[s]=a===ji.VUE_OMITTED_PROPERTY?void 0:a,this.batchTimeout==null&&(this.batchTimeout=setTimeout(()=>{this.batchTimeout=null,Xp(this.batchChanges,this.api),this.batchChanges=Kd({})},0))},deep:!0}}),[e,r,i]};function KS(e){pt(`Could not find component with name of ${e}. Is it in Vue.components?`)}var cg=class hT{static getComponentDefinition(t,r){let i;return typeof t=="string"?i=this.searchForComponentInstance(r,t):i={extends:_e({...t})},i||KS(t),i.extends?(i.extends.setup&&(i.setup=i.extends.setup),i.extends.props=this.addParamsToProps(i.extends.props)):i.props=this.addParamsToProps(i.props),i}static addParamsToProps(t){return!t||Array.isArray(t)&&t.indexOf("params")===-1?t=["params",...t||[]]:typeof t=="object"&&!t.params&&(t.params={type:Object}),t}static createAndMountComponent(t,r,i,s){const n=hT.getComponentDefinition(t,i);if(!n)return;const{vNode:o,destroy:a,el:l}=this.mount(n,{params:Object.freeze(r)},i,s||{});return{componentInstance:o.component.proxy,element:l,destroy:a}}static mount(t,r,i,s){let n=ye(t,r);n.appContext=i.$.appContext,n.appContext.provides={...s,...n.appContext.provides?n.appContext.provides:{},...i.$parent.$options.provide?i.$parent.$options.provide:{}};let o=document.createElement("div");return cd(n,o),{vNode:n,destroy:()=>{o&&cd(null,o),o=null,n=null},el:o}}static searchForComponentInstance(t,r,i=10,s=!1){let n=null,o=t.$parent,a=0;for(;!n&&o&&o.$options&&++a<i;){const l=o;l.$options&&l.$options.components&&l.$options.components[r]?n=l.$options.components[r]:l[r]&&(n=l[r]),o=o.$parent}if(!n){const l=t.$.appContext.components;l&&l[r]&&(n=l[r])}return!n&&!s?(KS(r),null):n}},tie=class Ju extends lre{constructor(t,r){super(),this.parent=t,Ju.provides||(Ju.provides=r)}createWrapper(t){const r=this;class i extends rie{init(o){super.init(o)}hasMethod(o){const a=s.getFrameworkComponentInstance();return a[o]?!0:a.$.setupState[o]!=null}callMethod(o,a){var u;const l=this.getFrameworkComponentInstance(),c=s.getFrameworkComponentInstance();return c[o]?c[o].apply(l,a):(u=c.$.setupState[o])==null?void 0:u.apply(l,a)}addMethod(o,a){s[o]=a}processMethod(o,a){return o==="refresh"&&(this.getFrameworkComponentInstance().params=a[0]),this.hasMethod(o)?this.callMethod(o,a):o==="refresh"}createComponent(o){return r.createComponent(t,o)}}const s=new i;return s}createComponent(t,r){return cg.createAndMountComponent(t,r,this.parent,Ju.provides)}createMethodProxy(t,r,i){return function(){return t.hasMethod(r)?t.callMethod(r,arguments):(i&&Te("Framework component is missing the method "+r+"()"),null)}}destroy(){this.parent=null}},rie=class{getGui(){return this.element}destroy(){this.getFrameworkComponentInstance()&&typeof this.getFrameworkComponentInstance().destroy=="function"&&this.getFrameworkComponentInstance().destroy(),this.unmount()}getFrameworkComponentInstance(){return this.componentInstance}init(e){const{componentInstance:t,element:r,destroy:i}=this.createComponent(e);this.componentInstance=t,this.unmount=i,this.element=r.firstElementChild??r}},iie=class extends YF{constructor(e){super("vue"),this.parent=e}frameworkComponent(e,t){let r=cg.searchForComponentInstance(this.parent,e,10,!0)?e:null;if(!r&&t&&t[e]){const i=t[e];r=cg.searchForComponentInstance(this.parent,i,10,!0)?i:null}return r}isFrameworkComponent(e){return typeof e=="object"}},sie=new Set(["rowDataUpdated","cellValueChanged","rowValueChanged"]),jS="onUpdate:modelValue",nie="update:modelValue",[oie,aie,lie]=eie(),cie=_e({render(){return yr("div")},props:{gridOptions:{type:Object,default:()=>({})},componentDependencies:{type:Array,default:()=>[]},plugins:[],modules:{type:Array,default:()=>[]},modelValue:{type:Array,default:void 0,required:!1},...oie},data(){return{api:void 0,gridCreated:!1,isDestroyed:!1,gridReadyFired:!1,emitRowModel:void 0,batchTimeout:null,batchChanges:Bf({})}},computed:aie,watch:lie,methods:{globalEventListenerFactory(e){return t=>{if(this.isDestroyed)return;t==="gridReady"&&(this.gridReadyFired=!0);const r=Yl.has(t);r&&!e||!r&&e||this.updateModelIfUsed(t)}},processChanges(e,t,r){if(this.gridCreated){if(this.skipChange(e,t,r))return;const i={[e]:e==="rowData"?Object.isFrozen(t)?t:Bf(lg(t)):t};Xp(i,this.api)}},checkForBindingConflicts(){const e=this;(e.rowData&&e.rowData!=="AG-VUE-OMITTED-PROPERTY"||this.gridOptions.rowData)&&e.modelValue&&Te("Using both rowData and v-model. rowData will be ignored.")},getRowData(){var t;const e=[];return(t=this.api)==null||t.forEachNode(r=>{e.push(r.data)}),e},updateModelIfUsed(e){this.gridReadyFired&&this.$attrs[jS]&&sie.has(e)&&this.emitRowModel&&this.emitRowModel()},getRowDataBasedOnBindings(){const e=this,t=e.modelValue;return t||(e.rowData?e.rowData:e.gridOptions.rowData)},getProvides(){let e=Bt(),t={};for(;e;)e&&e.provides&&(t={...t,...e.provides}),e=e.parent;return t},skipChange(e,t,r){if(this.gridReadyFired&&e==="rowData"&&this.$attrs[jS]){if(t===r)return!0;if(t&&r){const i=t,s=r;if(i.length===s.length){for(let n=0;n<i.length;n++)if(i[n]!==s[n])return!1;return!0}}}return!1},debounce(e,t){let r;return()=>{const i=function(){e()};window.clearTimeout(r),r=window.setTimeout(i,t)}}},mounted(){this.emitRowModel=this.debounce(()=>{this.$emit(nie,Object.freeze(this.getRowData()))},20);const e=this.getProvides(),t=new tie(this,e),r=Bf(BK(lg(this.gridOptions),this));this.checkForBindingConflicts();const i=this.getRowDataBasedOnBindings();i!==ji.VUE_OMITTED_PROPERTY&&(r.rowData=dT(i));const s={globalEventListener:this.globalEventListenerFactory().bind(this),globalSyncEventListener:this.globalEventListenerFactory(!0).bind(this),frameworkOverrides:new iie(this),providedBeanInstances:{frameworkComponentWrapper:t},modules:this.modules};this.api=Jte(this.$el,r,s),this.gridCreated=!0},unmounted(){var e;this.gridCreated&&((e=this.api)==null||e.destroy(),this.isDestroyed=!0)}});const uie={class:"w-full flex flex-col p-2 box-border"},die={class:"bg-white border-1 p-2 border-solid border-gray-2 shadow-md overflow-hidden"},hie={class:"text-green-5"},fie={class:"flex-auto p-4 bg-white border-1 border-solid border-gray-2 border-t-0 shadow-md overflow-hidden",style:{height:"0"}},pie=_e({__name:"Excel",setup(e){const t=we(""),r=we([]),i=we(!1);we();const s=we(4),n=we(""),o=we(""),a=we([]),l=eK(),c=Q(()=>l.fileList.value),u=["备注","商品名称","业务描述"],d=Q(()=>c.value.find(T=>T.fileName===t.value)||{});function h(T){return Object.prototype.toString.call(T)==="[object String]"}const p=T=>h(T)?T==="序号"?50:T.includes("号")?200:T.includes("时间")?220:u.includes(T)?350:150:150;function g(T,A){if(A){const P=`<span style='color: red'>${A}</span>`;return T.replace(A,P)}else return T}const f=T=>{const A=T.column.colId,P=T.value;return h(A)?A.includes("时间")?J4(P).format("YYYY-MM-DD HH:mm:ss")||"":A.includes("号")?P:n.value&&n.value===A&&o.value?g(P,o.value):P:P},m=T=>{if(a.value.includes(T))return h0.RIGHT},v=Q(()=>{var A,P;const T=((P=(A=d.value)==null?void 0:A.headers)==null?void 0:P.map((U,J)=>({field:U,headerName:U,width:p(U),cellRenderer:f,pinned:m(U)?"right":""})))||[];return T.unshift({headerName:"序号",valueGetter:"node.rowIndex + 1",width:80}),T}),w=Q(()=>{var T;return((T=v.value)==null?void 0:T.map(A=>A))||[]}),C=Q(()=>{var T,A;return((A=(T=d.value)==null?void 0:T.data)==null?void 0:A.filter(P=>{var U;return n.value&&o.value?(U=P[n.value])==null?void 0:U.includes(o.value):!0}))||[]}),F=Q(()=>v.value.filter(T=>h(T==null?void 0:T.headerName)?T.headerName.includes("额"):!1)),D=T=>{var A;return(A=C.value)==null?void 0:A.reduce((P,U)=>{const J=Number(U[T]);return P+J},0).toFixed(2)},R=async T=>{y(T)},y=async T=>{if(!T){cf("亲，请先上传数据哦~");return}i.value=!0;const A=T.raw,P=[],U=[];if(T.name.endsWith(".csv")){const B=await A.text(),H=H7.parse(B,{header:!0});P.push(...Object.keys(H.data[0])),U.push(...H.data)}else if(T.name.endsWith(".xls")||T.name.endsWith(".xlsx")){const B=new Uint8Array(await A.arrayBuffer()),H=Np(B,{type:"array"}),_=H.Sheets[H.SheetNames[0]],se=B7.sheet_to_json(_,{header:1});P.push(...se[s.value]);for(let G=s.value+1;G<se.length;G++){const he=se[G],Re={};P.forEach((M,X)=>{Re[M]=he[X]||""}),U.push(Re)}}else{cf("不支持的文件类型"),i.value=!1;return}const J={fileName:T.name,headers:P,data:U};await l.storeData(J),l.fileList.value.push(J),t.value=T.name,i.value=!1},b=async(T,A)=>{A=="remove"&&(await l.deleteData(T),await l.getStoreAll(),t.value===T&&(t.value=c.value.length?c.value[0].fileName:""))},x=async()=>{var B;if(!C.value.length){cf("没有数据哦，不可以导出");return}const T=new ExcelJS.Workbook,A=T.addWorksheet("Sheet 1");A.addRow((B=d.value)==null?void 0:B.headers),C.value.forEach(H=>{A.addRow(Object.values(H))}),A.columns.forEach(H=>{H.width=30});const P=await T.xlsx.writeBuffer(),U=new Blob([P],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),J=n.value&&o.value?`${n.value}-${o.value}-筛选数据`:t.value;V7.saveAs(U,`${J}.xlsx`)};return Gt(async()=>{await l.getStoreAll(),c.value.length&&(t.value=c.value[0].fileName)}),(T,A)=>{const P=p3,U=f3,J=$N,B=s0,H=jG,_=X4,se=mV,G=zN,he=BH,Re=NH,M=xH,X=xV;return ue(),Ie("div",uie,[Oe("div",die,[ye(G,{class:"flex flex-wrap","label-suffix":"：",inline:""},{default:ze(()=>[ye(J,{label:"设置固定列"},{default:ze(()=>[ye(U,{modelValue:a.value,"onUpdate:modelValue":A[0]||(A[0]=z=>a.value=z),placeholder:"请选择筛选过滤项",style:{width:"240px"},multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:ze(()=>[(ue(!0),Ie(Dt,null,ao(v.value,z=>(ue(),Je(P,{key:z,label:z.headerName,value:z.headerName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),ye(J,{label:"筛选过滤项"},{default:ze(()=>[ye(U,{modelValue:n.value,"onUpdate:modelValue":A[1]||(A[1]=z=>n.value=z),placeholder:"请选择筛选过滤项",style:{width:"240px"}},{default:ze(()=>[(ue(!0),Ie(Dt,null,ao(v.value,z=>(ue(),Je(P,{key:z,label:z.headerName,value:z.headerName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),ye(J,{label:"筛选过滤关键词"},{default:ze(()=>[ye(B,{style:{width:"240px"},modelValue:o.value,"onUpdate:modelValue":A[2]||(A[2]=z=>o.value=z),placeholder:"请输入需要筛选的关键词"},null,8,["modelValue"])]),_:1}),ye(J,{label:"表头所在行"},{default:ze(()=>[ye(H,{modelValue:s.value,"onUpdate:modelValue":A[3]||(A[3]=z=>s.value=z),min:0},null,8,["modelValue"])]),_:1}),ye(J,null,{default:ze(()=>[ye(se,{"file-list":r.value,"onUpdate:fileList":A[4]||(A[4]=z=>r.value=z),action:"","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls,.csv","on-change":R},{default:ze(()=>[ye(_,{type:"primary"},{default:ze(()=>[nd("上传数据")]),_:1})]),_:1},8,["file-list"])]),_:1}),ye(J,null,{default:ze(()=>[ye(_,{type:"primary",onClick:x},{default:ze(()=>[nd("导出Excel")]),_:1})]),_:1}),ye(J,null,{default:ze(()=>[(ue(!0),Ie(Dt,null,ao(F.value,(z,Y)=>(ue(),Ie("span",{class:"mr-2",key:Y},[Oe("span",null,"总"+Ut(z.headerName)+"：",1),Oe("span",hie,Ut(D(z.headerName)),1)]))),128))]),_:1})]),_:1})]),ye(Re,{class:"bg-white mt-2",modelValue:t.value,"onUpdate:modelValue":A[5]||(A[5]=z=>t.value=z),closable:"",type:"card",onEdit:b},{default:ze(()=>[(ue(!0),Ie(Dt,null,ao(c.value,(z,Y)=>(ue(),Je(he,{key:Y,label:z.fileName,name:z.fileName},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),Yr((ue(),Ie("div",fie,[ye(M,null,{default:ze(({height:z,width:Y})=>[C.value.length?(ue(),Je(S(cie),{key:0,rowData:C.value,columnDefs:w.value,style:kt({height:z+"px"}),class:"ag-theme-quartz"},null,8,["rowData","columnDefs","style"])):We("",!0)]),_:1})])),[[X,i.value]])])}}}),gie=(e,t)=>{const r=e.__vccOpts||e;for(const[i,s]of t)r[i]=s;return r},mie=gie(pie,[["__scopeId","data-v-8d5b5993"]]),vie={class:"flex p-2 h-full box-border"},Cie=_e({__name:"App",setup(e){return(t,r)=>{const i=KL;return ue(),Je(i,{namespace:"ep"},{default:ze(()=>[Oe("div",vie,[ye(mie)])]),_:1})}}}),wie="modulepreload",Sie=function(e){return"/finance-tool/"+e},qS={},yie=function(t,r,i){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));s=Promise.all(r.map(a=>{if(a=Sie(a),a in qS)return;qS[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":wie,l||(u.as="script",u.crossOrigin=""),u.href=a,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return s.then(()=>t()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})};/*!
  * vue-router v4.4.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const aa=typeof document<"u";function xie(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Pt=Object.assign;function Gf(e,t){const r={};for(const i in t){const s=t[i];r[i]=ns(s)?s.map(e):e(s)}return r}const Xl=()=>{},ns=Array.isArray,fT=/#/g,bie=/&/g,Rie=/\//g,Eie=/=/g,Fie=/\?/g,pT=/\+/g,Tie=/%5B/g,Aie=/%5D/g,gT=/%5E/g,Pie=/%60/g,mT=/%7B/g,Die=/%7C/g,vT=/%7D/g,Mie=/%20/g;function Em(e){return encodeURI(""+e).replace(Die,"|").replace(Tie,"[").replace(Aie,"]")}function kie(e){return Em(e).replace(mT,"{").replace(vT,"}").replace(gT,"^")}function ug(e){return Em(e).replace(pT,"%2B").replace(Mie,"+").replace(fT,"%23").replace(bie,"%26").replace(Pie,"`").replace(mT,"{").replace(vT,"}").replace(gT,"^")}function _ie(e){return ug(e).replace(Eie,"%3D")}function Iie(e){return Em(e).replace(fT,"%23").replace(Fie,"%3F")}function Oie(e){return e==null?"":Iie(e).replace(Rie,"%2F")}function Ec(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const Lie=/\/$/,Nie=e=>e.replace(Lie,"");function Hf(e,t,r="/"){let i,s={},n="",o="";const a=t.indexOf("#");let l=t.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(i=t.slice(0,l),n=t.slice(l+1,a>-1?a:t.length),s=e(n)),a>-1&&(i=i||t.slice(0,a),o=t.slice(a,t.length)),i=Vie(i??t,r),{fullPath:i+(n&&"?")+n+o,path:i,query:s,hash:Ec(o)}}function Bie(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function YS(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Gie(e,t,r){const i=t.matched.length-1,s=r.matched.length-1;return i>-1&&i===s&&Ba(t.matched[i],r.matched[s])&&CT(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Ba(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function CT(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Hie(e[r],t[r]))return!1;return!0}function Hie(e,t){return ns(e)?XS(e,t):ns(t)?XS(t,e):e===t}function XS(e,t){return ns(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function Vie(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let n=r.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")n>1&&n--;else break;return r.slice(0,n).join("/")+"/"+i.slice(o).join("/")}const hn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Fc;(function(e){e.pop="pop",e.push="push"})(Fc||(Fc={}));var Ql;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Ql||(Ql={}));function Wie(e){if(!e)if(aa){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Nie(e)}const zie=/^[^#]+#/;function $ie(e,t){return e.replace(zie,"#")+t}function Uie(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const Ph=()=>({left:window.scrollX,top:window.scrollY});function Kie(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;t=Uie(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function QS(e,t){return(history.state?history.state.position-t:-1)+e}const dg=new Map;function jie(e,t){dg.set(e,t)}function qie(e){const t=dg.get(e);return dg.delete(e),t}let Yie=()=>location.protocol+"//"+location.host;function wT(e,t){const{pathname:r,search:i,hash:s}=t,n=e.indexOf("#");if(n>-1){let a=s.includes(e.slice(n))?e.slice(n).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),YS(l,"")}return YS(r,e)+i+s}function Xie(e,t,r,i){let s=[],n=[],o=null;const a=({state:h})=>{const p=wT(e,location),g=r.value,f=t.value;let m=0;if(h){if(r.value=p,t.value=h,o&&o===g){o=null;return}m=f?h.position-f.position:0}else i(p);s.forEach(v=>{v(r.value,g,{delta:m,type:Fc.pop,direction:m?m>0?Ql.forward:Ql.back:Ql.unknown})})};function l(){o=r.value}function c(h){s.push(h);const p=()=>{const g=s.indexOf(h);g>-1&&s.splice(g,1)};return n.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(Pt({},h.state,{scroll:Ph()}),"")}function d(){for(const h of n)h();n=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function JS(e,t,r,i=!1,s=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:s?Ph():null}}function Qie(e){const{history:t,location:r}=window,i={value:wT(e,r)},s={value:t.state};s.value||n(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function n(l,c,u){const d=e.indexOf("#"),h=d>-1?(r.host&&document.querySelector("base")?e:e.slice(d))+l:Yie()+e+l;try{t[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),r[u?"replace":"assign"](h)}}function o(l,c){const u=Pt({},t.state,JS(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});n(l,u,!0),i.value=l}function a(l,c){const u=Pt({},s.value,t.state,{forward:l,scroll:Ph()});n(u.current,u,!0);const d=Pt({},JS(i.value,l,null),{position:u.position+1},c);n(l,d,!1),i.value=l}return{location:i,state:s,push:a,replace:o}}function Jie(e){e=Wie(e);const t=Qie(e),r=Xie(e,t.state,t.location,t.replace);function i(n,o=!0){o||r.pauseListeners(),history.go(n)}const s=Pt({location:"",base:e,go:i,createHref:$ie.bind(null,e)},t,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Zie(e){return typeof e=="string"||e&&typeof e=="object"}function ST(e){return typeof e=="string"||typeof e=="symbol"}const yT=Symbol("");var ZS;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(ZS||(ZS={}));function Ga(e,t){return Pt(new Error,{type:e,[yT]:!0},t)}function Is(e,t){return e instanceof Error&&yT in e&&(t==null||!!(e.type&t))}const ey="[^/]+?",ese={sensitive:!1,strict:!1,start:!0,end:!0},tse=/[.+*?^${}()[\]/\\]/g;function rse(e,t){const r=Pt({},ese,t),i=[];let s=r.start?"^":"";const n=[];for(const c of e){const u=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let d=0;d<c.length;d++){const h=c[d];let p=40+(r.sensitive?.25:0);if(h.type===0)d||(s+="/"),s+=h.value.replace(tse,"\\$&"),p+=40;else if(h.type===1){const{value:g,repeatable:f,optional:m,regexp:v}=h;n.push({name:g,repeatable:f,optional:m});const w=v||ey;if(w!==ey){p+=10;try{new RegExp(`(${w})`)}catch(F){throw new Error(`Invalid custom RegExp for param "${g}" (${w}): `+F.message)}}let C=f?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;d||(C=m&&c.length<2?`(?:/${C})`:"/"+C),m&&(C+="?"),s+=C,p+=20,m&&(p+=-8),f&&(p+=-20),w===".*"&&(p+=-50)}u.push(p)}i.push(u)}if(r.strict&&r.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const o=new RegExp(s,r.sensitive?"":"i");function a(c){const u=c.match(o),d={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",g=n[h-1];d[g.name]=p&&g.repeatable?p.split("/"):p}return d}function l(c){let u="",d=!1;for(const h of e){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:g,repeatable:f,optional:m}=p,v=g in c?c[g]:"";if(ns(v)&&!f)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const w=ns(v)?v.join("/"):v;if(!w)if(m)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${g}"`);u+=w}}return u||"/"}return{re:o,score:i,keys:n,parse:a,stringify:l}}function ise(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function xT(e,t){let r=0;const i=e.score,s=t.score;for(;r<i.length&&r<s.length;){const n=ise(i[r],s[r]);if(n)return n;r++}if(Math.abs(s.length-i.length)===1){if(ty(i))return 1;if(ty(s))return-1}return s.length-i.length}function ty(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const sse={type:0,value:""},nse=/[a-zA-Z0-9_]/;function ose(e){if(!e)return[[]];if(e==="/")return[[sse]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,i=r;const s=[];let n;function o(){n&&s.push(n),n=[]}let a=0,l,c="",u="";function d(){c&&(r===0?n.push({type:0,value:c}):r===1||r===2||r===3?(n.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),n.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;a<e.length;){if(l=e[a++],l==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),r=1):h();break;case 4:h(),r=i;break;case 1:l==="("?r=2:nse.test(l)?h():(d(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:d(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),d(),o(),s}function ase(e,t,r){const i=rse(ose(e.path),r),s=Pt(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function lse(e,t){const r=[],i=new Map;t=sy({strict:!1,end:!0,sensitive:!1},t);function s(d){return i.get(d)}function n(d,h,p){const g=!p,f=cse(d);f.aliasOf=p&&p.record;const m=sy(t,d),v=[f];if("alias"in d){const F=typeof d.alias=="string"?[d.alias]:d.alias;for(const D of F)v.push(Pt({},f,{components:p?p.record.components:f.components,path:D,aliasOf:p?p.record:f}))}let w,C;for(const F of v){const{path:D}=F;if(h&&D[0]!=="/"){const R=h.record.path,y=R[R.length-1]==="/"?"":"/";F.path=h.record.path+(D&&y+D)}if(w=ase(F,h,m),p?p.alias.push(w):(C=C||w,C!==w&&C.alias.push(w),g&&d.name&&!iy(w)&&o(d.name)),bT(w)&&l(w),f.children){const R=f.children;for(let y=0;y<R.length;y++)n(R[y],w,p&&p.children[y])}p=p||w}return C?()=>{o(C)}:Xl}function o(d){if(ST(d)){const h=i.get(d);h&&(i.delete(d),r.splice(r.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=r.indexOf(d);h>-1&&(r.splice(h,1),d.record.name&&i.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return r}function l(d){const h=hse(d,r);r.splice(h,0,d),d.record.name&&!iy(d)&&i.set(d.record.name,d)}function c(d,h){let p,g={},f,m;if("name"in d&&d.name){if(p=i.get(d.name),!p)throw Ga(1,{location:d});m=p.record.name,g=Pt(ry(h.params,p.keys.filter(C=>!C.optional).concat(p.parent?p.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),d.params&&ry(d.params,p.keys.map(C=>C.name))),f=p.stringify(g)}else if(d.path!=null)f=d.path,p=r.find(C=>C.re.test(f)),p&&(g=p.parse(f),m=p.record.name);else{if(p=h.name?i.get(h.name):r.find(C=>C.re.test(h.path)),!p)throw Ga(1,{location:d,currentLocation:h});m=p.record.name,g=Pt({},h.params,d.params),f=p.stringify(g)}const v=[];let w=p;for(;w;)v.unshift(w.record),w=w.parent;return{name:m,path:f,params:g,matched:v,meta:dse(v)}}e.forEach(d=>n(d));function u(){r.length=0,i.clear()}return{addRoute:n,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:s}}function ry(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function cse(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:use(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function use(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="object"?r[i]:r;return t}function iy(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function dse(e){return e.reduce((t,r)=>Pt(t,r.meta),{})}function sy(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function hse(e,t){let r=0,i=t.length;for(;r!==i;){const n=r+i>>1;xT(e,t[n])<0?i=n:r=n+1}const s=fse(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function fse(e){let t=e;for(;t=t.parent;)if(bT(t)&&xT(e,t)===0)return t}function bT({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function pse(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<i.length;++s){const n=i[s].replace(pT," "),o=n.indexOf("="),a=Ec(o<0?n:n.slice(0,o)),l=o<0?null:Ec(n.slice(o+1));if(a in t){let c=t[a];ns(c)||(c=t[a]=[c]),c.push(l)}else t[a]=l}return t}function ny(e){let t="";for(let r in e){const i=e[r];if(r=_ie(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(ns(i)?i.map(n=>n&&ug(n)):[i&&ug(i)]).forEach(n=>{n!==void 0&&(t+=(t.length?"&":"")+r,n!=null&&(t+="="+n))})}return t}function gse(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=ns(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const mse=Symbol(""),oy=Symbol(""),Fm=Symbol(""),RT=Symbol(""),hg=Symbol("");function pl(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function Sn(e,t,r,i,s,n=o=>o()){const o=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=h=>{h===!1?l(Ga(4,{from:r,to:t})):h instanceof Error?l(h):Zie(h)?l(Ga(2,{from:t,to:h})):(o&&i.enterCallbacks[s]===o&&typeof h=="function"&&o.push(h),a())},u=n(()=>e.call(i&&i.instances[s],t,r,c));let d=Promise.resolve(u);e.length<3&&(d=d.then(c)),d.catch(h=>l(h))})}function Vf(e,t,r,i,s=n=>n()){const n=[];for(const o of e)for(const a in o.components){let l=o.components[a];if(!(t!=="beforeRouteEnter"&&!o.instances[a]))if(vse(l)){const u=(l.__vccOpts||l)[t];u&&n.push(Sn(u,r,i,o,a,s))}else{let c=l();n.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${o.path}"`));const d=xie(u)?u.default:u;o.components[a]=d;const p=(d.__vccOpts||d)[t];return p&&Sn(p,r,i,o,a,s)()}))}}return n}function vse(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function ay(e){const t=rt(Fm),r=rt(RT),i=Q(()=>{const l=S(e.to);return t.resolve(l)}),s=Q(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],d=r.matched;if(!u||!d.length)return-1;const h=d.findIndex(Ba.bind(null,u));if(h>-1)return h;const p=ly(l[c-2]);return c>1&&ly(u)===p&&d[d.length-1].path!==p?d.findIndex(Ba.bind(null,l[c-2])):h}),n=Q(()=>s.value>-1&&yse(r.params,i.value.params)),o=Q(()=>s.value>-1&&s.value===r.matched.length-1&&CT(r.params,i.value.params));function a(l={}){return Sse(l)?t[S(e.replace)?"replace":"push"](S(e.to)).catch(Xl):Promise.resolve()}return{route:i,href:Q(()=>i.value.href),isActive:n,isExactActive:o,navigate:a}}const Cse=_e({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:ay,setup(e,{slots:t}){const r=Br(ay(e)),{options:i}=rt(Fm),s=Q(()=>({[cy(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[cy(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const n=t.default&&t.default(r);return e.custom?n:yr("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},n)}}}),wse=Cse;function Sse(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function yse(e,t){for(const r in t){const i=t[r],s=e[r];if(typeof i=="string"){if(i!==s)return!1}else if(!ns(s)||s.length!==i.length||i.some((n,o)=>n!==s[o]))return!1}return!0}function ly(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const cy=(e,t,r)=>e??t??r,xse=_e({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=rt(hg),s=Q(()=>e.route||i.value),n=rt(oy,0),o=Q(()=>{let c=S(n);const{matched:u}=s.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=Q(()=>s.value.matched[o.value]);rr(oy,Q(()=>o.value+1)),rr(mse,a),rr(hg,s);const l=we();return Qe(()=>[l.value,a.value,e.name],([c,u,d],[h,p,g])=>{u&&(u.instances[d]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Ba(u,p)||!h)&&(u.enterCallbacks[d]||[]).forEach(f=>f(c))},{flush:"post"}),()=>{const c=s.value,u=e.name,d=a.value,h=d&&d.components[u];if(!h)return uy(r.default,{Component:h,route:c});const p=d.props[u],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,m=yr(h,Pt({},g,t,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return uy(r.default,{Component:m,route:c})||m}}});function uy(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const bse=xse;function Rse(e){const t=lse(e.routes,e),r=e.parseQuery||pse,i=e.stringifyQuery||ny,s=e.history,n=pl(),o=pl(),a=pl(),l=dr(hn);let c=hn;aa&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Gf.bind(null,W=>""+W),d=Gf.bind(null,Oie),h=Gf.bind(null,Ec);function p(W,re){let Z,ee;return ST(W)?(Z=t.getRecordMatcher(W),ee=re):ee=W,t.addRoute(ee,Z)}function g(W){const re=t.getRecordMatcher(W);re&&t.removeRoute(re)}function f(){return t.getRoutes().map(W=>W.record)}function m(W){return!!t.getRecordMatcher(W)}function v(W,re){if(re=Pt({},re||l.value),typeof W=="string"){const V=Hf(r,W,re.path),ie=t.resolve({path:V.path},re),ne=s.createHref(V.fullPath);return Pt(V,ie,{params:h(ie.params),hash:Ec(V.hash),redirectedFrom:void 0,href:ne})}let Z;if(W.path!=null)Z=Pt({},W,{path:Hf(r,W.path,re.path).path});else{const V=Pt({},W.params);for(const ie in V)V[ie]==null&&delete V[ie];Z=Pt({},W,{params:d(V)}),re.params=d(re.params)}const ee=t.resolve(Z,re),Fe=W.hash||"";ee.params=u(h(ee.params));const L=Bie(i,Pt({},W,{hash:kie(Fe),path:ee.path})),I=s.createHref(L);return Pt({fullPath:L,hash:Fe,query:i===ny?gse(W.query):W.query||{}},ee,{redirectedFrom:void 0,href:I})}function w(W){return typeof W=="string"?Hf(r,W,l.value.path):Pt({},W)}function C(W,re){if(c!==W)return Ga(8,{from:re,to:W})}function F(W){return y(W)}function D(W){return F(Pt(w(W),{replace:!0}))}function R(W){const re=W.matched[W.matched.length-1];if(re&&re.redirect){const{redirect:Z}=re;let ee=typeof Z=="function"?Z(W):Z;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=w(ee):{path:ee},ee.params={}),Pt({query:W.query,hash:W.hash,params:ee.path!=null?{}:W.params},ee)}}function y(W,re){const Z=c=v(W),ee=l.value,Fe=W.state,L=W.force,I=W.replace===!0,V=R(Z);if(V)return y(Pt(w(V),{state:typeof V=="object"?Pt({},Fe,V.state):Fe,force:L,replace:I}),re||Z);const ie=Z;ie.redirectedFrom=re;let ne;return!L&&Gie(i,ee,Z)&&(ne=Ga(16,{to:ie,from:ee}),Re(ee,ee,!0,!1)),(ne?Promise.resolve(ne):T(ie,ee)).catch(j=>Is(j)?Is(j,2)?j:he(j):se(j,ie,ee)).then(j=>{if(j){if(Is(j,2))return y(Pt({replace:I},w(j.to),{state:typeof j.to=="object"?Pt({},Fe,j.to.state):Fe,force:L}),re||ie)}else j=P(ie,ee,!0,I,Fe);return A(ie,ee,j),j})}function b(W,re){const Z=C(W,re);return Z?Promise.reject(Z):Promise.resolve()}function x(W){const re=z.values().next().value;return re&&typeof re.runWithContext=="function"?re.runWithContext(W):W()}function T(W,re){let Z;const[ee,Fe,L]=Ese(W,re);Z=Vf(ee.reverse(),"beforeRouteLeave",W,re);for(const V of ee)V.leaveGuards.forEach(ie=>{Z.push(Sn(ie,W,re))});const I=b.bind(null,W,re);return Z.push(I),ae(Z).then(()=>{Z=[];for(const V of n.list())Z.push(Sn(V,W,re));return Z.push(I),ae(Z)}).then(()=>{Z=Vf(Fe,"beforeRouteUpdate",W,re);for(const V of Fe)V.updateGuards.forEach(ie=>{Z.push(Sn(ie,W,re))});return Z.push(I),ae(Z)}).then(()=>{Z=[];for(const V of L)if(V.beforeEnter)if(ns(V.beforeEnter))for(const ie of V.beforeEnter)Z.push(Sn(ie,W,re));else Z.push(Sn(V.beforeEnter,W,re));return Z.push(I),ae(Z)}).then(()=>(W.matched.forEach(V=>V.enterCallbacks={}),Z=Vf(L,"beforeRouteEnter",W,re,x),Z.push(I),ae(Z))).then(()=>{Z=[];for(const V of o.list())Z.push(Sn(V,W,re));return Z.push(I),ae(Z)}).catch(V=>Is(V,8)?V:Promise.reject(V))}function A(W,re,Z){a.list().forEach(ee=>x(()=>ee(W,re,Z)))}function P(W,re,Z,ee,Fe){const L=C(W,re);if(L)return L;const I=re===hn,V=aa?history.state:{};Z&&(ee||I?s.replace(W.fullPath,Pt({scroll:I&&V&&V.scroll},Fe)):s.push(W.fullPath,Fe)),l.value=W,Re(W,re,Z,I),he()}let U;function J(){U||(U=s.listen((W,re,Z)=>{if(!Y.listening)return;const ee=v(W),Fe=R(ee);if(Fe){y(Pt(Fe,{replace:!0}),ee).catch(Xl);return}c=ee;const L=l.value;aa&&jie(QS(L.fullPath,Z.delta),Ph()),T(ee,L).catch(I=>Is(I,12)?I:Is(I,2)?(y(I.to,ee).then(V=>{Is(V,20)&&!Z.delta&&Z.type===Fc.pop&&s.go(-1,!1)}).catch(Xl),Promise.reject()):(Z.delta&&s.go(-Z.delta,!1),se(I,ee,L))).then(I=>{I=I||P(ee,L,!1),I&&(Z.delta&&!Is(I,8)?s.go(-Z.delta,!1):Z.type===Fc.pop&&Is(I,20)&&s.go(-1,!1)),A(ee,L,I)}).catch(Xl)}))}let B=pl(),H=pl(),_;function se(W,re,Z){he(W);const ee=H.list();return ee.length?ee.forEach(Fe=>Fe(W,re,Z)):console.error(W),Promise.reject(W)}function G(){return _&&l.value!==hn?Promise.resolve():new Promise((W,re)=>{B.add([W,re])})}function he(W){return _||(_=!W,J(),B.list().forEach(([re,Z])=>W?Z(W):re()),B.reset()),W}function Re(W,re,Z,ee){const{scrollBehavior:Fe}=e;if(!aa||!Fe)return Promise.resolve();const L=!Z&&qie(QS(W.fullPath,0))||(ee||!Z)&&history.state&&history.state.scroll||null;return Tt().then(()=>Fe(W,re,L)).then(I=>I&&Kie(I)).catch(I=>se(I,W,re))}const M=W=>s.go(W);let X;const z=new Set,Y={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:f,resolve:v,options:e,push:F,replace:D,go:M,back:()=>M(-1),forward:()=>M(1),beforeEach:n.add,beforeResolve:o.add,afterEach:a.add,onError:H.add,isReady:G,install(W){const re=this;W.component("RouterLink",wse),W.component("RouterView",bse),W.config.globalProperties.$router=re,Object.defineProperty(W.config.globalProperties,"$route",{enumerable:!0,get:()=>S(l)}),aa&&!X&&l.value===hn&&(X=!0,F(s.location).catch(Fe=>{}));const Z={};for(const Fe in hn)Object.defineProperty(Z,Fe,{get:()=>l.value[Fe],enumerable:!0});W.provide(Fm,re),W.provide(RT,xg(Z)),W.provide(hg,l);const ee=W.unmount;z.add(W),W.unmount=function(){z.delete(W),z.size<1&&(c=hn,U&&U(),U=null,l.value=hn,X=!1,_=!1),ee()}}};function ae(W){return W.reduce((re,Z)=>re.then(()=>x(Z)),Promise.resolve())}return Y}function Ese(e,t){const r=[],i=[],s=[],n=Math.max(t.matched.length,e.matched.length);for(let o=0;o<n;o++){const a=t.matched[o];a&&(e.matched.find(c=>Ba(c,a))?i.push(a):r.push(a));const l=e.matched[o];l&&(t.matched.find(c=>Ba(c,l))||s.push(l))}return[r,i,s]}const Fse=[{path:"/",name:"login",component:()=>yie(()=>import("./index-1Zbuq6af.js"),__vite__mapDeps([]))}],ET=Rse({history:Jie(),routes:Fse,strict:!0,scrollBehavior(e,t,r){return new Promise(i=>{if(r)return r;if(t.meta.saveSrollTop){const s=document.documentElement.scrollTop||document.body.scrollTop;i({left:0,top:s})}})}});ET.beforeEach((e,t,r)=>{r()});const Tse=xx(Cie).use(ET);Tse.mount("#app");export{gie as _,Ie as c,ue as o};
